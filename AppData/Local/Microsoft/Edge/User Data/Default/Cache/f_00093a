(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["218"],{"725":function(e,t,n){"use strict";var r=n(0),i=n(25),s=n(809),o=n(156),u=n(258),a=n(26),f=n(753),l=n(150),c=n(236),h=n(193),p=n(798),d=n(747),v=n(813);function m(e){var t=e.options,n=t.url,s=t.authToken,o=t.telemetryHandler,u=t.useExactAuthToken,f=e.dataSyncClient,l=e.aadUserId,c=e.getData,h=function(){return c({url:n,telemetryHandler:o,authToken:s,useExactAuthToken:u})};if(!l)return h();var p=function(e){var t=(function(e,t){return function(n,i){var s=n.eventData,o=s.extraData,u={performanceEntry:o&&o.performanceEntry,httpStatus:o&&o.HttpStatus,correlationId:o&&o.CorrelationId,succeeded:s&&s.resultType===a.e.Success||!1,resultCode:s&&s.resultCode,endpoint:i},f=t&&t(n),l=e.onRequestComplete(u);o.dataSyncQos=e.getQosInfo();return Object(r.__assign)(Object(r.__assign)({},f||{}),{eventData:Object(r.__assign)(Object(r.__assign)({},f?f.eventData:s),{extraData:Object(r.__assign)(Object(r.__assign)({},f?f.eventData.extraData:s.extraData),e.getQosInfo())}),canRetry:l&&(!f||f.canRetry)})}})(e,o);return e.getData({url:n},function(e){return c({url:e.url,authToken:e.authToken,telemetryHandler:function(n){return t(n,e)},useExactAuthToken:!0})},h)};return i.n.resolve(f).then(function(e){return e?p(e):h()})}n.d(t,"e",function(){return b});var g="undefined"!=typeof window?window:void 0,y=g&&g.performance;var b=(function(){function e(e,t){this._pageContext=t?t.pageContext:e.pageContext;this._tokenProvider=t&&t.tokenProvider;this._dataSyncClient=t&&t.dataSyncClient||this._pageContext&&this._pageContext.dataSyncClient;this._qosName=e.qosName;this._apiEvent=t&&t.apiEvent||o.t;this._engagement=t&&t.engagement||u.e;this._normalizeErrors=!!e.normalizeErrors;this._getDataWithTokenProvider=t&&t.getDataWithTokenProvider;this._getDataWithSyncClient=t&&t.getDataWithSyncClient||this._dataSyncClient?m:void 0}e.parseJSON=function(e){return e&&JSON.parse(e)||void 0};e.prototype.getData=function(t){var n,o=this,u=t.parseResponse,m=void 0===u?e.parseJSON:u,b=t.qosExtraData,w=t.additionalPostData,E=void 0===w?"":w,S=t.contentType,x=t.method,T=void 0===x?"POST":x,N=t.maxRetries,C=void 0===N?0:N,k=t.responseType,L=t.onUploadProgress,A=t.timeout,O=t.noTimeoutInLastRetry,M=void 0!==O&&O,_=this._pageContext,D=this._tokenProvider,P=this._getDataWithTokenProvider,H=this._getDataWithSyncClient,B=[];this._qosName&&B.push(this._qosName);t.qosName&&B.push(t.qosName);var j=B.join("."),F=function(e){var n=e.url,u=e.telemetryHandler,w=e.authToken,x=e.useExactAuthToken,N=void 0!==x&&x,O=!0,H=new c.e(n),B=H.authority+"/{ length: "+H.path.length+", segments: "+H.segments.length+" }",F=function(e){var w=e.authToken,x=e.qosExtraData,D=t.crossSiteCollectionCall,P=void 0!==D&&D,H=t.noRedirect,F=void 0!==H&&H,I=t.needsRequestDigest,q=void 0===I||I,R=t.additionalHeaders?Object(r.__assign)({},t.additionalHeaders):void 0;if(w){var U=N?w:"Bearer "+w;if(R){var z=!1;for(var W in R)W&&"authorization"===W.toLowerCase()&&(z=!0);z||(R.Authorization=U)}else R={Authorization:U};P=!0;q=!1;F=!0}var X,V,$=new v.e(Object(r.__assign)(Object(r.__assign)({},_?{webServerRelativeUrl:_.webServerRelativeUrl,webAbsoluteUrl:P?_.webAbsoluteUrl:void 0,formDigest:{serverTime:_.serverTime,updateFormDigestPageLoaded:_.updateFormDigestPageLoaded,formDigestValue:_.formDigestValue,formDigestTimeoutSeconds:_.formDigestTimeoutSeconds}}:{}),{needsRequestDigest:q,engagement:o._engagement,operationName:o._qosName})),J=g&&g.location&&new c.e(g.location.href).authority,K=new c.e(n).authority,Q=f.t.getRUMOneLogger(),G=Date.now();Q&&(Boolean(Q.readTempData("appDataFetchStart"))||Q.saveTempData("appDataFetchStart",G));return(function(e){var t,n=e.onExecute,r=e.onCancel,o=e.timeout,u=e.canRetry,a=e.noTimeoutInLastRetry,f=0,l=Math.max(e.maxRetries,0),c=function(){var e=new i.n(n,function(){r(f>=l||!u())});return o&&(!a||f<l)?i.n.timeout(o,e):e};t=f<l?Object(s.e)({canRetry:u,retries:l,callback:c,beforeRetry:function(){f++}}):c();return t})({timeout:A,onExecute:function(e,t){var i=function(i,s){return function(f){var l=f.getResponseText();V=f.getServiceWorkerDataSourceHeader();var c,d,v,g,y=Object(h.e)(n,s),E=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},b||{}),{needsRequestDigest:q,hasAuthToken:!!w,isCrossOrigin:!!J&&J!==K,CorrelationId:f.getCorrelationId()}),x||{}),{HttpStatus:f.getStatus(),serviceWorkerDataSource:V||void 0,rawRequestDuration:y.duration,performanceEntry:JSON.stringify(y),serviceWorkerFetchInfo:f.getServiceWorkerFetchInfoFromHeader()||void 0}),S=!1;try{!(function(e,t){return"blob"===e&&t&&"object"==typeof t})(k,l)?d=m(l,f):v=l;S=!0}catch(e){c=e;g={resultType:a.e.Failure,resultCode:"InvalidJSON",error:"object"==typeof e?JSON.stringify(e):e,extraData:E}}g||(g={resultType:a.e.Success,extraData:E});if(u){g=u({response:d,eventData:g}).eventData}i.end(g);if(S)try{e(v||d)}catch(e){}else t(o._normalizeErrors?new p.e({code:"-1,parse_response",innerError:c,errorData:{status:f.getStatus()}}):void 0);$=void 0}},s=function(e,i){return function(s,f){var c=Object(h.e)(n,i),v=Object(r.__assign)(Object(r.__assign)({},b||{}),{needsRequestDigest:q,hasAuthToken:!!w,isCrossOrigin:!!J&&J!==K,rawRequestDuration:c.duration,performanceEntry:JSON.stringify(c)}),m="undefined"!=typeof navigator&&!1===navigator.onLine;if(s){var g=s.getCorrelationId(),y=s.getGroupThrottle(),E=s.getMSCorrelationVector(),S=s.getStatus(),x=s.getAuthErrorType(),T=s.getFBAError();v=Object(r.__assign)(Object(r.__assign)({},v),{CorrelationId:g,HttpStatus:S,GroupThrottle:y,MSCorrelationVector:E,AuthErrorType:x});var N=a.e.Failure;if(401===S&&T||403===S||404===S||429===S||503===S||-1===S||0===S&&m){O=!1;N=a.e.ExpectedFailure}var C=function(n){var i,f=void 0;if("object"==typeof n&&"number"==typeof n.status)f=n;else if("string"==typeof n){var c=void 0;try{c=JSON.parse(n)}catch(e){}i=(function(e){var t=e.authDiagnostics,n=e.fbaHeaderError;if(t)try{var r=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?/.exec(t),i=r[1],s=void 0===i?"-1":i,o=r[2],u=void 0===o?"":o,a=r[3],f=void 0===a?"unknown":a,c=void 0;switch(Number(s)){case 3e6:case 3000003:case 3000006:case 3001003:case 3001004:case 3001005:case 3002e3:case 3004009:case 3004010:case 3003e3:c=!0;break;default:c=!1}return new l.e({code:s+","+f,message:u,isExpected:c})}catch(e){return new l.e({code:"-1,Unknown",innerError:e})}if(n)try{var h=/(\d+);\s+(.+)/.exec(n),p=h[1],d=(s=void 0===p?"-1":p,h[2]);u=void 0===d?"":d;return new l.e({code:""+s,message:u,isExpected:!0})}catch(e){return new l.e({code:"-1,Unknown",innerError:e})}})({authDiagnostics:x,fbaHeaderError:T});c&&(f=c.error_description?{code:"-1,"+(c.error||"Unknown"),message:c.error_description}:"string"==typeof c.error?{message:c.error}:c.error||c["odata.error"]||{responseData:c})}(f=f||{}).status=S;f.retryAfter=s.getRetryAfterHeader();var h=f["@error.redirectUrl"],m=s.getRedirectUrl()||h;m&&(N=a.e.ExpectedFailure);f.redirectUrl=m;f.authenticate=s.getAuthenticateHeader();g&&(f.correlationId=g);y&&(f.groupThrottle=y);"-1,policy_enforced"===f.code&&(N=a.e.ExpectedFailure);i&&i.isExpected&&(N=a.e.ExpectedFailure);f.code=i&&i.code||f.code||d.s;var b="["+S.toString()+"] "+f.code,w=JSON.stringify(f),E={resultType:N,error:w,resultCode:b,extraData:v};if(u){var C=u({eventData:E,errorData:f}),k=C.eventData,L=C.canRetry;E=k;!0!==L&&!1!==L||(O=L)}e.end(E);t(o._normalizeErrors?new p.e(Object(r.__assign)({errorData:f,innerError:i},N===a.e.ExpectedFailure?{isExpected:!0}:{})):f)},k=s.getResponseType();if(k&&"text"!==k)s.parseError().then(C);else{C(s.getResponseText())}}else{var L=d.s,A=!0,M=0;if(f&&f instanceof l.e){L=f.code;A=f.isExpected;M=-1}!m||L!==d.n&&L!==d.s||(L=d.r);var _={status:M,code:L},D={resultType:A?a.e.ExpectedFailure:a.e.Failure,resultCode:L,extraData:v};t(o._normalizeErrors?new p.e({errorData:_,innerError:f}):_);if(u){D=u({eventData:D,errorData:_}).eventData}e.end(D)}}};(function(){var e=X=new o._apiEvent({url:B,name:j}),t=y&&y.now();$.getServerDataFromUrl({url:n,successCallback:i(e,t),failureCallback:s(e,t),uploadProgressCallback:L,additionalPostData:E,method:T,additionalHeaders:R,contentType:S,withCredentials:!w&&void 0,noRedirect:F,responseType:k,needsRequestDigest:q})})()},maxRetries:C,noTimeoutInLastRetry:M,canRetry:function(){return O},onCancel:function(e){if($){$.abort();e&&$.dispose()}}}).then(function(e){$&&$.dispose();return e},function(e){$&&$.dispose();!X.endTime&&i.n.isCanceled(e)&&X.end({resultCode:d.e,resultType:a.e.ExpectedFailure});return i.n.reject(e)})};if(w)return i.n.resolve(w).then(function(e){return F({url:n,authToken:e})});if(D&&D.getAuthToken)return P?P({apiEvent:o._apiEvent,getData:F,options:{url:n,authToken:t.authToken,qosExtraData:t.qosExtraData},webAbsoluteUrl:_&&_.webAbsoluteUrl,qosName:j,tokenProvider:D}):i.n.resolve(D.getAuthToken({url:n,webAbsoluteUrl:_&&_.webAbsoluteUrl})).then(function(e){return F(Object(r.__assign)({url:n},e?"string"==typeof e?{authToken:e}:{authToken:e.authToken,qosExtraData:{AuthCorrelationId:e.correlationId,AuthExpiration:e.expiresOn}}:{}))});if(_){if(_.getAuthToken)return i.n.resolve(_.getAuthToken()).then(function(e){return F({url:n,authToken:e})});if(_.authToken)return i.n.resolve(_.authToken).then(function(e){return F({url:n,authToken:e})})}return F({url:n})},I={authToken:t.authToken,telemetryHandler:t.telemetryHandler,url:t.url,useExactAuthToken:t.useExactAuthToken};return H?H({options:I,aadUserId:null===(n=_)||void 0===n?void 0:n.aadUserId,dataSyncClient:this._dataSyncClient,getData:F}):F(I)};return e})();t.t=b},"728":function(e,t,n){"use strict";n.d(t,"e",function(){return s});n.d(t,"t",function(){return o});var r=n(0),i=n(119),s=(function(){function e(e){var t=e.webAbsoluteUrl,n=e.encodeWebAbsoluteUrl,r=void 0===n||n;this._webAbsoluteUrl=t;this._encodeWebAbsoluteUrl=r;this._segments=[];this._parameters=[];this._rawParameters=[];this._lastParameterId=0}e.prototype.toString=function(){var e,t=[];this._parameters.length&&t.push(this._parameters.map(function(e){return e.name+"="+e.serializedValue}).join("&"));t.push.apply(t,this._rawParameters);e=t.length?"?"+t.join("&"):"";var n=this._webUrl,i=void 0===n?this._webAbsoluteUrl:n;return""+Object(r.__spreadArrays)([this._encodeWebAbsoluteUrl?encodeURI(i):i,"_api"],this._segments).join("/")+e};e.prototype.segment=function(e){return this._extend({segments:[e]})};e.prototype.segments=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._extend({segments:e})};e.prototype.methodWithAliases=function(e,t){for(var n=this,r=[],i=0,s=Object.keys(t);i<s.length;i++){var o=s[i],u=t[o],a=n._autoParameter(u);n=a.apiUrl;r.push(o+"="+a.name)}return n.segment(e+"("+r.join(",")+")")};e.prototype.method=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=this,i=[],s=0,o=t;s<o.length;s++){var u=o[s],a=r._autoParameter(u);r=a.apiUrl;i.push(a.name)}return r.segment(e+"("+i.join(",")+")")};e.prototype.parameter=function(e,t){return this._parameter(e,t)};e.prototype.parameters=function(e){for(var t=this,n=0,r=Object.keys(e);n<r.length;n++){var i=r[n],s=e[i];t=t.parameter(i,s)}return t};e.prototype.oDataParameter=function(e,t){return this.parameter(e,{raw:t})};e.prototype.rawParameter=function(e){return this._extend({rawParameters:[e]})};e.prototype._autoParameter=function(e){var t=this._lastParameterId+1,n="@a"+t;return{name:n,apiUrl:this._extend({lastParameterId:t})._parameter(n,e)}};e.prototype._parameter=function(e,t){var n;n=(function(e){return!!e&&"object"==typeof e&&"json"in e})(t)?i.e.encodeRestUriStringToken(JSON.stringify(t.json)):(function(e){return!!e&&"object"==typeof e&&"guid"in e})(t)?"guid'"+t.guid+"'":(function(e){return!!e&&"object"==typeof e&&"raw"in e})(t)?t.raw:"number"==typeof t||"boolean"==typeof t?""+t:"'"+i.e.encodeRestUriStringToken(t)+"'";return this._extend({parameters:[{name:e,serializedValue:n}]})};e.prototype.clone=function(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})};e.prototype._extend=function(e){var t,n,r,i,s,o;void 0===e&&(e={});var u=this.clone();u._webUrl=this._webUrl;u._lastParameterId=this._lastParameterId;(t=u._parameters).push.apply(t,this._parameters);(n=u._segments).push.apply(n,this._segments);(r=u._rawParameters).push.apply(r,this._rawParameters);"webUrl"in e&&(u._webUrl=e.webUrl);"lastParameterId"in e&&(u._lastParameterId=e.lastParameterId);"parameters"in e&&(i=u._parameters).push.apply(i,e.parameters);"rawParameters"in e&&(s=u._rawParameters).push.apply(s,e.rawParameters);"segments"in e&&(o=u._segments).push.apply(o,e.segments);return u};return e})(),o=(function(){function e(e){this._apiUrlType=(function(t){Object(r.__extends)(n,t);function n(){return t.call(this,{webAbsoluteUrl:e.webAbsoluteUrl,encodeWebAbsoluteUrl:e.encodeWebAbsoluteUrl})||this}return n})(s)}e.prototype.build=function(){return new this._apiUrlType};e.prototype.contextInfoUrl=function(e){var t,n=e.indexOf("/_layouts/");if(n>-1)t=e.substring(0,n);else{var r=e.lastIndexOf("/"),i=e.lastIndexOf(".");t=i>r?e.substring(0,i)+"_"+e.substring(i+1):e}return t+"/_api/contextinfo"};return e})()},"747":function(e,t,n){"use strict";n.d(t,"s",function(){return r});n.d(t,"i",function(){return i});n.d(t,"e",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"t",function(){return a});var r="Unknown",i="RequestAborted",s="Canceled",o="NoConnection",u="Offline",a="MissingWebForDigestAuth"},"765":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(0),i=n(684),s=n(728),o=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{webAbsoluteUrl:n.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this;r._pageContext=n.pageContext;r._shouldEncodeWebAbsoluteUrl=n.encodeWebAbsoluteUrl;r._itemUrlHelper=n.itemUrlHelper;return r}t.prototype.webByUrl=function(e){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(e))};t.prototype.webByItemUrl=function(e){var t=e.siteRelation,n=e.isCrossDomain,r=e.fullItemUrl,s=this;(n||t===i.r.crossSite)&&(s=s.method("SP.RemoteWeb",r));return s.segment("web")};t.prototype.listById=function(e,t){return this.webByItemUrl(e).segment("lists").method("GetById",t)};t.prototype.clone=function(){return new t({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})};return t})(s.e),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var i=e.call(this,{webAbsoluteUrl:n&&n.pageContext?n.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:n.encodeWebAbsoluteUrl})||this,s=n.itemUrlHelper,u=n.pageContext,a=n.encodeWebAbsoluteUrl,f=n.apiUrlType,l=void 0===f?(function(e){Object(r.__extends)(t,e);function t(){return e.call(this,{},{itemUrlHelper:s,pageContext:u,encodeWebAbsoluteUrl:a})||this}return t})(o):f;i._apiUrlType=l;return i}t.prototype.build=function(){return new this._apiUrlType};return t})(s.t)},"798":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(n){var i=this,s=n.errorData,o=void 0===s?n.innerError instanceof t&&n.innerError.errorData||{status:0}:s,u=o.message,a=void 0===u?void 0:u,f=o.correlationId,l=void 0===f?void 0:f,c=o.code,h=void 0===c?void 0:c,p=Object(r.__rest)(o,["message","correlationId","code"]),d="object"==typeof a?a?"string"==typeof a.value?a.value:JSON.stringify(a):""+a:a,v=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},"string"==typeof l?{correlationId:l}:{}),"string"==typeof h?{code:h}:{}),"string"==typeof d?{message:d}:{}),n),{extraData:Object(r.__assign)(Object(r.__assign)({},n.extraData||{}),{hasAuthChallenge:!!p.authenticate,status:p.status,infected:p.infected,groupThrottle:p.groupThrottle,statusText:p.statusText})});(i=e.call(this,v)||this).name="GetDataError";i.errorData=o;for(var m=0,g=Object.keys(p);m<g.length;m++){var y=g[m];i[y]=p[y]}return i}return t})(n(150).e)},"809":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(147);function i(e){var t,n=e.adjustRetries,i=e.async,s=e.beforeRetry,o=e.callback,u=e.canRetry,a=void 0===u?function(){return!0}:u,f=e.delay,l=e.resetAttemptsOnRestart,c=e.retries,h=e.shouldRestart,p=0,d=new r.e(function(){t.cancel()});function v(e){if(h&&h()){l&&(p=0);g()}else d.complete(e)}function m(e){n&&(c=n(e));if(p<c&&a(e)){p++;s&&s();"number"==typeof f&&i?i.setTimeout(g,f):g()}else d.error(e)}function g(){(t=o()).then(v,m)}g();return d.getPromise()}},"813":function(e,t,n){"use strict";var r=n(104),i=n(70),s=n(40),o=n(25),u=n(150),a=n(147),f=n(119),l=n(251);var c=(function(){function e(e,t,n){this._request=e;this._url=t;this._webAbsoluteUrl=n&&n.webAbsoluteUrl;this._isCanaryRequest=n&&n.isCanaryRequest}e.prototype.getSourceUrl=function(){return this._url};e.prototype.getAllResponseHeaders=function(){return this._request.getAllResponseHeaders()};e.prototype.getCorrelationId=function(){return this.getResponseHeader("SPRequestGuid")};e.prototype.getGroupThrottle=function(){return this.getResponseHeader("SPGroupThrottle")};e.prototype.getAuthErrorType=function(){return this.getResponseHeader("x-ms-diagnostics")};e.prototype.getMSCorrelationVector=function(){return this.getResponseHeader("MS-CV")};e.prototype.getServiceWorkerDataSourceHeader=function(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")};e.prototype.getServiceWorkerFetchInfoFromHeader=function(){return this.getResponseHeader("X-ServiceWorkerFetchInfo")};e.prototype.getRetryAfterHeader=function(){var e=this.getResponseHeader("Retry-After"),t=Number(e);return isNaN(t)?void 0:t};e.prototype.getStatus=function(){try{return this._request.status}catch(e){}};e.prototype.getAuthenticationRedirect=function(){return this.getResponseHeader("X-Forms_Based_Auth_Required")};e.prototype.getFBAError=function(){return this.getResponseHeader("X-MSDAVEXT_Error")};e.prototype.getAuthenticateHeader=function(){return this.getResponseHeader("WWW-Authenticate")};e.prototype.getResponseType=function(){return this._request.responseType};e.prototype.getResponseText=function(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText};e.prototype.getErrorResponseText=function(){if("blob"===this._request.responseType){return{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader("x-virus-infected"),authenticate:this.getResponseHeader("WWW-Authenticate")}}return this.getResponseText()};e.prototype.parseError=function(){var e=this,t=new a.e;this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(e){var t,n=new a.e,r=function(){if(t.result){var e=void 0;try{e=JSON.parse(t.result);n.complete(e)}catch(e){n.complete({message:"Unable to parse blob result."})}}},i=function(){n.complete({message:"Unable to read blob error response."})};try{(t=new FileReader).addEventListener("load",r);t.addEventListener("error",i);t.readAsText(e)}catch(e){i()}return n.getPromise().then(function(e){if(t){t.removeEventListener("load",r);t.removeEventListener("error",i)}return e})})(this._request.response).then(function(n){var r={data:n,status:e.getStatus(),statusText:e._request.statusText,infected:!!e.getResponseHeader("x-virus-infected"),authenticate:e.getResponseHeader("WWW-Authenticate")};t.complete(r)}):t.complete(this._request.response):t.complete(this._request.responseText);return t.getPromise()};e.prototype.getValue=function(t){var n;switch(t){case e.DataValueKeys.SourceURL:n=this.getSourceUrl();break;case e.DataValueKeys.CorrelationId:n=this.getCorrelationId();break;case e.DataValueKeys.Status:n=this.getStatus();break;case e.DataValueKeys.AuthenticationRedirect:n=this.getAuthenticationRedirect();break;case e.DataValueKeys.ResponseText:n=this.getResponseText();break;case e.DataValueKeys.ErrorResponseText:n=this.getErrorResponseText()}return n};e.prototype.getRedirectUrl=function(){var e=l.e.isActivated("3FBEEB53-441C-4A84-82FC-C8221FCC50D8","02/11/2021","redirect url when access denied");if(this._isCanaryRequest)return 403===this.getStatus()?this.shouldRedirectToErrorCustomPromptLocation()?this.getRedirectToErrorCustomPromptLocation():this.getRedirectLoginPageUrl():this.getAccessDeniedRedirectUrl();if(403===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}else if(401===this.getStatus()){if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();if(!e)return this.getRedirectLoginPageUrl()}};e.prototype.getRedirectLoginPageUrl=function(){var e,t=this.getAuthenticationRedirect();if(t){var n=new r.e(t);n.setQueryParameter("ReturnUrl",f.e.encodeURIComponent(window.location.href));e=n.toString()}return e};e.prototype.getAccessDeniedRedirectUrl=function(){var e;if(this._webAbsoluteUrl){var t=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(t){var n=new r.e(t);n.setQueryParameter("Source",f.e.encodeURIComponent(window.location.href));n.setQueryParameter("Type","list");n.setQueryParameter("correlation",f.e.encodeURIComponent(this.getCorrelationId()));e=n.toString()}}return e};e.prototype.getRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),t=new r.e(e);t.setQueryParameter("ReturnUrl",window.location.href);return t.toString()};e.prototype.shouldRedirectToErrorCustomPromptLocation=function(){var e=this.getResponseHeader("X-SPO-ErrorCode"),t=this.getResponseHeader("sharepointerror");return"9.3"===e||"-2130575129"===t};e.prototype.getResponseHeadersDictionary=function(){var e={},t=this.getAllResponseHeaders();if(t){var n=t.trim().split(/[\r\n]+/);n&&n.length>0&&n.forEach(function(t){var n=t.split(": "),r=n.shift(),i=n.join(": ");e[r]=i})}this.getResponseHeadersDictionary=function(){return e};return e};e.prototype.getResponseHeader=function(e){var t=this.getResponseHeadersDictionary();return t[e.toLowerCase()]||t[e]||this._request.getResponseHeader(e)};e.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};return e})(),h=n(747);n.d(t,"e",function(){return p});var p=(function(){function e(e){void 0===e&&(e={});this._scope=new i.e;this._events=this._scope.attach(new s.t(this));var t=e.webAbsoluteUrl||e.webUrl;this._webServerRelativeUrl=e.webServerRelativeUrl||t&&new r.e(t).getPath();"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl="");if(t){this._webAbsoluteUrl=t;this._alwaysGetDigest=!0}else this._alwaysGetDigest=!1;this._needsRequestDigest=!1!==e.needsRequestDigest;this._needsRequestDigest&&this._tryLoadDigest(e.formDigest);this._requestCanaryForAuth=!1;this._engagement=e.engagement;this._operationName=e.operationName}e._isValidFormDigest=function(e){return e&&e.serverTime&&Date.now()-new Date(e.serverTime).getTime()<1e3*(e.formDigestTimeoutSeconds-60)};e.prototype.dispose=function(){this._scope.dispose()};e.prototype.abort=function(){if(this._currentRequest){var e=this._currentRequest;e.isCancelled=!0;e.abort();this._currentRequest=void 0}};e.prototype.isRequestActive=function(){return!!this._currentRequest};e.prototype.getServerDataFromUrl=function(e){var t=this,n=e.url,r=e.successCallback,i=e.failureCallback,s=e.uploadProgressCallback,o=e.additionalPostData,u=e.isRest,a=void 0===u||u,f=e.method,l=void 0===f?"POST":f,c=e.withCredentials,h=e.additionalHeaders,p=e.contentType,d=e.noRedirect,v=e.responseType,m=e.needsRequestDigest,g=void 0===m?this._needsRequestDigest:m,y=(new Date).toISOString(),b=new XMLHttpRequest;b.open(l,n,!0);"boolean"==typeof c&&(b.withCredentials=c);v&&(b.responseType=v);p?b.setRequestHeader("Content-Type",p):a?b.setRequestHeader("Content-Type","application/json;odata=verbose"):b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");var w=!1;if(h)for(var E in h)if(E){b.setRequestHeader(E,h[E]);"accept"===E.toLowerCase()&&(w=!0)}w||b.setRequestHeader("accept","application/json;odata=verbose");this._currentRequest=b;var S=function(e){g&&e&&b.setRequestHeader("x-requestdigest",e);t._events.on(b,"readystatechange",function(){t._onReadyStateChange(b,n,r,i,d,y)});s&&b.upload&&t._events.on(b.upload,"progress",function(e){s(e)});b.send(o)};g?this._ensureRequestDigest(S,i):S()};e.prototype.ensureRequestDigest=function(e,t){this._ensureRequestDigest(e,t)};e.prototype._ensureRequestDigest=function(t,n){var r=e._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&e._isValidFormDigest(r)?t(r.formDigestValue):this._ensureRequestDigestWorker(t,n)};e.prototype._ensureRequestDigestWorker=function(t,n){var i=this,s=new Date,a=new e({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});t||(a._requestCanaryForAuth=!0);var f=this._webAbsoluteUrl||this._webServerRelativeUrl;if("string"==typeof f){e._requestDigestPromise||(e._requestDigestPromise=new o.n(function(o,u){a.getServerDataFromUrl({url:r.e.concatenate(f,"/_api/contextinfo"),successCallback:function(t){var n=t.getResponseText(),r=JSON.parse(n).d.GetContextWebInformation;e._formDigests[i._webServerRelativeUrl]={serverTime:s.toISOString(),formDigestValue:r.FormDigestValue,formDigestTimeoutSeconds:r.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date};o(e._formDigests[i._webServerRelativeUrl].formDigestValue);e._requestDigestPromise=void 0},failureCallback:function(r,i){t?t(void 0):n&&n(r,i);u(void 0);e._requestDigestPromise=void 0},method:"POST",noRedirect:!!n})}));e._requestDigestPromise.then(function(e){t&&t(e);return e})}else n&&n(void 0,new u.e({code:h.t,isExpected:!1}))};e.prototype._onReadyStateChange=function(t,n,r,i,s,o){if(4===t.readyState){this._currentRequest=void 0;this._events.off(t);t.upload&&this._events.off(t.upload);if((d=t)&&d.isCancelled)i(void 0,new u.e({code:h.i,isExpected:!0}));else if((function(e){try{if(4===e.readyState&&(void 0===e.status||0===e.status))return!1}catch(e){return!1}return!0})(t)){var a=new c(t,n,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),f=a.getStatus(),l=!s&&a.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){this._requestCanaryForAuth=!1;if(403===f){var p=a.getRedirectLoginPageUrl();try{l?window.location.href=a.getRedirectToErrorCustomPromptLocation():i(a)}catch(e){}p&&!s&&(window.location.href=p)}else{p=a.getAccessDeniedRedirectUrl();try{i(a)}catch(e){}if(p&&!s){this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}});window.location.href=p}}return}if(200===f||201===f||204===f){r(a);return}if(403===f){e._requestDigestPromise=void 0;s?this._ensureRequestDigestWorker(void 0,function(e,t){return i(a,t)}):l?window.location.href=a.getRedirectToErrorCustomPromptLocation():this._ensureRequestDigestWorker(void 0);return}401===f&&l&&(window.location.href=a.getRedirectToErrorCustomPromptLocation());i(a)}else i(void 0,new u.e({code:h.n,isExpected:!0}));var d}};e.prototype._tryLoadDigest=function(t){if(e._isValidFormDigest(t))e._formDigests[this._webServerRelativeUrl]=t;else{var n=e._formDigests[this._webServerRelativeUrl];e._isValidFormDigest(t)&&(!e._isValidFormDigest(n)||n&&new Date(n.serverTime).getTime()<new Date(t.serverTime).getTime())&&(e._formDigests[this._webServerRelativeUrl]=t)}};e._formDigests={};e._requestDigestPromise=void 0;return e})();t.t=p},"891":function(e,t,n){"use strict";n.d(t,"e",function(){return o});var r=n(79),i=n(689),s=n(5),o=Object(s.s)("ItemUrlHelper",i.e,{pageContext:r.u});i.e},"1017":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0);function i(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(e,t){return Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e),t),e.extraMetrics||t.extraMetrics?{extraMetrics:Object(r.__assign)(Object(r.__assign)({},e.extraMetrics||{}),t.extraMetrics||{})}:{}),e.extraData||t.extraData?{extraData:Object(r.__assign)(Object(r.__assign)({},e.extraData||{}),t.extraData||{})}:{})},e)}},"1070":function(e,t,n){"use strict";n.d(t,"n",function(){return o});var r=n(725);n.d(t,"e",function(){return r.t});var i=n(79),s=n(5),o=Object(s.o)("DataRequestor",r.t,{pageContext:i.u});t.t=r.t},"1088":function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});function r(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}function i(e){return e?r(decodeURIComponent(e).split(".")[1]):{}}function s(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}},"1123":function(e,t,n){"use strict";var r,i=n(137),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},"1178":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(79),i=n(891),s=n(765),o=n(3),u=n(5),a=n(18).e.isActivated("335D0ECA-48E7-459E-9687-BE609CBBC94E","10/24/2018","Encode webUrl for api of $batch's additionalPostData"),f=new o.t({name:"ApiUrlHelper.encodeWebAbsoluteUrl",factory:new o.e(!a)}),l=Object(u.s)("ApiUrlHelper",s.e,{itemUrlHelper:i.e,pageContext:r.u,encodeWebAbsoluteUrl:f});s.e},"1538":function(e,t,n){"use strict";var r=n(0),i=n(1121),s=n(781),o=n(1559),u=["htm","html","svg"],a=["eml","msg","md","mdown","markdown"];function f(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}var l=n(1469),c=n(666),h=n(263),p=n(260),d=n(5),v=n(1088),m=n(1123),g=n(63),y=n(147);function b(e,t){void 0===t&&(t=0);if(!e.expiry){var n=(function(e){return Object(v.t)(e)})(e.authToken);e.expiry=n&&(function(e){try{return new Date(parseInt(e+"000",10))}catch(e){}})(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}var w=n(183),E=n(785),S=n(10),x=n(47),T=n(15),N=new(n(3).t)("rootAuthToken"),C=n(409),k=n(25),L=n(121),A=["00000002-0000-0ff1-ce00-000000000000","2d4d3d8e-2be3-4bef-9f87-7875a61c29de","00000007-0000-0ff1-ce00-000000000000","cc15fd57-2c6c-4117-a88c-83b1d56b4bbe","5e3ce6c0-2b1f-4285-8d4b-75ee78787346","1fec8e78-bce4-4aaf-ab1b-5451cc387264","3ab4b783-69c8-4af2-b6b3-7bb6d4bcff21","944f0bd1-117b-4b1c-af26-804ed95e767e","4345a7b9-9a63-4910-a426-35363201d503","d3590ed6-52b3-4102-aeff-aad2292ab01c","27922004-5251-4030-b22d-91ecd9a37ea4"];var O=n(272),M=n(104),_=n(18);n.d(t,"e",function(){return j});var D=(function(){function e(e,t){var n=this,i=t.urlDataSource,s=t.graphDataSource,o=t.itemIdentityProcessor,u=t.location,a=void 0===u?window.location:u,f=t.rootOAuthToken;this._urlDataSource=i;this._itemIdentityProcessor=o;this._origin=a.protocol+"//"+a.host;this._rootToken=f;this._graphDataSource=s;this._itemKeyByUrl=new Map;this._isOneDriveWinApp=Object(L.e)();this._async=new g.e(this);C.e.registerCookieChecker({isApplicable:function(e){return e.indexOf("needs_accessToken=true")>0},check:function(e){return Object(r.__awaiter)(n,void 0,k.n,function(){var n,i,s,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(n=this._itemKeyByUrl.get(e))?(s=this._graphDataSource.refreshAccessToken)?[4,this._graphDataSource.refreshAccessToken({key:n})]:[3,2]:[3,3];case 1:s=r.sent();r.label=2;case 2:o=(i=s)&&i.accessToken;u=e+"&access_token="+o;a=new t.itemTaskObserverType;f={url:u,width:window.innerWidth,height:window.innerHeight};a.update([new E.t(n).succeed({item:{key:n,thumbnail:E.e.replace(f)}})]);this._itemKeyByUrl.delete(e);a.flush();l=new y.e;this._async.setTimeout(function(){l.error(new Error("NeedAccessToken"))},0);return[2,l.getPromise()];case 3:return[2,!1]}})})}})}e.prototype.processItem=function(e,t){var n,i=e.itemFromServer,s=e.topCollaborator,o=e.requestKey,u=e.observer,a=e.driveAccessTokenWrap,f=this._itemIdentityProcessor.processIdentity({itemFromServer:i,requestKey:o,observer:u}).key,l=i.parentReference;if(l){var c=P(i),h=l.driveId,p=l.id,d=l.path;if(d||p){var v=Object(r.__assign)(Object(r.__assign)({},l),{"@odata.id":c&&(p?H(c,h,p):""+c+d)});n=this._itemIdentityProcessor.processIdentity({itemFromServer:v,requestKey:o,observer:u}).key}}var m=this._urlDataSource.getKeyParams(o),g=this._urlDataSource.getQueryType(m),y=this.buildItemFromServerResponse({itemFromServer:i,key:f,topCollaborator:s,parentKey:n,queryType:g,driveAccessTokenWrap:a},t);u.update([new E.t(f).succeed({item:y})]);return{key:f}};e.prototype.buildItemFromServerResponse=function(e,t){var n,c=e.itemFromServer,d=e.topCollaborator,g=e.key,y=e.parentKey,T=e.driveAccessTokenWrap,N=void 0===T?{}:T,C=e.queryType||S.e.Files,k=c.sharepointIds||{},L={key:g,parentKey:y,properties:{listId:k.listId,ID:k.listItemId,uniqueId:k.listItemUniqueId}};L.queryType=C;L.displayType=C;L.sharingRole=(function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,r=Object(w.e)(n||[],function(){return!0});return r.owner?0:r.write?2:r.read?1:5}return 0})(c);C===S.e.SharedWithMe&&(L.external={});var D=c.id,j=c.name,F=c.folder,I=c.thumbnails,q=c.size,R=c.description,U=c.location,z=(F?{extension:""}:s.n(j)).extension,W=(function(e){var t,n=e.package,r=s.t(e.name||"",!0);t=n&&"oneNote"===n.type?x.e.OneNote:e.folder?x.e.Folder:(function(e){var t=s.t(e.name||"",!0);return Object(O.t)(t||"")})(e)?x.e.File:e.photo||e.video||e.thumbnails?x.e.Media:m.e.isShortcutEnabled()&&m.e.isShortcutFileType(r)?x.e.Shortcut:x.e.File;return t})(c),X=c.parentReference,V=E.e.optional(X&&X.driveId);L.itemId=D;var $=X&&X.driveType;L.graph={itemId:D,driveId:V,driveType:E.e.optional($)};if(!_.e.isActivated("0093b167-93ea-4450-8214-5d6d22e559f3","03/12/2021","Add getDriveAccessToken to item")){var J=N.sessionToken,K=N.sessionTokenV21;J&&b({authToken:J.accessToken,proofToken:J.proofToken})&&(J=void 0);K&&b({authToken:K.accessToken,proofToken:K.proofToken})&&(K=void 0);L.graph=Object.assign({},L.graph,{sessionToken:E.e.optional(J),sessionTokenV21:E.e.optional(K)})}var Q=j;L.name=Q;L.displayName=Q;L.extension=z;L.size=q;L.caption=R||"";L.type=W;L.ownerId=V;L.geoLocation=U;var G=c.searchResult,Y=c["@microsoft.graph.downloadUrl"]||c["@content.downloadUrl"],Z=(function(e){var t=e["@odata.id"];if(t)return t;var n=e.id,r=(e.parentReference||{}).driveId,i=P(e);return i&&H(i,r,n)})(c),ee=((n={})[i.e.download]=Y,n[i.e.itemUrl]=E.e.optional(Z),n);if(G){var te=G.onClickTelemetryUrl;te&&(ee[i.e.bingClickInstrumentation]=te)}if(F){var ne=F.childCount;L.folder={childCount:ne};if(I&&I.length>0){L.folder.covers=[];for(var re=0,ie=I;re<ie.length;re++){var se=ie[re];L.folder.covers.push(se.large)}}L.childCount=ne}var oe=c.photo,ue=c.image;if(ue){var ae=ue.width,fe=ue.height;L.photo=Object(r.__assign)(Object(r.__assign)({},oe?{cameraMake:E.e.optional(oe.cameraMake),cameraModel:E.e.optional(oe.cameraModel),exposureDenominator:E.e.optional(oe.exposureDenominator),exposureNumerator:E.e.optional(oe.exposureNumerator),focalLength:E.e.optional(oe.focalLength),iso:E.e.optional(oe.iso)}:{}),{width:ae,height:fe,originalUrl:Y})}var le=(c.file||{}).mimeType,ce=void 0===le?"":le,he=(function(e,t){var n=e.thumbnails,r=n&&n[0],i=r&&(r.large||r.medium||r.small),s=i&&i.url;return s&&s.replace(/[&?](width|height|cropmode)=[^&]*/g,"").replace("https://media.cloudapp.net",t?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms")})(c,t&&"edog"===t.env),pe=he&&he.indexOf("/transform/thumbnail?")>=0&&he,de=this._rootToken,ve=(function(e){return e&&("."===e[0]?e.slice(1):e).toLowerCase()})(z),me="mp4"===ve||0===ce.lastIndexOf("video/mp4",0),ge=c.video;if(ge){ae=ge.width,fe=ge.height;var ye=ge.bitrate,be=ge.duration;L.video={fourCC:ge.fourCC||(me?"H264":void 0),width:ae,height:fe,bitrate:ye,duration:be}}var we=c.audio,Ee=c.lastModifiedBy,Se=(void 0===Ee?{}:Ee).user,xe=void 0===Se?{}:Se,Te=xe.email,Ne=void 0===Te?void 0:Te,Ce=xe.displayName,ke=void 0===Ce?void 0:Ce,Le=c.createdBy,Ae=(void 0===Le?{}:Le).user,Oe=(void 0===Ae?{}:Ae).displayName,Me=void 0===Oe?void 0:Oe,_e=c.lastModifiedDateTime,De=c.createdDateTime,Pe=c.shared,He=void 0===Pe?{}:Pe,Be=He.sharedBy,je=(void 0===Be?{}:Be).user,Fe=void 0===je?{}:je,Ie=Fe.email,qe=void 0===Ie?void 0:Ie,Re=Fe.displayName,Ue=void 0===Re?void 0:Re,ze=He.sharedDateTime,We=void 0===ze?void 0:ze;L.creatorName=Me;L.editorName=ke;var Xe=B(_e);L.dateModifiedTime=Xe.date;L.dateModified=Xe.dateString;Xe=B(De);L.dateCreatedTime=Xe.date;L.dateCreated=Xe.dateString;Xe=B(We);L.dateSharedTime=Xe.date;L.dateShared=Xe.dateString;L.properties.sharedByUser={title:Ue,isTopCollaborator:qe&&d&&d.indexOf(qe)>-1,sip:qe};L.properties.editorName=[{title:ke,sip:Ne}];var Ve=".ts"===z&&q<1<<19&&!ge,$e=h.n({type:W,extension:z,textEditorMimeType:Ve?"text/typescript":void 0});L.iconName=$e;var Je=we||"audio"===$e||0===ce.lastIndexOf("audio/",0),Ke=ge||"video"===$e||!Ve&&0===ce.lastIndexOf("video/",0);Je&&(L.audio={});if(Ke&&!ge){var Qe={fourCC:me?"H264":void 0,width:-1,height:-1,bitrate:void 0,duration:void 0};L.video=Qe}c.malware&&(L.lifeCycleStatus={isMalwareDetected:!0});var Ge=null,Ye=c["-embed-formats"];if(Ye&&Ye.dash)Ge=new M.e(Ye.dash.url);else if(ge||Je||Ke)if(pe){Ge=new M.e(pe.replace("/thumbnail?","/videomanifest?"));var Ze=ge&&ge.manifestMetadata;Ge.setQueryParameter("manifestMetadata",Ze,!0)}else"personal"===$&&(Ge=Y?new M.e(Y):null);if(Ge){Ge.setQueryParameter("action","Access");ee[i.e.video]=Ge.toString()}var et=W===x.e.OneNote?"one":$e,tt=et&&p.t[et];L.appMap=E.e.optional(tt);L.urls=ee;var nt,rt=c.cTag,it=rt&&encodeURIComponent(rt);if(he){var st=he+(he.indexOf("?")>=0?"&":"?")+"encodeFailures=1";ae=ue?ue.width:ge?ge.width:void 0,fe=ue?ue.height:ge?ge.height:void 0;L.thumbnail={url:st,width:ae,height:fe,getAligned:function(e){var t=e.width,n=void 0===t?window.innerWidth:t,r=e.height,i=void 0===r?window.innerHeight:r;return{width:n|=0,height:i|=0,url:st+"&width="+n+"&height="+i}}}}pe&&(nt={officeBundleGenerateUrl:pe.replace("/thumbnail?","/OfficeBundle?")+"&minVersion={{minVersion}}&cTag="+it,officeBundleGetFragmentUrl:pe.replace("/thumbnail?","/OfficeBundleFragment?")+"&fragment={0}"});var ot,ut,at,ft=(function(e){var t=e.officeBundle;if(t)return t;var n=e.listItem,r=n&&n.fields,i=r&&r.MediaServiceFastMetadata;if(i)try{return JSON.parse(i).officeBundle}catch(e){}})(c),lt="ms-excel"===tt,ct="ms-powerpoint"===tt,ht="ms-visio"===tt,pt="ms-word"===tt,dt=c.webUrl;if("pdf"!==$e&&pt||lt||ct||ht){var vt=!(!t||!t.wopiToken)||(de?!(at=Object(v.e)(Object(v.t)(de)))||A.indexOf(at.toLowerCase())>=0:dt&&0===dt.lastIndexOf(this._origin,0));(ct&&Y||pt&&vt)&&(L.officeBundle=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ft?(ut=(ot=ft).generationTime,{bundleCTag:ot.ctag,bundleVersion:ot.version,hasBundleGenerationFailed:ot.fatalError||!1,generationTime:ut?new Date(ut):void 0,bundleErrorInfo:ot.errorInfo||""}):{}),nt||{}),{cTag:rt}));"personal"!==$&&(L.wopiFrameUrl=dt)}"7z"!==ve&&"rar"!==ve&&"zip"!==ve||(L.zip=pe?{downloadZipContentsUrl:"",zipMetaDataUrl:pe.replace("/thumbnail?","/zipmetadata?")}:E.e.optional((function(e,t,n,r,i){var s="personal"===(e.parentReference||{}).driveType?"odc":"spo";return n&&r?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider="+s+"&inputFormat="+t+"&docid="+encodeURIComponent(n)+"&access_token="+r}:n&&i?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider="+s+"&inputFormat="+t+"&docid="+encodeURIComponent(n)}:void 0})(c,ve,Z,de,this._isOneDriveWinApp)));f(u,z)?L.htmlConversion={}:(function(e){return f(a,e)})(z)&&(L.htmlConversion=pe?{url:pe.replace("/thumbnail?","/html?")+"&inlineImages=true"}:{});o.t(ve)?L.model3d={canRenderNative:!0}:o.e(ve)&&(L.model3d=pe?{canConvert:!0,conversionUrl:pe.replace("/thumbnail?","/glb?")}:{canConvert:!0});var mt=c.dataLossPrevention;mt&&(L.itemStatus=E.e.optional((function(e,t,n){if(n.blockDownload){if(e===x.e.Media||t)return 4;if(e!==x.e.Folder)return 3}if(n.viewOnly)return 4})(W,tt,mt)));l.e(ve)?L.pdfConversion=pe?{url:pe.replace("/thumbnail?","/pdf?")}:{}:l.t(ve)&&pe&&mt&&(mt.blockDownload||mt.viewOnly)&&(L.pdfConversion={url:pe.replace("/thumbnail?","/passthrough?")});L.openUrl=dt;L.vault=c.vault;L.itemFromServer=c;L.isPlaceholder=!1;if(!L.thumbnail&&this._isOneDriveWinApp&&("jpg"===ve||"png"===ve||"jpeg"===ve)){var gt=this._graphDataSource.getItemUrl({key:g,graph:{itemId:D,driveId:X.driveId,driveType:X&&X.driveType}},{useDirectEndpoint:!0})+"/thumbnails/0/c"+(0|window.innerWidth)+"x"+(0|window.innerHeight)+"/content?needs_accessToken=true";L.thumbnail={url:gt,width:window.innerWidth,height:window.innerHeight};this._itemKeyByUrl.set(gt,g)}return L};e.dependencies={urlDataSource:T.we,itemIdentityProcessor:T.Ce,rootOAuthToken:N.optional,graphDataSource:T.w,itemTaskObserverType:E.r};return e})();function P(e){var t=e["@odata.context"];if(t)return t.split("/$")[0];var n=e.sharepointIds;if(n){var r=n.siteUrl;if(r)return r+"/_api/v2.1"}}function H(e,t,n){return e+"/drive"+(t?"s/"+t:"")+"/items/"+n}function B(e){var t=e&&e.lastIndexOf("0001-01-01T00:00:00",0)<0?new Date(e):void 0;return{date:t,dateString:t?c.s(t):""}}var j=Object(d.s)("ItemResultProcessor",D)},"1640":function(e,t,n){"use strict";n.d(t,"e",function(){return s});n(0);var r=n(3),i=n(5),s=(n(18).e.isActivated("723526D9-B1A5-4ADC-81B1-B7D1B4934EBB","9/23/2020","Workaround for loading sp-http in AMD builds"),new r.t({name:"SpHttpDataSource.key",loader:new i.t(function(){0;return n.e("216").then(n.bind(null,1982)).then(function(e){return e.resourceKey})})}))},"1656":function(e,t,n){"use strict";var r=n(0),i=n(231),s=n(79),o=n(25),u=n(3),a=n(5),f=n(236),l=n(12),c=n(1695),h=n(411),p=n(1070),d=n(728),v=n(1640),m=n(1287),g=n(18),y=n(552),b=n(1088),w=n(26),E=n(42),S=n(164);n.d(t,"e",function(){return M});var x=g.e.isActivated("BDA7F62C-13F2-46C1-9EB2-67F34FE3D170","3/8/2021","Alaways get a Graph token for Graph endpoints"),T=g.e.isActivated("cd6c23cc-c9ff-4588-ba6b-8979f5c110f0","1/7/2021","Use nucleus enabled datarequestor in odsp-next"),N=g.e.isActivated("70E79C4A-4303-45E7-A936-9B89FE84DE7F","8/25/2020","Use injectable Token Fetcher for OAuth tokens"),C=g.e.isActivated("59C92AB5-5436-4EBE-9657-00DE15A952DD","03/10/2021","Remove teamsite check when getting authToken"),k=(function(){function e(e,t){t.dataRequestorType?this._dataRequestor=new t.dataRequestorType({qosName:"IdentityDataSource"}):this._dataRequestor=new p.t({qosName:"IdentityDataSource"},{pageContext:t.pageContext});this._apiUrlHelper=new d.t({webAbsoluteUrl:t.pageContext.webAbsoluteUrl})}e.prototype.getToken=function(e){var t=e.name,n={resource:e.resource,tokenType:e.tokenType},i=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return this._dataRequestor.getData({url:i,method:"POST",qosName:"AcquireToken."+t,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},additionalPostData:JSON.stringify(n),telemetryHandler:function(e){var t=e.errorData,n=e.eventData;if(t){var i=t.code;if(i&&(i.indexOf("0x80070005")>-1||i.indexOf("10012")>-1))return{eventData:Object(r.__assign)(Object(r.__assign)({},n),{resultType:w.e.ExpectedFailure})}}return{eventData:n}}})};return e})(),L=new u.t({name:"IdentityDataSource.tokenFetcher",factory:new u.e(E.e.local)}),A=Object(a.s)("IdentityDataSource.tokenFetcher",k,{pageContext:s.u,dataRequestorType:T?p.n:void 0}),O=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageContext=n.pageContext;n.dataRequestorType?r._dataRequestor=n.dataRequestorType?new n.dataRequestorType({qosName:"IdentityDataSource"}):new p.t({qosName:"IdentityDataSource"}):r._dataRequestor=new p.t({qosName:"IdentityDataSource"},{pageContext:r._pageContext});r._cache=g.e.isActivated("C31A4871-75DE-406F-9E23-CB2D40E9F29E","3/30/2020","User persistent store for user OAuth tokens")?new h.t:new h.e({userId:r._pageContext.systemUserKey,cachingType:n.identityDataStoreCachingType});r._promiseCache=new Map;r._apiUrlHelper=new d.t({webAbsoluteUrl:r._pageContext.webAbsoluteUrl});r._tokenFetcher=n.tokenFetcher;return r}t.prototype.getIdentity=function(){return(function(e){var t=e.pageContext,n=(function(e){var t=e.pageContext,n=t&&t.systemUserKey;return n&&n.substring(n.lastIndexOf("|")+1).replace("@live.com","")||""})(e),r=!0===t.isAnonymousGuestUser||!0===t.isEmailAuthenticationGuestUser?S.e.anonymous:S.e.aad,i=t.userLoginName,s=t.webPermMasks;return{email:t.userEmail,id:n,loginName:i,type:r,sessionState:"",webPermMasks:s}})({pageContext:this._pageContext})};t.prototype.getSignInUrl=function(){throw new Error("Not Implemented")};t.prototype.getGraphToken=function(e){var t=e.resource;return!t||this._isGraphEndpoint(t)||g.e.isActivated("B60AB760-65F0-45C7-8F22-0F07B3541F8F","1/1/2020","Fall back to SharePoint token for non-Graph endpoints")?this._getTokenForResource("ms-graph",{resource:t&&new f.e(t).authority||"https://graph.microsoft.com"}):this.getSharePointToken(t)};t.prototype.getLokiToken=function(){return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com"})};t.prototype.getOfficeToken=function(){return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com"})};t.prototype.getSubstrateToken=function(e){void 0===e&&(e=c.e.Default);var t="ms-substrate",n={resource:"https://substrate.office.com"};if(e===c.e.STI){n.tokenType="STI";t+="-sti"}return this._getTokenForResource(t,n)};t.prototype.getSharePointToken=function(e){var t=/https:\/\/(.*).svc.ms/.test(e),n=Number(this._pageContext.webTemplate)===y.t.mySite&&Object(l.gr)(l.An)&&C;if(!x&&this._isGraphEndpoint(e))return this._getTokenForResource("ms-graph",{resource:new f.e(e).authority});if(!this._pageContext.isAnonymousGuestUser&&!this._pageContext.isEmailAuthenticationGuestUser&&Object(l.gr)(l.or)&&!t||n)return this._getTokenForResource("SharePoint_SelfIssued",{resource:e,tokenType:"SPO"});if(this._isGraphEndpoint(e)||t){var r=this._isGraphEndpoint(e)?"-graph":t?"-media":"";return this._getTokenForResource("SharePoint"+r,{resource:e})}return this.resources.consumeAsync(v.e.bypass).then(function(t){return t.fetchToken(e)}).then(function(e){return{accessToken:e}})};t.prototype.getPowerBIToken=function(e){return this._getTokenForResource("power-bi",{resource:e})};t.prototype.getYammerToken=function(e){return this._getTokenForResource("yammer",{resource:e})};t.prototype.getOAuthToken=function(e){var t=this;this._getTokenForResource("oAuth",{resource:e}).then(function(e){t.resources.consumeAsync(m.e).then(function(t){var n={command:"OAuthTokenCommand",token:e.accessToken};t.sendCommand(n)})},function(e){t.resources.consumeAsync(m.e).then(function(t){var n={command:"OAuthTokenCommand",errorMessage:e.message||""};t.sendCommand(n)})})};t.prototype.getFormDigest=function(e){var t=e||this.getContextInfoUrl();return this._dataRequestor.getData({url:t,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(function(e){return e.d.GetContextWebInformation.FormDigestValue})};t.prototype.getContextInfoUrl=function(){return this._apiUrlHelper.build().segment("contextInfo").toString()};t.prototype._getTokenForResource=function(e,t){var n=this,r=e+"|"+t.resource+"|"+(t.tokenType||""),i=this._cache.getValue(r,Date.now());if(i)return o.n.resolve({accessToken:i.value,tokenExpiry:i.expiration});var s=this._promiseCache.get(r);if(s)return s;var u=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString(),a=(this._tokenFetcher?this._tokenFetcher.getToken({name:e,resource:t.resource,tokenType:t.tokenType}):this._dataRequestor.getData({url:u,method:"POST",qosName:"AcquireToken."+e,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},additionalPostData:JSON.stringify(t)})).then(function(e){var t=e.access_token,i=e.expires_on,s=1e3*(Number(i||Object(b.t)(t).exp)-300);n._cache.setValue(r,{value:t,expiration:s});n._promiseCache.delete(r);return{accessToken:t,tokenExpiry:s}},function(e){n._promiseCache.delete(r);return o.n.reject(e)});this._promiseCache.set(r,a);return a};t.prototype._isGraphEndpoint=function(e){var t=this._pageContext.msGraphEndpointUrl+"/";return(e+"/").slice(0,t.length)===t};t.dependencies=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},i.e.dependencies),{dataRequestorType:T?p.n:void 0,pageContext:s.u,identityDataStoreCachingType:L.optional}),N?{}:{tokenFetcher:A.optional});return t})(i.e),M=Object(a.s)("IdentityDataSource",O)},"1695":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.STI=1]="STI";e[e.Default=2]="Default"})(r||(r={}))},"1778":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(384),s=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,Object(r.__assign)(Object(r.__assign)({},t),{isExpected:o(t.errorType)}))||this;n.message=t.message;n.errorType=t.errorType||i.e.other;n.maxSizeInBytes=t.maxSizeInBytes;n.allowRename=t.allowRename||!1;n.allowMerge=t.allowMerge||!1;n.supportsVersioning=t.supportsVersioning||!1;n.extraData=t.extraData;n.libraryName=t.libraryName;n.isFolder=t.isFolder;n.fixItUrl=t.fixItUrl;return n}return t})(n(150).e);function o(e){switch(e){case i.e.conflict:case i.e.similarNameExists:case i.e.emptyFileOrFolder:case i.e.emptyFileOrFolderForDocLib:case i.e.fileSize:case i.e.folderUploadNotSupported:case i.e.insufficientVaultQuota:case i.e.invalidName:case i.e.lockMismatch:case i.e.malwareDetected:case i.e.overQuota:case i.e.overQuotaSharedFolder:case i.e.pathTooLong:case i.e.targetFolderMissing:case i.e.throttled:case i.e.unlockRequired:case i.e.versionMismatch:return!0;case i.e.accessDenied:case i.e.itemNotFound:case i.e.disconnected:case i.e.authFailure:case i.e.general:return!1;case i.e.none:case i.e.other:return}}},"2460":function(e,t,n){"use strict";n.d(t,"t",function(){return r});n.d(t,"e",function(){return i});var r=window.performance?function(){return window.performance.now()}:function(){return Date.now()},i=(function(){function e(e,t){this._performanceNow=t.performanceNow;this._startTime=this._performanceNow();this._expirationTime=this._startTime+e.timeout;this._totalBytes=e.totalBytes;this._progressPoints=0}e.prototype.doesActivityHaveRemainingCapacity=function(e){var t=this._getRateRatio(e);return void 0===t||t<=1};e.prototype.didActivityHaveExtraCapacity=function(){return this._getRateRatio(this._totalBytes)<=.5};e.prototype._getRateRatio=function(e){this._progressPoints++;var t,n=this._performanceNow(),r=n-this._startTime,i=this._expirationTime-n,s=this._totalBytes-e;(this._progressPoints>=4&&r>=4e3||this._progressPoints>0&&0===s)&&i>0&&(t=s/i/(e/r));return t};return e})()},"2461":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(0),i=n(147),s=(function(){function e(e,t){this._dataRequestor=t.dataRequestor}e.prototype.createSession=function(e){var t=e.qosData,n=e.itemUrl,i=e.headers,s=e.allowCookies,u=e.accessToken,a=e.fileName,f=e.fileSize,l=e.lastModifiedDate,c=e.eTag,h=e.conflictBehavior,p=e.ignoreCookieAuth,d={item:Object(r.__assign)(Object(r.__assign)({},o(n)?{"@microsoft.graph.conflictBehavior":h}:{"@name.conflictBehavior":h}),l?{fileSystemInfo:{lastModifiedDateTime:l.toISOString()}}:{})},v=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},c?{"If-Match":c}:{}),p?{IgnoreCookieAuthentication:"t"}:{}),{Prefer:"synchronousmetadata"}),i);return this._dataRequestor.send({path:n+"/"+encodeURIComponent(a)+":/"+(o(n)?"createUploadSession":"oneDrive.createUploadSession"),requestType:"POST",apiName:"CreateSession",headers:v,allowCookies:s,accessToken:u,useAuthorizationHeaders:!0,postData:JSON.stringify(d),qosExtraData:Object(r.__assign)({conflictBehavior:h,fileSize:f},t)})};e.prototype.cancelSession=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"DELETE",apiName:"CancelSession",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.uploadFragment=function(e){var t=e.qosData,n=e.headers,s=e.sessionUrl,o=e.startByte,u=e.endByte,a=e.fileSize,f=e.content,l=e.timeout,c=e.onProgress,h=e.select,p=Object(r.__assign)({"Content-Range":"bytes "+o+"-"+Math.max(u-1,o)+"/"+a},n),d=!0,v=this._dataRequestor.send({path:s+(h?(s.indexOf("?")>-1?"&":"?")+"$select="+h:""),needsAuthorization:!1,requestType:"PUT",apiName:"UploadFragment",headers:p,postData:f,timeout:l,hasContentType:!1,onUploadProgress:function(e){e.lengthComputable&&d&&c(o+e.loaded)},qosExtraData:Object(r.__assign)(Object(r.__assign)({},t),{startByte:o,endByte:u,fileSize:a})}),m=new i.e(function(){d=!1;v.cancel()});v.done(function(e){d=!1;m.complete(e)},function(e){d=!1;m.error(e)});return m.getPromise()};e.prototype.commit=function(e){var t=e.qosData,n=e.itemUrl,i=e.accessToken,s=e.fileName,u=(e.description,e.eTag),a=e.conflictBehavior,f=e.sessionUrl,l={"If-Match":u},c=o(n)?{"@microsoft.graph.conflictBehavior":a,"@microsoft.graph.sourceUrl":f}:{"@name.conflictBehavior":a,"@content.sourceUrl":f};return this._dataRequestor.send({path:n+"/"+encodeURIComponent(s),requestType:"PUT",apiName:"CommitSession",headers:l,accessToken:i,useAuthorizationHeaders:!0,postData:JSON.stringify(c),qosExtraData:Object(r.__assign)({conflictBehavior:a},t)})};e.prototype.getStatus=function(e){var t=e.qosData,n=e.sessionUrl;return this._dataRequestor.send({requestType:"GET",apiName:"GetStatus",path:n,needsAuthorization:!1,qosExtraData:t})};e.prototype.getItem=function(e){var t=e.qosData,n=e.itemUrl,i=e.accessToken,s=e.fileName;return this._dataRequestor.send({requestType:"GET",apiName:"GetItem",path:n+"/"+encodeURIComponent(s),useAuthorizationHeaders:!0,accessToken:i,qosExtraData:Object(r.__assign)({},t)})};return e})();function o(e){return 0===e.toLowerCase().lastIndexOf("https://graph.microsoft.com",0)}},"2462":function(e,t,n){"use strict";n.d(t,"e",function(){return l});var r=n(0),i=n(232),s=n(154),o=n(26),u=n(25),a=n(147),f=Math.pow(2,1/4),l=(function(){function e(e,t){this._uploadService=t.uploadService;this._activityBandwidthVerifierType=t.activityBandwidthVerifierType;var n=t.useCommitForUpload,r=void 0!==n&&n,i=t.checkForCompletedUploadOnSessionTermination,s=void 0===i||i,o=t.shouldCancelOnCompleteFailure,u=void 0===o||o,a=t.maximumFragmentSize,f=void 0===a?62914560:a;this._shouldCancelOnCompleteFailure=u;this._useCommitForUpload=r;this._checkForCompletedUploadOnSessionTermination=s;this._maximumFragmentSize=f}e.prototype.advanceState=function(e,t){var n=this,r=t.sessionUrl,i=t.nextExpectedRanges;return(r?i?this._uploadItemState(e,t):this._getStatusState(e,t):this._createSessionState(e,t)).then(function(t){return t.error?n._handleGeneralErrorState(e,t):n._getState(t,{waitDuration:void 0,attemptsRemaining:void 0})})};e.prototype._createSessionState=function(e,t){var n=this,u=e.qosData,a=new s.e({name:"VroomUploader.createSession",extraData:u});return this._uploadService.createSession({qosData:u,itemUrl:e.itemUrl,headers:e.headers,allowCookies:e.allowCookies,accessToken:e.accessToken,fileName:e.fileName,fileSize:e.content.size,eTag:e.eTag,lastModifiedDate:e.lastModifiedDate,conflictBehavior:t.conflictBehavior,ignoreCookieAuth:e.ignoreCookieAuth}).then(function(e){a.end({resultType:o.e.Success});return n._getState(t,{nextExpectedRanges:e.nextExpectedRanges,sessionUrl:e.uploadUrl})},function(s){return n._handleCreateSessionErrorState(e,n._getState(t,{error:s})).then(function(e){e.error?a.end({resultType:o.e.Failure,error:s.message,resultCode:Object(i.i)(s),extraData:Object(r.__assign)(Object(r.__assign)({},u),Object(i.r)(s))}):a.end({resultType:o.e.ExpectedFailure,resultCode:"Canceled"});return e})})};e.prototype._handleCreateSessionErrorState=function(e,t){var n=this;return this._handleErrorState(t,function(r,i){switch(r){case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(i,e,t)}})};e.prototype._getStatusState=function(e,t){var n=this,u=e.qosData,a=new s.e({name:"VroomUploader.getStatus",extraData:u});return this._uploadService.getStatus({qosData:u,sessionUrl:t.sessionUrl}).then(function(e){a.end({resultType:o.e.Success});return n._getState(t,{nextExpectedRanges:e.nextExpectedRanges})},function(e){a.end({resultType:o.e.Failure,error:e.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)({},u),Object(i.r)(e))});return n._getState(t,{error:e})})};e.prototype._uploadItemState=function(e,t){var n=this,u=e.qosData,a=e.content.size,f=this._getNextRange({fileSize:a,nextExpectedRanges:t.nextExpectedRanges}),l=new s.e({name:"VroomUploader.uploadItem",extraData:e.qosData});return(f&&f.start<a?t.allowStreaming?this._uploadStreamState({nextRange:f},e,t):this._uploadFragmentState({nextRange:f},e,t):this._useCommitForUpload?this._commitState(e,t):this._shouldCancelOnCompleteFailure?this._cancelSessionState(e,t):this._terminateUploadOnCompleteFailure(t)).then(function(t){if(t.error)return n._handleUploadItemErrorState(e,t).then(function(e){var t=e.error;t?l.end({resultType:o.e.Failure,error:t.message,resultCode:Object(i.i)(t),extraData:Object(r.__assign)(Object(r.__assign)({},u),Object(i.r)(t))}):l.end({resultType:o.e.Success});return e});l.end({resultType:o.e.Success});return t})};e.prototype._terminateUploadOnCompleteFailure=function(e){return u.n.resolve(this._getState(e,{error:new Error("The upload session is still open but there are no more bytes to upload.")}))};e.prototype._uploadFragmentState=function(e,t,n){var u=this,l=e.nextRange,c=t.onProgress,h=t.headers,p=t.content,d=t.content.size,v=t.qosData,m=t.select,g=n.sessionUrl,y=n.speed,b=void 0===y?1/8:y,w=l.start,E=l.end;c&&c(w);var S,x,T=this._getFragmentSize(b),N=Math.min(w+T,E),C=new a.e(function(){S&&S.cancel()}),k=b>1/1920?6e4:3e5,L=new this._activityBandwidthVerifierType({timeout:k,totalBytes:N-w}),A=new s.e({name:"VroomUploader.uploadFragment",extraData:Object(r.__assign)(Object(r.__assign)({},v),{startByte:w,endByte:N,fileSize:d,speed:b,fragmentSize:T})});(S=this._uploadService.uploadFragment({qosData:v,headers:h,sessionUrl:g,startByte:w,endByte:N,fileSize:d,content:p.slice(w,N),timeout:k,select:m,onProgress:function(e){x=e;if(b>1/1920&&!L.doesActivityHaveRemainingCapacity(e-w)){A.end({resultType:o.e.ExpectedFailure,resultCode:"Aborted",extraData:Object(r.__assign)(Object(r.__assign)({},v),{lastByte:e})});C.complete(u._getState(n,{speed:Math.max(.5*b,1/1920),nextExpectedRanges:void 0}));S&&S.cancel()}c&&c(e)}}).then(function(e){c&&c(N);A.end({resultType:o.e.Success});return n=u._isItem(e)?u._getState(n,{item:e}):u._getState(n,{nextExpectedRanges:e.nextExpectedRanges,speed:Math.min(L.didActivityHaveExtraCapacity()?b*f:b,1)})},function(e){A.end({resultType:o.e.Failure,error:e.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},v),Object(i.r)(e)),{lastByte:x})});return u._getState(n,{error:e})})).done(function(e){C.complete(e)});return C.getPromise()};e.prototype._uploadStreamState=function(e,t,n){var u=this,f=e.nextRange,l=t.headers,c=t.onProgress,h=t.content,p=t.content.size,d=t.qosData,v=n.sessionUrl,m=f.start,g=f.end,y=Math.min(g-m,this._maximumFragmentSize),b=m+y;c&&c(m);var w,E=new a.e(function(){w&&w.cancel()}),S=new s.e({name:"VroomUploader.uploadStream",extraData:Object(r.__assign)(Object(r.__assign)({},d),{startByte:m,endByte:b,fileSize:p,fragmentSize:y})});(w=this._uploadService.uploadFragment({qosData:d,headers:l,sessionUrl:v,startByte:m,endByte:b,fileSize:p,content:h.slice(m,b),timeout:864e5,onProgress:function(e){c&&c(e)}}).then(function(e){c&&c(b);S.end({resultType:o.e.Success});return n=u._isItem(e)?u._getState(n,{item:e}):u._getState(n,{nextExpectedRanges:e.nextExpectedRanges})},function(e){S.end({resultType:o.e.Failure,error:e.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},d),Object(i.r)(e)),{lastByte:void 0})});return u._handleUploadStreamErrorState({nextRange:f},t,u._getState(n,{error:e}))})).done(function(e){E.complete(e)});return E.getPromise()};e.prototype._handleUploadStreamErrorState=function(e,t,n){var r=this,i=e.nextRange;return this._handleErrorState(n,function(e){switch(e){case 0:return r._wait({duration:1e3},t).then(function(){return r._getStatusState(t,n).then(function(e){return r._getNextRange({fileSize:t.content.size,nextExpectedRanges:e.nextExpectedRanges}).start>i.start?e:r._getState(n,{allowStreaming:!1})})})}})};e.prototype._commitState=function(e,t){var n=this,u=e.qosData,a=e.onProgress;a&&a(e.content.size);var f=new s.e({name:"VroomUploader.commit",extraData:u});return this._uploadService.commit({qosData:u,itemUrl:e.itemUrl,accessToken:e.accessToken,fileName:e.fileName,sessionUrl:t.sessionUrl,conflictBehavior:t.conflictBehavior}).then(function(e){f.end({resultType:o.e.Success});return n._getState(t,{item:e})},function(e){return n._handleCommitErrorState(n._getState(t,{error:e})).then(function(t){f.end({resultType:t.error?o.e.Failure:o.e.ExpectedFailure,error:e.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)({},u),Object(i.r)(e))});return t})})};e.prototype._handleCommitErrorState=function(e){var t=this;return this._handleErrorState(e,function(n){switch(n){case"uploadSessionFailed":case"uploadSessionNotFound":case 410:return u.n.resolve(t._getState(e,{error:void 0,sessionUrl:void 0}))}})};e.prototype._cancelSessionState=function(e,t){var n=this,u=e.qosData,a=new s.e({name:"VroomUploader.cancelSession",extraData:u});return this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:t.sessionUrl}).then(function(){a.end({resultType:o.e.Success});return n._getState(t,{sessionUrl:void 0})},function(e){a.end({resultType:o.e.Failure,error:e.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)({},u),Object(i.r)(e))});return n._getState(t,{sessionUrl:void 0})})};e.prototype._handleUploadItemErrorState=function(e,t){var n=this,r=t.speed,i=void 0===r?1:r;t=this._getState(t,{nextExpectedRanges:void 0});return this._handleErrorState(t,function(r,s){switch(r){case 0:return window.navigator.onLine?t.allowStreaming?u.n.resolve(n._getState(t,{allowStreaming:!1})):u.n.resolve(n._getState(t,{speed:Math.max(i*(1/8),1/1920)})):void 0;case"uploadSessionFailed":case"uploadSessionNotFound":case 404:return u.n.resolve(n._getState(t,{error:void 0,sessionUrl:void 0}));case"entityTagDoesNotMatch":case"resourceModified":case"versionNumberDoesNotMatch":case"nameAlreadyExists":case"unlockRequired":case 409:case 412:return n._promptForConflictBehaviorState(s,e,t);case"invalidRange":case 416:return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0})})}})};e.prototype._getItemIfCompletedState=function(e,t){var n=this,u=e.qosData,a=new s.e({name:"VroomUploader.getItemIfCompleted",extraData:u});return this._uploadService.getItem({qosData:u,fileName:e.fileName,itemUrl:e.itemUrl,accessToken:e.accessToken}).then(function(r){a.end({resultType:o.e.Success});return e.lastModifiedDate&&r.fileSystemInfo&&r.fileSystemInfo.lastModifiedDateTime===e.lastModifiedDate.toISOString()&&r.size===e.content.size&&"rename"!==t.conflictBehavior?n._getState(t,{item:r,error:void 0}):n._getState(t,{error:new Error("The upload session has terminated but the existing item does not match the input.")})},function(e){a.end({resultType:o.e.Failure,error:e.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)({},u),Object(i.r)(e))});return n._getState(t,{error:e})})};e.prototype._handleGeneralErrorState=function(e,t){var n=this,r=t.waitDuration,i=void 0===r?500:r,s=t.attemptsRemaining,o=void 0===s?10:s;return this._handleErrorState(t,function(r){switch(r){case"uploadSessionNotFound":return n._checkForCompletedUploadOnSessionTermination?n._getItemIfCompletedState(e,t):void 0;case"authFailure":case"unauthenticated":case 401:case"lockMismatch":case 423:case 501:case"quotaLimitReached":case 507:return}if("number"==typeof r){if(r>=400&&r<500)return;if(0===r||r>=500&&r<600)return n._wait({duration:i,allowWakeWhenOnline:!0},e).then(function(){return n._getState(t,{error:void 0,waitDuration:Math.min(2*i,3e4),attemptsRemaining:void 0})});if(!o)return;return n._wait({duration:1e3},e).then(function(){return n._getState(t,{error:void 0,waitDuration:void 0,attemptsRemaining:Math.max(o-1,0)})})}})};e.prototype._handleErrorState=function(e,t){var n=e.error,r=Object(i.t)(n,t);void 0===r&&(r=u.n.resolve(e));return r};e.prototype._promptForConflictBehaviorState=function(e,t,n){var a=this,f=t.onPromptForConfictBehavior,l=t.qosData,c=new s.e({name:"VroomUploader.promptForConflictBehavior",extraData:l});return u.n.resolve().then(function(){return f(e)}).then(function(e){c.end({resultType:o.e.Success,extraData:l});return a._getState(n,{error:void 0,conflictBehavior:e})},function(t){c.end({resultType:o.e.Failure,error:t.message,resultCode:Object(i.i)(e),extraData:Object(r.__assign)(Object(r.__assign)({},l),Object(i.r)(t))});return a._getState(n,{error:t})})};e.prototype._wait=function(e,t){var n=e.duration,r=e.allowWakeWhenOnline,a=t.onWait,f=t.qosData,l=new s.e({name:"VroomUploader.wait",extraData:f});return u.n.resolve(a({duration:n,allowWakeWhenOnline:r})).then(function(){l.end({resultType:o.e.Success})},function(e){l.end({resultType:u.n.isCanceled(e)?o.e.Success:o.e.Failure,error:e&&e.message,resultCode:Object(i.i)(e)});return u.n.reject(e)})};e.prototype._getState=function(e,t){return Object(r.__assign)(Object(r.__assign)({},e),t)};e.prototype._getNextRange=function(e){var t=e.fileSize,n=e.nextExpectedRanges;return(void 0===n?[]:n).reduce(function(e,n){var r,i=n.split("-",2),s=i[0],o=i[1],u=parseInt(s,10);if(!e||u<e.start&&u<t){r={start:u,end:""===o?t:Math.min(parseInt(o,10)+1,t)}}else r=e;return r},void 0)};e.prototype._isItem=function(e){return!!e.id};e.prototype._getFragmentSize=function(e){var t,n=62914560*e;t=n>327680?n-n%327680:n-n%32768;return Math.min(Math.max(t,32768),this._maximumFragmentSize)};return e})()},"2463":function(e,t,n){"use strict";n.d(t,"e",function(){return f});var r=n(0),i=n(25),s=n(232),o=n(154),u=n(26),a=n(781),f=(function(){function e(e,t){var n=t.uploadService,r=t.uploadStateMachine,i=t.useStreamingUpload,s=void 0!==i&&i;this._uploadService=n;this._uploadStateMachine=r;this._useStreamingUpload=s}e.prototype.upload=function(e){var t=e.conflictBehavior,n=Object(r.__rest)(e,["conflictBehavior"]),f=n.qosData,l=n.fileName,c=new o.e({name:"VroomUploader.upload",extraData:Object(r.__assign)(Object(r.__assign)({},f),{extension:Object(a.t)(l,!0)})});return this._uploadState(n,{conflictBehavior:t,allowStreaming:this._useStreamingUpload}).then(function(e){c.end({resultType:u.e.Success});return e},function(e){c.end({resultType:i.n.isCanceled(e)?u.e.ExpectedFailure:u.e.Failure,error:e.message,resultCode:Object(s.i)(e),extraData:Object(r.__assign)(Object(r.__assign)({},f),Object(s.r)(e))});return i.n.reject(e)})};e.prototype._uploadState=function(e,t){var n=this,r=t.sessionUrl,s=t.item,o=t.error;if(s)return i.n.resolve(s);if(o){var u=void 0;r&&(u=this._uploadService.cancelSession({qosData:e.qosData,sessionUrl:r}).then(function(){},function(){}));return i.n.resolve(u).then(function(){return i.n.reject(o)})}return this._uploadStateMachine.advanceState(e,t).then(function(t){return n._uploadState(e,t)})};return e})()},"3150":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(25),s=n(5),o=n(1405),u=n(7),a=n(384),f=n(1778),l=n(221),c=n(154),h=n(26),p=Object(l.e)({eventName:"Upload,Qos,",shortEventName:"Upload"},{dragAndDrop:3,size:2,extension:1,folderUpload:3,groupFolder:3},c.e),d=p,v=n(147),m=n(196),g=n(232),y=n(3),b=n(2460),w=n(2461),E=n(2462),S=n(2463),x=n(379),T=new y.t({name:"VroomUploader.maximumFragmentSize",factory:new y.e(251658240)}),N=new y.t({name:"VroomUploader.performanceNow",factory:new y.e(b.t)}),C=new y.t({name:"VroomUploader.vroomUploadService",factory:new s.n(w.e,{dataRequestor:x.e})}),k=new y.t({name:"VroomUploader.useCommitForVroomUpload",factory:new y.e(!0)}),L=new y.t({name:"VroomUploader.useStreamingUpload",factory:new y.e(!0)}),A=new y.t({name:"VroomUploader.activityBandwidthVerifier",factory:new s.r(b.e,{performanceNow:N})}),O=new y.t({name:"VroomUploader.vroomUploadStateMachine",factory:new s.n(E.e,{uploadService:C,activityBandwidthVerifierType:A,useCommitForUpload:k,maximumFragmentSize:T})}),M=Object(s.s)("VroomUploader",S.e,{uploadService:C,uploadStateMachine:O,useStreamingUpload:L}),_=(S.e,n(15)),D=n(1538),P=n(785),H=n(29),B=n(81),j=n(236),F=n(1178),I=n(79),q=n(1656),R=B.e(window.location.search.slice(1)).s,U=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._apiUrlHelper=n.apiUrlHelper;r._pageContext=n.pageContext;r._identityDataSource=n.identityDataSource;return r}t.prototype.getVroomCreateUploadSessionItemUrl=function(){return this._apiUrlHelper.build().segment("v2.1").segment("shares").segment("u!"+R).segment("driveItem:").toString().replace(this._pageContext.webServerRelativeUrl,"")};t.prototype.getAccessToken=function(){return this._identityDataSource.getSharePointToken(new j.e(this._pageContext.webAbsoluteUrl).authority)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},u.n.dependencies),{apiUrlHelper:F.e,pageContext:I.u,identityDataSource:q.e});return t})(u.n),z=Object(s.s)("FileRequestUtilityDataSource",U),W=n(121),X=new y.t({name:"SingleFileUploader.uploadQueue",factory:{dependencies:{},create:function(){return{instance:new m.e(3)}}}}),V=0,$=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.fileUpload;r._qosData={uploadId:""+ ++V,uploaderType:"Vroom",scenario:t.qosContext.scenario};r._vroomUploader=n.vroomUploader;r._uploadQueue=n.uploadQueue;r._graphDataSource=n.graphDataSource;r._itemResultProcessor=n.itemResultProcessor;r._itemTaskObserver=new n.itemTaskObserverType;r._parentItem=t.parentItem;r._fileUpload=i;r._qosContext=t.qosContext;r._isFileRequest=!!t.isFileRequest;r._allowCookies=!!t.allowCookies;r._accessToken=t.accessToken;r._fileNamePrefix=t.fileNamePrefix;r._isOneDriveWinApp=Object(W.e)();r.state=r.createObservable(0);r.uploadedBytes=r.createObservable(0);r.totalBytes=r.createObservable(i.size);r.fileName=r.createObservable(i.name);r.iconName=r.createObservable(i.iconName);r.error=r.createObservable();r.nameConflictBehavior=r.createObservable(0);r.allowRename=!0;r.item=r.createObservable();return r}t.prototype.start=function(){this._uploadPromise=this.trackPromise(this._upload())};t.prototype.abort=function(){delete this._fileUpload;var e=this._pendingRestart;delete this._pendingRestart;if(e)e.cancel();else{var t=this._uploadPromise;delete this._uploadPromise;if(t){t.cancel();t.done(function(){},function(){})}}};t.prototype.restart=function(){var e=this,t=this._pendingRestart;delete this._pendingRestart;if(t)t.complete();else{var n=this._uploadPromise;delete this._uploadPromise;if(n){n.cancel();n.done(function(){e.start()},function(){e.start()})}}};t.prototype._upload=function(){var e=this,t=this._fileUpload;this.uploadedBytes(0);this.error(void 0);if(!t){this.state(4);return i.n.wrap()}this.state(0);var n=this._qosContext,s=new p({name:"Upload."+n.uploadType,size:t.size,extension:t.extension.substring(1),dragAndDrop:n.isDragAndDrop,folderUpload:n.isFolderUpload,groupFolder:!1,extraData:this._qosData});return this._enqueue().then(function(){e.state(1);var n,r,i,s,o,u,a,f=e._parentItem,l={};e._isOneDriveWinApp&&f.vault&&(l.Prefer="Include-Feature=Vault");if(e._isFileRequest){e._fileRequestUtilityDataSource=e.resources.consume(z);n=e._fileRequestUtilityDataSource.getVroomCreateUploadSessionItemUrl();r=e._accessToken;i=e._allowCookies;s=Q(2);o=void 0;u=e._fileNamePrefix+t.name;a=!e._allowCookies}else{n=e._graphDataSource.getItemUrl(f,{useDirectEndpoint:!0,isPath:!0,allowCookies:e._allowCookies});r=e._accessToken||e._graphDataSource.getAccessToken(f);i=e._allowCookies;s=Q(e.nameConflictBehavior.peek());o=t.lastModifiedDate;u=t.name;a=!1}return e._vroomUploader.upload({qosData:e._qosData,itemUrl:n,accessToken:r,allowCookies:i,ignoreCookieAuth:a,headers:l,fileName:u,content:t,lastModifiedDate:o,eTag:t.eTag,conflictBehavior:s,onProgress:e.async.debounce(function(t){t>e.uploadedBytes.peek()&&e.uploadedBytes(t)},100,{leading:!1}),onPromptForConfictBehavior:function(t){return e._promptForConflictBehavior(t)},onWait:function(t){return e._wait(t)}})}).then(function(t){e._dequeue();return t},function(t){e._dequeue();return i.n.wrapError(t)}).then(function(t){if(!e._isFileRequest){var n=e._itemTaskObserver,r=e._itemResultProcessor.processItem({itemFromServer:t,requestKey:e._parentItem.key,observer:n}).key;n.update([new P.t(r).succeed({item:{key:r,parentKey:e._parentItem.key}})]);n.flush();var i=n.getItem({key:r});e.item(i)}}).then(function(){e.uploadedBytes(t.size);delete e._fileUpload;e.error(void 0);e.state(2);s.end({resultType:h.e.Success})},function(t){if(i.n.isCanceled(t)){var n=e.state.peek();e.error(void 0);e.state(3);var o=void 0;switch(n){case 0:o="Dequeued";break;case 4:o="Ignored";break;default:o="Aborted"}s.end({resultType:h.e.ExpectedFailure,resultCode:o,extraData:Object(r.__assign)(Object(r.__assign)({},e._qosData),{lastByte:e.uploadedBytes.peek()})})}else{Object(g.s)(t)||H.e.logError(t);var u=e._getUploadError(t),f=u.errorType;e.error(u);e.state(4);s.end({resultType:J(f)?h.e.ExpectedFailure:h.e.Failure,resultCode:a.e[f],error:u.message,extraData:Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},e._qosData),u.extraData),{lastByte:e.uploadedBytes.peek()})})}return i.n.wrapError(t)})};t.prototype._promptForConflictBehavior=function(e){var t=this;this._dequeue();var n=new v.e;this._pendingRestart=n;var r=e?this._getUploadError(e):new f.e({message:"",errorType:a.e.conflict,allowRename:this.allowRename});this.error(r);this.state(4);return n.getPromise().then(function(){var e=t.nameConflictBehavior.peek();t.error(void 0);t.state(0);return t._enqueue().then(function(){t.state(1);return i.n.wrap(Q(e))})})};t.prototype._enqueue=function(){var e=new v.e;this._queueBlocker=e;var t=new v.e(function(){e.cancel()});this._uploadQueue.enqueue(function(){t.complete();return e.getPromise()});return t.getPromise()};t.prototype._dequeue=function(){var e=this._queueBlocker;delete this._queueBlocker;e&&e.complete()};t.prototype._wait=function(e){var t,n=this,r=e.duration,s=e.allowWakeWhenOnline,o=void 0!==s&&s,u=new v.e(function(){n.async.clearTimeout(t)}),a=function(){o&&u.complete()};t=this.async.setTimeout(function(){u.complete()},r);this.events.on(window,"online",a);return u.getPromise().then(function(){n.events.off(window,"online",a)},function(e){n.events.off(window,"online",a);return i.n.wrapError(e)})};t.prototype._getUploadError=function(e){var t;if(Object(g.s)(e)){var n=e;t=n.response&&n.response.error&&n.response.error.fixItUrl}return new f.e({message:e.message,errorType:K(e),allowRename:this.allowRename,fixItUrl:t,extraData:Object(g.r)(e)})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},u.n.dependencies),{vroomUploader:M,uploadQueue:X,itemResultProcessor:D.e,itemTaskObserverType:P.r,graphDataSource:_.w});return t})(u.n);function J(e){switch(e){case a.e.conflict:case a.e.pathTooLong:case a.e.invalidName:case a.e.folderUploadNotSupported:case a.e.emptyFileOrFolder:case a.e.emptyFileOrFolderForDocLib:case a.e.lockMismatch:case a.e.overQuota:case a.e.fileSize:case a.e.unlockRequired:case a.e.insufficientVaultQuota:return!0;default:return!1}}function K(e){var t=Object(g.t)(e,function(e){switch(e){case"authFailure":case"unauthenticated":case 401:return a.e.authFailure;case"pathIsTooLong":return a.e.pathTooLong;case"pathIsTooDeep":case"invalidPath":case"nameContainsInvalidCharacters":return a.e.invalidName;case"itemNotFound":case 404:return a.e.targetFolderMissing;case"activityLimitReached":return a.e.throttled;case"unlockRequired":return a.e.unlockRequired;case"accessRestricted":case"accessDenied":case"notSupported":case 403:case 429:return a.e.accessDenied;case"nameAlreadyExists":case 409:return a.e.conflict;case"entityTagDoesNotMatch":case"versionNumberDoesNotMatch":case"resourceModified":case 412:return a.e.versionMismatch;case"maxFileSizeExceeded":case 413:return a.e.fileSize;case 415:return a.e.emptyFileOrFolder;case"lockMismatch":case"lockNotFoundOrAlreadyExpired":case"lockOwnerMismatch":case 423:return a.e.lockMismatch;case"insufficientVaultQuota":return a.e.insufficientVaultQuota;case"maxDocumentCountExceeded":case"maxFolderCountExceeded":case"maxItemCountExceeded":case"quotaLimitReached":case 507:return a.e.overQuota;case"malwareDetected":case"virusSuspicious":return a.e.malwareDetected;case"timeout":case"generalException":case"invalidRange":case"invalidRequest":case"notAllowed":case"resyncRequired":case"serviceNotAvailable":case"uploadSessionNotFound":case 400:case 405:case 411:case 422:case 500:case 501:case 503:return}});void 0===t&&(t=a.e.general);return t}function Q(e){var t;switch(e){case 1:case 3:t="replace";break;case 2:t="rename";break;default:case 0:t="fail"}return t}var G=new y.t({name:"SingleFileUploader",factory:new s.r($)}),Y=new y.t({name:"SingleFolderUploader.uploadQueue",factory:{dependencies:{},create:function(){return{instance:new m.e(3)}}}}),Z=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._itemDataSource=n.itemDataSource;r._uploadQueue=n.uploadQueue;r._parentItem=t.parentItem;r._onCreateFolder=t.onCreateFolder;r.allowRename=!1;var i=r.observables;r.item=i.create();r.state=i.create(0);r.uploadedBytes=i.create(0);r.totalBytes=i.create(0);r.fileName=i.create(t.name);r.iconName=i.create("folder");r.error=i.create();r.nameConflictBehavior=i.create(0);return r}t.prototype.start=function(){this._uploadPromise=this.trackPromise(this._upload())};t.prototype.abort=function(){this.error(void 0);this.state(3);var e=this._uploadPromise;delete this._uploadPromise;e&&e.cancel()};t.prototype.restart=function(){var e=this,t=this._uploadPromise;delete this._uploadPromise;t&&t.cancel();t.then(function(){},function(){}).done(function(){e.start()})};t.prototype._upload=function(){var e=this;this.state(1);return this._uploadQueue.enqueue(function(){return e._itemDataSource.createFolder({parent:e._parentItem,folderName:e.fileName.peek(),needItemDetails:!0})}).then(function(t){e.item(t);return e._onCreateFolder(t)}).then(function(){e.state(2)},function(t){var n;n=t instanceof Error?t.message:t;e.error(new f.e({errorType:a.e.other,message:n}));e.state(4)})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},u.n.dependencies),{itemDataSource:_.B,uploadQueue:Y});return t})(u.n),ee=Object(s.o)("SingleFolderUploader",Z),te=n(781),ne=n(263),re=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=t.name,s=t.isFolder,o=t.error;r._error=o;var u=te.t(i),a=s?"folder":Object(ne.t)(u);r.allowRename=!1;var f=r.observables;r.item=f.create();r.state=f.create(4);r.uploadedBytes=f.create(0);r.totalBytes=f.create(0);r.fileName=f.create(i);r.iconName=f.create(a);r.error=f.create(r._error);r.nameConflictBehavior=f.create(0);return r}t.prototype.start=function(){this.error(this._error);this.state(4)};t.prototype.abort=function(){this.error(void 0);this.state(3)};t.prototype.restart=function(){this.start()};return t})(u.n),ie=Object(s.o)("SingleErrorUploader",re),se=0,oe=(function(){function e(e,t){var n=e.file;this._file=n;this.eTag=n.eTag;var r,i=n.fileName||n.name,s=te.n(i),o=s.name,u=s.extension;this.extension=u;this.iconName=ne.t(u);this.size=n.size;if(t.platformDetection.isIOS&&"image"===o&&"photo"===this.iconName){var a=n.lastModifiedDate,f=void 0===a?new Date:a;r="IMG_"+this._getLastModifiedISO8601(f)+"_"+ ++se+u}else r=i;n.lastModifiedDate&&(this.lastModifiedDate=n.lastModifiedDate);this.name=r}e.prototype.slice=function(e,t){var n=this._file;return(n.slice||n.mozSlice||n.webkitSlice).call(n,e,t)};e.prototype._getLastModifiedISO8601=function(e){return e.getUTCFullYear()+"-"+ue(e.getUTCMonth()+1,2)+"-"+ue(e.getUTCDate(),2)+" "+ue(e.getUTCHours(),2)+"-"+ue(e.getUTCMinutes(),2)+"-"+ue(e.getSeconds(),2)};return e})();function ue(e,t){for(var n=""+e;n.length<t;)n="0"+n;return n}var ae,fe=n(34),le=Object(s.o)("Html5FileUpload",oe,{platformDetection:fe.e});(function(e){e[e.unknown=0]="unknown";e[e.file=1]="file";e[e.directory=2]="directory"})(ae||(ae={}));function ce(e){return{name:e.name,type:2,getEntries:function(){return i.n.resolve({entries:pe(e)})}}}function he(e){return e.type?{name:e.name,type:1,getFile:function(){return i.n.resolve(e)}}:{name:e.name,type:0,getFile:function(){return i.n.resolve(e)}}}function pe(e){var t=[];for(var n in e.directories)n&&t.push(ce(e.directories[n]));for(var r=0,i=e.files;r<i.length;r++){var s=i[r];t.push(he(s))}return t}function de(e){return(function(e){var t=new v.e;e.readEntries(function(e){return t.complete(e)},function(e){return t.error(e)});return t.getPromise()})(e).then(function(t){return t.length?{entries:t.map(ve),getEntries:function(){return de(e)}}:{entries:[]}})}function ve(e){var t;e.isDirectory?t={name:e.name,type:2,getEntries:function(){return de(e.createReader())}}:e.isFile&&(t={name:e.name,type:1,getFile:function(){return(function(e){var t=new v.e;e.file(function(e){t.complete(e)},function(e){t.error(e)});return t.getPromise()})(e)}});return t}var me=n(374),ge=n(1017),ye=0,be=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._uploader=t.uploader;r._isDragDrop=t.isDragDrop;r._id=++ye;r._sequence=0;r.observables.backgroundCompute(r._computeUpdateQos);return r}t.prototype._computeUpdateQos=function(){var e=this._uploader,t=e.state.peek();if(0===t){this._uploadEvent=void 0;e.state()}else if(1===t){this._uploadEvent=this._createUploadEvent();e.state()}else if(2===t){(this._uploadEvent||(this._uploadEvent=this._createUploadEvent())).end({resultType:h.e.Success})}else if(4===t){var n=e.error.peek();(this._uploadEvent||(this._uploadEvent=this._createUploadEvent())).end(Object(ge.e)(Object(me.e)(n),Object(r.__assign)({},n?{resultType:we(n)?h.e.ExpectedFailure:h.e.Failure}:{})));e.state()}else if(3===t){(this._uploadEvent||(this._uploadEvent=this._createUploadEvent())).end({resultType:h.e.ExpectedFailure,resultCode:"canceled"})}};t.prototype._createUploadEvent=function(){return new d({name:"BatchUploader.uploadSingleItem",dragAndDrop:this._isDragDrop,size:this._uploader.totalBytes.peek(),extension:Object(te.t)(this._uploader.fileName.peek(),!0),folderUpload:"folder"===this._uploader.iconName.peek(),groupFolder:!1,extraData:{uploadId:this._id,uploadAttemptCount:++this._sequence,isScenarioQosEvent:!0}})};return t})(u.n);function we(e){switch(e.errorType){case a.e.conflict:case a.e.emptyFileOrFolder:case a.e.emptyFileOrFolderForDocLib:case a.e.fileSize:case a.e.folderUploadNotSupported:case a.e.invalidName:case a.e.lockMismatch:case a.e.malwareDetected:case a.e.overQuota:case a.e.overQuotaSharedFolder:case a.e.throttled:case a.e.versionMismatch:case a.e.unlockRequired:case a.e.insufficientVaultQuota:return!0;default:case a.e.authFailure:case a.e.accessDenied:case a.e.general:case a.e.none:case a.e.other:case a.e.targetFolderMissing:return!1}}var Ee=Object(s.o)("UploadQosMonitor",be,{});var Se=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,{},n)||this,i=t.batchStartTime,s=void 0===i?Date.now():i;r.filesUploading=r.observables.createArray();r.wasDragAndDropped=!!t.wasDragAndDropped;r.parentItem=t.parentItem;r.isFileRequest=!!t.isFileRequest;r.allowCookies=!!t.allowCookies;r.accessToken=t.accessToken;r.fileNamePrefix=t.fileNamePrefix;r._behavior=t.behavior;r._fileList=t.files;r.scenario=(t.scenario?t.scenario+".":"")+(r.wasDragAndDropped?"DragDrop.Upload":"Upload");r.batchStartTime=s;r._fileReader=new FileReader;r._fileReaderQueue=new m.e;r._startUploadQueue=new m.e;r._html5FileUploadType=n.html5FileUploadType;r._singleErrorUploaderType=n.singleErrorUploaderType;r._singleFolderUploaderType=n.singleFolderUploaderType;r._uploadQosMonitorType=n.uploadQosMonitorType;return r}t.prototype.start=function(){var e=this,t=new c.e({name:"BatchUploader.start",extraData:{scenario:this.scenario,dragAndDrop:this.wasDragAndDropped}});return this.beforeStart().then(function(){var t,n=e._fileList;t=(function(e){var t=e[0];return!!t&&"function"==typeof(t.slice||t.mozSlice||t.webkitSlice)&&"size"in t})(n)?(function(e){for(var t={name:"",directories:{},files:[]},n=0,r=e;n<r.length;n++){for(var i=r[n],s=i.webkitRelativePath,o=t,u=0,a=(void 0===s?i.name:s).split("/").slice(0,-1);u<a.length;u++){var f=a[u];o=o.directories[f]||(o.directories[f]={name:f,directories:{},files:[]})}o.files.push(i)}return pe(t)})(n):n.map(ve);return i.n.all(t.map(function(t,n){return e._getUpload(t,e.parentItem,n)})).then(function(e){return i.n.all(e.map(function(e){return e.wait}))}).then(function(){})}).then(function(){t.end({resultType:h.e.Success});e.onBatchComplete()},function(){t.end({resultType:h.e.Failure});e.onBatchComplete()})};t.prototype.beforeStart=function(){return i.n.wrap()};t.prototype.validateFile=function(e){return i.n.wrap()};t.prototype.createSingleFolderUploader=function(e){var t=e.parentItem,n=e.name,r=e.onCreateFolder;return new(this.scope.attached(this._singleFolderUploaderType))({name:n,parentItem:t,onCreateFolder:r})};t.prototype.onBatchComplete=function(){};t.prototype.isSPList=function(){return!1};t.prototype.libraryName=function(){return""};t.prototype._isFolder=function(e){var t=this,n=this._fileReader;return this._fileReaderQueue.enqueue(function(){var r=new v.e;t.events.on(n,"load",function(){r.complete(!1)});t.events.on(n,"error",function(){r.complete(!0)});var i=e.slice||e.mozSlice||e.webkitSlice;try{n.readAsArrayBuffer(i.call(e,0,Math.min(1,e.size)))}catch(e){r.complete(!0)}return r.getPromise().then(function(e){t.events.off(n);return e})})};t.prototype._getUpload=function(e,t,n){var r=this,s=new c.e({name:"BatchUploader.getUpload",extraData:{scenario:this.scenario,dragAndDrop:this.wasDragAndDropped}});return this._startUploadQueue.enqueue(function(){var e,t=new v.e(function(){e&&r.async.clearTimeout(e)});e=r.async.setTimeout(function(){return t.complete()},0);return t.getPromise()}).then(function(){return 2===e.type?r._getDirectoryUpload(e,t):r._getUnknownUpload(e,t,n)}).then(function(e){s.end({resultType:h.e.Success});return e},function(e){s.end({resultType:h.e.Failure});return i.n.wrapError(e)})};t.prototype._getUploadsForDirectoryPage=function(e,t,n){var r=this,s=e.entries,o=[i.n.all(s.map(function(e,i){return r._getUpload(e,t,n+i)}))];e.getEntries&&o.push(e.getEntries().then(function(e){return r._getUploadsForDirectoryPage(e,t,n+s.length)}));return i.n.all(o).then(function(e){var t;return(t=[]).concat.apply(t,e)})};t.prototype._getDirectoryUpload=function(e,t){var n=this,r=new v.e,s=this.createSingleFolderUploader({name:e.name,parentItem:t,onCreateFolder:function(t){return e.getEntries().then(function(e){return n._getUploadsForDirectoryPage(e,t,0)}).then(function(e){r.complete(e)},function(e){r.error(e)})}}),o={wait:this._waitForUploader(s).then(function(){return r.getPromise()}).then(function(e){return i.n.all(e.map(function(e){return e.wait}))}).then(function(){})};return i.n.wrap(o)};t.prototype._getUnknownUpload=function(e,t,n){var r=this;return e.getFile().then(function(s){var o,u;o=0===e.type?r._isFolder(s).then(function(e){u=!0;if(e)return i.n.wrapError(new f.e({message:"",errorType:a.e.folderUploadNotSupported}))}):i.n.wrap();var l=new r._html5FileUploadType({file:s});return o.then(function(){return r._validateFile({fileUpload:l})}).then(function(){return r.validateFile({fileUpload:l,parentItem:t,index:n})}).then(function(){return r.createSingleFileUploader({fileUpload:l,parentItem:t,index:n,isTemplate:r.isTemplate,isFileRequest:r.isFileRequest,allowCookies:r.allowCookies,accessToken:r.accessToken,fileNamePrefix:r.fileNamePrefix})},function(e){return new(r.scope.attached(r._singleErrorUploaderType))({name:s.name,parentItem:t,isFolder:u,error:e})})},function(n){return new(r.scope.attached(r._singleErrorUploaderType))({name:e.name,parentItem:t,isFolder:!1,error:new f.e({errorType:a.e.general,message:""})})}).then(function(e){return{wait:r._waitForUploader(e)}})};t.prototype._waitForUploader=function(e){var t=new v.e(function(){e.abort()});this.scope.attach(new this._uploadQosMonitorType({uploader:e,isDragDrop:this.wasDragAndDropped}));this.observables.backgroundCompute(function(){var n=e.state.peek();2===n?t.complete():4===n?t.error(e.error.peek()||new Error("Unknown error from uploader.")):3===n?t.cancel():e.state()});this._addUploader(e);e.start();return t.getPromise()};t.prototype._validateFile=function(e){var t=e.fileUpload;return t.name?t.size?void 0!==this.maxFileSize&&t.size>this.maxFileSize?i.n.wrapError(new f.e({message:"",errorType:a.e.fileSize,maxSizeInBytes:this.maxFileSize})):i.n.wrap():i.n.wrapError(new f.e({message:"",errorType:this.isSPList()?a.e.emptyFileOrFolderForDocLib:a.e.emptyFileOrFolder,libraryName:this.libraryName()})):i.n.wrapError(new f.e({message:"",errorType:a.e.invalidName}))};t.prototype._addUploader=function(e){var t=this._behavior;t&&e.nameConflictBehavior(t);this.filesUploading.push(e);return e};t.dependencies=Object(r.__assign)(Object(r.__assign)({},u.n.dependencies),{html5FileUploadType:le,singleErrorUploaderType:ie,singleFolderUploaderType:ee,uploadQosMonitorType:Ee});return t})(u.n);n.d(t,"typeResourceKey",function(){return Te});var xe=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.maxFileSize=107374182400;r._itemToRedeem=t.item||t.parentItem;r._vroomSingleFileUploaderType=n.vroomSingleFileUploaderType;return r}t.prototype.beforeStart=function(){return this._itemToRedeem?o.i(this._itemToRedeem,{name:"UploadManager",resources:this.resources}).then(function(){}):i.n.resolve()};t.prototype.createSingleFileUploader=function(e){var t=e.fileUpload,n=e.parentItem;return new(this.scope.attached(this._vroomSingleFileUploaderType))({fileUpload:t,parentItem:n,qosContext:{uploadType:"h5",isDragAndDrop:this.wasDragAndDropped,isFolderUpload:!0,scenario:this.scenario}})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},Se.dependencies),{vroomSingleFileUploaderType:G});return t})(Se),Te=(t.default=xe,Object(s.o)("BatchUploader",xe))}}]);