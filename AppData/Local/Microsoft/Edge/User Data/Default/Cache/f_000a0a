(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["176"],{"1365":function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(9),o=n(268),u=n(66),a=n(1901),f=n(60),l=n(11);Object(l.n)([{rawString:".od-CarouselIndicator{padding-top:8px;text-align:center}[dir=ltr] .od-CarouselIndicator-dot:not(:last-child){margin-right:20px}[dir=rtl] .od-CarouselIndicator-dot:not(:last-child){margin-left:20px}.od-CarouselIndicator-dot:not(:disabled){cursor:pointer}.od-CarouselIndicator-dot{color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";border:none;font-size:1em;background:0 0}.od-CarouselIndicator-dot.od-CarouselIndicator-dot--isActive{color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:"}"}]);var c,h=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.pagedComponents,i=t.pageSize,s=t.startIndex,o=t.endIndex;n._pagedComponents=r;n._pageSize=n.wrapObservable(i);n._startIndex=s;n._endIndex=o;n.pageMarkers=n.createPureComputed(n._computePageMarkers).extend({rateLimit:3});return n}t.prototype.determinePageMarkers=function(e,t,n,r,i){for(var s=this,o=[],u=0;u<t;u++){var a=u*n,f=(a=Math.min(a,e-n))+n-1;o.push({startIndex:a,endIndex:f,isActive:a<=r&&i<=f,onClick:function(e,t){s._startIndex(e.startIndex)}})}return o};t.prototype.determinePageMarkerCount=function(e,t){return Math.ceil(e/t)};t.prototype._computePageMarkers=function(){var e=this._pagedComponents().length,t=this._pageSize(),n=this.determinePageMarkerCount(e,t),r=this._startIndex(),i=this._endIndex();return this.determinePageMarkers(e,n,t,r,i)};return t})(s.t),p=n(16).e({tagName:"od-carousel-indicator",template:'<div class="od-CarouselIndicator ms-font-xxl">\x3c!--ko foreach:pageMarkers--\x3e<button class="od-CarouselIndicator-dot" data-bind="css:{\'od-CarouselIndicator-dot--isActive\':isActive},disable:isActive,click:onClick,attr:{\'aria-pressed\':isActive}">â€¢</button>\x3c!--/ko--\x3e</div>',viewModel:h,synchronous:!0}),d=n(36);n.d(t,"e",function(){return c});(function(e){e[e.arrowsBottom=0]="arrowsBottom";e[e.arrowsSide=1]="arrowsSide"})(c||(c={}));var v=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.carouselIndicatorTagName=p.tagName;var r=t.tileWidth,s=t.tileHeight,l=t.padding,h=void 0===l?i.observable({paddingTop:0,paddingRight:0,paddingBottom:0,paddingLeft:0}):l,d=t.components,v=t.pageSize,m=void 0===v?0:v,g=t.parentSize,y=t.useVirtualizedList,b=void 0!==y&&y,w=t.pagerMode,E=void 0===w?c.arrowsBottom:w,S=t.useCarouselIndicator,x=void 0!==S&&S,T=t.maxNumberOfPages,N=void 0===T?-1:T,C=t.useTopNavigation,k=void 0!==C&&C,L=t.carouselTitle,A=void 0===L?void 0:L;n.useTopNavigation=k;n.showCarouselTitle=!!A;n.title=A?A.title:"";n.label=A?A.ariaLabel:"";n.tileWidth=r;n.tileHeight=s;n.padding=h;n._allComponents=d;n._customPageSize=m;n.startIndex=i.observable(0);n._parentSize=g;n.useVirtualizedList=b;n.pagerMode=E;n.useCarouselIndicator=x;n.pagerModeEnum=c;n._maxNumberOfPages=n.wrapObservable(N);n._engagement=n.resources.consume(f.e);n.addBindingHandlers({clientRect:o.e,element:u.e});n.resx=a.e;n.size=i.observable({width:0,height:0});n._numVisibleTiles=n.createPureComputed(n._computeNumVisibleTiles);n.pageSize=n.createPureComputed(n._computePageSize);n.endIndex=n.createPureComputed(n._computeEndIndex);n.showNav=n.createPureComputed(n._computeShowNav);n.enableNextNav=n.createPureComputed(n._computeEnableNextNav);n.enablePrevNav=n.createPureComputed(n._enablePrevNav);n.carouselNavNextButtonAriaLabel=n.createPureComputed(n._computeCarouselNavNextButtonAriaLabel);n.carouselNavPrevButtonAriaLabel=n.createPureComputed(n._computeCarouselNavPrevButtonAriaLabel);n._pagedComponents=n.createPureComputed(n._computePagedComponents).extend({rateLimit:1});n.visibleComponents=n.createPureComputed(n._computeVisibleComponents).extend({rateLimit:2});n.carouselIndicatorParams={pagedComponents:n._pagedComponents,pageSize:n.pageSize,startIndex:n.startIndex,endIndex:n.endIndex};n.createBackgroundComputed(n._computeResetStartIndex);n.carouselNavPrevButtonElement=n.createObservable(null);n.carouselNavNextButtonElement=n.createObservable(null);return n}t.prototype.previous=function(){var e=this._numVisibleTiles(),t=this._pagedComponents.peek().length;if(e&&e<=t){var n=this.pageSize(),r=this.startIndex()-n;r<0&&(r=0);if(this.useCarouselIndicator){var i=Math.floor(r/n);r!==i*n&&(r=(i+1)*n)}this.startIndex(r);this._engagement.logData({name:"ComponentCarousel.Previous"})}};t.prototype.next=function(){var e=this._numVisibleTiles(),t=this._pagedComponents.peek().length;if(e&&e<=t){var n=this.pageSize(),r=this.startIndex()+n;r>t-e&&(r=t-e);this.startIndex(r);this._engagement.logData({name:"ComponentCarousel.Next"})}};t.prototype._computeVisibleComponents=function(){var e=this._pagedComponents();return this.useVirtualizedList?e.slice(this.startIndex(),this.endIndex()+1):e};t.prototype._computePagedComponents=function(){var e=this._allComponents();if(this.useVirtualizedList){var t=this._maxNumberOfPages(),n=this.pageSize(),r=-1===t?Math.ceil(e.length/n):Math.min(Math.ceil(e.length/n),t);0===r&&e.length>0&&(r=1);return e.slice(0,r*n)}return e};t.prototype._computeNumVisibleTiles=function(){var e=this._parentSize&&this._parentSize()||this.size(),t=Math.floor(e.width/this.tileWidth());return Math.max(t,1)};t.prototype._computeResetStartIndex=function(){this.showNav()||this.startIndex(0)};t.prototype._enablePrevNav=function(){var e=0!==this.startIndex()&&this.showNav();!e&&document.activeElement===this.carouselNavPrevButtonElement()&&this.carouselNavNextButtonElement()&&this.carouselNavNextButtonElement().focus();return e};t.prototype._computeEnableNextNav=function(){var e=this._pagedComponents().length,t=this.endIndex()!==e-1&&this.showNav();!t&&document.activeElement===this.carouselNavNextButtonElement()&&this.carouselNavPrevButtonElement()&&this.carouselNavPrevButtonElement().focus();return t};t.prototype._computeShowNav=function(){return this._numVisibleTiles()<this._pagedComponents().length};t.prototype._computeEndIndex=function(){var e=this._pagedComponents().length,t=this.startIndex()+this._numVisibleTiles()-1;return t=t>=e?e-1:t};t.prototype._computePageSize=function(){var e=this._customPageSize,t=this._numVisibleTiles();if(t){(!e||t<e)&&(e=t);return e}return 1};t.prototype._computeCarouselNavNextButtonAriaLabel=function(){var e=this._pagedComponents().length,t=this.endIndex()+2,n=t+this.pageSize()-1;n>e&&(t=(n=e)-this.pageSize()+1);return d.format(this.resx.carouselNavButtonAriaLabel,t,n)};t.prototype._computeCarouselNavPrevButtonAriaLabel=function(){var e=this.startIndex(),t=e-this.pageSize()+1;t<=0&&(e=(t=1)+this.pageSize()-1);return d.format(this.resx.carouselNavButtonAriaLabel,t,e)};return t})(s.t);t.t=v},"1588":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-ComponentCarousel-container{display:inline-block;width:100%}.od-ComponentCarousel-list{display:inline-block;overflow:hidden}@keyframes fadeAndScale{from{opacity:.55;animation-timing-function:ease-in}to{opacity:1;animation-timing-function:ease-out}}.od-ComponentCarousel-iconFadeInOut{animation:fadeAndScale .85s;position:relative;display:inline-block;vertical-align:top}.od-ComponentCarousel-iconFadeInOut:focus{outline:1px solid #666}.od-ComponentCarousel-nav{margin-top:8px;text-align:center}.od-ComponentCarousel-navButton{background:0 0;border:none}.od-ComponentCarousel-navButton:not(:disabled){cursor:pointer}[dir=ltr] .od-ComponentCarousel-margin{margin-right:8px}[dir=rtl] .od-ComponentCarousel-margin{margin-left:8px}.od-ComponentCarousel-title{display:inline-block;vertical-align:top;font-size:21px;font-weight:100;margin-bottom:12px}.lg .od-ComponentCarousel-title,.xlg .od-ComponentCarousel-title,.xxlg .od-ComponentCarousel-title,.xxxlg .od-ComponentCarousel-title,.xxxxlg .od-ComponentCarousel-title{margin-bottom:10px}.xlg .od-ComponentCarousel-title,.xxlg .od-ComponentCarousel-title,.xxxlg .od-ComponentCarousel-title,.xxxxlg .od-ComponentCarousel-title{font-size:28px;font-weight:100;margin-bottom:20px}.od-ComponentCarousel-toolbar.od-ComponentCarousel-topNavigation{display:block}.md .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-nav,.sm .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-nav{display:none}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-nav.od-ComponentCarousel-topNavigation{float:right}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton{position:absolute;padding:0;top:0;bottom:0;margin-top:auto;margin-bottom:auto;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";height:40px;width:32px}.xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton,.xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton,.xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton{width:36px}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton:disabled{color:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton:hover{background-color:"},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton[disabled]:hover{background:0 0}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-topNavigation--button{position:static;float:right;margin-top:auto;margin-bottom:auto;height:32px}.xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-topNavigation--button,.xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-topNavigation--button,.xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-topNavigation--button{height:36px}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{float:left}[dir=ltr] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{left:-32px}[dir=rtl] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{right:-32px}[dir=ltr] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=ltr] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=ltr] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{left:-36px}[dir=rtl] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=rtl] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev,[dir=rtl] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--prev{right:-36px}.od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{float:left}[dir=ltr] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{right:-32px}[dir=rtl] .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{left:-32px}[dir=ltr] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=ltr] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=ltr] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{right:-36px}[dir=rtl] .xxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=rtl] .xxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next,[dir=rtl] .xxxxlg .od-ComponentCarousel--arrowsSide .od-ComponentCarousel-navButton--next{left:-36px}"}]);var i=n(1365),s=n(16).e({tagName:"ms-component-carousel",template:'<div class="od-ComponentCarousel" data-bind="clientRect:{size:size,allowHiddenSizeUpdates:true},css:{\'od-ComponentCarousel--arrowsBottom\':pagerMode===pagerModeEnum.arrowsBottom,\'od-ComponentCarousel--arrowsSide\':pagerMode===pagerModeEnum.arrowsSide}"><div class="od-ComponentCarousel-container"><div class="od-ComponentCarousel-toolbar" data-bind="css:{\'od-ComponentCarousel-topNavigation\':useTopNavigation,\'od-ComponentCarousel-SideNavigation\':!useTopNavigation}">\x3c!--ko if:showCarouselTitle--\x3e<h2 class="od-ComponentCarousel-title" data-bind="text:title,attr:{\'aria-label\':label}"></h2>\x3c!--/ko--\x3e\x3c!--ko if:showNav--\x3e<div class="od-ComponentCarousel-nav ms-font-xxl" data-bind="css:{\'od-ComponentCarousel-topNavigation\':useTopNavigation}"><button class="od-ComponentCarousel-navButton od-ComponentCarousel-navButton--prev ms-Icon" data-bind="element:carouselNavPrevButtonElement,disable:!enablePrevNav(),click:previous.bind($data),attr:{\'aria-label\':carouselNavPrevButtonAriaLabel()},css:{\'od-ComponentCarousel-topNavigation--button\':useTopNavigation}"><i aria-hidden="true" class="ms-Icon ms-Icon--ChevronLeft" data-bind="icon:true"></i></button><button class="od-ComponentCarousel-navButton od-ComponentCarousel-navButton--next ms-Icon" data-bind="element:carouselNavNextButtonElement,disable:!enableNextNav(),click:next.bind($data),attr:{\'aria-label\':carouselNavNextButtonAriaLabel()},css:{\'od-ComponentCarousel-topNavigation--button\':useTopNavigation}"><i aria-hidden="true" class="ms-Icon ms-Icon--ChevronRight" data-bind="icon:true"></i></button></div>\x3c!--/ko--\x3e</div><div class="od-ComponentCarousel-list" data-bind="style:{height:tileHeight()+\'px\',padding:padding().paddingTop+\'px \'+padding().paddingRight+\'px \'+padding().paddingBottom+\'px \'+padding().paddingLeft+\'px\'}">\x3c!--ko foreach:visibleComponents()--\x3e<div class="od-ComponentCarousel-iconFadeInOut" data-bind="component:{name:name,params:params},visible:$parent.useVirtualizedList?true:$parent.startIndex()<=$index()&&$index()<=$parent.endIndex(),style:{width:$parent.tileWidth()+\'px\',height:$parent.tileHeight()+\'px\'},css:{\'od-ComponentCarousel-margin\':$parent.useVirtualizedList?$index()!==$parent.pageSize()-1:$index()!==$parent.endIndex()}"></div>\x3c!--/ko--\x3e</div>\x3c!--ko if:useCarouselIndicator&&showNav()--\x3e\x3c!--ko component:{name:carouselIndicatorTagName,params:carouselIndicatorParams}--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e</div></div>',viewModel:i.t,synchronous:!0});t.e=s},"1797":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-ItemTileCard-cardSection{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;bottom:0;left:0;right:0;border:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";padding-left:12px;padding-right:12px;height:40px;line-height:40px;font-size:14px}.md .od-ItemTileCard-cardSection,.sm .od-ItemTileCard-cardSection{height:40px;line-height:40px}.lg .od-ItemTileCard-cardSection{height:40px;line-height:40px}.xlg .od-ItemTileCard-cardSection,.xxlg .od-ItemTileCard-cardSection,.xxxlg .od-ItemTileCard-cardSection,.xxxxlg .od-ItemTileCard-cardSection{padding-left:20px;padding-right:20px}.od-ItemTileCard .ItemTile{bottom:42px}.md .od-ItemTileCard .ItemTile,.sm .od-ItemTileCard .ItemTile{bottom:42px}.lg .od-ItemTileCard .ItemTile{bottom:42px}.od-ItemTileCard-action{position:absolute;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}[dir=ltr] .od-ItemTileCard-action{right:12px}[dir=rtl] .od-ItemTileCard-action{left:12px}[dir=ltr] .xlg .od-ItemTileCard-action,[dir=ltr] .xxlg .od-ItemTileCard-action,[dir=ltr] .xxxlg .od-ItemTileCard-action,[dir=ltr] .xxxxlg .od-ItemTileCard-action{right:20px}[dir=rtl] .xlg .od-ItemTileCard-action,[dir=rtl] .xxlg .od-ItemTileCard-action,[dir=rtl] .xxxlg .od-ItemTileCard-action,[dir=rtl] .xxxxlg .od-ItemTileCard-action{left:20px}.od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle{display:inline;text-align:center;left:0;right:0}.xlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle,.xxlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle,.xxxlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle,.xxxxlg .od-ItemTileCard-action.od-ItemTileCard-action--withoutTitle{right:0}.od-ItemTileCard .od-ItemTile--isAlbum .ItemTile-namePlate,.od-ItemTileCard .od-ItemTile--isAlbum .od-FolderCoverTile-item1{left:0;right:0}"}]);var i=n(0),s=n(9),o=n(26),u=n(25),a=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.text,i=void 0===r?"":r,s=t.itemTileParams,o=t.actionText,u=void 0===o?"":o,a=t.action,f=t.itemTileTagName,l=t.ariaLabel;n.text=n.wrapObservable(i);n.actionText=n.wrapObservable(u);n.action=a;n.itemTileParams=s;n.itemTileTagName=f;n.ariaLabel=l;return n}t.prototype.onClick=function(e,t){return this.action?this.action.execute(t):u.n.wrap({resultType:o.e.ExpectedFailure})};return t})(s.t),f=n(16).e({tagName:"od-item-tile-card",template:'<div class="od-ItemTileCard"><div class="od-ItemTileCard-tile">\x3c!--ko component:{name:itemTileTagName,params:itemTileParams}--\x3e\x3c!--/ko--\x3e</div><div class="od-ItemTileCard-cardSection">\x3c!--ko if:text--\x3e<span class="od-ItemTileCard-title" data-bind="text:text"></span>\x3c!--/ko--\x3e\x3c!--ko if:actionText--\x3e<a class="od-ItemTileCard-action od-Link" href="#" data-bind="attr:{\'aria-label\':ariaLabel},text:actionText,click:onClick,css:{\'od-ItemTileCard-action--withoutTitle\':!text()}"></a>\x3c!--/ko--\x3e</div></div>',viewModel:a,synchronous:!0});t.e=f},"2155":function(e,t,n){"use strict";n.r(t);var r=n(11);Object(r.n)([{rawString:".od-PromotedPhotos-itemTile{position:relative;display:inline-block}[dir=ltr] .od-PromotedPhotos-itemTile{margin-right:4px}[dir=rtl] .od-PromotedPhotos-itemTile{margin-left:4px}.od-PromotedPhotos-sections{height:140px;overflow:hidden}.lg .od-PromotedPhotos-sections,.xlg .od-PromotedPhotos-sections,.xxlg .od-PromotedPhotos-sections,.xxxlg .od-PromotedPhotos-sections,.xxxxlg .od-PromotedPhotos-sections{height:220px}.od-PromotedPhotos-featuredAlbum{height:140px;overflow:hidden;margin-bottom:4px}.lg .od-PromotedPhotos-featuredAlbum,.xlg .od-PromotedPhotos-featuredAlbum,.xxlg .od-PromotedPhotos-featuredAlbum,.xxxlg .od-PromotedPhotos-featuredAlbum,.xxxxlg .od-PromotedPhotos-featuredAlbum{height:380px}.od-PromotedPhotos-featuredAlbum .od-PromotedPhotos-itemTile{margin-top:4px}html[dir=ltr] .od-PromotedPhotos-featuredAlbum .od-PromotedPhotos-itemTile{float:left}html[dir=rtl] .od-PromotedPhotos-featuredAlbum .od-PromotedPhotos-itemTile{float:right}.od-PromotedPhotos .ItemTile .ItemTile-name{font-size:21px;font-weight:100}.od-PromotedPhotos .ItemTile.is-tag,.od-PromotedPhotos .ItemTile.od-OnThisDayTile{top:8px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name{bottom:28px;line-height:31px;left:12px;right:12px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-name{left:20px;right:20px;bottom:40px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name{bottom:12px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum.od-ItemTile--noDate .ItemTile-name{bottom:20px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{display:block;position:absolute;top:auto;bottom:12px;font-size:14px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{left:12px}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{right:12px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{bottom:20px}[dir=ltr] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=ltr] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=ltr] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=ltr] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{left:20px}[dir=rtl] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=rtl] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=rtl] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date,[dir=rtl] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-date{right:20px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{font-size:14px;bottom:12px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:12px}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:12px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:auto}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:auto}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{bottom:20px}[dir=ltr] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=ltr] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=ltr] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=ltr] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{right:20px}[dir=rtl] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=rtl] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=rtl] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount,[dir=rtl] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-childCount{left:20px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{bottom:53px}.xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,.xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,.xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,.xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{bottom:72px}[dir=ltr] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=ltr] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=ltr] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=ltr] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{left:9px}[dir=rtl] .xlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=rtl] .xxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=rtl] .xxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge,[dir=rtl] .xxxxlg .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .ItemTile-newBadge{right:9px}.od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .od-newBadge{font-size:15px}[dir=ltr] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .od-newBadge .od-newBadge-icon{margin-right:-.55em}[dir=rtl] .od-PromotedPhotos .ItemTile.od-ItemTile--isAlbum .od-newBadge .od-newBadge-icon{margin-left:-.55em}"}]);var i=n(16),s=n(24),o=n(0),u=n(2184),a=n(9),f=n(6),l=n(15),c=n(31),h=n(1797),p=n(274),d=n(268),v=n(433),m=n(1365),g=n(1588),y=n(1223),b=n(4),w=n(941),E=n(346),S=n(46),x=n(80),T=n(36),N=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.carouselTagName=g.e.tagName;n.addBindingHandlers({clientRect:d.e});var r=n.resources.consume(c.d);n._promotedPhotosProvider=n.resources.consume(c.g);n._actionMap=n.resources.consume(f.e);n._urlDataSource=n.resources.consume(l.we);n.promotedPhotosSize=n.createObservable({width:0,height:0}).extend({rateLimit:{timeout:v.e,method:"notifyWhenChangesStop"}});n._cellSize=n.createPureComputed(n._computeCellSize);n.label=u.e.exploreRecentPhotosLabel;n.title=u.e.exploreRecentPhotosTitle;n._allPhotosUserSettings=r.getAllPhotosSettings();n._allPhotosContext={rootItemId:n._allPhotosUserSettings.peek().rootId,ascending:!1,pageSize:100,startIndex:0,parentKey:void 0};n._photoItemSet=r.getAllPhotosSync(n._allPhotosContext);n._photoItemSetCanary=n.observables.pureCompute(function(){return n._photoItemSet.content().items});n._photoItemSetCanary.equalityComparer=S.t;n._onThisDayPhotos=n.createObservable([]);n._autoAlbums=n.createObservable([]);n._sharedAlbums=n.createObservable([]);n._tagsAndPlaces=n.createObservable({tags:[],places:[]});n.createBackgroundComputed(n._updateContent).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});n._availableTiles=n.createPureComputed(n._computeAvailableTiles);n._visibleTileCount=n.createPureComputed(n._computeVisibleTileCount);n._carouselComponents=n.createPureComputed(n._computeCarouselComponents);n._carouselItemWidth=n.createPureComputed(n._computeCarouselItemWidth);var i={title:u.e.exploreRecentPhotosTitle,ariaLabel:u.e.exploreRecentPhotosLabel},s=n.resources.consume(x.n),o=s?194:268;n.carouselParams={tileWidth:n._carouselItemWidth,tileHeight:n.createObservable(o),components:n._carouselComponents,parentSize:n.promotedPhotosSize,useVirtualizedList:!0,pagerMode:m.e.arrowsSide,useCarouselIndicator:!s,maxNumberOfPages:6,useTopNavigation:s,carouselTitle:i};return n}t.prototype._updateContent=function(){var e=this;this._photoItemSetCanary();this._promotedPhotosProvider.getNewAutoAlbums().done(function(t){e._autoAlbums(t)});this._promotedPhotosProvider.getSharedAlbums().done(function(t){e._sharedAlbums(t)});this._promotedPhotosProvider.getOnThisDay(this._allPhotosContext).done(function(t){e._onThisDayPhotos(t)});this._promotedPhotosProvider.getTagsAndPlaces(this._allPhotosContext).done(function(t){e._tagsAndPlaces(t)})};t.prototype._computeAvailableTiles=function(){var e=this._tagsAndPlaces()||{tags:[],places:[]};return this._orderPromotedPhotos(this._onThisDayPhotos()||[],this._autoAlbums()||[],e.tags||[],e.places||[],this._sharedAlbums()||[])};t.prototype._orderPromotedPhotos=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],r=!1,i=0;!r;i++){r=!0;for(var s=0,o=e;s<o.length;s++){var u=o[s];if(u[i]){n.push(u[i]);r=!1}}}return n};t.prototype._computeCarouselItemWidth=function(){var e=this.promotedPhotosSize(),t=this._visibleTileCount();return e.width/t-8+8/t};t.prototype._computeCellSize=function(){var e=this.promotedPhotosSize(),t=this._visibleTileCount();return{width:e.width/t-8,height:268}};t.prototype._computeCarouselComponents=function(){var e=this._availableTiles().filter(function(e){return!!e}),t=[],n=this._carouselComponents.peek(),r=[];n&&n.length&&(r=n.map(function(e){return e.params.itemTileParams.item}));for(var i=0,s=e;i<s.length;i++){var o=s[i],u=r.indexOf(o),a=void 0;if(u>=0)a=n[u];else{var f={itemTileParams:{item:o,cellSize:this._cellSize,isInteractable:!0,engagementSource:"PromotedPhotosTile"},text:this._getCardTitleForItem(o.peek()),actionText:this._getActionText(o.peek()),action:this._getAction(o),itemTileTagName:p.e.tagName,ariaLabel:this.getItemTileCardArialabel(this._getActionText(o.peek()),this._getCardTitleForItem(o.peek()),o().name)};a={name:h.e.tagName,params:f}}t.push(a)}return t};t.prototype.customizeItemNameForScreenReader=function(e){return 0===e.indexOf("#")?e.slice(1):e};t.prototype.getItemTileCardArialabel=function(e,t,n){return n?T.format(u.e.ItemTileCardArialabel,e,t,this.customizeItemNameForScreenReader(n)):e};t.prototype._computeVisibleTileCount=function(){var e=this.promotedPhotosSize().width;return Math.min(10,Math.floor(e/268))};t.prototype._isItemTag=function(e){var t=e.tagInfo;return t&&(t.tagType===y.e.singleTag||t.tagType===y.e.allTags)};t.prototype._isItemLocation=function(e){var t=e.tagInfo;return t&&(t.tagType===y.e.singlePlace||t.tagType===y.e.allPlaces)};t.prototype._isOnThisDayItem=function(e){return e&&!e.tagInfo&&e.dateTakenTime};t.prototype._isSharedAlbum=function(e){return e.isAlbum&&e.ownerId.toLowerCase()!==this._urlDataSource.getOwnerId(this._photoItemSet.item.peek().key).toLowerCase()};t.prototype._getAction=function(e){var t=this.peekUnwrapObservable(e);return Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&w.s(t)?new(this.child(this._actionMap.SaveAutoAlbumAction))({item:e}):!Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&t.properties.autoAlbumTag?new(this.managed(this._actionMap.ShareByLinkAction))({item:e}):new(this.child(this._actionMap.DefaultClickAction))({item:e,userInvokedItem:!0,sourceEngagement:"PromotedPhotosTile.AutoAlbum.Click"})};t.prototype._getActionText=function(e){return this._isSharedAlbum(e)?"":Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&w.s(e)?E.e.autoAlbumCardAction:!Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&e.properties.autoAlbumTag?u.e.shareActionTitle:this._isItemTag(e)||this._isItemLocation(e)||this._isOnThisDayItem(e)?u.e.seeAllTitle:""};t.prototype._getCardTitleForItem=function(e){var t=this._isItemTag(e),n=this._isItemLocation(e);return this._isSharedAlbum(e)?u.e.sharedAlbumTitle:Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&w.s(e)?E.e.autoAlbumCardTitle:!Object(b.isFeatureEnabled)(b.EnableEvokeAlignments)&&e.properties.autoAlbumTag?u.e.autoAlbumCardTitle:t?u.e.recentTagsTitle:n?u.e.recentPlacesTitle:this._isOnThisDayItem(e)?u.e.onThisDayTitle:void 0};return t})(a.t);n.d(t,"resourceKey",function(){return L});var C='<div class="od-PromotedPhotos" data-bind="clientRect:{size:promotedPhotosSize,allowHiddenSizeUpdates:true}">\x3c!--ko component:{name:carouselTagName,params:carouselParams}--\x3e\x3c!--/ko--\x3e</div>',k=i.e({tagName:"od-promoted-photos",template:C,viewModel:N,synchronous:!0}),L=Object(s.e)({automationName:"od-promoted-photos",name:"PromotedPhotos",template:C,viewModelType:N});t.default=k}}]);