(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["331"],{"678":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(48),i=n(1014),s=new r.e("allPhotosRootItemSet",{photosRootKeyPart:Object(r.o)(i.e),groupBy:Object(r.s)(),filter:Object(r.s)(),filterType:Object(r.r)({folder:0,tag:1,album:2,place:3,onthisday:4})})},"1004":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(48),i=new r.e("tagsRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"1005":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(48),i=new r.e("placesRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"1014":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(48),i=new r.e("photosRootKey",{driveId:Object(r.s)(),endpoint:Object(r.s)()})},"1048":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(48),i=n(1005),s=new r.e("placeSetKey",{placesRootKeyPart:Object(r.o)(i.e),countryOrRegion:Object(r.s)(),state:Object(r.s)(),locality:Object(r.s)(),city:Object(r.s)()})},"1049":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(48),i=n(1004),s=new r.e("tagKey",{tagsRootKeyPart:Object(r.o)(i.e),id:Object(r.s)()})},"1088":function(e,t,n){"use strict";n.d(t,"t",function(){return i});n.d(t,"e",function(){return s});function r(e){if(!e)return{};try{var t=atob(e.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(t)}catch(e){return{}}}function i(e){return e?r(decodeURIComponent(e).split(".")[1]):{}}function s(e){if(e){var t=e.azp||e.appid;if(t)return t;var n=e.nameid;return n&&"true"!==e.isuser&&n.split("@")[0]||void 0}}},"1121":function(e,t,n){"use strict";var r;(function(e){e[e.download=0]="download";e[e.open=1]="open";e[e.textContent=2]="textContent";e[e.viewInBrowser=3]="viewInBrowser";e[e.bingClickInstrumentation=4]="bingClickInstrumentation";e[e.original=5]="original";e[e.shortcutTarget=6]="shortcutTarget";e[e.video=7]="video";e[e.downloadAsZip=8]="downloadAsZip";e[e.itemUrl=9]="itemUrl";e[e.mediaBaseUrl=10]="mediaBaseUrl";e[e.immersiveReaderUrl=11]="immersiveReaderUrl"})(r||(r={}));t.e=r},"1123":function(e,t,n){"use strict";var r,i=n(137),s={ODB:563,ODC:null,Fallback:!1};(function(e){e.isShortcutItem=function(e){return!(!e||!e.extension)&&t("."!==e.extension[0]?e.extension:e.extension.slice(1))};function t(e){return"url"===e||"website"===e}e.isShortcutFileType=t;e.isShortcutEnabled=function(){return i.e.isFeatureEnabled(s)};(function(e){e[e.UnknownError=0]="UnknownError";e[e.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError";e[e.InvalidCharacterError=2]="InvalidCharacterError"})(e.ShortcutErrors||(e.ShortcutErrors={}))})(r||(r={}));t.e=r},"1469":function(e,t,n){"use strict";n.d(t,"e",function(){return u});n.d(t,"t",function(){return a});var r=["ai","pdf"],i=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],s=["dwg","dxf"];function o(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function u(e,t){return o(i,e)||!!t&&o(s,e)}function a(e){return o(r,e)}},"1538":function(e,t,n){"use strict";var r=n(0),i=n(1121),s=n(781),o=n(1559),u=["htm","html","svg"],a=["eml","msg","md","mdown","markdown"];function f(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}var l=n(1469),c=n(666),h=n(263),p=n(260),d=n(5),v=n(1088),m=n(1123),g=n(63),y=n(147);function b(e,t){void 0===t&&(t=0);if(!e.expiry){var n=(function(e){return Object(v.t)(e)})(e.authToken);e.expiry=n&&(function(e){try{return new Date(parseInt(e+"000",10))}catch(e){}})(n.exp)}return(e.expiry?e.expiry.getTime():0)-Date.now()<t}var w=n(183),E=n(785),S=n(10),x=n(47),T=n(15),N=new(n(3).t)("rootAuthToken"),C=n(409),k=n(25),L=n(121),A=["00000002-0000-0ff1-ce00-000000000000","2d4d3d8e-2be3-4bef-9f87-7875a61c29de","00000007-0000-0ff1-ce00-000000000000","cc15fd57-2c6c-4117-a88c-83b1d56b4bbe","5e3ce6c0-2b1f-4285-8d4b-75ee78787346","1fec8e78-bce4-4aaf-ab1b-5451cc387264","3ab4b783-69c8-4af2-b6b3-7bb6d4bcff21","944f0bd1-117b-4b1c-af26-804ed95e767e","4345a7b9-9a63-4910-a426-35363201d503","d3590ed6-52b3-4102-aeff-aad2292ab01c","27922004-5251-4030-b22d-91ecd9a37ea4"];var O=n(272),M=n(104),_=n(18);n.d(t,"e",function(){return j});var D=(function(){function e(e,t){var n=this,i=t.urlDataSource,s=t.graphDataSource,o=t.itemIdentityProcessor,u=t.location,a=void 0===u?window.location:u,f=t.rootOAuthToken;this._urlDataSource=i;this._itemIdentityProcessor=o;this._origin=a.protocol+"//"+a.host;this._rootToken=f;this._graphDataSource=s;this._itemKeyByUrl=new Map;this._isOneDriveWinApp=Object(L.e)();this._async=new g.e(this);C.e.registerCookieChecker({isApplicable:function(e){return e.indexOf("needs_accessToken=true")>0},check:function(e){return Object(r.__awaiter)(n,void 0,k.n,function(){var n,i,s,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(n=this._itemKeyByUrl.get(e))?(s=this._graphDataSource.refreshAccessToken)?[4,this._graphDataSource.refreshAccessToken({key:n})]:[3,2]:[3,3];case 1:s=r.sent();r.label=2;case 2:o=(i=s)&&i.accessToken;u=e+"&access_token="+o;a=new t.itemTaskObserverType;f={url:u,width:window.innerWidth,height:window.innerHeight};a.update([new E.t(n).succeed({item:{key:n,thumbnail:E.e.replace(f)}})]);this._itemKeyByUrl.delete(e);a.flush();l=new y.e;this._async.setTimeout(function(){l.error(new Error("NeedAccessToken"))},0);return[2,l.getPromise()];case 3:return[2,!1]}})})}})}e.prototype.processItem=function(e,t){var n,i=e.itemFromServer,s=e.topCollaborator,o=e.requestKey,u=e.observer,a=e.driveAccessTokenWrap,f=this._itemIdentityProcessor.processIdentity({itemFromServer:i,requestKey:o,observer:u}).key,l=i.parentReference;if(l){var c=P(i),h=l.driveId,p=l.id,d=l.path;if(d||p){var v=Object(r.__assign)(Object(r.__assign)({},l),{"@odata.id":c&&(p?H(c,h,p):""+c+d)});n=this._itemIdentityProcessor.processIdentity({itemFromServer:v,requestKey:o,observer:u}).key}}var m=this._urlDataSource.getKeyParams(o),g=this._urlDataSource.getQueryType(m),y=this.buildItemFromServerResponse({itemFromServer:i,key:f,topCollaborator:s,parentKey:n,queryType:g,driveAccessTokenWrap:a},t);u.update([new E.t(f).succeed({item:y})]);return{key:f}};e.prototype.buildItemFromServerResponse=function(e,t){var n,c=e.itemFromServer,d=e.topCollaborator,g=e.key,y=e.parentKey,T=e.driveAccessTokenWrap,N=void 0===T?{}:T,C=e.queryType||S.e.Files,k=c.sharepointIds||{},L={key:g,parentKey:y,properties:{listId:k.listId,ID:k.listItemId,uniqueId:k.listItemUniqueId}};L.queryType=C;L.displayType=C;L.sharingRole=(function(e){var t=e.shared;if(t&&t.effectiveRoles&&t.owner){var n=t.effectiveRoles,r=Object(w.e)(n||[],function(){return!0});return r.owner?0:r.write?2:r.read?1:5}return 0})(c);C===S.e.SharedWithMe&&(L.external={});var D=c.id,j=c.name,F=c.folder,I=c.thumbnails,q=c.size,R=c.description,U=c.location,z=(F?{extension:""}:s.n(j)).extension,W=(function(e){var t,n=e.package,r=s.t(e.name||"",!0);t=n&&"oneNote"===n.type?x.e.OneNote:e.folder?x.e.Folder:(function(e){var t=s.t(e.name||"",!0);return Object(O.t)(t||"")})(e)?x.e.File:e.photo||e.video||e.thumbnails?x.e.Media:m.e.isShortcutEnabled()&&m.e.isShortcutFileType(r)?x.e.Shortcut:x.e.File;return t})(c),X=c.parentReference,V=E.e.optional(X&&X.driveId);L.itemId=D;var $=X&&X.driveType;L.graph={itemId:D,driveId:V,driveType:E.e.optional($)};if(!_.e.isActivated("0093b167-93ea-4450-8214-5d6d22e559f3","03/12/2021","Add getDriveAccessToken to item")){var J=N.sessionToken,K=N.sessionTokenV21;J&&b({authToken:J.accessToken,proofToken:J.proofToken})&&(J=void 0);K&&b({authToken:K.accessToken,proofToken:K.proofToken})&&(K=void 0);L.graph=Object.assign({},L.graph,{sessionToken:E.e.optional(J),sessionTokenV21:E.e.optional(K)})}var Q=j;L.name=Q;L.displayName=Q;L.extension=z;L.size=q;L.caption=R||"";L.type=W;L.ownerId=V;L.geoLocation=U;var G=c.searchResult,Y=c["@microsoft.graph.downloadUrl"]||c["@content.downloadUrl"],Z=(function(e){var t=e["@odata.id"];if(t)return t;var n=e.id,r=(e.parentReference||{}).driveId,i=P(e);return i&&H(i,r,n)})(c),ee=((n={})[i.e.download]=Y,n[i.e.itemUrl]=E.e.optional(Z),n);if(G){var te=G.onClickTelemetryUrl;te&&(ee[i.e.bingClickInstrumentation]=te)}if(F){var ne=F.childCount;L.folder={childCount:ne};if(I&&I.length>0){L.folder.covers=[];for(var re=0,ie=I;re<ie.length;re++){var se=ie[re];L.folder.covers.push(se.large)}}L.childCount=ne}var oe=c.photo,ue=c.image;if(ue){var ae=ue.width,fe=ue.height;L.photo=Object(r.__assign)(Object(r.__assign)({},oe?{cameraMake:E.e.optional(oe.cameraMake),cameraModel:E.e.optional(oe.cameraModel),exposureDenominator:E.e.optional(oe.exposureDenominator),exposureNumerator:E.e.optional(oe.exposureNumerator),focalLength:E.e.optional(oe.focalLength),iso:E.e.optional(oe.iso)}:{}),{width:ae,height:fe,originalUrl:Y})}var le=(c.file||{}).mimeType,ce=void 0===le?"":le,he=(function(e,t){var n=e.thumbnails,r=n&&n[0],i=r&&(r.large||r.medium||r.small),s=i&&i.url;return s&&s.replace(/[&?](width|height|cropmode)=[^&]*/g,"").replace("https://media.cloudapp.net",t?"https://centralus1-mediad.svc.ms":"https://northcentralus1-medias.svc.ms")})(c,t&&"edog"===t.env),pe=he&&he.indexOf("/transform/thumbnail?")>=0&&he,de=this._rootToken,ve=(function(e){return e&&("."===e[0]?e.slice(1):e).toLowerCase()})(z),me="mp4"===ve||0===ce.lastIndexOf("video/mp4",0),ge=c.video;if(ge){ae=ge.width,fe=ge.height;var ye=ge.bitrate,be=ge.duration;L.video={fourCC:ge.fourCC||(me?"H264":void 0),width:ae,height:fe,bitrate:ye,duration:be}}var we=c.audio,Ee=c.lastModifiedBy,Se=(void 0===Ee?{}:Ee).user,xe=void 0===Se?{}:Se,Te=xe.email,Ne=void 0===Te?void 0:Te,Ce=xe.displayName,ke=void 0===Ce?void 0:Ce,Le=c.createdBy,Ae=(void 0===Le?{}:Le).user,Oe=(void 0===Ae?{}:Ae).displayName,Me=void 0===Oe?void 0:Oe,_e=c.lastModifiedDateTime,De=c.createdDateTime,Pe=c.shared,He=void 0===Pe?{}:Pe,Be=He.sharedBy,je=(void 0===Be?{}:Be).user,Fe=void 0===je?{}:je,Ie=Fe.email,qe=void 0===Ie?void 0:Ie,Re=Fe.displayName,Ue=void 0===Re?void 0:Re,ze=He.sharedDateTime,We=void 0===ze?void 0:ze;L.creatorName=Me;L.editorName=ke;var Xe=B(_e);L.dateModifiedTime=Xe.date;L.dateModified=Xe.dateString;Xe=B(De);L.dateCreatedTime=Xe.date;L.dateCreated=Xe.dateString;Xe=B(We);L.dateSharedTime=Xe.date;L.dateShared=Xe.dateString;L.properties.sharedByUser={title:Ue,isTopCollaborator:qe&&d&&d.indexOf(qe)>-1,sip:qe};L.properties.editorName=[{title:ke,sip:Ne}];var Ve=".ts"===z&&q<1<<19&&!ge,$e=h.n({type:W,extension:z,textEditorMimeType:Ve?"text/typescript":void 0});L.iconName=$e;var Je=we||"audio"===$e||0===ce.lastIndexOf("audio/",0),Ke=ge||"video"===$e||!Ve&&0===ce.lastIndexOf("video/",0);Je&&(L.audio={});if(Ke&&!ge){var Qe={fourCC:me?"H264":void 0,width:-1,height:-1,bitrate:void 0,duration:void 0};L.video=Qe}c.malware&&(L.lifeCycleStatus={isMalwareDetected:!0});var Ge=null,Ye=c["-embed-formats"];if(Ye&&Ye.dash)Ge=new M.e(Ye.dash.url);else if(ge||Je||Ke)if(pe){Ge=new M.e(pe.replace("/thumbnail?","/videomanifest?"));var Ze=ge&&ge.manifestMetadata;Ge.setQueryParameter("manifestMetadata",Ze,!0)}else"personal"===$&&(Ge=Y?new M.e(Y):null);if(Ge){Ge.setQueryParameter("action","Access");ee[i.e.video]=Ge.toString()}var et=W===x.e.OneNote?"one":$e,tt=et&&p.t[et];L.appMap=E.e.optional(tt);L.urls=ee;var nt,rt=c.cTag,it=rt&&encodeURIComponent(rt);if(he){var st=he+(he.indexOf("?")>=0?"&":"?")+"encodeFailures=1";ae=ue?ue.width:ge?ge.width:void 0,fe=ue?ue.height:ge?ge.height:void 0;L.thumbnail={url:st,width:ae,height:fe,getAligned:function(e){var t=e.width,n=void 0===t?window.innerWidth:t,r=e.height,i=void 0===r?window.innerHeight:r;return{width:n|=0,height:i|=0,url:st+"&width="+n+"&height="+i}}}}pe&&(nt={officeBundleGenerateUrl:pe.replace("/thumbnail?","/OfficeBundle?")+"&minVersion={{minVersion}}&cTag="+it,officeBundleGetFragmentUrl:pe.replace("/thumbnail?","/OfficeBundleFragment?")+"&fragment={0}"});var ot,ut,at,ft=(function(e){var t=e.officeBundle;if(t)return t;var n=e.listItem,r=n&&n.fields,i=r&&r.MediaServiceFastMetadata;if(i)try{return JSON.parse(i).officeBundle}catch(e){}})(c),lt="ms-excel"===tt,ct="ms-powerpoint"===tt,ht="ms-visio"===tt,pt="ms-word"===tt,dt=c.webUrl;if("pdf"!==$e&&pt||lt||ct||ht){var vt=!(!t||!t.wopiToken)||(de?!(at=Object(v.e)(Object(v.t)(de)))||A.indexOf(at.toLowerCase())>=0:dt&&0===dt.lastIndexOf(this._origin,0));(ct&&Y||pt&&vt)&&(L.officeBundle=Object(r.__assign)(Object(r.__assign)(Object(r.__assign)({},ft?(ut=(ot=ft).generationTime,{bundleCTag:ot.ctag,bundleVersion:ot.version,hasBundleGenerationFailed:ot.fatalError||!1,generationTime:ut?new Date(ut):void 0,bundleErrorInfo:ot.errorInfo||""}):{}),nt||{}),{cTag:rt}));"personal"!==$&&(L.wopiFrameUrl=dt)}"7z"!==ve&&"rar"!==ve&&"zip"!==ve||(L.zip=pe?{downloadZipContentsUrl:"",zipMetaDataUrl:pe.replace("/thumbnail?","/zipmetadata?")}:E.e.optional((function(e,t,n,r,i){var s="personal"===(e.parentReference||{}).driveType?"odc":"spo";return n&&r?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider="+s+"&inputFormat="+t+"&docid="+encodeURIComponent(n)+"&access_token="+r}:n&&i?{downloadZipContentsUrl:"",zipMetaDataUrl:"https://southcentralus1-mediap.svc.ms/transform/zipmetadata?provider="+s+"&inputFormat="+t+"&docid="+encodeURIComponent(n)}:void 0})(c,ve,Z,de,this._isOneDriveWinApp)));f(u,z)?L.htmlConversion={}:(function(e){return f(a,e)})(z)&&(L.htmlConversion=pe?{url:pe.replace("/thumbnail?","/html?")+"&inlineImages=true"}:{});o.t(ve)?L.model3d={canRenderNative:!0}:o.e(ve)&&(L.model3d=pe?{canConvert:!0,conversionUrl:pe.replace("/thumbnail?","/glb?")}:{canConvert:!0});var mt=c.dataLossPrevention;mt&&(L.itemStatus=E.e.optional((function(e,t,n){if(n.blockDownload){if(e===x.e.Media||t)return 4;if(e!==x.e.Folder)return 3}if(n.viewOnly)return 4})(W,tt,mt)));l.e(ve)?L.pdfConversion=pe?{url:pe.replace("/thumbnail?","/pdf?")}:{}:l.t(ve)&&pe&&mt&&(mt.blockDownload||mt.viewOnly)&&(L.pdfConversion={url:pe.replace("/thumbnail?","/passthrough?")});L.openUrl=dt;L.vault=c.vault;L.itemFromServer=c;L.isPlaceholder=!1;if(!L.thumbnail&&this._isOneDriveWinApp&&("jpg"===ve||"png"===ve||"jpeg"===ve)){var gt=this._graphDataSource.getItemUrl({key:g,graph:{itemId:D,driveId:X.driveId,driveType:X&&X.driveType}},{useDirectEndpoint:!0})+"/thumbnails/0/c"+(0|window.innerWidth)+"x"+(0|window.innerHeight)+"/content?needs_accessToken=true";L.thumbnail={url:gt,width:window.innerWidth,height:window.innerHeight};this._itemKeyByUrl.set(gt,g)}return L};e.dependencies={urlDataSource:T.we,itemIdentityProcessor:T.Ce,rootOAuthToken:N.optional,graphDataSource:T.w,itemTaskObserverType:E.r};return e})();function P(e){var t=e["@odata.context"];if(t)return t.split("/$")[0];var n=e.sharepointIds;if(n){var r=n.siteUrl;if(r)return r+"/_api/v2.1"}}function H(e,t,n){return e+"/drive"+(t?"s/"+t:"")+"/items/"+n}function B(e){var t=e&&e.lastIndexOf("0001-01-01T00:00:00",0)<0?new Date(e):void 0;return{date:t,dateString:t?c.s(t):""}}var j=Object(d.s)("ItemResultProcessor",D)},"1559":function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"t",function(){return u});var r=["glb","gltf"],i=["cool","fbx","obj","ply","stl","3mf"];function s(e,t){return!!t&&e.indexOf(("."===t[0]?t.slice(1):t).toLowerCase())>=0}function o(e){return s(i,e)}function u(e){return s(r,e)}},"1613":function(e,t,n){"use strict";n.d(t,"e",function(){return r});n.d(t,"t",function(){return i});n.d(t,"s",function(){return s});n.d(t,"n",function(){return o});n.d(t,"r",function(){return u});n.d(t,"i",function(){return a});n.d(t,"o",function(){return f});n.d(t,"u",function(){return l});n.d(t,"a",function(){return c});n.d(t,"f",function(){return h});n.d(t,"l",function(){return p});n.d(t,"c",function(){return d});n.d(t,"h",function(){return v});n.d(t,"p",function(){return m});n.d(t,"d",function(){return g});n.d(t,"v",function(){return y});n.d(t,"m",function(){return b});n.d(t,"g",function(){return w});n.d(t,"y",function(){return E});n.d(t,"b",function(){return S});n.d(t,"w",function(){return x});n.d(t,"E",function(){return T});n.d(t,"S",function(){return N});n.d(t,"x",function(){return C});n.d(t,"N",function(){return k});n.d(t,"C",function(){return L});n.d(t,"T",function(){return A});n.d(t,"k",function(){return O});n.d(t,"L",function(){return M});n.d(t,"A",function(){return _});n.d(t,"O",function(){return D});n.d(t,"M",function(){return P});n.d(t,"_",function(){return H});n.d(t,"D",function(){return B});n.d(t,"H",function(){return j});n.d(t,"P",function(){return F});n.d(t,"B",function(){return I});n.d(t,"j",function(){return q});n.d(t,"F",function(){return R});n.d(t,"I",function(){return U});n.d(t,"q",function(){return z});n.d(t,"R",function(){return W});n.d(t,"U",function(){return X});n.d(t,"z",function(){return V});n.d(t,"W",function(){return $});n.d(t,"X",function(){return J});n.d(t,"V",function(){return K});n.d(t,"$",function(){return Q});var r="ab",i="acp",s="aol",o="at",u="ata",a="ats",f="ce",l="cm",c="cp",h="cxls",p="cxlsf",d="cf",v="cmp",m="con",g="cppt",y="cdoc",b="defc",w="de",E="dl",S="ef",x="em",T="erb",N="mc",C="mv",k="oo",L="openInTextEditor",A="openInImageEditor",O="openPdfInBrowser",M="pl",_="ar",D="rcp",P="rfa",H="rmru",B="rmp",j="rn",F="rol",I="ra",q="orr",R="rst",U="rai",z="rot",W="sh",X="sf",V="up",$="vb",J="vo",K="pf",Q="vv"},"3226":function(e,t,n){"use strict";n.r(t);var r,i=n(0),s=n(638),o=n(3),u=n(1425),a=n(632),f=n(997),l=n(7),c=n(1613),h=n(5),p=n(272),d=n(1609),v=n(1204),m=n(736),g=n(31);(function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION";e[e.HAS_PERMISSION=1]="HAS_PERMISSION"})(r||(r={}));var y,b={XLSX:1,XLSM:1,XLSB:1,XLS:1,ODS:1,ONE:2,PPTX:3,PPSX:3,PPT:3,PPS:3,POT:3,PPTM:3,POTM:3,POTX:3,PPSM:3,ODP:3,PPA:3,PPAM:3,DOCX:4,DOCM:4,DOC:4,DOTX:4,DOT:4,DOTM:4,ODT:4,VSDX:5,VSDM:5,VSSX:5,VSSM:5,VSTX:5,VSTM:5,VDW:5,VSD:5,VSS:5,VST:5,VSW:5,VDX:5,VSX:5,VTX:5,MPP:6,MPT:6,PUB:7},w=["MP3","M4A","WMA"];(function(e){e[e.NO_PERMISSION=0]="NO_PERMISSION";e[e.CAN_MULTI_SHARE_COMMAND_STATE=1]="CAN_MULTI_SHARE_COMMAND_STATE";e[e.CAN_SHARE_COMMAND_STATE=2]="CAN_SHARE_COMMAND_STATE"})(y||(y={}));var E=["PSD","PSB"],S=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._userInfoProvider=n.userInfoProvider;return r}t.prototype.getCommandStates=function(e,t){var n,i=t.itemKey,s=e.demandItemFacet(u.e,i),o=e.demandItemFacet(a.h,i),f=Object(d.o)(e,{itemKey:i,oneOfRequiredRoles:["write","owner"]}),l=!!e.demandItemFacet(a.d,i),h=(o.extension||"").toUpperCase(),g=e.demandItemFacet(v.e,i),S=!!b[h]&&b[h]<=4,x={itemKey:i,driveItemResponse:s,fileName:o.name,fileExtension:"."===h[0]?h.substring(1):h,canEdit:f,canDelete:e.demandItemFacet(d.t,i),canRename:e.demandItemFacet(d.i,i),canMove:e.demandItemFacet(d.r,i),canUpload:e.demandItemFacet(d.s,i),canDownload:e.demandItemFacet(d.n,i),isOneNote:!!e.demandItemFacet(m.i,i),isFolder:l,isOwner:Object(d.u)(e,i),isRoot:!!s.root,isXBoxMusicSupportedExtension:w.indexOf(h)>-1,hasItems:l&&(s.folder||s.remoteItem.folder).childCount>0,isPhoto:!!s.photo,isVideo:!!s.video,isAuthenticated:this._userInfoProvider.isAuthenticated(),isMountPoint:!!s.remoteItem,isBundle:!1,isWacViewEnabled:S,isVaultLocked:!!(g&&g.root&&g.isLocked),isSharerFolder:!1,isRestricted:!1,isPanorama:!1,isMounted:!(!s||!s.remoteItem),canCreateOfficeDocument:!0,ownerUsesODF:!1,isBadgerUser:!1,isAdmin:!1,isUserRoleFromViewToken:!1};return(n={})[c.e]=r.NO_PERMISSION,n[c.t]=r.NO_PERMISSION,n[c.s]=r.NO_PERMISSION,n[c.n]=r.NO_PERMISSION,n[c.r]=(function(e){var t=e.canEdit,n=e.isAuthenticated,i=e.isPhoto,s=e.isVideo,o=e.isOwner;return n&&(i||s)&&t&&o?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.i]=r.NO_PERMISSION,n[c.o]=r.NO_PERMISSION,n[c.u]=r.NO_PERMISSION,n[c.a]=(function(e){var t=e.canMove,n=e.isAuthenticated,i=e.isOwner,s=e.isMounted,o=e.isMountPoint,u=e.isRoot,a=e.isSharerFolder,f=e.isBundle;return!n||!t||a||f||u||!i&&!s||o?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.f]=(function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2})(x),n[c.l]=(function(e){var t=e.canEdit,n=e.canCreateOfficeDocument,i=e.ownerUsesODF;return t&&n&&!i?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.c]=r.NO_PERMISSION,n[c.h]=(function(e){var t=e.canEdit,n=e.isFolder,i=e.isBundle,s=e.isMounted,o=e.isMountPoint,u=e.isOwner;return!t||!n||i||s||o||u?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.p]=x.canCreateOfficeDocument?r.HAS_PERMISSION:r.NO_PERMISSION,n[c.d]=(function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2})(x),n[c.v]=(function(e){var t=e.canCreateOfficeDocument,n=e.canEdit;if(!t)return 0;return n?1:2})(x),n[c.m]=(function(e){var t=e.fileExtension,n=e.isRestricted,r=e.isOwner,i=e.isPhoto,s=e.isVideo,o=e.isFolder;if(n&&!r&&!i&&!s)return 50;if(o)return 1;var u=Object(p.t)(t),a=-1!==E.indexOf(t);if(i||s||u)return 1;if(a)return 1;return 4})(x),n[c.g]=(function(e){var t=e.canDelete,n=e.isOwner,i=e.isRestricted,s=e.isMountPoint,o=e.isMounted;return i&&!n||!t||s||!n&&!o?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.y]=(function(e){var t=e.canDownload,n=e.isOneNote,i=e.isFolder,s=e.isOwner,o=e.isRoot,u=e.isSharerFolder,a=e.isRestricted,f=e.hasItems,l=!o&&f;return a&&!s||!t||n||u||i&&!l?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.b]=r.NO_PERMISSION,n[c.w]=(function(e){var t=e.isAuthenticated,n=e.isRoot,i=e.isBundle;return!t||n||i?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.E]=r.NO_PERMISSION,n[c.S]=(function(e){var t=e.canEdit,n=e.isAuthenticated,i=e.isRoot;return n&&t&&!i?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.x]=(function(e){var t=e.canMove,n=e.isAuthenticated,i=e.isOwner,s=e.isMounted,o=e.isMountPoint,u=e.isRoot;return n&&t&&!u&&(i||s)&&!o?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.T]=(function(e){var t=e.canEdit,n=e.driveItemResponse,i=e.isAuthenticated,s=e.isPhoto,o=!!n.file&&n.file.mimeType&&"image/jpeg"===n.file.mimeType.toLowerCase();return i&&s&&t&&o?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.N]=(function(e){var t=e.canEdit,n=e.isBadgerUser,i=e.isAdmin,s=e.isUserRoleFromViewToken,o=e.fileExtension;if(t&&!n&&!i&&!s){var u=b[o];if(u)return u}return r.NO_PERMISSION})(x),n[c.L]=(function(e){var t=e.isAuthenticated,n=e.isOwner,i=e.isXBoxMusicSupportedExtension;return t&&n&&i?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.A]=r.NO_PERMISSION,n[c.O]=r.NO_PERMISSION,n[c.M]=r.NO_PERMISSION,n[c._]=r.NO_PERMISSION,n[c.D]=(function(e){var t=e.canEdit,n=e.isMounted,i=e.isMountPoint;return t&&n&&i?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.H]=(function(e){var t=e.canRename,n=e.isAuthenticated,i=e.isOwner,s=e.isMounted,o=e.isRoot;return n&&t&&!o&&(i||s)?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.P]=r.NO_PERMISSION,n[c.B]=(function(e){var t=e.isAuthenticated,n=e.isRestricted,i=e.isOwner,s=e.isAdmin;return!t||n||i||s?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.j]=r.NO_PERMISSION,n[c.F]=r.NO_PERMISSION,n[c.I]=r.NO_PERMISSION,n[c.q]=(function(e){var t=e.canEdit,n=e.driveItemResponse,i=e.isAuthenticated,s=e.isPhoto,o=!!n.file&&n.file.mimeType&&"image/jpeg"===n.file.mimeType.toLowerCase();return i&&s&&t&&o?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.R]=(function(e){var t=e.canEdit,n=e.isAuthenticated,r=e.isRestricted,i=e.isOwner,s=e.isBundle,o=e.isRoot,u=e.isVaultLocked;if(!n||r&&!i||!t||o||u)return y.NO_PERMISSION;return s?y.CAN_SHARE_COMMAND_STATE:y.CAN_MULTI_SHARE_COMMAND_STATE})(x),n[c.U]=r.NO_PERMISSION,n[c.z]=(function(e){var t=e.canUpload,n=e.isAuthenticated,i=e.isBundle;return n&&t&&!i?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.W]=(function(e){return e.isWacViewEnabled?r.HAS_PERMISSION:r.NO_PERMISSION})(x),n[c.X]=(function(e){var t=e.isRestricted,n=e.isOwner,i=e.isPanorama;return t&&!n||i?r.NO_PERMISSION:r.HAS_PERMISSION})(x),n[c.V]=r.NO_PERMISSION,n[c.$]=r.NO_PERMISSION,n};t.dependencies=Object(i.__assign)(Object(i.__assign)({},l.n.dependencies),{userInfoProvider:g.L});return t})(l.n);var x=Object(h.s)("ItemCacheToKOStoreCommands",S),T=n(1538),N=n(337),C=n(53),k=n(141),L=n(1049),A=n(1048),O=n(678),M=n(10);n.d(t,"resourceKey",function(){return _});var _=new o.t({name:"OneDriveItemControlHandler",factory:{dependencies:{itemCacheToKOStoreCommands:x,itemResultProcessor:T.e},create:function(e){var t=e.itemCacheToKOStoreCommands,n=e.itemResultProcessor,r=function(e,r){var s=r.itemKey,o=r.key,l=r.item;if(l){var c=void 0,h=l.queryType,p=e.demandItemFacet(O.e,s),d=e.demandItemFacet(L.e,s),v=e.demandItemFacet(A.e,s);d&&(c=k.e.Tag);v&&(c=k.e.Location);p&&(h=M.e.AllMyPhotos);Object(N.default)(l,{virtualItemType:c,queryType:h})}var m=e.demandItemFacet(u.e,s);if(!l||!m)return{item:l};if(m.remoteItem){var g=m.remoteItem,y=Object(i.__rest)(m,["remoteItem"]);m=Object(C.p)(g,y)}var b=(function(e){var t=e.itemCache,n=e.itemKey,r=t.demandItemFacet(a.A,n);if(!r)return;var i=t.demandItemFacet(f.e,r.itemKey);if(i)return i.key})({itemCache:e,itemKey:s}),w=n.buildItemFromServerResponse({itemFromServer:m,key:o,parentKey:b}),E=(function(e){var t=e.itemCache,n=e.itemKey,r=e.itemCacheToKOStoreCommands.getCommandStates(t,{itemKey:n}),i={};for(var s in r)0!==r[s]&&(i[s]=""+r[s]);return i})({itemCache:e,itemKey:s,itemCacheToKOStoreCommands:t});return{item:Object(C.p)(Object(N.default)(l,w),{properties:{commandsSupported:new C.h(E)}})}};return{instance:Object(s.t)()(function(){return function(e){return r}})}}}})}}]);