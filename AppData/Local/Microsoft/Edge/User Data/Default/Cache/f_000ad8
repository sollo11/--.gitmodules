(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"1Z3a":function(e,t,n){},"2uLe":function(e,t,n){"use strict";var a=n("mj2O"),c=n.n(a),r=n("7SM1"),i=n("8Epr"),o=n("Hvhg"),s=n("ERkP"),u=n("uDfI"),l=n("vTYT"),d=n("7oto");t.a=function useSetPreviewHeight(){var e=Object(s.useRef)(null),t=Object(u.c)(function(e){return!!e.conversations.activeConversation}),n=Object(u.c)(o.b).showBranding,a=void 0!==n&&n,f=Object(i.a)().noPolicy,b=Object(u.c)(function(e){return e.session.gdpr}),m=b.hasConsent,O=b.declinedConsent,j=Object(s.useCallback)(function(){var e=0,t=!a&&f;return O&&(e+=40),t&&(e+=18),m||(e+=t?14:7),e},[O,m,f,a]),v=Object(s.useCallback)(function(){return e.current?e.current.clientHeight:200},[e]),g=Object(s.useCallback)(function(){var e=Object(r.a)(c.a.mark(function _callee(e){var n,a,r,i,o=arguments;return c.a.wrap(function _callee$(c){for(;;)switch(c.prev=c.next){case 0:if(n=o.length>1&&void 0!==o[1]&&o[1],!t||!m){c.next=3;break}return c.abrupt("return");case 3:a=j(),r=v(),i=e?"".concat(r+155-a,"px"):"0px",Object(d.a)({topic:"set-frame-height",message:{height:i,name:l.b.CHAT,transition:!0,transitionHeight:n}});case 7:case"end":return c.stop()}},_callee)}));return function(t){return e.apply(this,arguments)}}(),[t,m,j,v]),p=Object(s.useCallback)(Object(r.a)(c.a.mark(function _callee2(){var e;return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:e=v(),Object(d.a)({topic:"set-frame-height",message:{height:"".concat(e+80,"px"),name:l.b.SLIDER,transition:!0,transitionHeight:!1}});case 2:case"end":return t.stop()}},_callee2)})),[v]),h=Object(s.useCallback)(Object(r.a)(c.a.mark(function _callee3(){var e;return c.a.wrap(function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:e=v(),Object(d.a)({topic:"set-frame-height",message:{height:"".concat(e+35,"px"),name:l.b.EMAIL_CAPTURE,transition:!0,transitionHeight:!1}});case 2:case"end":return t.stop()}},_callee3)})),[v]);return{previewRef:e,setChatHeight:g,setSliderHeight:p,setEmailCaptureHeight:h}}},"9Hpm":function(e,t,n){},G5CQ:function(e,t,n){},Ldxc:function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return f});var a=n("mj2O"),c=n.n(a),r=n("7SM1"),i=n("SsZN"),o=n("vjCh"),s=n("qixE"),u=n("6lNa"),l=n("0lfv"),d=function(){var e=Object(r.a)(c.a.mark(function _callee(e,t){return c.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:try{Object(o.j)(t.id,t.playbookId),Object(s.a)(u.b.SUBMITTED),Object(s.a)(u.b.LEAD_CAPTURED,{email:e})}catch(a){Object(l.w)(["Failed to capture lead for email announcement playbook",a])}case 1:case"end":return n.stop()}},_callee)}));return function captureLeadForEmailAnnouncementPlaybook(t,n){return e.apply(this,arguments)}}(),f=function(){var e=Object(r.a)(c.a.mark(function _callee2(e){return c.a.wrap(function _callee2$(t){for(;;)switch(t.prev=t.next){case 0:try{Object(o.j)(e.id,e.playbookId),Object(i.c)(u.b.CLICKED,e.id),Object(s.a)(u.b.CLICKED)}catch(n){Object(l.w)(["Failed to capture CTA click for takeover playbook",n])}case 1:case"end":return t.stop()}},_callee2)}));return function captureCTAClickForAnnouncementPlaybook(t){return e.apply(this,arguments)}}()},MWt3:function(e,t,n){},SrLZ:function(e,t,n){"use strict";n.r(t);var a,c=n("mj2O"),r=n.n(c),i=n("7SM1"),o=n("s8DI"),s=n("OE2q"),u=n("O94r"),l=n.n(u),d=n("Rqwx"),f=n("fTFZ"),b=n("vkRn"),m=n("CwrG"),O=n("HXmn"),j=n("8eKL"),v=n("slYP"),g=n("BY8A"),p=n("+/Je"),h=n("fw6E"),E=n("1b8i"),w=n("gRD2"),C=n("fpJs"),y=n("6wvX"),k=n("Sn8X"),T=n("fJrp"),_=n("8Epr"),N=n("lE29"),S=n("swFs"),L=n("+Kbs"),I=n("nQD+"),A=n("jm9a"),x=n("efbE"),H=function recordConsent(e,t){return x.e.post("/end_users/".concat(e,"/consent"),{consentId:"has_consent",message:t})},R=n("Ztgx"),M=n("NJA7"),D=n("TDUE"),F=n("ERkP"),P=n.n(F),B=n("uDfI"),U=n("gG69"),G=function useTrackImpressionOnce(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U.c.LIVE_CHAT,t=Object(F.useState)(!1),n=Object(o.a)(t,2),a=n[0],c=n[1],s=Object(B.c)(function(e){return e.view}).chatOpen;Object(F.useEffect)(function(){!function(){var t=Object(i.a)(r.a.mark(function _callee(){var t;return r.a.wrap(function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if(!s||a){n.next=5;break}return n.next=3,Object(D.d)(e);case 3:t=n.sent,c(t);case 5:case"end":return n.stop()}},_callee)}));return function trackImpression(){return t.apply(this,arguments)}}()()},[a,s,e])},V=n("qixE"),Z=n("SFoa"),K=n("qwiD"),J=n("LVcX"),Y=n("SWQ0"),$=n("0lfv"),W=n("Nlet"),X=n("wNJw"),q=(n("sZBt"),function DeclinedConsent(e){var t=e.consentMessage;return P.a.createElement("div",{className:"drift-widget-greeting-content"},P.a.createElement("p",{className:"drift-widget-gdpr-consent--copy"},t))}),Q=function InquireConsent(e){var t=e.message,n=e.onConsentButtonClicked,a=e.yesConsentLabel,c=e.noConsentLabel;return P.a.createElement(P.a.Fragment,null,P.a.createElement("div",{className:"drift-widget-greeting-content"},P.a.createElement("p",{className:"drift-widget-gdpr-consent--copy"},t)),P.a.createElement("div",{className:"drift-gdpr-actions"},P.a.createElement(M.a,{className:"drift-gdpr-action--allow-consent",onClick:n(!0)},P.a.createElement("span",{className:"drift-gdpr-action--text"},a)),P.a.createElement(M.a,{className:"drift-gdpr-action--deny-consent",onClick:n(!1)},P.a.createElement("span",{className:"drift-gdpr-action--text"},c))))},z=function GDPR(e){var t=e.previewRef,n=e.resetChatHeight,a=Object(B.b)(),c=Object(B.c)(function(e){return e.embed.configuration.dataProtection}),o=c.policies,s=c.default,u=Object(B.c)(function(e){return e.embed.configuration}).team,l=void 0===u?[]:u,d=Object(B.c)(function(e){return e.session}),f=d.endUser,b=d.gdpr,m=(void 0===b?{}:b).declinedConsent;Object(F.useLayoutEffect)(function(){m&&n()},[m,n]),Object(F.useEffect)(function(){Object(X.a)(Y.b.GDPR_REQUESTED)},[]);var O=Object(W.c)().locale,j=Object(Z.h)()?Object(Z.e)():O,v=Object(F.useMemo)(function(){return l.find(function(e){return e.bot})||{}},[l]),g=Object(F.useMemo)(function(){var e=Object(J.a)(null,[j],o);if(e)return e;var t=Object(J.a)(null,["".concat(s)],o);return t||(Object($.n)({data:["No locale matched and unable to find default policy: ".concat(t)]}),null)},[j,o,s]);if(G(U.c.GDPR),!g)return null;return P.a.createElement("div",{className:"drift-widget-gdpr-consent drift-widget-greeting"},P.a.createElement(R.a,{messageText:"Data Privacy Bot",senderIds:[v.id]}),P.a.createElement("div",{ref:t,className:"drift-widget-gdpr-body"},!m&&P.a.createElement(Q,{message:g.message,onConsentButtonClicked:function doRecordConsent(e){return Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,Object(X.a)(Y.b.GDPR_CLICKED,{accepted:e,endUser:f.id}),!e){t.next=5;break}return t.next=5,H(f.id,g.message);case 5:a(Object(K.p)({hasConsent:e})),e||(a(Object(K.c)(!0)),Object(V.b)()),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn(t.t0);case 12:case"end":return t.stop()}},_callee,null,[[0,9]])}))},yesConsentLabel:g.giveConsentLabel,noConsentLabel:g.declineConsentLabel}),m&&P.a.createElement(q,{consentMessage:g.consentDeclinedMessage})))},ee=n("noex"),te=n("mZ4K"),ne=n("SsZN"),ae=n("g6eD"),ce=n("6lNa"),re=n("7oto"),ie=n("nedb"),oe=function createCampaignDismissedEvent(e,t){return Object(ne.c)(ce.b.CLICKED,t.id),"number"!==typeof e?null:Object(V.a)(ce.b.DISMISSED,{conversationId:e})},se=function useCloseChat(){var e=Object(ie.a)(),t=Object(B.c)(function(e){return e.session.endUser}),n=Object(B.b)(),a=Object(F.useState)(!1),c=Object(o.a)(a,2),r=c[0],i=c[1],s=Object(B.c)(function(e){return e.view.isChatTakeover}),u=Object(B.c)(function(e){return Object(J.a)(null,["view","closeChatRedirectUrl"],e)}),l=Object(B.c)(function(e){return e.conversations.activeConversation}),d=Object(B.c)(function(e){return Object(J.a)(!1,["conversations","conversationStatus",l,"endUserResponded"],e)});Object(F.useEffect)(function(){r&&(n(Object(ae.c)({chatOpen:!1,isChatTakeover:!1})),i(!1))},[r,n]);var f=Object(F.useCallback)(function(){var n;if(Object(re.a)({topic:"remove-chat-takeover",message:{classNamesToRemove:["drift-frame-chat__takeover"]}}),!d){var a=[oe(l,e)];if(e&&e.id){var c={campaignId:e.id,endUserId:t.id};e.attributes.playbookId&&(c.playbookId=e.attributes.playbookId),a.push(Object(re.a)({topic:"send-usage-metric-event",message:{name:"Campaign Dismissed",attributes:c,publishImmediately:!0}}))}n=Promise.all(a)}if(u){var r=function redirect(){return Object(re.a)({topic:"redirect-to-url",message:{url:u}})};n?n.then(r):r()}},[e,l,u,t.id,d]);return Object(F.useCallback)(function closeChat(){i(!0),s&&f()},[s,f])},ue=n("58kB"),le=(n("1Z3a"),function ChatTakeover(){var e=Object(B.c)(function(e){return e.conversations.activeConversation}),t=Object(te.a)(),n=Object(ue.a)(t).recipient,a=Object(N.a)().conversationHeaderTextStyles,c=se();return P.a.createElement("div",{className:"drift-widget-active-conversation-header"},e&&P.a.createElement(P.a.Fragment,null,P.a.createElement(ee.a,{size:"SMALL",id:n.id}),P.a.createElement("h1",{className:"drift-widget-recipient-name",style:a},n.name)),P.a.createElement(I.a,{onClick:c,className:"drift-widget-chat-takeover-close-button"},P.a.createElement(L.j,{width:16,height:16})))}),de=n("nJ3u"),fe=n("GtSE"),be=function Time(e){var t=e.height,n=void 0===t?24:t,a=e.width,c=void 0===a?24:a,r=e.fill,i=void 0===r?"#FFF":r;return P.a.createElement("svg",{className:"drift-default-icon drift-default-icon--Time",width:c,height:n,viewBox:"0 0 20 20"},P.a.createElement("path",{d:"M3.55,10.3l.79-.78a.77.77,0,0,1,1.09,1.09L3.3,12.74a.79.79,0,0,1-1.11,0l-2-2.13A.77.77,0,1,1,1.33,9.54l.69.73V10a9,9,0,1,1,3.07,6.77.77.77,0,1,1,1-1.16A7.45,7.45,0,1,0,3.56,10C3.56,10.08,3.56,10.18,3.55,10.3Zm7.72-4.93v4.87h3.34a.77.77,0,0,1,0,1.54H10.5A.76.76,0,0,1,9.73,11V5.37a.77.77,0,0,1,1.54,0Z",fill:i}))},me=n("z24s"),Oe=n("Tr4L"),je=(n("9Hpm"),function ConversationHeader(){var e=Object(F.useRef)(null),t=Object(me.a)(e),n=Object(Oe.a)().t,a=Object(te.a)(),c=Object(ue.a)(a).recipient,r=Object(B.c)(function(e){return e.conversations.conversations}),i=Object(N.a)(),o=i.backgroundStyles,s=i.conversationHeaderTextStyles,u=i.widgetSecondaryColor,d=Object(y.a)(),f=Object(h.a)(),b=f.conversationHistoryEnabled,m=f.conversationHistoryOpen,O=f.onToggleConversationHistory,j=b&&!m&&Object.keys(r).length>1,v=Object(F.useRef)(),g=Object(me.a)(v);return Object(F.useEffect)(function(){v.current&&v.current.focus()},[m]),P.a.createElement("div",{className:"drift-widget-active-conversation-header"},P.a.createElement(ee.a,{size:"SMALL",id:c.id}),P.a.createElement("h1",{"aria-hidden":m,className:"drift-widget-recipient-name",style:s},c.name),P.a.createElement("div",{className:l()("drift-widget-conversation-history-header",{"drift-widget-conversation-history-header--open":m}),style:o,"aria-hidden":!m},P.a.createElement("style",null,"\n            .drift-widget-history-back-button.keyboard-focused svg {\n              ".concat(Object(de.d)(o.background.toString().replace("#",""),u.replace("#","")),"\n            }\n          ")),P.a.createElement(I.a,{ref:v,className:l()("drift-widget-history-back-button",{"keyboard-focused":g}),onClick:function onClick(){return O(!m)},"aria-label":"Back to conversation",disabled:!m},P.a.createElement(fe.a,{color:u,width:20,height:20})),P.a.createElement("h1",{style:s},n("history.headerTitle"))),j&&P.a.createElement(P.a.Fragment,null,P.a.createElement("style",null,"\n              .drift-widget-history.keyboard-focused {\n                ".concat(Object(de.b)(u.replace("#","")),"\n              }\n            ")),P.a.createElement(I.a,{className:l()("drift-widget-history",{"drift-widget-history--mobile":d,"drift-widget-history--open":m,"keyboard-focused":t}),"aria-label":"Open conversation history",disabled:m,onClick:function onClick(){return O(!m)},ref:e},P.a.createElement(be,{fill:u,height:20,width:20}))))}),ve=n("NFvl"),ge=function useDefaultGreeting(){var e=Object(Oe.a)().t,t=Object(B.c)(function(t){var n=Object(ve.a)(["embed","configuration","theme","welcomeMessage"],t);return n||e("greeting.onlineMessage")}),n=Object(B.c)(function(e){return e.view.matchedHours}),a=Object(B.c)(function(t){var n=Object(ve.a)(["embed","configuration","theme","awayMessage"],t);return n||e("greeting.awayMessage")});return n?t:a},pe=n("hm8b"),he=(n("txDs"),function GreetingMessage(e){var t=e.previewRef,n=ge(),a=Object(te.b)(),c=Object(B.c)(function(e){return e.view}).chatOpen,r=Object(T.a)(c),i=Object(B.c)(function(e){return e.view.matchedHours});Object(F.useEffect)(function(){Object(pe.a)(r)||c===r||(i?Object(ne.s)(c):Object(ne.a)(c))},[r,c,i]);var o=a.length>1;return G(),P.a.createElement("div",{className:l()("drift-widget-greeting",{"greeting-multiple-senders":o})},P.a.createElement(R.a,{senderIds:a}),P.a.createElement("p",{ref:t,className:"drift-widget-greeting-content"},n))}),Ee=n("xyhj"),we=n("hSLT"),Ce=n("Wjfv"),ye=n("Ldxc"),ke=n("PjZB"),Te=(n("Uo75"),function WelcomeMessage(e){var t=e.previewRef,n=Object(B.b)(),a=Object(B.c)(function(e){return e.view}).chatOpen,c=Object(te.b)(),o=Object(we.a)();if(!a)return null;var s=function(){var e=Object(i.a)(r.a.mark(function _callee(){return r.a.wrap(function _callee$(e){for(;;)switch(e.prev=e.next){case 0:Object(ye.a)(o),n(Object(Ce.a)()),o.ctaType===ke.a.LINK_TO_URL&&n(Object(ae.c)({chatOpen:!1}));case 3:case"end":return e.stop()}},_callee)}));return function onCtaClicked(){return e.apply(this,arguments)}}();return P.a.createElement("div",{className:"drift-widget-greeting"},P.a.createElement(R.a,{senderIds:c}),P.a.createElement("div",{ref:t,className:"drift-widget-welcome-message-content"},P.a.createElement("div",{dangerouslySetInnerHTML:{__html:'\n              <div class="drift-welcome-message-content--body">\n                '.concat(o.body,"\n              </div>\n            ")}})),o.ctaCopy&&o.ctaType!==ke.a.CHAT_RESPONSE&&P.a.createElement("div",{className:"drift-widget-greeting-cta-wrapper"},P.a.createElement(Ee.a,{ctaUrl:o.ctaUrl,ctaType:o.ctaType,ctaCopy:o.ctaCopy,onClick:s})))}),_e="GREETING",Ne="CHAT_TAKEOVER",Se="CONVERSATION",Le="GDPR",Ie="WELCOME_MESSAGE",Ae=(a={},Object(A.a)(a,Ie,function(e){return P.a.createElement(Te,e)}),Object(A.a)(a,_e,function(e){return P.a.createElement(he,e)}),Object(A.a)(a,Se,function(e){return P.a.createElement(je,e)}),Object(A.a)(a,Le,function(e){return P.a.createElement(z,e)}),Object(A.a)(a,Ne,function(e){return P.a.createElement(le,e)}),a),xe=n("2uLe"),He=(n("SwvN"),function HeaderLayout(e){var t=e.activeConversation,n=e.chatHidden,a=e.isChatTakeover,c=void 0!==a&&a,r=Object(B.b)(),i=Object(N.a)(),s=i.backgroundStyles,u=i.conversationHeaderTextStyles,d=Object(B.c)(function(e){return e.campaigns.activeCampaign}).id,f=Object(B.c)(function(e){return e.session.gdpr}).hasConsent,b=Object(y.a)(),m=Object(xe.a)(),O=m.setChatHeight,j=m.previewRef,v=Object(B.c)(function(e){return e.view}).chatOpen,g=Object(F.useCallback)(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t;return f?c?Ne:e?Se:d?Ie:_e:Le},[t,f,c,d]),p=Object(F.useState)(g()),h=Object(o.a)(p,2),E=h[0],w=h[1],C=Object(T.a)(E),k=E!==C;Object(F.useLayoutEffect)(function(){v&&!n&&O(v,k)},[v,n,O,k]),Object(F.useEffect)(function(){var e=g(t);e!==E&&w(e)},[t,d,f,g,E]);var _=Ae[E],A=E!==Se,x=b&&!c;return P.a.createElement("header",{className:l()("drift-widget-header",{"drift-widget-header--collapsed":A,"drift-widget-header--gdpr-consent":!f})},P.a.createElement(S.a,{style:s}),P.a.createElement("div",{className:"drift-widget-header--content"},P.a.createElement(_,{previewRef:j,resetChatHeight:function resetChatHeight(){O(v,!0)}})),x&&P.a.createElement(I.a,{onClick:function doToggleChat(){r(Object(ae.c)({chatOpen:!1}))},className:"drift-widget-mobile-close","aria-label":"Close chat",style:u},P.a.createElement(L.j,{width:16,height:16})))}),Re=n("vjCh"),Me=n("K7i0"),De=n("bYXQ"),Fe=n("Hvhg"),Pe=n("da4L"),Be=n("Gxm1"),Ue=n("TbSn"),Ge=n("kNJ0"),Ve=n("oPI6"),Ze=n("MFhO"),Ke=n("VpmR"),Je=n("4c+F"),Ye=n("HSQL"),$e=(n("sXTY"),null),We=function ChatLayout(){var e=Object(B.b)(),t=Object(y.a)(),n=Object(F.useState)(!0),a=Object(o.a)(n,2),c=a[0],u=a[1];Object(k.a)();var d=Object(B.c)(function(e){return e.view}),S=d.chatOpen,L=d.isChatTakeover,I=Object(B.c)(Fe.b).showBranding,A=void 0!==I&&I,x=Object(_.a)().noPolicy,H=!A&&x;Object(F.useLayoutEffect)(function(){L&&S&&Object(re.a)({topic:"set-frame-width-and-height",message:{className:"drift-frame-chat__takeover",height:"100%",max:!0,name:"chat",width:"100%"}})},[L,S]);var R=Object(B.c)(function(e){return e.conversations.activeConversation}),M=Object(w.a)().fetchMessages,D=Object(T.a)(R),U=Object(B.c)(function(e){return e.conversations.conversations}),G=Object(B.c)(function(e){return e.conversations.messages}),V=Object(B.c)(function(e){return Object(J.a)({},["conversations","messages",e.conversations.activeConversation],e)}),Z=Object(B.c)(function(e){return Object(J.a)(!1,["conversations","conversationStatus",e.conversations.activeConversation,"permaclosed"],e)}),K=Object(F.useMemo)(function(){return Object(Pe.n)(V)},[V]),Y=Object(B.c)(function(e){return e.campaigns.activeCampaign}),W=Object(F.useMemo)(function(){return Object(J.a)(null,["attributes","campaignDisplayType"],Y)===Ze.a.WELCOME_MESSAGE},[Y]),X=Object(B.c)(function(e){return e.session.gdpr}).hasConsent,q=Object(B.c)(function(e){return Object(J.a)(!1,["conversations","conversationStatus",R,"endUserResponded"],e)}),Q=Object(h.a)(),z=Q.conversationHistoryOpen,ee=Q.conversationHistoryEnabled,te=Object(N.a)().widgetBackgroundStyles;Object(F.useEffect)(function(){(function(){var t=Object(i.a)(r.a.mark(function _callee(){var t,n,a,c,i;return r.a.wrap(function _callee$(r){for(;;)switch(r.prev=r.next){case 0:if(t=!R||R===p.a,n=D===R,a=!!U[R]&&!!G[R],!(t||n||a||Object(De.c)(R))){r.next=5;break}return r.abrupt("return");case 5:return r.prev=5,r.next=8,Object(s.h)(R);case 8:c=r.sent,i=c.data,e(Object(Me.h)({conversation:i})),M({}),r.next=17;break;case 14:r.prev=14,r.t0=r.catch(5),Object($.f)("Failed to fetch messages or active conversation",r.t0);case 17:case"end":return r.stop()}},_callee,null,[[5,14]])}));return function fetchInfoForActiveConversation(){return t.apply(this,arguments)}})()()},[R,e,M,D,U,G]),Object(F.useEffect)(function(){S?(function(){var e=Object(i.a)(r.a.mark(function _callee2(){return r.a.wrap(function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(re.a)({topic:"focus-frame",message:{name:"chat"}});case 2:case"end":return e.stop()}},_callee2)}));return function focus(){return e.apply(this,arguments)}}()(),$e&&clearTimeout($e),u(!1)):$e=setTimeout(function delaySetReflowHidden(){u(!0)},350)},[S]);var ae=Object(F.useMemo)(function(){if(!X||!S)return!1;if(Y&&Y.id&&!R){var e=!!Object(J.a)(null,["attributes","cta"],Y),t="CHAT_RESPONSE"!==Object(J.a)(null,["attributes","cta","CtaType"],Y);if(e&&t)return!1}var n=K.length>0&&K.length<=2&&!Object(Pe.f)(K[0]);return!L||n||K.length>2},[Y,R,X,L,K,S]);Object(F.useEffect)(function(){Object(Ye.b)("WIDGET_CHAT_FRAME.start")},[]);var ie=Object(F.useRef)(!1);Object(F.useEffect)(function(){if(!ie.current&&L&&K.length>0){var e=Object(Be.b)("post_form_takeover_tti"),t=Object(Be.b)("post_form_takeover_show");e&&Object(Je.d)("Post Form Takeover TTI",e),t&&Object(Je.d)("Post Form Takeover Show",t),ie.current=!0}},[L,K]);var oe=Object(F.useMemo)(function(){if(Z)return f.a.UNAVAILABLE;var e=Object(Ue.a)(K);if(!e)return f.a.AVAILABLE;var t=Object(Ge.a)(-2,K),n=Object(Pe.f)(t)&&Object(Pe.h)(e);return Object(Pe.f)(e)||n||Object(Pe.i)(e)?f.a.UNAVAILABLE_BUTTONS:Object(Pe.k)(e)||Object(Pe.k)(t)&&Object(Pe.h)(e)?f.a.AVAILABLE_BUTTONS:f.a.AVAILABLE},[K,Z]),se=oe===f.a.AVAILABLE||oe===f.a.AVAILABLE_BUTTONS,ue=Object(E.a)(K,R),le=Object(F.useMemo)(function(){return Object(Pe.d)(ue)},[ue]),de=Object(F.useMemo)(function(){return P.a.createElement(j.a,{messageGroups:le,messages:ue,reflowHidden:c,disabled:z})},[le,ue,c,z]),fe=Object(C.a)(),be=Object(F.useMemo)(function(){if(ue&&ue.length){var e=Object(Ue.a)(ue);if(e&&Object(Pe.j)(e))return e}return null},[ue]),me=X&&(!!R||L),Oe=!ae||!se;return P.a.createElement("main",{className:l()("drift-widget-chat-layout",{"drift-widget-chat-layout__takeover":L&&!t,"drift-widget-chat-layout__takeover--noResponse":L&&!t&&!q}),role:"main","aria-label":"Chat window"},P.a.createElement(g.a,null),P.a.createElement("div",{className:l()("drift-widget-chat-wrapper",{"drift-widget-chat-wrapper__open":S,"drift-widget-chat-wrapper__closed":!S,"drift-widget-chat-wrapper__reflow-hidden":c,"drift-widget-chat-wrapper__active-conversation":me,"drift-widget-chat-wrapper__no-footer-content":H&&Oe})},P.a.createElement(He,{activeConversation:R,chatHidden:c,isChatTakeover:L}),!L&&ee&&P.a.createElement(b.a,null),me&&P.a.createElement("div",{className:l()("drift-widget-message-history",{"drift-widget-message-history--with-footer":fe,"drift-widget-message-history--no-composer":Oe}),style:te},de,0===K.length&&P.a.createElement(O.a,null)),P.a.createElement("div",{className:"drift-widget-chat-bottom"},ae&&P.a.createElement(f.b,{state:oe,disabled:z,onSubmit:function doSendMessage(t){if((W||L)&&!R){var n=Object(J.a)(null,["attributes","playbookId"],Y);!function sendSubmittedEventForChatResponseCampaign(){Y&&"CHAT_RESPONSE"===Object(J.a)(null,["attributes","cta","CtaType"],Y)&&Object(ne.c)(ce.b.SUBMITTED,Y.id)}(),Object(Re.j)(Y.id,n)}e(Object(Me.m)(t))},chatHidden:c,activeConversationId:R}),P.a.createElement(m.a,null)),R&&!!be&&P.a.createElement(v.a,{message:be})))};t.default=function(e){var t=Object(F.useState)(!1),n=Object(o.a)(t,2),a=n[0],c=n[1],s=Object(B.c)(function(e){return e.view.initComplete}),u=Object(B.c)(function(e){return Object(J.a)("en",["embed","configuration","locale"],e)});return Object(F.useEffect)(function(){s&&!a&&function(){var e=Object(i.a)(r.a.mark(function _callee3(){return r.a.wrap(function _callee3$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(Ke.a)(u);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),Object($.n)({data:["i18n failed to load - ".concat(e.t0.message),e.t0],type:"warn"});case 8:c(!0);case 9:case"end":return e.stop()}},_callee3,null,[[0,5]])}));return function runAsync(){return e.apply(this,arguments)}}()()},[s,a,u]),P.a.createElement(Ve.a,null,s&&a?P.a.createElement(We,e):P.a.createElement(d.a,null))}},SwvN:function(e,t,n){},Uo75:function(e,t,n){},Ztgx:function(e,t,n){"use strict";var a=n("yEsl"),c=n("58kB"),r=n("i9gz"),i=n("weY7"),o=n("RhEL"),s=n("ERkP"),u=n.n(s),l=n("Tr4L"),d=n("uDfI"),f=n("F8vJ");n("oY6K");t.a=u.a.memo(function SenderInfo(e){var t=e.senderIds,n=e.messageText,o=void 0===n?null:n,b=Object(l.a)().t,m=Object(d.c)(function(e){return e.embed.configuration.organizationName}),O=Object(c.b)(t),j=Object(s.useMemo)(function(){var e;if(o)return o;if(t.length>1||Object(r.a)(O))return"";var n=null===(e=O[0])||void 0===e?void 0:e.recipient;if(!n||!n.name)return"";var a=!m||!m.length||Object(f.a)(m),c=!!m&&n.name.toLowerCase()===m.toLowerCase();return a||c?"".concat(n.name):b("header.senderInfo",{name:n.name,orgName:m})},[t.length,O,m,o,b]);return u.a.createElement("div",{className:"drift-widget-greeting-agent-header"},u.a.createElement("h1",{className:"drift-widget-greeting-recipient-name"},j),u.a.createElement(function Avatars(){return u.a.createElement(u.a.Fragment,null," ",Object(i.a)(function(e){return e.recipient?u.a.createElement(a.a,{key:e.recipient.id,id:e.recipient.id}):u.a.createElement(u.a.Fragment,null)},O))},null))},function propsAreEqual(e,t){return e.senderId===t.senderId&&e.messageText===t.messageText||Object(o.a)(e.senderIds,t.senderIds)&&e.messageText===t.messageText})},hSLT:function(e,t,n){"use strict";var a=n("LVcX"),c=n("uDfI");t.a=function useActiveAnnouncementCampaign(){var e=Object(c.c)(function(e){return Object(a.a)({},["campaigns","activeCampaign"],e)}),t=e.attributes,n=void 0===t?{}:t;return{id:e.id,playbookId:Object(a.a)(null,["playbookId"],n),ctaType:Object(a.a)(null,["cta","CtaType"],n),ctaCopy:Object(a.a)("",["cta","copy"],n),ctaUrl:Object(a.a)("",["cta","UrlLink"],n),body:n.message||"",title:n.title||"",thanksTitle:n.thankYouHeadline||"",thanksMessage:n.thankYouMessage||"",senderId:n.senderId,type:n.campaignDisplayType}}},oY6K:function(e,t,n){},sXTY:function(e,t,n){},sZBt:function(e,t,n){},swFs:function(e,t,n){"use strict";var a=n("ERkP"),c=n.n(a);n("G5CQ");t.a=function TopLine(e){var t=e.style;return c.a.createElement("div",{className:"drift-widget-header-top-line",style:t})}},txDs:function(e,t,n){},xyhj:function(e,t,n){"use strict";var a=n("nfbA"),c=n("nJ3u"),r=n("O94r"),i=n.n(r),o=n("z24s"),s=n("o3t1"),u=n("lE29"),l=n("ERkP"),d=n.n(l),f=n("uDfI"),b=n("PjZB"),m=n("7oto"),O=n("rTkt");n("MWt3");t.a=function CtaButton(e){var t=e.ctaUrl,n=e.ctaCopy,r=e.ctaType,j=e.onClick,v=e.ariaHidden,g=Object(s.a)(),p=g.hoverProps,h=g.isHovered,E=Object(u.a)(),w=E.activeColor,C=E.backgroundStyles,y=Object(f.c)(function(e){return e.campaigns.activeCampaign}),k=Object(l.useRef)(null),T=Object(o.a)(k),_=Object(l.useMemo)(function(){var e=h?Object(O.c)(C.background,-5):C.background;return Object(a.a)(Object(a.a)({},C),{},{background:e})},[C,h]),N=function onCtaClick(e){r===b.a.CHAT_RESPONSE?Object(m.a)({topic:"drift-api:open-chat"}):r===b.a.SCHEDULE_MEETING&&Object(m.a)({topic:"drift-api:schedule-meeting",message:{scheduleMeetingWith:y.attributes.senderId,options:{activeCampaign:y}}}),j&&j(e)};return Object(l.useEffect)(function(){var e=k;return setTimeout(function(){return e.current&&e.current.focus()},50),function(){return e.current&&e.current.blur()}},[]),r===b.a.LINK_TO_URL?d.a.createElement(d.a.Fragment,null,d.a.createElement("style",null,"\n            .drift-widget-announcement-cta-link-wrapper a.keyboard-focused {\n              ".concat(Object(c.d)("FFFFFF",w),"\n            }\n          ")),d.a.createElement("div",{className:"drift-widget-announcement-cta drift-widget-announcement-cta-link-wrapper",hidden:v},d.a.createElement("a",Object.assign({className:i()("drift-widget-announcement-cta-link",{"keyboard-focused":T&&!v}),href:t,onClick:N,target:"_blank",rel:"noopener noreferrer",ref:k,"aria-describedby":"drift-widget-announcement-cta-description",style:_,"aria-hidden":v},p),n),d.a.createElement("span",{hidden:!0,id:"drift-widget-announcement-cta-description"},n+"; opens an external site in a new window"))):d.a.createElement(d.a.Fragment,null,d.a.createElement("style",null,"\n          .drift-widget-announcement-cta.keyboard-focused {\n            ".concat(Object(c.d)("FFFFFF",w),"\n          }\n        ")),d.a.createElement("button",Object.assign({className:i()("drift-widget-announcement-cta",{"keyboard-focused":T}),onClick:N,style:_,ref:k},p),n))}}}]);