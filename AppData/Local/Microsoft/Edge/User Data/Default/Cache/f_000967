var otelWorker=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([,,,function(e,t,n){var i=n(8),r=n(9),a=r;a.v1=i,a.v4=r,e.exports=a},,function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var i=new Uint8Array(16);e.exports=function(){return n(i),i}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}},function(e,t){for(var n=[],i=0;i<256;++i)n[i]=(i+256).toString(16).substr(1);e.exports=function(e,t){var i=t||0,r=n;return[r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],"-",r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]],r[e[i++]]].join("")}},,function(e,t,n){var i,r,a=n(5),o=n(6),s=0,c=0;e.exports=function(e,t,n){var l=t&&n||0,u=t||[],d=(e=e||{}).node||i,f=void 0!==e.clockseq?e.clockseq:r;if(null==d||null==f){var p=a();null==d&&(d=i=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=r=16383&(p[6]<<8|p[7]))}var v=void 0!==e.msecs?e.msecs:(new Date).getTime(),g=void 0!==e.nsecs?e.nsecs:c+1,h=v-s+(g-c)/1e4;if(h<0&&void 0===e.clockseq&&(f=f+1&16383),(h<0||v>s)&&void 0===e.nsecs&&(g=0),g>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=v,c=g,r=f;var m=(1e4*(268435455&(v+=122192928e5))+g)%4294967296;u[l++]=m>>>24&255,u[l++]=m>>>16&255,u[l++]=m>>>8&255,u[l++]=255&m;var y=v/4294967296*1e4&268435455;u[l++]=y>>>8&255,u[l++]=255&y,u[l++]=y>>>24&15|16,u[l++]=y>>>16&255,u[l++]=f>>>8|128,u[l++]=255&f;for(var T=0;T<6;++T)u[l+T]=d[T];return t||o(u)}},function(e,t,n){var i=n(5),r=n(6);e.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||i)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[a+s]=o[s];return t||r(o)}},function(e,t,n){"use strict";n.r(t);var i,r=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),a=function(){function e(){}return e.prototype.sendTraceTag=function(){},e.prototype.shipAssertTag=function(){},e.prototype.debugAssertTag=function(){},e}(),o=new(function(){function e(){this.externalLogger=new a}return e.prototype.setLogger=function(e){this.externalLogger=e},e.prototype.sendTraceTag=function(e,t,n,i){this.externalLogger.sendTraceTag(e,t,n,i)},e.prototype.debugAssertTag=function(e,t,n,i){this.externalLogger.debugAssertTag(e,t,n,i)},e.prototype.shipAssertTag=function(e,t,n,i){this.externalLogger.shipAssertTag(e,t,n,i)},e}());function s(e){if(!e)throw new Error("The 'logger' argument is missing");o.setLogger(e)}function c(e){var t={eventName:e.eventName,eventFlags:e.eventFlags};return e.telemetryProperties&&(t.telemetryProperties={ariaTenantToken:e.telemetryProperties.ariaTenantToken,nexusTenantToken:e.telemetryProperties.nexusTenantToken}),e.eventContract&&(t.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),t.dataFields=e.dataFields?e.dataFields.slice():[],t}!function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(i||(i={}));var l,u,d,f,p,v,g,h=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e.prototype.getListenerCount=function(){return this._listeners.length},e}(),m=new h;function y(e,t,n){m.fireEvent({level:e,category:t,message:n})}function T(e,t,n){y(l.Error,e,(function(){var e=n instanceof Error?n.message:"";return t+": "+e}))}function S(e,t){return{name:e,dataType:p.Boolean,value:t,classification:g.SystemMetadata}}function b(e,t){return{name:e,dataType:p.Int64,value:t,classification:g.SystemMetadata}}function E(e,t){return{name:e,dataType:p.Double,value:t,classification:g.SystemMetadata}}function _(e,t){return{name:e,dataType:p.String,value:t,classification:g.SystemMetadata}}!function(e){e[e.Error=0]="Error",e[e.Warning=1]="Warning",e[e.Info=2]="Info",e[e.Verbose=3]="Verbose"}(l||(l={})),function(e){e[e.Core=0]="Core",e[e.Sink=1]="Sink",e[e.Transport=2]="Transport"}(u||(u={})),function(e){e[e.Aria=0]="Aria",e[e.Nexus=1]="Nexus"}(d||(d={})),function(e){var t={},n={},i={};function r(e){if("object"!=typeof e)throw new Error("tokenTree must be an object");i=function e(t,n){if("object"!=typeof n)return n;for(var i=0,r=Object.keys(n);i<r.length;i++){var a=r[i];a in t&&(t[a],1)?t[a]=e(t[a],n[a]):t[a]=n[a]}return t}(i,e)}function a(e){if(t[e])return t[e];var n=s(e,d.Aria);return"string"==typeof n?(t[e]=n,n):void 0}function o(e){if(n[e])return n[e];var t=s(e,d.Nexus);return"number"==typeof t?(n[e]=t,t):void 0}function s(e,t){var n=e.split("."),r=i,a=void 0;if(r){for(var o=0;o<n.length-1;o++)r[n[o]]&&(r=r[n[o]],t===d.Aria&&"string"==typeof r.ariaTenantToken?a=r.ariaTenantToken:t===d.Nexus&&"number"==typeof r.nexusTenantToken&&(a=r.nexusTenantToken));return a}}e.setTenantToken=function(e,t,n){var i=e.split(".");if(i.length<2||"Office"!==i[0])y(l.Error,u.Core,(function(){return"Invalid namespace: "+e}));else{var a=Object.create(Object.prototype);t&&(a.ariaTenantToken=t),n&&(a.nexusTenantToken=n);var o,s=a;for(o=i.length-1;o>=0;--o){var c=Object.create(Object.prototype);c[i[o]]=s,s=c}r(s)}},e.setTenantTokens=r,e.getTenantTokens=function(e){var t=a(e),n=o(e);if(!n||!t)throw new Error("Could not find tenant token for "+e);return{ariaTenantToken:t,nexusTenantToken:n}},e.getAriaTenantToken=a,e.getNexusTenantToken=o,e.clear=function(){t={},n={},i={}}}(f||(f={})),function(e){e[e.String=0]="String",e[e.Boolean=1]="Boolean",e[e.Int64=2]="Int64",e[e.Double=3]="Double",e[e.Guid=4]="Guid"}(p||(p={})),function(e){var t=/^[A-Z][a-zA-Z0-9]*$/,n=/^[a-zA-Z0-9_\.]*$/;function i(e){return void 0!==e&&n.test(e)}function r(e){if(!((t=e.name)&&i(t)&&t.length+5<100))throw new Error("Invalid dataField name");var t;e.dataType===p.Int64&&a(e.value)}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>9007199254740991)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;var n=e.split("."),i=n[n.length-1];return function(e){return!!e&&e.length>=3&&"Office"===e[0]}(n)&&(r=i,void 0!==r&&t.test(r));var r}(e.eventName))throw new Error("Invalid eventName");if(e.eventContract&&!i(e.eventContract.name))throw new Error("Invalid eventContract");if(null!=e.dataFields)for(var n=0;n<e.dataFields.length;n++)r(e.dataFields[n])},e.validateInt=a}(v||(v={})),function(e){e[e.EssentialServiceMetadata=1]="EssentialServiceMetadata",e[e.AccountData=2]="AccountData",e[e.SystemMetadata=4]="SystemMetadata",e[e.OrganizationIdentifiableInformation=8]="OrganizationIdentifiableInformation",e[e.EndUserIdentifiableInformation=16]="EndUserIdentifiableInformation",e[e.CustomerContent=32]="CustomerContent",e[e.AccessControl=64]="AccessControl"}(g||(g={}));var C=function(){return(C=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},O=function(){function e(e,t,n){var i,r;this.onSendEvent=new h,this.persistentDataFields=[],this.config=n||{},e?(this.onSendEvent=e.onSendEvent,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=C(C({},e.getConfig()),this.config)):this.persistentDataFields.push(_("OTelJS.Version","3.1.72")),t&&(r=this.persistentDataFields).push.apply(r,t)}return e.prototype.sendTelemetryEvent=function(e){var t;try{if(0===this.onSendEvent.getListenerCount())return void y(l.Warning,u.Core,(function(){return"No telemetry sinks are attached."}));t=this.cloneEvent(e),this.processTelemetryEvent(t)}catch(e){return void T(u.Core,"SendTelemetryEvent",e)}try{this.onSendEvent.fireEvent(t)}catch(e){}},e.prototype.processTelemetryEvent=function(e){var t;e.telemetryProperties||(e.telemetryProperties=f.getTenantTokens(e.eventName)),e.dataFields&&this.persistentDataFields&&(t=e.dataFields).unshift.apply(t,this.persistentDataFields),this.config.disableValidation||v.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.onSendEvent.addListener((function(t){return e.sendTelemetryEvent(t)}))},e.prototype.setTenantToken=function(e,t,n){f.setTenantToken(e,t,n)},e.prototype.setTenantTokens=function(e){f.setTenantTokens(e)},e.prototype.cloneEvent=function(e){return c(e)},e.prototype.getConfig=function(){return this.config},e}(),w=Object.getPrototypeOf,x=0;function I(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function P(e){return"function"==typeof e}function k(e){return e&&(e===Object.prototype||e===Array.prototype)}function N(e){return k(e)||e===Function.prototype}function M(e){if(e){if(w)return w(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}function F(e,t,n){return"constructor"!==t&&P(e[t])&&(n||I(e,t))}function D(e){throw new TypeError("DynamicProto: "+e)}function A(e,t){for(var n=e.length-1;n>=0;n--)if(e[n]===t)return!0;return!1}function L(e,t,n,i){var r=null;if(e&&I(n,"_dynClass")){var a=e._dynInstFuncs||{};if((r=(a[n._dynClass]||{})[t])||D("Missing ["+t+"] function"),!r._dynInstChk&&!1!==a._dynInstChk){for(var o=!I(e,t),s=M(e),c=[];o&&s&&!N(s)&&!A(c,s);){var l=s[t];if(l){o=l===i;break}c.push(s),s=M(s)}try{o&&(e[t]=r),r._dynInstChk=1}catch(e){a._dynInstChk=!1}}}return r}function U(e,t,n){var i=t[e];return i===n&&(i=M(t)[e]),P(i)||D("["+e+"] is not a function"),i}function W(e,t){return I(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function R(e,t,n,i){I(e,"prototype")||D("theClass is an invalid class definition.");var r=e.prototype;(function(e,t){for(var n=M(t);n&&!N(n);){if(n===e)return!0;n=M(n)}return!1})(r,t)||D("["+W(e)+"] is not in class hierarchy of ["+W(t)+"]");var a=null;I(r,"_dynClass")?a=r._dynClass:(a="_dynCls$"+W(e,"_")+"$"+x,x++,r._dynClass=a);var o=R._dfOpts,s=!!o.useBaseInst;s&&i&&void 0!==i.useBaseInst&&(s=!!i.useBaseInst);var c=function(e){var t={};for(var n in e)!t[n]&&F(e,n,!1)&&(t[n]=e[n]);return t}(t);n(t,function(e,t,n,i){function r(e,t,n){var r=t[o];if(r._isDynProxy&&i){var a=e._dynInstFuncs||{};!1!==a._dynInstChk&&(r=(a[t._dynClass]||{})[n]||r)}return function(){return r.apply(e,arguments)}}var a={};for(var o in n)a[o]=r(t,n,o);for(var s=M(e),c=[];s&&!N(s)&&!A(c,s);){for(var o in s)!a[o]&&F(s,o,!w)&&(a[o]=r(t,s,o));c.push(s),s=M(s)}return a}(r,t,c,s));var l=!!w&&!!o.setInstFuncs;l&&i&&(l=!!i.setInstFuncs),function(e,t,n,i,r){function a(e,t){var n=function(){var i=L(this,t,e,n)||U(t,e,n);return i.apply(this,arguments)};return n._isDynProxy=1,n}if(!k(e)){var o=n._dynInstFuncs=n._dynInstFuncs||{},s=o[t]=o[t]||{};for(var c in!1!==o._dynInstChk&&(o._dynInstChk=!!r),n)F(n,c,!1)&&n[c]!==i[c]&&(s[c]=n[c],delete n[c],(!I(e,c)||e[c]&&!e[c]._isDynProxy)&&(e[c]=a(e,c)))}}(r,a,t,c,!1!==l)}R._dfOpts={setInstFuncs:!0,useBaseInst:!0};var B=R;function V(){return"undefined"!=typeof globalThis&&globalThis?globalThis:"undefined"!=typeof self&&self?self:"undefined"!=typeof window&&window?window:"undefined"!=typeof global&&global?global:null}function H(e){var t=Object.create;if(t)return t(e);if(null==e)return{};var n=typeof e;if("object"!==n&&"function"!==n)throw new TypeError("Object prototype may only be an Object:"+e);function i(){}return i.prototype=e,new i}var z=function(e,t){return(z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var q,j,K,J=V()||{};j=function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},K=function(e,t){function n(){this.constructor=e}z(e,t),e.prototype=null===t?H(t):(n.prototype=t.prototype,new n)},(q=J).__assign||(q.__assign=Object.assign||j),q.__extends||(q.__extends=K),__assign||(__assign=J.__assign),__extends||(__extends=J.__extends);var G=V;function Q(e){var t=G();return t&&t[e]?t[e]:"window"===e&&X()?window:null}function X(){return Boolean("object"==typeof window&&window)}function Z(){return X()?window:Q("window")}function $(){return Boolean("object"==typeof document&&document)?document:Q("document")}function Y(){return Boolean("object"==typeof navigator&&navigator)}function ee(){return Y()?navigator:Q("navigator")}function te(){return"object"==typeof location&&location?location:Q("location")}function ne(){return Boolean("object"==typeof JSON&&JSON||null!==Q("JSON"))}var ie=null,re=!1,ae=123456789,oe=987654321;function se(e){e<0&&(e>>>=0),ae=123456789+e&4294967295,oe=987654321-e&4294967295,re=!0}function ce(){se(4294967296*Math.random()^(new Date).getTime())}function le(e,t){return typeof e===t}function ue(e){return le(e,"undefined")||void 0===e}function de(e){return ue(e)||null===e}function fe(e,t){return e&&Object.prototype.hasOwnProperty.call(e,t)}function pe(e){return le(e,"object")}function ve(e){return le(e,"function")}function ge(e,t,n,i){void 0===i&&(i=!1);var r=!1;if(!de(e))try{de(e.addEventListener)?de(e.attachEvent)||(e.attachEvent("on"+t,n),r=!0):(e.addEventListener(t,n,i),r=!0)}catch(e){}return r}function he(e,t,n,i){if(void 0===i&&(i=!1),!de(e))try{de(e.removeEventListener)?de(e.detachEvent)||e.detachEvent("on"+t,n):e.removeEventListener(t,n,i)}catch(e){}}function me(e,t,n,i){var r=Object.defineProperty;if(r)try{var a={enumerable:!0,configurable:!0};return n&&(a.get=n),i&&(a.set=i),r(e,t,a),!0}catch(e){}return!1}var ye,Te=function(){function e(){}return e.isDate=function(e){return"[object Date]"===Object.prototype.toString.call(e)},e.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},e.isError=function(e){return"[object Error]"===Object.prototype.toString.call(e)},e.isString=function(e){return le(e,"string")},e.isNumber=function(e){return le(e,"number")},e.isBoolean=function(e){return le(e,"boolean")},e.disableCookies=function(){e._canUseCookies=!1},e.newGuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Se,(function(t){var n=0|e.randomValue(15);return("x"===t?n:3&n|8).toString(16)}))},e.toISOString=function(t){if(e.isDate(t)){var n=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return t.getUTCFullYear()+"-"+n(t.getUTCMonth()+1)+"-"+n(t.getUTCDate())+"T"+n(t.getUTCHours())+":"+n(t.getUTCMinutes())+":"+n(t.getUTCSeconds())+"."+String((t.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}},e.arrForEach=function(e,t,n){for(var i=e.length,r=0;r<i;r++)r in e&&t.call(n||e,e[r],r,e)},e.arrIndexOf=function(e,t,n){for(var i=e.length,r=n||0,a=Math.max(r>=0?r:i-Math.abs(r),0);a<i;a++)if(a in e&&e[a]===t)return a;return-1},e.arrMap=function(e,t,n){for(var i=e.length,r=n||e,a=new Array(i),o=0;o<i;o++)o in e&&(a[o]=t.call(r,e[o],e));return a},e.arrReduce=function(e,t,n){var i,r=e.length,a=0;if(arguments.length>=3)i=arguments[2];else{for(;a<r&&!(a in e);)a++;i=e[a++]}for(;a<r;)a in e&&(i=t(i,e[a],a,e)),a++;return i},e.strTrim=function(t){return e.isString(t)?t.replace(/^\s+|\s+$/g,""):t},e.objKeys=function(e){var t=!{toString:null}.propertyIsEnumerable("toString");if(!(ve(e)||pe(e)&&null!==e))throw new TypeError("objKeys called on non-object");var n=[];for(var i in e)fe(e,i)&&n.push(i);if(t)for(var r=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],a=r.length,o=0;o<a;o++)fe(e,r[o])&&n.push(r[o]);return n},e.addEventHandler=function(e,t){var n=!1,i=Z();i&&(n=ge(i,e,t),n=ge(i.body,e,t)||n);var r=$();return r&&(n=be.Attach(r,e,t)||n),n},e.dateNow=function(){var e=Date;return e.now?e.now():(new e).getTime()},e.perfNow=function(){var t=Q("performance");return t&&t.now?t.now():e.dateNow()},e.newId=function(t){void 0===t&&(t=22);for(var n=e.random32()>>>0,i=0,r="";r.length<t;)i++,r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&n),n>>>=6,5===i&&(n=(e.random32()<<2&4294967295|3&n)>>>0,i=0);return r},e.isIE=function(){if(null===ie){var e=((ee()||{}).userAgent||"").toLowerCase();ie=-1!==e.indexOf("msie")||-1!==e.indexOf("trident/")}return ie},e.randomValue=function(t){return t>0?Math.floor(e.random32()/4294967295*(t+1))>>>0:0},e.random32=function(t){var n,i=Q("crypto")||Q("msCrypto");return i&&i.getRandomValues?n=4294967295&i.getRandomValues(new Uint32Array(1))[0]:e.isIE()?(re||ce(),n=4294967295&e.mwcRandom32()):n=Math.floor(4294967296*Math.random()|0),t||(n>>>=0),n},e.mwcRandomSeed=function(e){e?se(e):ce()},e.mwcRandom32=function(e){var t=((oe=36969*(65535&oe)+(oe>>16)&4294967295)<<16)+(65535&(ae=18e3*(65535&ae)+(ae>>16)&4294967295))>>>0&4294967295|0;return e||(t>>>=0),t},e.generateW3CId=function(){for(var t,n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i="",r=0;r<4;r++)i+=n[15&(t=e.random32())]+n[t>>4&15]+n[t>>8&15]+n[t>>12&15]+n[t>>16&15]+n[t>>20&15]+n[t>>24&15]+n[t>>28&15];var a=n[8+(3&e.random32())|0];return i.substr(0,8)+i.substr(9,4)+"4"+i.substr(13,3)+a+i.substr(16,3)+i.substr(19,12)},e.isTypeof=le,e.isUndefined=ue,e.isNullOrUndefined=de,e.hasOwnProperty=fe,e.isFunction=ve,e.isObject=pe,e.objCreate=H,e.objDefineAccessors=me,e}(),Se=/[xy]/g,be=function(){function e(){}return e.Attach=ge,e.AttachEvent=ge,e.Detach=he,e.DetachEvent=he,e}(),Ee=function(){function e(t,n,i){var r,a=this,o=!1;(a.start=Te.dateNow(),a.name=t,a.isAsync=i,a.isChildEvt=function(){return!1},Te.isFunction(n))&&(o=Te.objDefineAccessors(a,"payload",(function(){return!r&&Te.isFunction(n)&&(r=n(),n=null),r})));a.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?a[t]:(a.ctx||{})[t]:null},a.setCtx=function(t,n){if(t)if(t===e.ParentContextKey)a[t]||(a.isChildEvt=function(){return!0}),a[t]=n;else if(t===e.ChildrenContextKey)a[t]=n;else{(a.ctx=a.ctx||{})[t]=n}},a.complete=function(){var t=0,i=a.getCtx(e.ChildrenContextKey);if(Te.isArray(i))for(var r=0;r<i.length;r++){var s=i[r];s&&(t+=s.time)}a.time=Te.dateNow()-a.start,a.exTime=a.time-t,a.complete=function(){},!o&&Te.isFunction(n)&&(a.payload=n())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),_e=function(){function e(t){this.ctx={},B(e,this,(function(e){e.create=function(e,t,n){return new Ee(e,t,n)},e.fire=function(e){e&&(e.complete(),t&&t.perfEvent(e))},e.setCtx=function(t,n){t&&((e.ctx=e.ctx||{})[t]=n)},e.getCtx=function(t){return(e.ctx||{})[t]}}))}return e.prototype.create=function(e,t,n){return null},e.prototype.fire=function(e){},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e}();function Ce(e,t,n,i,r){if(e){var a=e;if(a&&Te.isFunction(a.getPerfMgr)&&(a=a.getPerfMgr()),a){var o=void 0,s=a.getCtx("CoreUtils.doPerf");try{if(o=a.create(t(),i,r)){if(s&&o.setCtx&&(o.setCtx(Ee.ParentContextKey,s),s.getCtx&&s.setCtx)){var c=s.getCtx(Ee.ChildrenContextKey);c||(c=[],s.setCtx(Ee.ChildrenContextKey,c)),c.push(o)}return a.setCtx("CoreUtils.doPerf",o),n(o)}}catch(e){o&&o.setCtx&&o.setCtx("exception",e)}finally{o&&a.fire(o),a.setCtx("CoreUtils.doPerf",s)}}}return n()}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(ye||(ye={}));var Oe={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103};function we(e){return e?'"'+e.replace(/\"/g,"")+'"':""}var xe=function(){function e(e,t,n,i){void 0===n&&(n=!1);this.messageId=e,this.message=(n?"AI: ":"AI (Internal): ")+e;var r="";ne()&&(r=(ne()?JSON||Q("JSON"):null).stringify(i));var a=(t?" message:"+we(t):"")+(i?" props:"+we(r):"");this.message+=a}return e.dataType="MessageData",e}(),Ie=function(){function e(t){this.identifier="DiagnosticLogger",this.queue=[];var n=0,i={};B(e,this,(function(e){var r=Te.isNullOrUndefined,a=Te.isUndefined,o=Te.isFunction;function s(e,n){var i=t[e];return r(i)?n:i}r(t)&&(t={}),e.consoleLoggingLevel=function(){return s("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return s("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return s("maxMessageLimit",25)},e.enableDebugExceptions=function(){return s("enableDebugExceptions",!1)},e.throwInternal=function(t,n,r,o,s){void 0===s&&(s=!1);var c=new xe(n,r,s,o);if(e.enableDebugExceptions())throw c;if(!a(c)&&c&&!a(c.message)){if(s){var l=+c.messageId;!i[l]&&e.consoleLoggingLevel()>=ye.WARNING&&(e.warnToConsole(c.message),i[l]=!0)}else e.consoleLoggingLevel()>=ye.WARNING&&e.warnToConsole(c.message);e.logInternalMessage(t,c)}},e.warnToConsole=function(e){var t="undefined"!=typeof console?console:Q("console");if(t){var n="log";t.warn&&(n="warn"),o(t[n])&&t[n](e)}},e.resetInternalMessageCount=function(){n=0,i={}},e.logInternalMessage=function(t,r){if(!(n>=e.maxInternalMessageLimit())){var a=!0,o="AITR_"+r.messageId;if(i[o]?a=!1:i[o]=!0,a&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(r),n++),n===e.maxInternalMessageLimit())){var s="Internal events throttle limit per PageView reached for this app.",c=new xe(Oe.MessageLimitPerPVExceeded,s,!1);e.queue.push(c),e.warnToConsole(s)}}}}))}return e.prototype.enableDebugExceptions=function(){return!1},e.prototype.consoleLoggingLevel=function(){return 0},e.prototype.telemetryLoggingLevel=function(){return 1},e.prototype.maxInternalMessageLimit=function(){return 25},e.prototype.throwInternal=function(e,t,n,i,r){void 0===r&&(r=!1)},e.prototype.warnToConsole=function(e){},e.prototype.resetInternalMessageCount=function(){},e.prototype.logInternalMessage=function(e,t){},e}(),Pe=Te.isFunction,ke=function(e,t){var n=this,i=null,r=Pe(e.processTelemetry),a=Pe(e.setNextPlugin);n._hasRun=!1,n.getPlugin=function(){return e},n.getNext=function(){return i},n.setNext=function(e){i=e},n.processTelemetry=function(o,s){s||(s=t);var c=e?e.identifier:"TelemetryPluginChain";Ce(s?s.core():null,(function(){return c+":processTelemetry"}),(function(){if(e&&r){n._hasRun=!0;try{s.setNext(i),a&&e.setNextPlugin(i),i&&(i._hasRun=!1),e.processTelemetry(o,s)}catch(n){var t=i&&i._hasRun;i&&t||s.diagLog().throwInternal(ye.CRITICAL,Oe.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+n),i&&!t&&i.processTelemetry(o,s)}}else i&&(n._hasRun=!0,i.processTelemetry(o,s))}),(function(){return{item:o}}),!o.sync)}},Ne=Te.isNullOrUndefined;function Me(e,t){var n=[];if(e&&e.length>0)for(var i=null,r=0;r<e.length;r++){var a=e[r];if(a&&Te.isFunction(a.processTelemetry)){var o=new ke(a,t);n.push(o),i&&i.setNext(o),i=o}}return n.length>0?n[0]:null}var Fe=function e(t,n,i,r){var a=this,o=null;null!==r&&(t&&Te.isFunction(t.getPlugin)?o=function(e,t,n){var i=[],r=!n;if(e)for(;e;){var a=e.getPlugin();(r||a===n)&&(r=!0,i.push(a)),e=e.getNext()}return r||i.push(n),Me(i,t)}(t,a,r||t.getPlugin()):r?o=function(e,t,n){var i=e,r=!1;return n&&e&&(i=[],Te.arrForEach(e,(function(e){(r||e===n)&&(r=!0,i.push(e))}))),n&&!r&&(i||(i=[]),i.push(n)),Me(i,t)}(t,a,r):Te.isUndefined(r)&&(o=Me(t,a))),a.core=function(){return i},a.diagLog=function(){var e=(i||{}).logger;return e||(e=new Ie(n||{})),e},a.getCfg=function(){return n},a.getExtCfg=function(e,t){var i;if(void 0===t&&(t={}),n){var r=n.extensionConfig;r&&e&&(i=r[e])}return i||t},a.getConfig=function(e,t,i){var r;void 0===i&&(i=!1);var o=a.getExtCfg(e,null);return o&&!Ne(o[t])?r=o[t]:n&&!Ne(n[t])&&(r=n[t]),Ne(r)?i:r},a.hasNext=function(){return null!=o},a.getNext=function(){return o},a.setNext=function(e){o=e},a.processNext=function(e){var t=o;t&&(o=t.getNext(),t.processTelemetry(e,a))},a.createNew=function(t,r){return void 0===t&&(t=null),new e(t||o,n,i,r)}},De=Te.isFunction,Ae=function(){function e(){var e=this,t=!1,n=null,i=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){i=e},e.processNext=function(e,t){t?t.processNext(e):i&&De(i.processTelemetry)&&i.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var r=t;if(!r){var a=n||new Fe(null,{},e.core);r=i&&i.getPlugin?a.createNew(null,i.getPlugin):a.createNew(null,i)}return r},e._baseTelInit=function(r,a,o,s){r&&(r.extensionConfig=r.extensionConfig||[]),!s&&a&&(s=a.getProcessTelContext().getNext());var c=i;i&&i.getPlugin&&(c=i.getPlugin()),e.core=a,n=new Fe(s,r,a,c),t=!0}}return e.prototype.initialize=function(e,t,n,i){this._baseTelInit(e,t,n,i)},e}(),Le=Te.isFunction;function Ue(e,t){for(var n=[],i=null,r=e.getNext();r;){var a=r.getPlugin();a&&(i&&Le(i.setNextPlugin)&&Le(a.processTelemetry)&&i.setNextPlugin(a),Le(a.isInitialized)&&a.isInitialized()||n.push(a),i=a,r=r.getNext())}Te.arrForEach(n,(function(n){n.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function We(e){return e.sort((function(e,t){var n=0,i=Le(t.processTelemetry);return Le(e.processTelemetry)?n=i?e.priority-t.priority:1:i&&(n=-1),n}))}var Re=Te.objDefineAccessors,Be=function(e){function t(){var n=e.call(this)||this;n.identifier="ChannelControllerPlugin",n.priority=500;var i,r=Te.arrForEach;function a(e){e&&e.length>0&&(function(e){r(e,(function(e){if(e.priority<500)throw Error("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),i.push(e))}return B(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){i&&r(i,(function(i){i.length>0&&n._getTelCtx(t).createNew(i).processNext(e)}))},e.getChannelControls=function(){return i},e.initialize=function(n,o,s){e.isInitialized()||(t.initialize(n,o,s),n.isCookieUseDisabled&&Te.disableCookies(),function(e,t){i=[],e&&r(e,(function(e){return a(e)}));if(t){var n=[];r(t,(function(e){e.priority>500&&n.push(e)})),a(n)}}((n||{}).channels,s),r(i,(function(e){return Ue(new Fe(e,n,o),s)})))}})),n}return __extends(t,e),t.prototype.processTelemetry=function(e,t){},t.prototype.getChannelControls=function(){return null},t.prototype.initialize=function(e,t,n){},t._staticInit=(Re(t.prototype,"ChannelControls",t.prototype.getChannelControls),void Re(t.prototype,"channelQueue",t.prototype.getChannelControls)),t}(Ae),Ve=Te.arrForEach,He=Te.isNullOrUndefined,ze=function(){function e(){var t,n,i,r,a=!1;B(e,this,(function(e){e._extensions=new Array,n=new Be,e.logger=Te.objCreate({throwInternal:function(e,t,n,i,r){void 0===r&&(r=!1)},warnToConsole:function(e){},resetInternalMessageCount:function(){}}),t=[],e.isInitialized=function(){return a},e.initialize=function(t,r,o,s){if(e.isInitialized())throw Error("Core should not be initialized more than once");if(!t||He(t.instrumentationKey))throw Error("Please provide instrumentation key");i=s,e._notificationManager=s,e.config=t||{},t.extensions=He(t.extensions)?[]:t.extensions,(t.extensionConfig=He(t.extensionConfig)?{}:t.extensionConfig).NotificationManager=s,o&&(e.logger=o);var c=[];c.push.apply(c,r.concat(t.extensions)),c=We(c);var l=[],u=[],d={};if(Ve(c,(function(e){if(He(e)||He(e.initialize))throw Error("Extensions must provide callback to initialize");var t=e.priority,i=e.identifier;e&&t&&(He(d[t])?d[t]=i:o.warnToConsole("Two extensions have same priority #"+t+" - "+d[t]+", "+i)),!t||t<n.priority?l.push(e):u.push(e)})),c.push(n),l.push(n),c=We(c),e._extensions=c,Ue(new Fe([n],t,e),c),Ue(new Fe(l,t,e),c),e._extensions=l,0===e.getTransmissionControls().length)throw new Error("No channels available");a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return n.getChannelControls()},e.track=function(n){n.iKey||(n.iKey=e.config.instrumentationKey),n.time||(n.time=Te.toISOString(new Date)),He(n.ver)&&(n.ver="4.0"),e.isInitialized()?e.getProcessTelContext().processNext(n):t.push(n)},e.getProcessTelContext=function(){var t=e._extensions,i=t;return t&&0!==t.length||(i=[n]),new Fe(i,e.config,e)},e.getNotifyMgr=function(){return i||(i=Te.objCreate({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=i),i},e.getPerfMgr=function(){return r||e.config&&e.config.enablePerfMgr&&(r=new _e(e.getNotifyMgr())),r},e.setPerfMgr=function(e){r=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(Ve(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))}return e.prototype.initialize=function(e,t,n,i){},e.prototype.getTransmissionControls=function(){return null},e.prototype.track=function(e){},e.prototype.getProcessTelContext=function(){return null},e.prototype.getNotifyMgr=function(){return null},e.prototype.getPerfMgr=function(){return null},e.prototype.setPerfMgr=function(e){},e.prototype.eventCnt=function(){return 0},e.prototype.releaseQueue=function(){},e}(),qe=0,je=1,Ke=2,Je=4,Ge=5,Qe=function(){function e(t){this.listeners=[];var n=Te.arrForEach,i=!!(t||{}).perfEvtsSendAll;B(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var n=Te.arrIndexOf(e.listeners,t);n>-1;)e.listeners.splice(n,1),n=Te.arrIndexOf(e.listeners,t)},e.eventsSent=function(t){n(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,i){n(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,i)}),0)}))},e.eventsSendRequest=function(t,i){n(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(i)setTimeout((function(){return e.eventsSendRequest(t,i)}),0);else try{e.eventsSendRequest(t,i)}catch(e){}}))},e.perfEvent=function(t){t&&(!i&&t.isChildEvt()||n(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))}return e.prototype.addNotificationListener=function(e){},e.prototype.removeNotificationListener=function(e){},e.prototype.eventsSent=function(e){},e.prototype.eventsDiscarded=function(e,t){},e.prototype.eventsSendRequest=function(e,t){},e}(),Xe=function(e){function t(){var n=e.call(this)||this;return B(t,n,(function(e,t){function n(t){var n=e.getNotifyMgr();n&&n.eventsDiscarded([t],Ke)}e.initialize=function(e,n,i,r){t.initialize(e,n,i||new Ie(e),r||new Qe(e))},e.track=function(i){Ce(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){if(null===i)throw n(i),Error("Invalid telemetry item");!function(e){if(Te.isNullOrUndefined(e.name))throw n(e),Error("telemetry name required")}(i),t.track(i)}),(function(){return{item:i}}),!i.sync)},e.addNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.addNotificationListener(t)},e.removeNotificationListener=function(t){var n=e.getNotifyMgr();n&&n.removeNotificationListener(t)},e.pollInternalLogs=function(t){var n=e.config.diagnosticLogInterval;return n&&n>0||(n=1e4),setInterval((function(){var n=e.logger?e.logger.queue:[];Te.arrForEach(n,(function(n){var i={name:t||"InternalMessageId: "+n.messageId,iKey:e.config.instrumentationKey,time:Te.toISOString(new Date),baseType:xe.dataType,baseData:{message:n.message}};e.track(i)})),n.length=0}),n)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,i){},t.prototype.track=function(e){},t.prototype.addNotificationListener=function(e){},t.prototype.removeNotificationListener=function(e){},t.prototype.pollInternalLogs=function(e){return 0},t}(ze),Ze=1,$e=2,Ye=3,et={Unspecified:0,String:1,Int32:2,UInt32:3,Int64:4,UInt64:5,Double:6,Bool:7,Guid:8,DateTime:9},tt=__assign({},Oe,{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519}),nt=et,it=null;var rt=Te.isUndefined,at=Te.isNullOrUndefined;function ot(e){return!rt(e)}Te.hasOwnProperty;var st,ct=null,lt=Te.arrForEach,ut=(Te.arrIndexOf,Te.arrMap,Te.arrReduce,Te.objKeys),dt=(Te.toISOString,function(){var e=ee();return!(!e||!e.product)&&"ReactNative"===e.product}),ft=Te.isString,pt=Te.isNumber,vt=Te.isBoolean,gt=(Te.isFunction,Te.isArray),ht=(Te.isObject,Te.strTrim),mt=(Boolean($()),Boolean(Z()));function yt(e){return!(at(e)||""===e)}function Tt(){return null===ct&&(ct=Y()&&Boolean(ee().sendBeacon)),ct}function St(e,t,n){if(!ft(e)||at(t)||""===t)return null;if(ft(t)||pt(t)||vt(t)||gt(t))t={value:t};else if("object"!=typeof t||t.hasOwnProperty("value")){if(at(t.value)||""===t.value||!ft(t.value)&&!pt(t.value)&&!vt(t.value)&&!gt(t.value))return null}else t={value:n?JSON.stringify(t):t};if(gt(t.value)&&!(t.value.length>0))return null;if(ot(t.kind)){if(gt(t.value)||!function(e){if(pt(e)&&(e>=0&&e<=13||32===e))return!0;return!1}(t.kind))return null;t.value=t.value.toString()}return t}function bt(e,t,n){var i=-1;return rt(e)?i:(t&&t>0&&(32===t?i=1<<13:t<=13&&(i=t<<5)),ot(n)&&function(e){if(pt(e)&&e>=0&&e<=9)return!0;return!1}(n)?(-1===i&&(i=0),i|n):(gt(e)&&(e=e[0]),-1!==i?i|function(e){if(rt(e))return-1;if(pt(e))return nt.Double;if(ft(e))return nt.String;if(vt(e))return nt.Bool;return-1}(e):pt(e)?nt.Double:i))}function Et(){if(void 0===st){st=!1;try{var e=$(),t=ee();e&&!rt(e.cookie)&&t&&t.cookieEnabled&&(st=!0)}catch(e){}}return st}function _t(e,t,n){if(Et()){var i="",r=te();r&&"https:"===r.protocol&&(i=";secure",null===it&&(it=function(e){return!!ft(e)&&(-1!==e.indexOf("CPU iPhone OS 12")||-1!==e.indexOf("iPad; CPU OS 12")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&-1!==e.indexOf("Version/")&&-1!==e.indexOf("Safari")||(-1!==e.indexOf("Macintosh; Intel Mac OS X 10_14")&&(n="AppleWebKit/605.1.15 (KHTML, like Gecko)",i=(t=e).length,r=i-n.length,t.substring(r>=0?r:0,i)===n)||(-1!==e.indexOf("Chrome/5")||-1!==e.indexOf("Chrome/6")||(-1!==e.indexOf("UnrealEngine")&&-1===e.indexOf("Chrome")||(-1!==e.indexOf("UCBrowser/12")||-1!==e.indexOf("UCBrowser/11")))))));var t,n,i,r}((ee()||{}).userAgent)),it||(t+=";SameSite=None"));var a=new Date;a.setTime(a.getTime()+24*n*60*60*1e3);var o="; expires="+a.toUTCString();$().cookie=e+"="+t+o+"; path=/"+i}}var Ct=Te.perfNow;function Ot(e){return e<10?"0"+e:e.toString()}function wt(e,t){var n=e;n.timings=n.timings||{},n.timings.processTelemetryStart=n.timings.processTelemetryStart||{},n.timings.processTelemetryStart[t]=Ct()}var xt=Te.addEventHandler,It=function(e){function t(){var n=e.call(this)||this;return n.pluginVersionStringArr=[],n.pluginVersionString="",B(t,n,(function(e,t){e.initialize=function(n,i,r,a){Ce(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(n){n.endpointUrl||(n.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var o=n.propertyStorageOverride;if(o&&(!o.getProperty||!o.setProperty))throw"Invalid property storage override passed.";n.channels&&lt(n.channels,(function(t){t&&lt(t,(function(t){if(t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},i&&lt(i,(function(t){if(t&&t.identifier&&t.version){var n=t.identifier+"="+t.version;e.pluginVersionStringArr.push(n)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{t.initialize(n,i,r,a)}catch(t){e.logger.throwInternal(ye.CRITICAL,tt.ErrorProvidedChannels,"Channels must be provided through config.channels only")}e.pollInternalLogs("InternalLog")}),(function(){return{config:n,extensions:i,logger:r,notificationManager:a}}))},e.track=function(n){Ce(e,(function(){return"AppInsightsCore.track"}),(function(){var i,r=n;if(r){r.timings=r.timings||{},r.timings.trackStart=Ct(),(i=r.latency)&&pt(i)&&i>=1&&i<=3||(r.latency=Ze);var a=r.ext=r.ext||{};a.sdk=a.sdk||{},a.sdk.ver="1DS-Web-JS-2.4.6";var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var s=o.properties;s.version||(s.version=""),""!=e.pluginVersionString&&(s.version=e.pluginVersionString)}t.track(r)}),(function(){return{item:n}}),!n.sync)}})),n}return __extends(t,e),t.prototype.initialize=function(e,t,n,i){},t.prototype.track=function(e){},t}(Xe),Pt=function(){function e(t,n){var i=n?[].concat(n):[],r=Te.isNullOrUndefined;B(e,this,(function(n){n.iKey=function(){return t},n.count=function(){return i.length},n.events=function(){return i},n.addEvents=function(e,t){return void 0===t&&(t=!0),e&&e.length>0?(i=t?i.concat(e):e.concat(i),e.length):0},n.split=function(n,a){var o=new e(t);if(n<i.length){var s=i.length-n;r(a)||(s=a<s?a:s),o.addEvents(i.splice(n,s))}return o}}))}return e.create=function(t,n){return new e(t,n)},e}(),kt=Math.min(2e6,65e3),Nt=function e(t){B(e,this,(function(e){e.createPayload=function(e,t,n,i){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],batches:[],numEvents:0,retryCnt:e,isTeardown:t,isSync:n,isBeacon:i}},e.appendPayload=function(n,i,r){var a=n&&i&&!n.overflow;return a&&Ce(t,(function(){return"Serializer:appendPayload"}),(function(){for(var t=i.events(),a=n.payloadBlob,o=n.numEvents,s=!1,c=[],l=n.isBeacon,u=l?65e3:3984588,d=l?kt:2e6,f=0;f<t.length;){var p=t[f];if(p){if(o>=r){n.overflow=i.split(f);break}var v=e.getEventBlob(p);if(v.length<=d){var g=v.length;if(a.length+g>u){n.overflow=i.split(f);break}a&&(a+="\n"),a+=v,s=!0,o++}else c.concat(t.slice(f,1))}f++}if(c&&c.length>0&&n.sizeExceed.push(Pt.create(i.iKey(),c)),s){n.batches.push(i),n.payloadBlob=a,n.numEvents=o;var h=i.iKey();-1===Te.arrIndexOf(n.apiKeys,h)&&n.apiKeys.push(h)}}),(function(){return{payload:n,theBatch:{iKey:i.iKey(),evts:i.events()},max:r}})),a},e.getEventBlob=function(e){return Ce(t,(function(){return"Serializer.getEventBlob"}),(function(){var t={};return t.name=e.name,t.time=e.time,t.ver=e.ver,t.iKey="o:"+function(e){if(e){var t=e.indexOf("-");if(t>-1)return e.substring(0,t)}return""}(e.iKey),e.ext&&(t.ext={},lt(ut(e.ext),(function(n){t.ext[n]={},lt(ut(e.ext[n]),(function(i){yt(e.ext[n][i])&&(t.ext[n][i]=St(i,e.ext[n][i]).value)}))}))),t.data={},t.data.baseData={},t.data.baseType=e.baseType,e.baseData&&lt(ut(e.baseData),(function(n){var i=St(n,e.baseData[n]);Mt(t.data.baseData,n,i),Ft(t.ext,"baseData."+n,i)})),e.data&&lt(ut(e.data),(function(n){var i=St(n,e.data[n]);Mt(t.data,n,i),Ft(t.ext,n,i)})),JSON.stringify(t)}),(function(){return{item:e}}))}}))};function Mt(e,t,n){if(n){for(var i=e,r=t.split("."),a=0;a<r.length-1;++a)i[r[a]]||(i[r[a]]={}),i=i[r[a]];i[r[r.length-1]]=n.value}}function Ft(e,t,n){if(n){var i=bt(n.value,n.kind,n.propertyType);if(i>-1){var r=e;r.metadata||(r.metadata={}),r.metadata.f||(r.metadata.f={}),r=r.metadata.f;for(var a=t.split("."),o=0;o<a.length-1;++o)r[a[o]]||(r[a[o]]={f:{}}),r=r[a[o]].f;gt(n.value)?r[a[a.length-1]]={a:{t:i}}:r[a[a.length-1]]={t:i}}}}
/*!
 * 1DS JS SDK POST plugin, 2.4.6
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */var Dt=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!==e&&429!==e||501===e||505===e)},e.getMillisToBackoffForRetry=function(e){var t,n=Math.floor(1200*Math.random())+2400;return t=Math.pow(2,e)*n,Math.min(t,6e5)},e}(),At=function e(){var t={};B(e,this,(function(e){e.setKillSwitchTenants=function(e,n){if(e&&n)try{var i=(o=e.split(","),s=[],o&&lt(o,(function(e){s.push(ht(e))})),s);if("this-request-only"===n)return i;for(var r=1e3*parseInt(n,10),a=0;a<i.length;++a)t[i[a]]=Te.dateNow()+r}catch(e){return[]}var o,s;return[]},e.isTenantKilled=function(e){var n=t,i=ht(e);return void 0!==n[i]&&n[i]>Te.dateNow()||(delete n[i],!1)}}))},Lt=function e(){var t=!0,n=!0,i=!0,r="use-collector-delta",a=!1;B(e,this,(function(e){e.allowRequestSending=function(){return t},e.firstRequestSent=function(){i&&(i=!1,a||(t=!1))},e.shouldAddClockSkewHeaders=function(){return n},e.getClockSkewHeaderValue=function(){return r},e.setClockSkew=function(e){a||(e?(r=e,n=!0,a=!0):n=!1,t=!0)}}))},Ut=((Rt={})[1]="requeue",Rt[100]="requeue",Rt[200]="sent",Rt[8004]="drop",Rt[8003]="drop",Rt);function Wt(e){try{return e.responseText}catch(e){}return""}var Rt,Bt,Vt,Ht,zt,qt,jt,Kt=function e(t,n,i,r){this._responseHandlers=[];var a,o,s,c="?cors=true&content-type=application/x-json-stream&client-id=NO_AUTH&client-version=1DS-Web-JS-2.4.6",l=new At,u=!1,d=new Lt,f=!1,p=0,v=!0,g=[],h={},m=[],y=null,T=!0;B(e,this,(function(e){var S=!0;function b(e,t){var n=new XDomainRequest;n.open("POST",e.urlString),n.onload=function(){var e=Wt(n);C(t,200,{},e),L(e)},n.onerror=function(){C(t,400,{})},n.ontimeout=function(){C(t,500,{})},n.send(e.data)}function E(e,t){var n;fetch(e.urlString,(n={body:e.data,method:"POST",credentials:"include"},n.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,n.headers=e.headers,n)).then((function(e){var n={},i="";e.headers&&e.headers.forEach((function(e,t){n[t]=e})),e.body&&e.text().then((function(e){i=e})),C(t,e.status,n,i),L(i)})).catch((function(e){C(t,0,{})}))}function _(e,t,n){function i(e,t,n){if(!e[n]&&t&&t.getResponseHeader){var i=t.getResponseHeader(n);i&&(e[n]=ht(i))}return e}function r(e){var t={};return e.getAllResponseHeaders?t=function(e){var t={};if(ft(e)){var n=ht(e).split(/[\r\n]+/);lt(n,(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var i=ht(e.substring(0,n)).toLowerCase(),r=ht(e.substring(n+1));t[i]=r}else t[ht(e)]=1}}))}return t}(e.getAllResponseHeaders()):(t=i(t,e,"time-delta-millis"),t=i(t,e,"kill-duration"),t=i(t,e,"kill-duration-seconds")),t}function a(e,n){C(t,e.status,r(e),n)}var o=new XMLHttpRequest;try{o.Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0}catch(e){}S&&(o.withCredentials=!0),o.open("POST",e.urlString,!n),lt(ut(e.headers),(function(t){o.setRequestHeader(t,e.headers[t])})),o.onload=function(){var e=Wt(o);a(o,e),L(e)},o.onerror=function(){a(o)},o.ontimeout=function(){a(o)},o.send(e.data)}function C(e,t,n,i){try{e(t,n,i)}catch(e){a.diagLog().throwInternal(ye.WARNING,tt.SendPostOnCompleteFailure,e)}}function O(){return!u&&p<n}function w(){var e=m;return m=[],e}function x(e,t,n){var i=!1;return e&&e.length>0&&!u&&o&&y&&(i=t||O()&&(n>0||d.allowRequestSending())),i}function I(e){var t={};return e&&lt(e,(function(e,n){t[n]={iKey:e.iKey(),evts:e.events()}})),t}function P(e,n,i,r,a,o){if(e&&0!==e.length)if(u)U(e,1,r);else{var c=e;Ce(s,(function(){return"HttpManager:_sendBatches"}),(function(s){s&&(e=e.slice(0));for(var c=[],u=null,d=Ct();x(e,r,n);){var f=e.shift();f&&f.count()>0&&(l.isTenantKilled(f.iKey())?c.push(f):(u=u||y.createPayload(n,i,r,o&&N()),y.appendPayload(u,f,t)?null!==u.overflow&&(e=[u.overflow].concat(e),u.overflow=null,F(u,d,Ct(),a),d=Ct(),u=null):(F(u,d,Ct(),a),d=Ct(),e=[f].concat(e),u=null)))}u&&F(u,d,Ct(),a),e.length>0&&(m=e.concat(m)),U(c,8004,r)}),(function(){return{batches:I(c),retryCount:n,isTeardown:i,isSynchronous:r,sendReason:a,useSendBeacon:o}}),!r)}}function k(e){var t=c,n="";lt(e.apiKeys,(function(e){n.length>0&&(n+=","),n+=e})),n.length>0&&(t+="&apikey="+n),t+="&upload-time="+Te.dateNow().toString();var i=function(e){for(var t=0;t<e.batches.length;t++)for(var n=e.batches[t].events(),i=0;i<n.length;i++){var r=(n[i].ext||{}).intweb||{};if(yt(r.msfpc))return encodeURIComponent(r.msfpc)}return""}(e);if(yt(i)&&(t=t+"&ext.intweb.msfpc="+i),d.shouldAddClockSkewHeaders()&&(t+="&time-delta-to-apply-millis="+d.getClockSkewHeaderValue()),s.getWParam){var r=s.getWParam();r>=0&&(t+="&w="+r)}for(var a=0;a<g.length;a++)t+="&"+g[a].name+"="+g[a].value;return t}function N(){return!v&&f&&Tt()}function M(e,t,n){e[t]=e[t]||{},e[t][a.identifier]=n}function F(t,n,r,c){if(t&&t.payloadBlob&&t.payloadBlob.length>0){var u=k(t),f=Ct();Ce(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){lt(t.batches,(function(e){lt(e.events(),(function(e){if(T){var t=e.timings=e.timings||{};M(t,"sendEventStart",f),M(t,"serializationStart",n),M(t,"serializationCompleted",r)}e.sendAttempt>0?e.sendAttempt++:e.sendAttempt=1}))})),U(t.batches,1e3+(c||0),t.isSync,!0);var v={data:t.payloadBlob,urlString:u,headers:h};t.payloadBlob=null;var g=null,m=!!e.sendHook;N()&&t.isBeacon?(m=!1,g=function(n){!function(e,t,n){try{if(Tt()){var i=ee();if(i.sendBeacon(e.urlString,e.data))return void D(t,200,n,!1);lt(t.batches,(function(e){null.push(e.split(0))})),D(t,200,n,!1),U(null,8003,t.isSync,!0)}}catch(e){a.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e)}}(n,t,c),e.sendListener&&e.sendListener(v,n,t.isSync||t.isTeardown,!0)}):o&&(g=function(n){d.firstRequestSent();var r=function(e,n){!function(e,t,n,r){var a=9e3,o=null,s=!1,c=!1;try{var u=!0;if(void 0!==e){if(t){d.setClockSkew(t["time-delta-millis"]);var f=t["kill-duration"]||t["kill-duration-seconds"];lt(l.setKillSwitchTenants(t["kill-tokens"],f),(function(e){lt(n.batches,(function(t){if(t.iKey()===e){o=o||[];var i=t.split(0);n.numEvents-=i.count(),o.push(i)}}))}))}if(200===e)return void(a=200);(!Dt.shouldRetryForStatus(e)||n.numEvents<=0)&&(u=!1),a=9e3+e%1e3}if(u){a=100;var v=n.retryCnt;n.isSync||(v<i?(s=!0,A((function(){n.isSync||p--,P(n.batches,v+1,n.isTeardown,n.isSync,5,n.isBeacon)}),!0,Dt.getMillisToBackoffForRetry(v))):c=!0)}}finally{s||(d.setClockSkew(),D(n,a,r,c)),U(o,8004,n.isSync)}}(e,n,t,c)};try{o.sendPOST(n,r,t.isTeardown||t.isSync),e.sendListener&&e.sendListener(v,n,t.isSync||t.isTeardown,!1)}catch(e){C(r,0,{})}}),Ce(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(g)if(t.isSync||p++,m){var n={data:v.data,urlString:v.urlString,headers:v.headers},i=!1;Ce(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(n,(function(e){i=!0,g(e)}),t.isSync||t.isTeardown)}catch(e){i||g(v)}}))}else g(v)})),U(t.sizeExceed,8003,t.isSync)}),(function(){return{thePayload:t,serializationStart:n,serializationCompleted:r,sendReason:c}}),t.isSync)}}function D(t,n,i,r){try{r&&a._backOffTransmission(),200===n&&(r||t.isSync||a._clearBackOff(),function(e){if(T){var t=Ct();lt(e,(function(e){var n,i;e&&e.count()>0&&(n=e.events(),i=t,T&&lt(n,(function(e){M(e.timings=e.timings||{},"sendEventCompleted",i)})))}))}}(t.batches)),U(t.batches,n,t.isSync,!0)}finally{t.isSync||(p--,5!==i&&e.sendQueuedRequests(i,!t.isSync,t.isBeacon))}}function A(e,t,n){t?e():a._setTimeoutOverride(e,n)}function L(t){var n=e._responseHandlers;try{for(var i=0;i<n.length;i++)try{n[i](t)}catch(e){a.diagLog().throwInternal(ye.CRITICAL,tt.PostResponseHandler,"Response handler failed: "+e)}if(t){var r=JSON.parse(t);yt(r.webResult)&&yt(r.webResult.msfpc)&&_t("MSFPC",r.webResult.msfpc,365)}}catch(e){}}function U(e,t,n,i){if(e&&e.length>0&&r){var o=r[(c=t,l=Ut[c],yt(l)||(l="oth",c>=9e3&&c<=9999?l="rspFail":c>=8e3&&c<=8999?l="drop":c>=1e3&&c<=1999&&(l="send")),l)];o&&Ce(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){A((function(){try{o.call(r,e,t,n)}catch(e){a.diagLog().throwInternal(ye.CRITICAL,tt.NotificationException,"send request notification failed: "+e)}}),i||n,0)}),(function(){return{batches:I(e),reason:t,isSync:n,sendSync:i}}),!n)}var c,l}e.initialize=function(e,t,n,i){if(c=e+c,T=!(s=t).config.disableEventTimings,a=n,y=new Nt(t),!(o=i)){v=!1,f=!dt();var r=te();r&&r.protocol&&"file:"===r.protocol.toLowerCase()&&(S=!1);var l=null;!function(){if(void 0!==typeof XMLHttpRequest){var e=Q("XMLHttpRequest");if(e){var t=new e;return Boolean(rt(t.withCredentials)&&void 0!==typeof XDomainRequest)}}}()?dt()?l=E:"undefined"!=typeof XMLHttpRequest&&(l=_):l=b,o={sendPOST:l}}},e._getDbgPlgTargets=function(){return[o,l,y]},e.addQueryStringParameter=function(e,t){for(var n=0;n<g.length;n++)if(g[n].name===e)return void(g[n].value=t);g.push({name:e,value:t})},e.addHeader=function(e,t){h[e]=t},e.canSendRequest=function(){return O()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,t,n){var i=!Te.isNullOrUndefined(t)&&!t;x(m,i,0)&&P(w(),0,!1,i,e||0,!!n)},e.isCompletelyIdle=function(){return!u&&0===p&&0===m.length},e.addBatch=function(e){if(e&&e.count()>0){if(l.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&P(w(),0,!0,!0,2,!0)},e.pause=function(){u=!0},e.resume=function(){u=!1,e.sendQueuedRequests(4,!1)},e.sendSynchronousBatch=function(e,t,n){e&&e.count()>0&&P([e],0,!1,!0,t||0,!!n)}}))},Jt=mt?window:void 0,Gt=function(e){function t(){var n,i=e.call(this)||this;i.identifier="PostChannel",i.priority=1011,i.version="2.4.6";var r,a,o,s,c,l=!1,u=[],d=null,f=!1,p=0,v=1e4,g={},h="REAL_TIME",m=null,y=0,T=0,S={},b=-1;return B(t,i,(function(e,t){function i(e,t){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=Ze),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,e.sync)if(y||f)e.latency=Ye,e.sync=!1;else if(a)return void a.sendSynchronousBatch(Pt.create(e.iKey,[e]),3);var n=!1;p<v?n=!k(e,t):(n=!0,function(e,t){var n=Ze;for(;n<=t;){var i=I(e,t,!0);if(i&&i.count()>0){var r=i.split(0,20);if(r.count()>0)return A("eventsDiscarded",[r],Ge),!0}n++}return!1}(e.iKey,e.latency)&&(n=!k(e,t))),n&&D("eventsDiscarded",[e],Ge)}function E(e,t,n,i){var r=N(e,t,n);return a.sendQueuedRequests(t,n,i),r}function _(){return p>0}function C(){b>=0&&N(b,c,!0)&&a.sendQueuedRequests(c,!0,!1);var e=g[h][1];!m&&!d&&e>=0&&!f&&(_()?m=O((function(){m=null,E(0===T?Ye:Ze,1,!0),T++,T%=2,C()}),e):T=0)}function O(t,n){0===n&&y&&(n=1);var i=1e3;return y&&(i=Dt.getMillisToBackoffForRetry(y-1)),e._setTimeoutOverride(t,n*i)}function w(){null!==m&&(e._clearTimeoutOverride(m),m=null,T=0)}function x(t,n){w(),d&&(e._clearTimeoutOverride(d),d=null),f||E(Ze,t,n,!0)}function I(e,t,n){var i=S[t];i||(i=S[t=Ze]);var r=i.iKeyMap[e];return!r&&n&&(r=Pt.create(e),i.batches.push(r),i.iKeyMap[e]=r),r}function P(t,n){a.canSendRequest()&&!y&&(o>0&&p>o&&(n=!0),n&&null==d&&e.flush(t,null,20))}function k(e,t){var n=I(e.iKey,e.latency,!0);return!!n.addEvents([e],t)&&(p++,t&&0===e.sendAttempt&&P(!e.sync,s>0&&n.count()>=s),!0)}function N(t,n,i){var r=!1;return!i||a.canSendRequest()?Ce(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],n=Ye;n>=t;){var i=S[n];i&&i.batches&&(lt(i.batches,(function(t){a.addBatch(t)?r=r||t&&t.count()>0:e=e.concat(t.events()),p-=t.count()})),i.batches=[],i.iKeyMap={}),n--}e.length>0&&D("eventsDiscarded",e,Je),r&&b>=t&&(b=-1,c=0)}),(function(){return{latency:t,sendReason:n}}),i):(b=b>=0?Math.min(b,t):t,c=Math.max(c,n)),r}function M(){(g={}).REAL_TIME=[2,1],g.NEAR_REAL_TIME=[6,3],g.BEST_EFFORT=[18,9]}function F(t,n){var i=e._notificationManager||{},r=i[t];if(r)try{r.apply(i,n)}catch(n){e.diagLog().throwInternal(ye.CRITICAL,tt.NotificationException,t+" notification failed: "+n)}}function D(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&F(e,[t].concat(n))}function A(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];t&&t.length>0&&lt(t,(function(t){t&&t.count()>0&&F(e,[t.events()].concat(n))}))}function L(){s=n&&n.disableAutoBatchFlushLimit?0:Math.max(1500,v/6)}M(),S[Ye]={batches:[],iKeyMap:{}},S[$e]={batches:[],iKeyMap:{}},S[Ze]={batches:[],iKeyMap:{}},L(),a=new Kt(500,2,1,{requeue:function(t,n){var r=[];lt(t,(function(t){t&&t.count()>0&&lt(t.events(),(function(t){t&&(t.sync&&(t.latency=Ye,t.sync=!1),t.sendAttempt<6?(wt(t,e.identifier),i(t,!1)):r.push(t))}))})),r.length>0&&D("eventsDiscarded",r,je)},send:function(e,t,n){e&&e.length>0&&F("eventsSendRequest",[t>=1e3&&t<=1999?t-1e3:0,!0!==n])},sent:function(e,t){A("eventsSent",e,t),C()},drop:function(e,t){A("eventsDiscarded",e,t>=8e3&&t<=8999?t-8e3:qe)},rspFail:function(e){A("eventsDiscarded",e,je),C()},oth:function(e,t){A("eventsDiscarded",e,qe),C()}}),e._getDbgPlgTargets=function(){return[a]},e.initialize=function(i,s,c){Ce(s,(function(){return"PostChannel:initialize"}),(function(){var l=s;t.initialize(i,s,c),e.setInitialized(!1);var u=e._getTelCtx();i.extensionConfig[e.identifier]=i.extensionConfig[e.identifier]||{},n=u.getExtCfg(e.identifier),e._setTimeoutOverride=n.setTimeoutOverride?n.setTimeoutOverride:setTimeout.bind(Jt),e._clearTimeoutOverride=n.clearTimeoutOverride?n.clearTimeoutOverride:clearTimeout.bind(Jt);var d=l.getWParam;l.getWParam=function(){var e=0;return n.ignoreMc1Ms0CookieProcessing&&(e|=2),e|d()},n.eventsLimitInMem>0&&(v=n.eventsLimitInMem),n.autoFlushEventsLimit>0&&(o=n.autoFlushEventsLimit),L(),n.httpXHROverride&&n.httpXHROverride.sendPOST&&(r=n.httpXHROverride),yt(i.anonCookieName)&&a.addQueryStringParameter("anoncknm",i.anonCookieName),a.sendHook=n.payloadPreprocessor,a.sendListener=n.payloadListener;var f,p,g=n.overrideEndpointUrl?n.overrideEndpointUrl:i.endpointUrl;e._notificationManager=i.extensionConfig.NotificationManager,a.initialize(g,e.core,e,r),p=xt("beforeunload",f=function(){x(2,!1)}),p=xt("unload",f)||p,p=xt("pagehide",f)||p,e.setInitialized(!0)}),(function(){return{coreConfig:i,core:s,extensions:c}}))},e.processTelemetry=function(t,r){wt(t,e.identifier);var a=(r=e._getTelCtx(r)).getExtCfg(e.identifier),o=!!n.disableTelemetry;a&&(o=o||!!a.disableTelemetry);var s=t;o||l||(n.overrideInstrumentationKey&&(s.iKey=n.overrideInstrumentationKey),a&&a.overrideInstrumentationKey&&(s.iKey=a.overrideInstrumentationKey),i(s,!0),C()),e.processNext(s,r)},e.setEventQueueLimits=function(e,t){v=e>0?e:1e4,o=t>0?t:0,L();var n=p>e;if(!n&&s>0)for(var i=Ze;!n&&i<=Ye;i++){var r=S[i];r&&r.batches&&lt(r.batches,(function(e){e&&e.count()>=s&&(n=!0)}))}P(!0,n)},e.teardown=function(){x(2,!1),l=!0,a.teardown()},e.pause=function(){w(),f=!0,a.pause()},e.resume=function(){f=!1,a.resume(),C()},e.addResponseHandler=function(e){a._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){w(),M(),h="REAL_TIME",C(),function(e,t){if(e&&pe(e))for(var n in e)fe(e,n)&&t.call(e,n,e[n])}(e,(function(e,t){if(t.length>=2){if(t.splice(0,t.length-2),t[1]<0&&(t[0]=-1),t[1]>0&&t[0]>0){var n=t[0]/t[1];t[0]=Math.ceil(n)*t[1]}g[e]=t}}))},e.flush=function(e,t,n){void 0===e&&(e=!0),f||(w(),n=n||1,e?(N(Ze,n,e),null==d?d=O((function(){!function e(t,n){E(Ze,n,!0),function e(t){a.isCompletelyIdle()?t():d=O((function(){e(t)}),.25)}((function(){t&&t(),u.length>0?d=O((function(){return e(u.shift(),n)}),0):(d=null,_()&&C())}))}(t,n)}),0):u.push(t)):(E(Ze,n,!1),null!=t&&t()))},e.setMsaAuthTicket=function(e){a.addHeader("AuthMsaDeviceTicket",e)},e.hasEvents=_,e._setTransmitProfile=function(e){h!==e&&void 0!==g[e]&&(w(),h=e,C())},e._backOffTransmission=function(){y<4&&(y++,w(),C())},e._clearBackOff=function(){y&&(y=0,w(),C())}})),i}return __extends(t,e),t}(Ae),Qt=(Bt=function(e,t){return(Bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Bt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),Xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Qt(t,e),t.prototype.initialize=function(t,n){this._postChannel=new Gt;var i=[];n&&(i=i.concat(n)),t.channels=[[this._postChannel]],t.extensionConfig=t.extensionConfig||[],t.extensionConfig[this._postChannel.identifier]=t.channelConfiguration?t.channelConfiguration:{};try{e.prototype.initialize.call(this,t,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},t.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var t=e/1e3,n=t/2,i={};i.OTelCustomTransmissionProfile=[t,n],this._postChannel._loadTransmitProfiles(i),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},t.prototype.connectNotificationListener=function(e){e&&this.addNotificationListener(e)},t.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},t.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},t}(It);!function(e){e[e.NotSet=0]="NotSet",e[e.Measure=1]="Measure",e[e.Diagnostics=2]="Diagnostics",e[e.CriticalBusinessImpact=191]="CriticalBusinessImpact",e[e.CriticalCensus=192]="CriticalCensus",e[e.CriticalExperimentation=193]="CriticalExperimentation",e[e.CriticalUsage=194]="CriticalUsage"}(Vt||(Vt={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(Ht||(Ht={})),function(e){e[e.NotSet=0]="NotSet",e[e.Normal=1]="Normal",e[e.High=2]="High"}(zt||(zt={})),function(e){e[e.NotSet=0]="NotSet",e[e.SoftwareSetup=1]="SoftwareSetup",e[e.ProductServiceUsage=2]="ProductServiceUsage",e[e.ProductServicePerformance=4]="ProductServicePerformance",e[e.DeviceConfiguration=8]="DeviceConfiguration",e[e.InkingTypingSpeech=16]="InkingTypingSpeech"}(qt||(qt={})),function(e){e[e.ReservedDoNotUse=0]="ReservedDoNotUse",e[e.BasicEvent=10]="BasicEvent",e[e.FullEvent=100]="FullEvent",e[e.NecessaryServiceDataEvent=110]="NecessaryServiceDataEvent",e[e.AlwaysOnNecessaryServiceDataEvent=120]="AlwaysOnNecessaryServiceDataEvent"}(jt||(jt={}));var Zt=function(){function e(){this._fullEventsEnabled=!1}return e.prototype.processEvent=function(e){if(!this._fullEventsEnabled&&!e.eventFlags)throw new Error(e.eventName+" missing Event Flags");var t=this._fullEventsEnabled||!!e.eventFlags&&(e.eventFlags.diagnosticLevel===jt.BasicEvent||e.eventFlags.diagnosticLevel===jt.NecessaryServiceDataEvent||e.eventFlags.diagnosticLevel===jt.AlwaysOnNecessaryServiceDataEvent);return t||y(l.Info,u.Sink,(function(){return"1DS Data Classification Failed to Send: "+e.eventName})),t},e.prototype.setFullEventsEnabled=function(e){this._fullEventsEnabled=e},e}();function $t(e){return e?new Date(e):new Date}function Yt(e,t,n){t&&t.forEach((function(t){if(!t.classification||t.classification===g.SystemMetadata||t.classification===g.EssentialServiceMetadata){var i,r;switch(i=n?"zC."===t.name.substr(0,3)?"zC.Data."+t.name.substr(3):"Data."+t.name:t.name,t.dataType){case p.Double:r=et.Double;break;case p.Int64:r=et.Int64;break;case p.Guid:r=et.Guid;break;case p.String:return void(e[i]="string"==typeof t.value?t.value.substr(0,25e3):t.value);case p.Boolean:default:return void(e[i]=t.value)}var a={value:t.value,propertyType:r};e[i]=a}}))}var en,tn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),nn=function(){return(nn=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},rn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.identifier="PartAPlugin",t.priority=3,t._properties={},t}return tn(t,e),t.prototype.initialize=function(t,n,i){e.prototype.initialize.call(this,t,n,i)},t.prototype.processTelemetry=function(e,t){e.data=nn(nn({},e.data),this._properties);var n=this._getTelCtx(t);this.processNext(e,n)},t.prototype.addDataFields=function(e){Yt(this._properties,e,!1)},t}(Ae),an=n(3);(en||(en={})).newGuid=function(){return Object(an.v4)()};var on=function(){function e(e,t,n){this.start=Date.now(),this.name=e,this.isAsync=!0===n,this.payload=t}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),sn=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,t,n){return"HttpManager:_sendBatches"===e||"HttpManager:_sendBatchesNotification"===e?new on(e,t,n):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case"HttpManager:_sendBatches":this.handleSendBatches(e);break;case"HttpManager:_sendBatchesNotification":this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,t){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var t=e.payload();if(t.batches&&t.reason&&t.reason>=1e3&&t.reason<=1999){var n=0;for(var i in t.batches)n+=t.batches[i].evts.length;this._callbacks.requestProcessingStats(0,n)}}},e}(),cn=function(){function e(e,t){if(this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this._persistentDataFields=[],this._preprocessors=[],this._partADataFieldsPlugin=new rn,t.trackOverride)this._trackOverride=t.trackOverride;else{if(!t||!t.endpointUrl)throw new Error("Missing Endpoint Url");var n=[this._partADataFieldsPlugin];t.plugins&&n.push.apply(n,t.plugins);var i={instrumentationKey:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",endpointUrl:t.endpointUrl,channelConfiguration:{eventsLimitInMem:t.eventsLimitInMem,httpXHROverride:t.httpXHROverride,setTimeoutOverride:t.setTimeoutOverride,clearTimeoutOverride:t.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0},disableCookiesUsage:!0};t.stats&&t.stats.networkStats&&i.channelConfiguration&&(i.channelConfiguration.payloadListener=function(e,n){var i,r=n||e;r.data&&(null===(i=t.stats)||void 0===i||i.networkStats(r.data.length))}),this._applicationInsights=new Xt,this._applicationInsights.initialize(i,n),this._applicationInsights.setUploadFrequency(t.uploadFrequency),this._applicationInsights.connectNotificationListener(t.notificationListener),t.stats&&this._applicationInsights.setPerfMgr(new sn(t.stats)),t.disableStatsTracking||this.hookUp1DSNotifications(this._applicationInsights)}this._oneDSSinkSessionId=en.newGuid(),this._epoch=(new Date).getTime().toString(),this._dataClassificationChecker=new Zt,this.addPreprocessor(this._dataClassificationChecker),this.setPersistentDataFields(e)}return e.prototype.sendTelemetryEvent=function(e,t){var n=c(e);try{for(var i=0;i<this._preprocessors.length;i++)if(!this._preprocessors[i].processEvent(n))return;this.sendEventInternal(n,t)}catch(e){T(u.Sink,"1DS Sink",e)}},e.prototype.getPersistentDataFields=function(){return this._persistentDataFields},e.prototype.setPersistentDataFields=function(e){this._partADataFieldsPlugin.addDataFields(e),this._persistentDataFields=e},e.prototype.addPreprocessor=function(e){this._preprocessors.push(e)},e.prototype.setFullEventsEnabled=function(e){this._dataClassificationChecker.setFullEventsEnabled(e)},e.prototype.sendEventInternal=function(e,t){var n;if(this.eventsProcessed++,!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");var i,r,a,o,s=(i={telemetryEvent:e,oneDSSinkSessionId:this._oneDSSinkSessionId,eventSequence:this.eventsProcessed,timestamp:t},Yt(o={},i.telemetryEvent.dataFields,!0),o["Event.Sequence"]={value:i.eventSequence,propertyType:et.Int64},o["Event.Name"]=i.telemetryEvent.eventName,o["Event.Source"]="OTelJS",o["Event.Time"]={value:(a=$t(i.timestamp),a.getUTCFullYear()+"-"+Ot(a.getUTCMonth()+1)+"-"+Ot(a.getUTCDate())+"T"+Ot(a.getUTCHours())+":"+Ot(a.getUTCMinutes())+":"+Ot(a.getUTCSeconds())+"."+(r=a.getUTCMilliseconds(),(r<10?"00"+r:r<100?"0"+r:r.toString())+"Z")),propertyType:et.DateTime},i.oneDSSinkSessionId&&(o["Event.Id"]=i.oneDSSinkSessionId+"."+i.eventSequence),i.telemetryEvent.eventContract&&(o["Event.Contract"]=i.telemetryEvent.eventContract.name,Yt(o,i.telemetryEvent.eventContract.dataFields,!1)),o),c={iKey:e.telemetryProperties.ariaTenantToken,name:e.eventName,data:s,time:(new Date).toISOString(),baseType:"EventData",ext:{sdk:{seq:this.eventsProcessed,epoch:this._epoch}}};this._trackOverride?(null===(n=this._partADataFieldsPlugin)||void 0===n||n.processTelemetry(c),this._trackOverride(c)):this._applicationInsights&&this._applicationInsights.track(c)},e.prototype.hookUp1DSNotifications=function(e){var t=this;e.addNotificationListener({eventsSent:function(e){y(l.Info,u.Transport,(function(){return"Successfully sent "+e.length+" event(s)"})),y(l.Verbose,u.Transport,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),t.eventsSent+=e.length},eventsDiscarded:function(e,n){y(l.Error,u.Transport,(function(){return"Discarded "+e.length+" event(s) because "+n})),y(l.Verbose,u.Transport,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),t.eventsDiscarded+=e.length}})},e.prototype.flush=function(e){this._applicationInsights&&this._applicationInsights.flush(e)},e.prototype.shutdown=function(){if(this._applicationInsights)try{this._applicationInsights.shutdown()}catch(e){y(l.Error,u.Transport,(function(){return"An error occurred on shutdown"}))}},e}();function ln(e){return{name:"App",contract:{name:"App",dataFields:[mn("Name",e.name),mn("Platform",e.platform),mn("Version",e.version)]}}}function un(e){return{name:"Session",contract:{name:"Session",dataFields:[mn("Id",e.sessionId),mn("EcsETag",e.flightsImpressionId)]}}}function dn(e){return{name:"Release",contract:{name:"Release",dataFields:[mn("AudienceGroup",e.audienceGroup)]}}}function fn(e){return{name:"Browser",contract:{name:"Browser",dataFields:[mn("Name",e.browserName),mn("Version",e.browserVersion)]}}}function pn(e){return{name:"Culture",contract:{name:"Culture",dataFields:[mn("UiLanguage",e.appLanguage)]}}}function vn(e){return{name:"User",contract:{name:"User",dataFields:[mn("PrimaryIdentityHash",e.loggableUserId),mn("PrimaryIdentitySpace",e.loggableUserIdSpace),mn("TenantId",e.omsTenantId),yn("IsAnonymous",e.isAnonymousUser)]}}}function gn(e){return{name:"WAC",contract:{name:"WAC",dataFields:[mn("Host",e.host),mn("ServerDocId",e.serverDocId),mn("Datacenter",e.datacenter),yn("IsSynthetic",e.isSynthetic),yn("IsBusinessUser",e.isBusinessUser),yn("IsEdu",e.isEduUser),mn("ApplicationMode",e.applicationMode),mn("ApplicationModeExtended",e.applicationModeExtended),mn("BrowserLanguage",e.browserLanguage),mn("ContentLanguage",e.contentLanguage),mn("OsVersion",e.osVersion),mn("Ring",e.ring),mn("UiHost",e.uiHost),mn("SessionOrigin",e.sessionOrigin),mn("UiHostIntegrationType",e.uiHostIntegrationType)]}}}var hn;function mn(e,t){return null==t?{name:e,string:""}:{name:e,string:t}}function yn(e,t){return null==t?{name:e,bool:!1}:{name:e,bool:t}}!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost"}(hn||(hn={}));var Tn=hn.msoulscat_MSOSP_OTelJS;var Sn,bn,En,_n,Cn,On,wn,xn,In,Pn={alwaysOnMetadata:void 0,useOneDsLogger:!0,logToUls:!1,logToExp:!1,oneDsTransportSettings:{enabled:!0,collectorEndpointEnum:"PUBLIC",collectorEndpointUrl:"",eventUploadFrequency:2e3,cacheMemorySizeLimitInNumberOfEvents:1e4,enableCustomerContent:!1},expLoggerTransportSettings:{enabled:!1,endpointUrl:"",numEventsToTriggerUpload:200,timeToWaitBeforeAutoUploadingEvents:1e4,maxEventsPerRequest:500},throttlingSettings:{enabled:!0,totalEventsThrottlePerSec:100,singleEventThrottlePerSec:20,eventNamesToBeSuppressedCommaSeparated:""},statsSettings:{taskDurationLogFrequency:20,durationThreshold:100,reportTaskDetails:!1,sessionDurationCutoff:1e4},samplingSettings:{enabled:!1,sampleRate:.02}};function kn(e,t){return null==e?t:e}function Nn(e,t){return null==e?t:e}function Mn(e,t){return null==e?t:e}function Fn(e,t,n){e.push(_("zC."+t,n))}(Sn||(Sn={})).getFields=function(e,t){var n=[];return n.push(b(e+".Code",t.code)),void 0!==t.type&&n.push(_(e+".Type",t.type)),void 0!==t.tag&&n.push(b(e+".Tag",t.tag)),void 0!==t.isExpected&&n.push(S(e+".IsExpected",t.isExpected)),Fn(n,e,"Office.System.Result"),n},(En=bn||(bn={})).contractName="Office.System.Activity",En.getFields=function(e){var t=[];return void 0!==e.cV&&t.push(_("Activity.CV",e.cV)),t.push(b("Activity.Duration",e.duration)),t.push(b("Activity.Count",e.count)),t.push(b("Activity.AggMode",e.aggMode)),void 0!==e.success&&t.push(S("Activity.Success",e.success)),void 0!==e.result&&t.push.apply(t,Sn.getFields("Activity.Result",e.result)),Fn(t,"Activity",En.contractName),t},(_n||(_n={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(_(e+".Id",t.id)),void 0!==t.version&&n.push(_(e+".Version",t.version)),void 0!==t.sessionId&&n.push(_(e+".SessionId",t.sessionId)),Fn(n,e,"Office.System.Host"),n},(Cn||(Cn={})).getFields=function(e,t){var n=[];return void 0!==t.alias&&n.push(_(e+".Alias",t.alias)),void 0!==t.primaryIdentityHash&&n.push(_(e+".PrimaryIdentityHash",t.primaryIdentityHash)),void 0!==t.primaryIdentitySpace&&n.push(_(e+".PrimaryIdentitySpace",t.primaryIdentitySpace)),void 0!==t.tenantId&&n.push(_(e+".TenantId",t.tenantId)),void 0!==t.tenantGroup&&n.push(_(e+".TenantGroup",t.tenantGroup)),void 0!==t.isAnonymous&&n.push(S(e+".IsAnonymous",t.isAnonymous)),Fn(n,e,"Office.System.User"),n},(On||(On={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(_(e+".Id",t.id)),void 0!==t.version&&n.push(_(e+".Version",t.version)),void 0!==t.instanceId&&n.push(_(e+".InstanceId",t.instanceId)),void 0!==t.name&&n.push(_(e+".Name",t.name)),void 0!==t.marketplaceType&&n.push(_(e+".MarketplaceType",t.marketplaceType)),void 0!==t.sessionId&&n.push(_(e+".SessionId",t.sessionId)),void 0!==t.browserToken&&n.push(_(e+".BrowserToken",t.browserToken)),void 0!==t.osfRuntimeVersion&&n.push(_(e+".OsfRuntimeVersion",t.osfRuntimeVersion)),void 0!==t.officeJsVersion&&n.push(_(e+".OfficeJsVersion",t.officeJsVersion)),void 0!==t.hostJsVersion&&n.push(_(e+".HostJsVersion",t.hostJsVersion)),void 0!==t.assetId&&n.push(_(e+".AssetId",t.assetId)),void 0!==t.providerName&&n.push(_(e+".ProviderName",t.providerName)),void 0!==t.type&&n.push(_(e+".Type",t.type)),Fn(n,e,"Office.System.SDX"),n},(wn||(wn={})).getFields=function(e,t){var n=[];return void 0!==t.name&&n.push(_(e+".Name",t.name)),void 0!==t.state&&n.push(_(e+".State",t.state)),Fn(n,e,"Office.System.Funnel"),n},(xn||(xn={})).getFields=function(e,t){var n=[];return void 0!==t.id&&n.push(b(e+".Id",t.id)),void 0!==t.name&&n.push(_(e+".Name",t.name)),void 0!==t.commandSurface&&n.push(_(e+".CommandSurface",t.commandSurface)),void 0!==t.parentName&&n.push(_(e+".ParentName",t.parentName)),void 0!==t.triggerMethod&&n.push(_(e+".TriggerMethod",t.triggerMethod)),void 0!==t.timeOffsetMs&&n.push(b(e+".TimeOffsetMs",t.timeOffsetMs)),Fn(n,e,"Office.System.UserAction"),n},function(e){e.getFields=function(e,t){var n=[];return n.push(_(e+".ErrorGroup",t.errorGroup)),n.push(b(e+".Tag",t.tag)),void 0!==t.code&&n.push(b(e+".Code",t.code)),void 0!==t.id&&n.push(b(e+".Id",t.id)),void 0!==t.count&&n.push(b(e+".Count",t.count)),Fn(n,e,"Office.System.Error"),n}}(In||(In={}));var Dn,An=bn,Ln=Sn,Un=In,Wn=wn,Rn=_n,Bn=On,Vn=xn,Hn=Cn;function zn(e,t){var n=[];if(e)for(var i=0;i<e.length;i+=1)n.push.apply(n,qn(e[i],t));return n}function qn(e,t,n){e.name||(e.name="DataFieldNameIsMissing");var i=function(e){if(null!=e.string)return 2;if(null!=e.bool)return 1;if(null!=e.int64&&!isNaN(e.int64))return 3;if(null!=e.double&&!isNaN(e.double))return 4;if(null!=e.contract)return 6;if(null!=e.date&&!isNaN(e.date))return 5;return 0}(e),r=n?n+"."+e.name:e.name;switch(i){case 0:return[];case 1:return[S(r,e.bool)];case 2:return[_(r,e.string)];case 3:return[b(r,Math.floor(e.int64))];case 4:return[E(r,e.double)];case 5:return[_(r,new Date(e.date).toISOString())];case 6:return function(e,t,n){var i=[];if(t.dataFields)for(var r=0;r<t.dataFields.length;r+=1)i.push.apply(i,qn(t.dataFields[r],n,e));return i}(r,e.contract,t);default:throw new Error(i)}}!function(e){!function(e){!function(e){e.Activity=An,e.Result=Ln,e.Error=Un,e.Funnel=Wn,e.Host=Rn,e.SDX=Bn,e.User=Hn,e.UserAction=Vn}(e.System||(e.System={}))}(e.Office||(e.Office={}))}(Dn||(Dn={}));var jn,Kn=function(){function e(){this.sampleRate=.02}return e.prototype.enableWithIdentifier=function(e,t){return!("string"!=typeof t||t.length<4)&&(this.samplingValue=function(e){return function(e){for(var t=5381,n=0;n<e.length;n++)t=(t<<5)+t+e.charCodeAt(n);return t>>>0}(e)%1e3/1e3}(t),this.samplingKey=e,!0)},e.prototype.enableWithSamplingValue=function(e,t){return!(isNaN(t)||t<0||t>=1)&&(this.samplingValue=t,this.samplingKey=e,!0)},e.prototype.enableWithRandomValue=function(){var e=new Uint32Array(1);return!!window.crypto&&(window.crypto.getRandomValues(e),this.samplingValue=e[0]%1e3/1e3,this.samplingKey="Random",!0)},e.prototype.setSampleRate=function(e){return!(e<0||e>1)&&(this.sampleRate=e,!0)},e.prototype.getSamplingValue=function(){return this.samplingValue},e.prototype.isMeasuresEnabled=function(){return void 0===this.samplingValue||this.samplingValue<this.sampleRate},e.prototype.processEvent=function(e){if(void 0===this.samplingValue)return!0;if(e.eventFlags&&void 0!==e.eventFlags.samplingPolicy){if(e.eventFlags.samplingPolicy===Vt.Measure)return!!this.isMeasuresEnabled()&&(this.addSampleRateField(e,this.sampleRate,this.samplingValue),!0);if(e.eventFlags.samplingPolicy===Vt.Diagnostics)return!1;this.addSampleRateField(e,1,this.samplingValue)}return!0},e.prototype.addSampleRateField=function(e,t,n){e.eventContract||(e.eventContract={name:"",dataFields:[]}),e.eventContract.dataFields.push(E("Event.SampleRate",t)),e.eventContract.dataFields.push(E("Session.SamplingValue",n)),this.samplingKey&&e.eventContract.dataFields.push(_("Session.SamplingKey",this.samplingKey)),e.eventContract.dataFields.push(S("Session.MeasuresEnabled",this.isMeasuresEnabled()))},e}(),Jn=function(){function e(e,t){this._totalEventsInLastInterval=0,this._singleEventInLastInterval={},this._sinkName=e,this._lastIntervalStart=Date.now(),this._maxNamedEventsPerSecond={},this._oneDSSink=t}return e.prototype.setSingleEventThrottle=function(e){this._maxSingleEventPerSecond=e},e.prototype.setTotalEventThrottle=function(e){this._maxTotalEventsPerSecond=e},e.prototype.setNamedEventThrottle=function(e,t){this._maxNamedEventsPerSecond[e]=t},e.prototype.processEvent=function(e){var t=!0;return Date.now()-this._lastIntervalStart>1e3&&(this._lastIntervalStart=Date.now(),this._totalEventsInLastInterval=0,this._singleEventInLastInterval={}),this._singleEventInLastInterval[e.eventName]=this._singleEventInLastInterval[e.eventName]+1||1,e.eventName in this._maxNamedEventsPerSecond?t=this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxNamedEventsPerSecond[e.eventName],"MaxNamedEventsPerSecond",e.eventName):this._maxSingleEventPerSecond&&(t=this.applyThrottle(this._singleEventInLastInterval[e.eventName],this._maxSingleEventPerSecond,"MaxSingleEventsPerSecond",e.eventName)),this._maxTotalEventsPerSecond&&(this._totalEventsInLastInterval++,t&&(t=this.applyThrottle(this._totalEventsInLastInterval,this._maxTotalEventsPerSecond,"MaxTotalEventsPerSecond",e.eventName))),t},e.prototype.applyThrottle=function(e,t,n,i){if(e>t){if(e===t+1){var r={eventName:"Office.Telemetry.OTelJS.EventThrottled",telemetryProperties:{ariaTenantToken:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",nexusTenantToken:1723},dataFields:[_("SinkName",this._sinkName),_("ThrottledEvent.Name",i),b(n,t)]};this._oneDSSink.sendEventInternal(r)}return y(l.Info,u.Sink,(function(){return"1DS Sink Event Throttle: Exceeded "+t+" "+n+": "+i})),!1}return!0},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/"}(jn||(jn={}));var Gn,Qn=function(){function e(e){this.stats=void 0,this.taskStats=void 0,this.config=e,this.logOtelEvent=void 0,this.resetStats()}return e.prototype.setLogOtelTelemetryEventFunc=function(e){this.logOtelEvent=e},e.prototype.resetStats=function(){this.stats={processed:0,sent:0,throttled:0,sampledNotSent:0,dropped:0,droppedDetails:{},eventsProcessingTime:0,taskExecutionTime:0,taskExecutionCount:0,bytesOverWire:0,eventSerializationTime:0,eventTransmissionTime:0,oteljsVersion:"3.1.72"},this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]}},e.prototype.logSessionStatsViaUls=function(){this.computeSessionAverages(),o.sendTraceTag(this.config.tags.sessionStats,Tn,i.Info,JSON.stringify(this.stats))},e.prototype.logSessionStatsViaOTel=function(){if(this.computeSessionAverages(),this.logOtelEvent){var e={eventName:this.config.tags.sessionStatsEventName,dataFields:[{name:"Processed",value:this.stats.processed,dataType:p.Double},{name:"Sent",value:this.stats.sent,dataType:p.Double},{name:"Throttled",value:this.stats.throttled,dataType:p.Double},{name:"SampledNotSent",value:this.stats.sampledNotSent,dataType:p.Double},{name:"Dropped",value:this.stats.dropped,dataType:p.Double},{name:"EventsProcessingTime",value:this.stats.eventsProcessingTime,dataType:p.Double},{name:"TaskExecutionTime",value:this.stats.taskExecutionTime,dataType:p.Double},{name:"TaskExecutionCount",value:this.stats.taskExecutionCount,dataType:p.Double},{name:"BytesOverWire",value:this.stats.bytesOverWire,dataType:p.Double},{name:"AverageProcessingTimeCostPerEvent",value:this.stats.averageProcessingTimeCostPerEvent||0,dataType:p.Double}],eventFlags:{}};this.logOtelEvent(e)}},e.prototype.computeSessionAverages=function(){this.stats.processed>0&&(this.stats.averageTimeCostPerEvent=+((this.stats.eventsProcessingTime+this.stats.taskExecutionTime)/this.stats.processed).toFixed(3),this.stats.averageProcessingTimeCostPerEvent=+(this.stats.eventsProcessingTime/this.stats.processed).toFixed(4),this.stats.averageTaskTimeCostPerEvent=+(this.stats.taskExecutionTime/this.stats.processed).toFixed(4),this.stats.averageNetworkCostPerEvent=+(this.stats.bytesOverWire/this.stats.processed).toFixed(0))},e.prototype.logAndClearTaskStats=function(){this.taskStats.taskExecutionTimes.length<=0||(o.sendTraceTag(this.config.tags.taskStats,Tn,i.Info,this.taskStats.taskExecutionTimes.join(",")),this.config.settings.reportTaskDetails&&o.sendTraceTag(this.config.tags.taskDetailsStats,Tn,i.Info,JSON.stringify(this.taskStats.taskExecutionTimesDetails)),this.taskStats={taskExecutionTimes:[],taskExecutionTimesDetails:[]})},e.prototype.recordUploadTaskDuration=function(e,t,n,r){if(e>this.config.settings.durationThreshold&&o.sendTraceTag(this.config.tags.taskDurationThresholdExceeded,Tn,i.Info,"Task took "+e+" ms"),this.stats.taskExecutionTime+=e,t>0){var a=+e.toFixed(3);this.stats.taskExecutionCount+=1,this.taskStats.taskExecutionTimes.push(a),this.stats.eventSerializationTime+=n||0,this.stats.eventTransmissionTime+=r||0,this.taskStats.taskExecutionTimesDetails.push({x:Date.now(),e:t,c:a,s:n,t:r}),this.taskStats.taskExecutionTimes.length>=this.config.settings.taskDurationLogFrequency&&this.logAndClearTaskStats()}},e.prototype.checkAndLogPipelineHealth=function(){var e=Date.now()-this.config.sdkInitializationTime;this.stats.processed>0&&0===this.stats.sent&&(this.stats.dropped>0||e>this.config.settings.sessionDurationCutoff)&&o.sendTraceTag(this.config.tags.sdkHealth,Tn,i.Warning,"Telemetry pipeline might be malfunctioning: Processed="+this.stats.processed+", Sent="+this.stats.sent+", Dropped="+this.stats.dropped+", SessionDuration="+e+" ms")},e}();function Xn(e){var t,n,i=(t=e.statsSettings,n={settings:t,tags:{sessionStatsEventName:"Office.Online.Telemetry.OTelJS.OneDS.Session.Stats",sessionStats:593597406,taskStats:593597407,taskDetailsStats:593597408,taskDurationThresholdExceeded:593597409,sdkHealth:593597410},sdkInitializationTime:Date.now()},new Qn(n)),r=new ni({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.transportSettings,throttlingSettings:e.throttlingSettings,samplingSettings:e.samplingSetings,stats:i,createSinkFunc:Zn,createSamplerFunc:$n,createThrottlerFunc:Yn,collectorPingUrl:"https://browser.events.data.microsoft.com/ping"});return i.setLogOtelTelemetryEventFunc(r.sendOtelTelemetryEvent.bind(r)),r}function Zn(e,t,n){var r=function(e,t){var n;n=e.collectorEndpointUrl?e.collectorEndpointUrl:function(e){var t=jn[e];void 0===t&&(o.sendTraceTag(593597411,Tn,i.Error,"Unknown 1DS endpoint "+e+" - defaulting to Public one"),t=jn.PUBLIC);return t}(e.collectorEndpointEnum);var r={endpointUrl:n,notificationListener:new ei(t),uploadFrequency:e.eventUploadFrequency,eventsLimitInMem:e.cacheMemorySizeLimitInNumberOfEvents,stats:{requestProcessingStats:function(e,n){t.recordUploadTaskDuration(e,n)},networkStats:function(e){t.stats.bytesOverWire+=e}},disableStatsTracking:!0};return r.enableCustomerContent=e.enableCustomerContent,r}(e,n);return new cn(t||[],r)}function $n(e,t,n){var i=new Kn;return"number"==typeof n&&i.setSampleRate(n),e&&i.enableWithIdentifier("PrimaryIdentityHash",e)||t&&i.enableWithIdentifier("SessionId",t)?i:void 0}function Yn(e){return new Jn("WACAriaSink",e)}!function(e){e[e.Unknown=0]="Unknown",e[e.NonRetryableStatus=1]="NonRetryableStatus",e[e.InvalidEvent=2]="InvalidEvent",e[e.SizeLimitExceeded=3]="SizeLimitExceeded",e[e.KillSwitch=4]="KillSwitch",e[e.QueueFull=5]="QueueFull"}(Gn||(Gn={}));var ei=function(){function e(e){this.reporter=e}return e.prototype.eventsSent=function(e){this.reporter.stats.sent+=e.length},e.prototype.eventsDiscarded=function(e,t){var n=Gn[t]||t.toString();this.reporter.stats.droppedDetails[n]=this.reporter.stats.droppedDetails[n]+e.length||e.length,this.reporter.stats.dropped+=e.length},e}();function ti(){return"undefined"==typeof performance||void 0===performance.now?0:performance.now()}var ni=function(){function e(e){this._processedEvent=new r,this._throttledEvent=new r,this._logger=new O(void 0,void 0,{disableValidation:!0}),this._isOtel4=0==="3.1.72".indexOf("4"),this._enabled=e.transportSettings.enabled,this._throttlingEnabled=e.throttlingSettings.enabled,this._reporter=e.stats,this._collectorPingUrl=e.collectorPingUrl,this._enableCustomerContent=e.transportSettings.enableCustomerContent;var t,n=zn((t=e.alwaysOnMetadata)?[ln,un,dn,fn,pn,gn,vn].map((function(e){return e(t)})):[],"AlwaysOnMetadata");this._sink=e.createSinkFunc(e.transportSettings,n,this._reporter),this._sink.setFullEventsEnabled(!0),this._logger.addSink(this._sink),this._eventThrottler=e.createThrottlerFunc(this._sink),function(e,t){if(e.setSingleEventThrottle(t.singleEventThrottlePerSec),e.setTotalEventThrottle(t.totalEventsThrottlePerSec),t.eventNamesToBeSuppressedCommaSeparated){t.eventNamesToBeSuppressedCommaSeparated.split(",").forEach((function(t){e.setNamedEventThrottle(t,0)}))}}(this._eventThrottler,e.throttlingSettings),this._eventSampler=void 0,e.samplingSettings.enabled&&e.alwaysOnMetadata&&this.setupSampler(e.createSamplerFunc,e.alwaysOnMetadata,e.samplingSettings.sampleRate)}return e.prototype.setupSampler=function(e,t,n){this._eventSampler=e(t.loggableUserId,t.sessionId,n),this._eventSampler&&o.sendTraceTag(577275598,Tn,i.Info,"Sampler added. Measures enabled: "+this._eventSampler.isMeasuresEnabled())},e.prototype.pingCollectorPingUrl=function(){!function(e){try{var t=new XMLHttpRequest;t.open("GET",e,!0),t.onreadystatechange=function(){4===t.readyState&&(200===t.status?t.responseText.toLowerCase().indexOf("ok")>-1?o.sendTraceTag(593597389,Tn,i.Info,"Collector ping 200 OK."):o.sendTraceTag(593597390,Tn,i.Warning,"Collector ping 200 OK but with invalid response."):o.sendTraceTag(593597391,Tn,i.Warning,"Collector ping returned with HTTP "+t.status.toString()))},t.send()}catch(e){o.sendTraceTag(593597392,Tn,i.Warning,"Collector ping failed with error: "+e.toString())}}(this._collectorPingUrl)},e.prototype.pingCollectorEndpoint=function(){},e.prototype.setTenantToken=function(e,t){t&&this._logger.setTenantToken(e,t,-1)},e.prototype.processEvent=function(e,t){var n=!1,i=!1,r=ti();this._logger.processTelemetryEvent(e),this._throttlingEnabled&&!this._eventThrottler.processEvent(e)?n=!0:this._enabled&&(this._eventSampler&&!this._eventSampler.processEvent(e)?i=!0:t(e)),this._reporter.stats.eventsProcessingTime+=ti()-r,n?(this._reporter.stats.throttled+=1,this._throttledEvent.fireEvent(e)):i?this._reporter.stats.sampledNotSent+=1:(this._reporter.stats.processed+=1,this._processedEvent.fireEvent(e))},e.prototype.sendOtelCustomerContent=function(e,t){var n=this;this._enableCustomerContent&&this._logger.sendCustomerContent&&this.processEvent(e,(function(e){e.timestamp=t,n._logger.sendCustomerContent(e)}))},e.prototype.sendOtelTelemetryEvent=function(e,t){var n=this;this.processEvent(e,(function(e){n._isOtel4?(e.timestamp=t,n._logger.sendTelemetryEvent(e)):n._sink.sendTelemetryEvent(e,t)}))},e.prototype.flush=function(e){this._sink instanceof cn&&this._sink.flush(e)},e.prototype.shutdown=function(){this._enabled&&(this._reporter.logSessionStatsViaOTel(),this._sink.shutdown()),this._reporter.logSessionStatsViaUls(),this._reporter.logAndClearTaskStats(),this._reporter.checkAndLogPipelineHealth()},e.prototype.getStats=function(){return this._reporter},e.prototype.onProcessedEvent=function(){return this._processedEvent},e.prototype.onThrottledEvent=function(){return this._throttledEvent},e}();var ii,ri,ai=[{id:1,namespace:"Office.Online",ariaTenant:"79b56d2f6f2444f1a3d7f7c7f12bcc0c-f47f5fe6-ed89-42f6-8a43-cea0f5930b17-7407"},{id:2,namespace:"Office.Word.Online.Data",ariaTenant:"7e7959aac92e41d6892c69a87259ed58-de5c63ef-10f5-45e1-bef2-d23e9cac2fab-6830"},{id:3,namespace:"Office.Excel.Online.Data",ariaTenant:"011776870b754a649aedc9456ac07a97-6bd8247c-11d3-4599-b599-ec9ef6d401f6-6722"},{id:4,namespace:"Office.PowerPoint.Online.Data",ariaTenant:"35612b11d234460da5c673d7b172fd93-f8762c6b-96cb-4e60-87fa-015aac0c2ff1-7212"},{id:4,namespace:"Office.OneNote.Online.Data",ariaTenant:"86258c80efed47d9b34bf77fc663b381-af82a060-b49f-448b-baf0-956ba7709592-7634"},{id:5,namespace:"Office.Visio.Online.Data",ariaTenant:"77fd25a525d24b7f9b924307de0cc70f-5f2b6ec0-f1d2-40dd-b875-e6bd2849e1eb-7539"},{id:6,namespace:"Office.Word.Online",ariaTenant:"ff7e2f12a4be407096fc01eeb760eda3-eeeb63cf-35d9-4734-ab45-66a873412359-7045"},{id:7,namespace:"Office.Excel.Online",ariaTenant:"fad3bd1d8e4b4c06894bd7bac80e4f02-67df67b4-f1fd-4ecd-9d55-4d41540b1757-7724"},{id:8,namespace:"Office.PowerPoint.Online",ariaTenant:"b664cab4b3f24a739be75b93b026749e-65c206a3-a985-48b4-8b50-36c56c3ce309-7201"},{id:9,namespace:"Office.OneNote.Online",ariaTenant:"1705ef36a51840648341da866d62baf8-ddbcd60b-4ce4-48da-96be-ad5f28b48954-8035"},{id:10,namespace:"Office.Visio.Online",ariaTenant:"a9b6cb604fe942a89c8671aab85364f6-af0f81b1-c5ce-419a-82d5-af38c33ebea3-7250"},{id:11,namespace:"Office.Word.Online.Health",ariaTenant:"e064ef4d9cdb454d9eddb2f7f7a94c83-89a6d9df-7218-4efd-bcd4-16ea059deea2-7672"},{id:12,namespace:"Office.Excel.Online.Health",ariaTenant:"e76e8055912d482eb56ea5dad2fd5a97-5552f2bb-d1eb-4843-95d7-3019215328a0-6899"},{id:13,namespace:"Office.PowerPoint.Online.Health",ariaTenant:"706f939c0d24440ba8dfb0838ed33611-d60b1956-db23-4410-a59d-e7fa08d4217f-7388"},{id:14,namespace:"Office.OneNote.Online.Health",ariaTenant:"c6393e4ed4b94e3baf9a46aa6585dce0-c1b3b0c6-b44c-4121-8eae-311d31e67bb6-7176"},{id:15,namespace:"Office.Visio.Online.Health",ariaTenant:"c4999163c49d49c99a1649b404873d24-a62a394b-ad47-45f0-92fa-fd4085dc8bb3-7324"},{id:16,namespace:"Office.Telemetry",ariaTenant:"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405"},{id:17,namespace:"Office.System",ariaTenant:"cd836626611c4caaa8fc5b2e728ee81d-3b6d6c45-6377-4bf5-9792-dbf8e1881088-7521"},{id:18,namespace:"Office.TellMe",ariaTenant:"31d9dd3e4c7046a696537586281d7ed1-06d11dd6-a946-4281-8ac3-a7c2ab4776f5-7063"},{id:19,namespace:"Office.Voice",ariaTenant:"9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162"},{id:20,namespace:"Office.Insights",ariaTenant:"250a372c4a854d8fb120ef0366f9410c-dd39bcd8-3b38-4c6c-9f8d-3821e5c28b47-7487"},{id:21,namespace:"Office.Graphics",ariaTenant:"cfcfdb91c68c4329bb8b7cb7babb3cf7-e082c2f2-ef1d-427a-ac4d-b0b700afe7a7-7655"},{id:22,namespace:"Office.AugLoop",ariaTenant:"3de4087d4de34817b1c376e3d1e6e293-983c4292-5ba9-485a-ab10-9797863c788b-6770"},{id:23,namespace:"Office.FileIO",ariaTenant:"d2b065c5ae634beb9cec4813140e22da-eda42ada-ffd9-4e26-92a1-e3b440eaf8bf-7717"},{id:24,namespace:"Office.Sandbox",ariaTenant:"1cd66059dc1d41f1887e3770ea8ba967-f1d0108c-8535-4cf9-bf23-ec8227f6afa7-6999"},{id:25,namespace:"Office.UX",ariaTenant:"c4388c977297413bb054bad1acf0ade1-cc58e53e-f5a4-4f37-b0d2-9a8079e34420-6879"}];!function(e){e[e.None=0]="None",e[e.Activity=2]="Activity",e[e.EssentialMetadata=4]="EssentialMetadata",e[e.CompleteEventNameAndTenantInfo=8]="CompleteEventNameAndTenantInfo",e[e.GDRPRelated=16]="GDRPRelated",e[e.ExpRelated=32]="ExpRelated"}(ii||(ii={})),function(e){e[e.TelemetryEvent=1]="TelemetryEvent",e[e.ULS=2]="ULS"}(ri||(ri={}));var oi={};function si(e){return function(e){var t=(i=e.statsSettings,r={settings:i,tags:{sessionStatsEventName:"Office.Online.Telemetry.ExpJS.Session.Stats",sessionStats:593597393,taskStats:593597394,taskDetailsStats:593597395,taskDurationThresholdExceeded:593597396,sdkHealth:593597397},sdkInitializationTime:Date.now()},new Qn(r)),n=new ci(e,t);var i,r;return n.initialize(e.aom),n}({aom:e.alwaysOnMetadata||{},transportSettings:e.expLoggerTransportSettings,statsSettings:e.statsSettings})}var ci=function(){function e(e,t){this.protocolVersion="0.1",this.endpointUrl=e.transportSettings.endpointUrl+"?version="+this.protocolVersion,this.numEventsToTriggerUpload=e.transportSettings.numEventsToTriggerUpload,this.timeToWaitBeforeAutoUploadingEvents=e.transportSettings.timeToWaitBeforeAutoUploadingEvents,this.maxEventsPerRequest=e.transportSettings.maxEventsPerRequest,this.sendToCollector=e.sendToCollectorOverride||li,this.alwaysOnMetadataSerializedPayload="",this.asyncFlushTimerId=0,this.periodicUploaderTimerId=0,this.events=[],this.reporter=t}return e.prototype.initialize=function(e){this.alwaysOnMetadataSerializedPayload=JSON.stringify(function(e){var t={},n={appLanguage:"a",applicationMode:"b",applicationModeExtended:"c",audienceGroup:"d",browserLanguage:"e",browserName:"f",browserVersion:"g",contentLanguage:"h",datacenter:"i",flightsImpressionId:"j",host:"k",isAnonymousUser:"l",isBusinessUser:"m",isEduUser:"n",isSynthetic:"o",loggableUserId:"p",loggableUserIdSpace:"q",name:"r",omsTenantId:"s",osBuild:"t",osVersion:"u",ring:"v",serverDocId:"w",sessionId:"x",uiHost:"y",version:"z",sessionOrigin:"aa",uiHostIntegrationType:"ab"};for(var i in e){var r=n[i],a=e[i];r&&a&&(t[r]="boolean"==typeof a?1:a)}return t}(e)),this.schedulePeriodicUploadTimer()},e.prototype.sendOtelTelemetryEvent=function(e){var t=ti();try{var n=function(e){var t={},n=ii.None;if(t.t=Date.now(),e.dataFields&&e.dataFields.length>0){for(var i={},r=0;r<e.dataFields.length;r+=1)i[e.dataFields[r].name]=e.dataFields[r].value;t.d=i}if(e.telemetryProperties&&e.telemetryProperties.ariaTenantToken){var a=oi[e.telemetryProperties.ariaTenantToken];if(a)t.n=e.eventName.substring(a.namespace.length+1),t.a=a.id;else{t.n=e.eventName;var o=e.telemetryProperties.ariaTenantToken.indexOf("-");t.a=-1!==o?e.telemetryProperties.ariaTenantToken.substring(0,o):e.telemetryProperties.ariaTenantToken,n|=ii.CompleteEventNameAndTenantInfo}}else t.n=e.eventName;if(e.eventContract&&e.eventContract.dataFields){n|=ii.Activity;for(r=0;r<e.eventContract.dataFields.length;r+=1){var s=e.eventContract.dataFields[r].value;switch(e.eventContract.dataFields[r].name){case"Activity.Duration":s&&(t.q=s);break;case"Activity.Success":s&&(t.r=!0);break;case"Activity.CV":s&&(t.s=s);break;case"Activity.AggMode":s>0&&(t.x=s);break;case"Activity.Count":s>1&&(t.y=s)}}}n&&(t.m=n);return t}(e);this.addEventToQueue(n)}catch(e){o.sendTraceTag(593597398,Tn,i.Warning,e.message)}this.reporter.stats.eventsProcessingTime+=ti()-t},e.prototype.sendOtelCustomerContent=function(e){},e.prototype.sendEvent=function(e,t,n){var i=ti();this.addEventToQueue({t:Date.now(),n:t,a:e,d:n}),this.reporter.stats.eventsProcessingTime+=ti()-i},e.prototype.sendActivityEvent=function(e,t,n,i,r,a){var o=ti();this.addEventToQueue({t:Date.now(),n:t,a:e,d:n,q:i,r:r||void 0,s:a,m:ii.Activity}),this.reporter.stats.eventsProcessingTime+=ti()-o},e.prototype.addEventToQueue=function(e){this.reporter.stats.processed+=1,this.events.push(e),this.events.length>=this.numEventsToTriggerUpload&&this.flush(!0)},e.prototype.flush=function(e){var t=this;if(!e)return this.cancelOutstandingFlushTimer(),void this.sendOutstandingTelemetryEvents();this.asyncFlushTimerId||(this.asyncFlushTimerId=self.setTimeout((function(){t.flushRoutine()}),0))},e.prototype.flushRoutine=function(){this.asyncFlushTimerId=0,this.sendOutstandingTelemetryEvents()},e.prototype.cancelOutstandingFlushTimer=function(){this.asyncFlushTimerId&&(self.clearTimeout(this.asyncFlushTimerId),this.asyncFlushTimerId=0)},e.prototype.shutdown=function(){this.sendOutstandingTelemetryEvents(!0),this.cancelOutstandingFlushTimer(),this.cancelPeriodicUploadTimer(),this.reporter.logSessionStatsViaUls(),this.reporter.logSessionStatsViaOTel(),this.reporter.logAndClearTaskStats()},e.prototype.getStats=function(){return this.reporter},e.prototype.sendOutstandingTelemetryEvents=function(e){if(void 0===e&&(e=!1),this.schedulePeriodicUploadTimer(),!(this.events.length<=0)){try{for(var t=0;t<this.events.length;){var n=void 0,r=ti();n=this.events.length<this.maxEventsPerRequest?this.events:this.events.slice(t,t+this.maxEventsPerRequest),t+=this.maxEventsPerRequest;var a=JSON.stringify(n),s=this.alwaysOnMetadataSerializedPayload+"\n"+a,c=ti();this.sendToCollector(this.endpointUrl,s,e);var l=ti(),u=l-r,d=c-r,f=l-c;this.reporter.stats.sent+=n.length,this.reporter.recordUploadTaskDuration(u,n.length,d,f),this.reporter.stats.bytesOverWire+=s.length}}catch(e){o.sendTraceTag(593597399,Tn,i.Warning,e.message)}this.events=[]}},e.prototype.periodicUploaderRoutine=function(){this.periodicUploaderTimerId=0,this.sendOutstandingTelemetryEvents()},e.prototype.schedulePeriodicUploadTimer=function(){var e=this;this.cancelPeriodicUploadTimer(),this.periodicUploaderTimerId=self.setTimeout((function(){e.periodicUploaderRoutine()}),this.timeToWaitBeforeAutoUploadingEvents)},e.prototype.cancelPeriodicUploadTimer=function(){this.periodicUploaderTimerId&&(self.clearTimeout(this.periodicUploaderTimerId),this.periodicUploaderTimerId=0)},e}();function li(e,t,n){if(n){if(void 0!==navigator.sendBeacon)try{navigator.sendBeacon(e,t)}catch(n){var i;(i=new XMLHttpRequest).open("POST",e),i.send(t)}}else(i=new XMLHttpRequest).open("POST",e),i.send(t)}var ui,di,fi=!1,pi="",vi="",gi="unknown";function hi(e){if(fi)throw new Error("Telemetry is already initialized!");if(!e.ulsLogger)throw new Error("Must provide a ULS logger!");var t;s(e.ulsLogger),e.loggingCategory&&(t=e.loggingCategory,Tn=t),e.alwaysOnMetadata&&(gi=e.alwaysOnMetadata.name+", "+e.alwaysOnMetadata.applicationMode+", "+e.alwaysOnMetadata.applicationModeExtended),o.sendTraceTag(595947925,Tn,i.Info,"Initializing Otel library ["+gi+"] with settings "+function(e){return JSON.stringify(e,(function(e,t){if("alwaysOnMetadata"!==e)return t}))}(e)),function(e){e.alwaysOnMetadata&&(null==e.alwaysOnMetadata.name||""===e.alwaysOnMetadata.name?(pi="Office.Online.UserAction",vi="Office.Online.Data.Activity",o.sendTraceTag(595900060,Tn,i.Info,"Cannot determine the App for UserActionEvent, using generic UserAction event name.")):(pi="Office."+e.alwaysOnMetadata.name+".Online.UserAction.",vi="Office."+e.alwaysOnMetadata.name+".Online.Data.Activity."))}(e);var n=function(e){return{alwaysOnMetadata:e.alwaysOnMetadata||Pn.alwaysOnMetadata,useOneDsLogger:kn(e.otelUseOneDsSink,Pn.useOneDsLogger),logToUls:kn(e.sendToUls,Pn.logToUls),logToExp:kn(e.sendToExpLogger,Pn.logToExp),oneDsTransportSettings:{enabled:kn(e.sendToAria,Pn.oneDsTransportSettings.enabled),collectorEndpointEnum:Mn(e.ariaEndpointTarget,Pn.oneDsTransportSettings.collectorEndpointEnum),collectorEndpointUrl:Mn(e.ariaEndpointUrl,Pn.oneDsTransportSettings.collectorEndpointUrl),eventUploadFrequency:Nn(e.eventUploadFrequency,Pn.oneDsTransportSettings.eventUploadFrequency),cacheMemorySizeLimitInNumberOfEvents:Nn(e.cacheMemorySizeLimitInNumberOfEvents,Pn.oneDsTransportSettings.cacheMemorySizeLimitInNumberOfEvents),enableCustomerContent:kn(e.enableCustomerContent,Pn.oneDsTransportSettings.enableCustomerContent)},throttlingSettings:{enabled:kn(e.wacAriaThrottlingIsEnabled,Pn.throttlingSettings.enabled),totalEventsThrottlePerSec:Nn(e.wacAriaTotalEventsThrottlePerSec,Pn.throttlingSettings.totalEventsThrottlePerSec),singleEventThrottlePerSec:Nn(e.wacAriaSingleEventThrottlePerSec,Pn.throttlingSettings.singleEventThrottlePerSec),eventNamesToBeSuppressedCommaSeparated:Mn(e.otelEventNamesToBeSuppressedCommaSeparated,Pn.throttlingSettings.eventNamesToBeSuppressedCommaSeparated)},expLoggerTransportSettings:{enabled:kn(e.sendToExpLogger,Pn.expLoggerTransportSettings.enabled),endpointUrl:Mn(e.expLoggerEndpointUrl,Pn.expLoggerTransportSettings.endpointUrl),numEventsToTriggerUpload:Nn(e.expLoggerNumEventsToTriggerUpload,Pn.expLoggerTransportSettings.numEventsToTriggerUpload),timeToWaitBeforeAutoUploadingEvents:Nn(e.expLoggerTimeToWaitBeforeAutoUploadingEvents,Pn.expLoggerTransportSettings.timeToWaitBeforeAutoUploadingEvents),maxEventsPerRequest:Nn(e.expLoggerMaxEventsPerRequest,Pn.expLoggerTransportSettings.maxEventsPerRequest)},statsSettings:{taskDurationLogFrequency:Nn(e.taskDurationLogFrequency,Pn.statsSettings.taskDurationLogFrequency),durationThreshold:Nn(e.taskDurationLogThreshold,Pn.statsSettings.durationThreshold),reportTaskDetails:kn(e.reportTaskDetails,Pn.statsSettings.reportTaskDetails),sessionDurationCutoff:Pn.statsSettings.sessionDurationCutoff},samplingSettings:{enabled:kn(e.samplingIsEnabled,Pn.samplingSettings.enabled),sampleRate:Nn(e.sampleRate,Pn.samplingSettings.sampleRate)}}}(e),r=function(e){return Xn({alwaysOnMetadata:e.alwaysOnMetadata,transportSettings:e.oneDsTransportSettings,throttlingSettings:e.throttlingSettings,statsSettings:e.statsSettings,samplingSetings:e.samplingSettings})}(n);e.sendToUls&&(r.onProcessedEvent().addListener(bi),r.onThrottledEvent().addListener(Ei)),e.sendToExpLogger&&(ai.forEach((function(e){oi[e.ariaTenant]=e})),(di=si(n)).getStats().setLogOtelTelemetryEventFunc(r.sendOtelTelemetryEvent.bind(r)),r.onProcessedEvent().addListener((function(e){di.sendOtelTelemetryEvent(e)}))),m.addListener((function(t){!function(e,t){if(e.category===u.Transport&&!t)return;o.sendTraceTag(595947933,Tn,function(e){switch(e){case l.Verbose:return i.Verbose;case l.Info:return i.Info;case l.Warning:return i.Warning;case l.Error:return i.Error;default:throw new Error(e)}}(e.level),e.message())}(t,e.enableAdditionalDiagnosticTracing||!1)})),ai.forEach((function(e){r.setTenantToken(e.namespace,e.ariaTenant)})),e.pingCollectorPingUrl&&r.pingCollectorPingUrl(),e.pingCollectorEndpoint&&r.pingCollectorEndpoint(),ui=r,fi=!0,o.sendTraceTag(595947926,Tn,i.Info,"Successfully initialized Otel library")}function mi(e,t){_i();var n=function(e){if(!e.name)throw new Error("Event is missing a name");var t=zn(e.dataFields,e.name),n={eventName:e.name,dataFields:t,eventFlags:{}};return 1===e.samplingPolicy&&(n.eventFlags={samplingPolicy:Vt.Measure}),n}(e);ui.sendOtelTelemetryEvent(n,t)}function yi(e,t){_i(),null!=e&&null!=e.name&&(e.name.indexOf("Office.")>=0||(e.name=vi+e.name));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0),(null==e.count||isNaN(e.count))&&(e.count=1),null==e.aggMode&&(e.aggMode=0);var t=Math.floor(1e3*e.durationMs),n=zn(e.dataFields,e.name),i=Dn.Office.System.Activity.getFields({cV:e.CV||void 0,duration:t,count:e.count,aggMode:e.aggMode,success:e.succeeded});return{eventName:e.name,eventContract:{name:Dn.Office.System.Activity.contractName,dataFields:i},dataFields:n,eventFlags:{}}}(e);ui.sendOtelTelemetryEvent(n,t)}function Ti(e,t){_i(),null==e.name&&(e.name=pi,null!=e.actionName&&(e.name+=e.actionName));var n=function(e){if(!e.name)throw new Error("Event is missing a name");null==e.succeeded&&(e.succeeded=void 0),(null==e.durationMs||isNaN(e.durationMs))&&(e.durationMs=0);var t=Math.floor(1e3*e.durationMs);null==e.dataFields&&(e.dataFields=[]);var n=zn(e.dataFields,e.name),i=Dn.Office.System.UserAction.getFields("UserAction",{id:null==e.actionId?void 0:e.actionId,name:null==e.actionName?void 0:e.actionName,commandSurface:null==e.commandSurface?void 0:e.commandSurface,parentName:null==e.parentName?void 0:e.parentName,triggerMethod:null==e.triggerMethod?void 0:e.triggerMethod,timeOffsetMs:null==e.timeOffsetMs?void 0:e.timeOffsetMs});n.push.apply(n,i);var r=Dn.Office.System.Activity.getFields({duration:t,count:1,aggMode:0,success:e.succeeded});return{eventName:e.name,eventContract:{name:Dn.Office.System.Activity.contractName,dataFields:r},dataFields:n,eventFlags:{}}}(e);ui.sendOtelTelemetryEvent(n,t)}function Si(){_i(),ui.flush(!0)}function bi(e){o.sendTraceTag(595947932,Tn,i.Info,"Processed TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function Ei(e){o.sendTraceTag(593597440,Tn,i.Warning,"Throttled TelemetryEvent "+e.eventName+" :"+JSON.stringify(e))}function _i(){if(!fi)throw new Error("Telemetry is not initialized!")}function Ci(e){switch(e.kind){case"event":try{mi(e.event)}catch(t){o.sendTraceTag(595947920,Tn,i.Error,"Error while processing TelemetryEvent "+e.event.name+" : "+Oi(t))}break;case"activity":try{yi(e.event)}catch(t){o.sendTraceTag(595947921,Tn,i.Error,"Error while processing ActivityEvent "+e.event.name+" : "+Oi(t))}break;case"action":try{Ti(e.event)}catch(t){o.sendTraceTag(595928211,Tn,i.Error,"Error while processing UserActionEvent "+e.event.name+" : "+Oi(t))}break;case"otel":try{!function(e){var t;_i();var n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var i=zn(e.additionalDataFields,n.eventName);(t=n.dataFields).push.apply(t,i)}ui.sendOtelTelemetryEvent(n)}(e.event)}catch(r){var t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(595947922,Tn,i.Error,"Error while processing OtelEvent "+t+" : "+Oi(r))}break;case"otelcc":try{!function(e){var t;_i();var n=e.otelEvent;if(!n||!n.dataFields)throw new Error("Invalid Otel event");if(e.additionalDataFields){var i=zn(e.additionalDataFields,n.eventName);(t=n.dataFields).push.apply(t,i)}ui.sendOtelCustomerContent(n)}(e.event)}catch(r){var n;t="";(n=e.event)&&(t=n.eventName),o.sendTraceTag(572298211,Tn,i.Error,"Error while processing OTel CustomerContent "+t+" : "+Oi(r))}break;case"addNamespaceMapping":try{r=e.namespace,a=e.ariaTenantToken,_i(),ui.setTenantToken(r,a)}catch(t){o.sendTraceTag(595947923,Tn,i.Error,"Error while adding namespace mapping for "+e.namespace+" : "+Oi(t))}break;case"shutdown":try{_i(),o.sendTraceTag(595947931,Tn,i.Info,"Otel library shutdown triggered ["+gi+"]"),di&&di.shutdown(),ui.shutdown()}catch(e){o.sendTraceTag(595947924,Tn,i.Error,"Error while processing shutdown event")}break;case"initialize":break;default:throw new Error(e)}var r,a}function Oi(e){return e instanceof Error?e.message?e.message:"":null!=e.message?e.message:JSON.stringify(e)}var wi=function(){function e(){}return e.prototype.sendTraceTag=function(e,t,n,i){this.sendTagToMainThread(e,t,n,i)},e.prototype.shipAssertTag=function(e,t,n,r){this.sendTagToMainThread(e,t,i.Warning,r)},e.prototype.debugAssertTag=function(e,t,n,r){this.sendTagToMainThread(e,t,i.Warning,r)},e.prototype.sendTagToMainThread=function(e,t,n,i){var r;switch(e){case 593597406:r=570763344;break;case 593597407:r=570763345;break;case 593597408:r=570763346;break;case 593597409:r=570763347;break;case 593597410:r=570763348;break;default:r=e}self.postMessage({tagId:r,category:t,level:n,message:i})},e}();n.d(t,"processWebWorkerMessage",(function(){return Mi}));var xi="00000000-0000-0000-0000-000000000001",Ii="-314",Pi="WebWorkerPrototype",ki="00000000-0000-0000-0000-000000000002",Ni={total:0,miscEvents:0,allowed:0,disallowed:0};function Mi(e){try{if(!e||!e.data)return void o.sendTraceTag(570709062,hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype,i.Warning,"Received invalid event!");for(var t=e.data,n=0,r=t;n<r.length;n++){var a=r[n];try{switch(a.kind){case"initialize":Ni.total+=1,Ni.miscEvents+=1,Fi(a.event,a.timestamp);break;case"addNamespaceMapping":case"shutdown":Ni.total+=1,Ni.miscEvents+=1,Ci(a),Li();break;case"action":case"activity":case"event":Di(a.event)&&Ci(a);break;case"otel":case"otelcc":Ai(a.event)&&Ci(a);break;default:throw new Error(a)}}catch(e){o.sendTraceTag(570709063,hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype,i.Warning,"Exception while processing event "+a.kind+" : "+e)}}t.length>1&&Si(),o.sendTraceTag(570709064,hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype,i.Info,"Worker received "+t.length+" event(s) from main thread")}catch(e){o.sendTraceTag(570709065,hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype,i.Warning,"Exception while processing events : "+e)}}function Fi(e,t){var n,r,a,s=(new Date).getTime()-t;o.sendTraceTag(570763339,hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype,i.Info,s),e.ulsLogger=new wi,xi=(null===(n=e.alwaysOnMetadata)||void 0===n?void 0:n.sessionId)||xi,Ii=(null===(r=e.alwaysOnMetadata)||void 0===r?void 0:r.ring)||Ii,Pi=(null===(a=e.alwaysOnMetadata)||void 0===a?void 0:a.audienceGroup)||Pi,ki=Object(an.v1)(),e.alwaysOnMetadata&&(e.alwaysOnMetadata.sessionId=ki,e.alwaysOnMetadata.ring="-314",e.alwaysOnMetadata.audienceGroup="WebWorkerPrototype"),e.loggingCategory=hn.msoulscat_MSOSP_OTelJSInWebWoker,hi(e);var c={name:"Office.Online.Telemetry.OTelJS.WebWoker.Ready",dataFields:[{name:"WorkerInitDuration",double:s}]};Di(c),mi(c),Si()}function Di(e){if(Ni.total+=1,!e.name)return!1;var t=e.name.toLowerCase();return 0!==t.indexOf("office.sandbox")&&0!==t.indexOf("office.online")&&0!==t.indexOf("office.word.online")&&0!==t.indexOf("office.excel.online")&&0!==t.indexOf("office.powerpoint.online")&&0!==t.indexOf("office.onenote.online")&&0!==t.indexOf("office.visio.online")?(Ni.disallowed+=1,!1):(e.dataFields||(e.dataFields=[]),e.dataFields.push({name:"Original.SessionId",string:xi}),e.dataFields.push({name:"Original.Ring",string:Ii}),e.dataFields.push({name:"Original.AudienceGroup",string:Pi}),!0)}function Ai(e){return Ni.total+=1,Ni.disallowed+=1,!1}function Li(){Ni.allowed=Ni.total-Ni.disallowed-Ni.miscEvents,o.sendTraceTag(570709066,hn.msoulscat_MSOSP_OTelJSWebWorkerPrototype,i.Info,"OtelWorker processed event stats "+JSON.stringify(Ni))}self.onmessage=Mi,s(new wi)}]);
//# sourceMappingURL=otel.worker.min.js.map