(window.webpackJsonp_name_=window.webpackJsonp_name_||[]).push([[20],{1198:function(e,t,n){"use strict";var o=n(1813),i=n(1609),r=n(1838);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return r.a}))},1208:function(e,t,n){"use strict";n.r(t);var o=n(1837);n.d(t,"TeachingCallout",(function(){return o.a}));var i=n(1833);n.d(t,"OfficeStandardCallout",(function(){return i.a}));var r=n(1789);n.d(t,"Notification",(function(){return r.a})),n.d(t,"ToastNotification",(function(){return r.c})),n.d(t,"StandardCallout",(function(){return r.b}))},1209:function(e,t,n){"use strict";var o=n(1),i=n(0),r=n(45),a=n(1838),s=n(210),l=n(4),c=n(92),u=n(247),p=n(1711),d=n(33),h=n(179),g=n(286),m=n(157),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.contentRendererFunction&&this.props.contentRendererFunction()||this.props.message;return i.createElement(m.a,null,(function(n){var r=function(e){return{root:Object(l.eb)(e.root),icon:Object(l.eb)(e.icon)}}(function(e,t){var n=Object(c.a)(e),o=Object(d.a)()?e.palette.neutralLight:u.a.hoverBackgroundColor,i={root:[l.f.small,{border:"1px solid "+o,borderRadius:"2px",boxShadow:p.a.depth8,color:n.textColor,display:"flex",lineHeight:"16px",margin:"2px",padding:"8px 12px 8px 12px",backgroundColor:n.defaultBackgroundColor}],icon:{height:16,width:16,paddingRight:8}};return Object(l.H)(i,t)}(n,e.props.styles));return i.createElement("div",{className:r.root},e.props.icon&&i.createElement(h.a,Object(o.__assign)({},Object(g.a)(e.props.icon),{className:r.icon})),t)}))},t}(i.PureComponent);function f(e){return i.createElement(b,Object(o.__assign)({},e))}var y=n(9),v=n(520);var C,x={appear:"appear",appearActive:"appearActive",appearDone:"appearDone",enter:"enter",enterActive:"enterActive",enterDone:"enterDone",exit:"exit",exitActive:"exitActive",exitDone:"exitDone"},S=Object(y.c)((function(e){var t,n={animations:{selectors:(t={},t["&.appear"]=e.appear,t["&.appearActive"]=e.appearActive,t["&.enter"]=e.enter,t["&.enterActive"]=e.enterActive,t["&.enterDone"]=e.enterDone,t["&.exit"]=e.exit,t["&.exitActive"]=e.exitActive,t["&.exitDone"]=e.exitDone,t)}};return Object(l.db)(n)})),E=n(12),w=n(38),k=Object(y.c)((function(e){return Object(l.db)({root:{display:"flex",flexDirection:"row",justifyContent:"flex-end",whiteSpace:"nowrap"},hidden:{display:"inline-block",position:"absolute",opacity:0}},e)})),T=Math.max(250,100),I=function(e){return e?E.E:350+T},R=Object(y.c)((function(e,t){if(t)return{};var n={width:0,opacity:0,transform:"scale(0,0)"},o={width:e,opacity:1,transform:"scale(1,1)",transition:"width 250ms linear, transform 250ms ease-out 350ms, opacity 100ms linear 350ms"};return{appear:n,appearActive:o,enter:n,enterActive:o,exit:{width:e,opacity:1,transform:"scale(1,1)"},exitActive:{width:0,opacity:0,transform:"scale(0,0)",transition:"transform 250ms ease-out, opacity 100ms linear, width 250ms linear "+(T+100)+"ms"},exitDone:n}})),O=n(1606),P=(function(e){function t(t){var n=e.call(this,t)||this;return n.getDeleteToastCallback=function(e){return function(){n.setState((function(t){var n=Object(s.e)(t.toasts,(function(t){return t.key===e}));if(n>=0){var i={toasts:Object(o.__spreadArrays)(t.toasts)};return i.toasts.splice(n,1),i}return t}))}},n.state={toasts:[]},n}Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.afterComponentRender()},t.prototype.componentDidUpdate=function(){this.afterComponentRender()},t.prototype.render=function(){var e=this,t=k(this.props.styles);return i.createElement("div",{ref:this.props.containerRef,className:t.root,"aria-live":"polite","aria-relevant":"additions","aria-atomic":"false"},this.state.toasts.filter((function(e){return!e.width})).map((function(e){return i.createElement("div",{key:e.key,ref:e.ref,className:t.hidden,"aria-hidden":!0},f(e.toastProps))})),this.state.toasts.filter((function(e){return e.width})).map((function(t){var n,r,a,s,l,c=(n=t.width,r=Object(w.isReducedAnimations)(),{transitionClassNames:S(R(n,r)),timeout:I(r)}),u=i.createElement("div",{ref:t.ref,className:c.transitionClassNames.animations},f(t.toastProps));return i.createElement(O.a,Object(o.__assign)({key:t.key},t.notificationProps),(a=u,s=c,l={key:t.key,onExited:e.getDeleteToastCallback(t.key),appear:!0,in:!t.isLeaving},i.createElement(v.CSSTransition,Object(o.__assign)({},l,{classNames:x,timeout:s.timeout||0}),a)))})))},t.prototype.addToast=function(e,n){var r=Object(s.d)(this.state.toasts,(function(t){return t.toastProps===e}));if(r)return r.key;var a=t.toastCounter.toString();return t.toastCounter+=1,this.setState((function(t){return{toasts:Object(o.__spreadArrays)(t.toasts,[{key:a,toastProps:e,notificationProps:n,ref:i.createRef(),isLeaving:!1}])}})),a},t.prototype.updateToast=function(e,t){this.setState((function(n){var i=Object(s.e)(n.toasts,(function(t){return t.key===e}));if(i>=0){var r={toasts:Object(o.__spreadArrays)(n.toasts)};return r.toasts[i]=Object(o.__assign)(Object(o.__assign)({},r.toasts[i]),{toastProps:t}),r}return n}))},t.prototype.removeToast=function(e){this.setState((function(t){var n=Object(s.e)(t.toasts,(function(t){return t.key===e}));if(n>=0){var i={toasts:Object(o.__spreadArrays)(t.toasts)};return i.toasts[n].isLeaving=!0,i}return t}))},t.prototype.afterComponentRender=function(){var e=this;requestAnimationFrame((function(){e.setState((function(e){var t=!1,n={toasts:Object(o.__spreadArrays)(e.toasts)};return n.toasts.forEach((function(e){!e.width&&e.ref.current&&(e.width=e.ref.current.clientWidth+1,t=!0)})),t?n:e}))}))},t.toastCounter=0}(i.PureComponent),n(115)),F=n(390),D=n(882),_=Object(y.c)((function(e,t,n){var o=[];e&&o.push(e),n&&o.push(n);var i={root:{width:o.length?Math.max.apply(Math,o):void 0,selectors:{img:{display:"block",marginLeft:"auto",marginRight:"auto",height:t}}}};return Object(l.db)(i)})),j=n(1763),B=function(e){function t(t){var n=e.call(this,t)||this;return n.imgWrapperRef=i.createRef(),n.onLoadingStateChange=function(e){if(e===P.c.loaded&&!n.props.imageWidth&&n.imgWrapperRef.current){var t=n.imgWrapperRef.current.querySelector("img");t&&t.width&&n.setState({imageWidth:t.clientWidth})}},n.state={imageWidth:t.imageWidth},n}return Object(o.__extends)(t,e),t.prototype.componentDidUpdate=function(e){e.imageWidth!==this.props.imageWidth&&this.props.imageWidth!==this.state.imageWidth&&this.setState({imageWidth:this.props.imageWidth})},t.prototype.render=function(){var e=this,t=this.props,n=t.paragraphs,r=t.image,a=Object(o.__assign)(Object(o.__assign)({},r),{onLoadingStateChange:this.getOnloadingStateChangecallback()}),s=_(this.state.imageWidth,this.props.imageHeight,this.props.parentContainerMinWidth);return i.createElement("div",{className:s.root},(Array.isArray(n)?n:[n]).map((function(t,n){return e.renderParagraph(n,t)})),i.createElement("div",{ref:this.imgWrapperRef},i.createElement(F.a,Object(o.__assign)({},a))))},t.prototype.renderParagraph=function(e,t){if("string"==typeof t)return i.createElement("p",{key:e},t);switch(t.type){case"AppLinkProps":return i.createElement("p",{key:e},i.createElement(j.a,Object(o.__assign)({},t)));default:Object(D.a)(t.type)}},t.prototype.getOnloadingStateChangecallback=function(){var e=this;return function(t){e.props.image.onLoadingStateChange&&e.props.image.onLoadingStateChange(t),e.onLoadingStateChange(t)}},t}(i.PureComponent),L=n(924),M=Object(y.c)((function(e){var t=Object(c.a)(e),n={root:{backgroundColor:t.defaultBackgroundColor,height:"58px",width:"234px",display:"flex",marginTop:"8px"},rootRow:{display:"flex",flexDirection:"row",alignItems:"center"},rootColumn:{display:"flex",flexDirection:"column"},countNumber:{color:t.defaultBackgroundColor,fontFamily:"Bahnschrift, Segoe UI, Helvetica Neue",fontSize:"20px",height:"40px",letterSpacing:"0px",lineHeight:"46px",textAlign:"center",verticalAlign:"middle",width:"40px"},countBox:{background:"linear-gradient(-225deg, #3355ff 0%, #7160e8 100%)",borderRadius:"2px",height:"42px",width:"40px",marginRight:"20px"},messageBody:{width:"166px",height:"40px",color:t.textSecondaryColor,fontSize:"12px",fontFamily:"Segoe UI, Helvetica Neue",lineHeight:"18px"}};return Object(l.db)(n)})),A=function(e){function t(t){var n=e.call(this,t)||this;return n.createButton=function(e,t){return void 0===e||0===e.length?i.createElement(i.Fragment,null," "):i.createElement(L.a,Object(o.__assign)({type:"AppButtonProps",onExecute:e[0].onExecute,label:e[0].label,id:e[0].label,styles:t},e))},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.numberOfWritingIssuesFound,o=t.buttonPropsList,r=t.ideasProactiveCalloutMessageSingular,a=t.ideasProactiveCalloutMessagePlural,s=n<100?n:"99+",l=1===n?r.replace("{0}",n.toString()):a.replace("{0}",n.toString());return i.createElement(m.a,null,(function(t){var n=M(t);return i.createElement("div",{className:n.root},i.createElement("div",{className:n.rootRow},i.createElement("div",{className:n.countBox},i.createElement("div",{className:n.countNumber},s))),i.createElement("div",{className:n.rootColumn},i.createElement("div",{className:n.messageBody},l),e.createButton(o,function(){var e;return{root:{border:"0px",padding:"0px",minWidth:"94px",maxWidth:"166px",height:"18px",backgroundColor:"transparent",selectors:(e={},e[E.b]={backgroundColor:"transparent"},e)},rootHovered:{backgroundColor:"transparent"},rootPressed:{backgroundColor:"transparent"},flexContainer:{padding:"0px",margin:"0px"},textContainer:{color:"#7160E8",fontSize:"12px",fontFamily:"Segoe UI, Helvetica Neue",lineHeight:"18px",margin:"0px",padding:"0px"},label:{margin:"0px",padding:"0px",selectors:{":hover":{color:"#5648b0",textDecoration:"underline"},":active":{color:"#403582",textDecoration:"underline"}}}}}())))}))},t}(i.PureComponent),W=function(e){return function(){return i.createElement(A,Object(o.__assign)({},e))}},z=n(1832);!function(e){e[e.None=0]="None",e[e.Top=1]="Top",e[e.Side=2]="Side"}(C||(C={}));var H,N=Object(y.c)((function(e,t,n){void 0===t&&(t=C.None);var o={root:{display:"flex",flexDirection:t===C.Side?"row":"column"},imageContainer:{display:"flex",alignItems:"center",justifyContent:"center",paddingBottom:t===C.Top?20:0,paddingRight:t===C.Side?20:0},contentContainer:{maxWidth:300},title:{fontWeight:l.k.semibold,marginBottom:14,fontSize:e?l.j.mediumPlus:l.j.xLarge,paddingRight:24},buttonsContainer:{display:"inline-block",paddingLeft:12},footer:{width:"100%",display:"flex",justifyContent:"flex-end",alignItems:"center"},message:{selectors:{p:{marginTop:"1em",marginBottom:"1em"},"p:first-child":{marginTop:0,paddingRight:n?void 0:24}}}};return Object(l.db)(o)})),V=Object(y.c)((function(e,t){var n={position:"relative"},i={root:Object(o.__assign)({},n)},r={root:Object(o.__assign)(Object(o.__assign)({},n),{marginLeft:8})},a=Object(z.a)(e,t,{primaryButton:i,secondaryButton:r});return{primaryButton:a.primaryButton,secondaryButton:a.secondaryButton}})),G=n(151),U=function(e){return function(){return i.createElement(K,Object(o.__assign)({},e))}},K=function(e){function t(t){var n=e.call(this,t)||this;return n.onLoadingStateChange=function(e){e===P.c.error&&n.setState({hideImage:!0})},n.state={hideImage:!1},n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.image,n=e.positionImageAtLeft,r=e.smallHeadline,a=e.message,s=e.footer,l=e.title,c=t?n?C.Side:C.Top:C.None,u=Array.isArray(a)?a:[a],p=N(!!r,c,!!l);return i.createElement("div",{className:p.root},t&&!this.state.hideImage&&i.createElement("div",{className:p.imageContainer},i.createElement(F.a,Object(o.__assign)({},t,{className:p.image,onLoadingStateChange:this.onLoadingStateChange}))),i.createElement("div",{className:p.contentContainer},l&&i.createElement("div",{className:p.title},l),i.createElement("div",{className:p.message},u.map((function(e,t){return i.createElement("p",{key:t},e)}))),i.createElement("div",{className:p.footer},s&&i.createElement("span",null,s),this.renderButtons(p))))},t.prototype.renderButtons=function(e){var t=this.props,n=t.primaryButtonProps,r=t.secondaryButtonProps,a=t.appColors,s=Object(G.a)("FloodgateCallout");return i.createElement(m.a,null,(function(t){var l=V(t,a);return(n||r)&&i.createElement("span",{className:e&&e.buttonsContainer},n&&i.createElement(L.a,Object(o.__assign)({},n,{id:s+"-primaryButton",type:"AppButtonProps",styles:l&&l.primaryButton})),r&&i.createElement(L.a,Object(o.__assign)({},r,{id:s+"-secondaryButton",type:"AppButtonProps",styles:l&&l.secondaryButton})))}))},t}(i.PureComponent),q=n(55),Q=n(58),J=n(188),Y=n(568),X=n(82),Z=n(477),$=n(339),ee=Object(y.c)((function(e,t,n){var o=Object(c.a)(e),i={borderRadius:2,height:32,fontWeight:l.k.semibold,letterSpacing:"0",textAlign:"center",position:"relative"},r={root:{background:o.defaultBackgroundColor,minWidth:250},radioButtonsContainer:{display:"inline-flex",justifyContent:"center",marginBottom:23},prompt:{marginBottom:13,marginTop:0,fontSize:l.j.medium,color:Object(d.a)()?e.palette.black:X.a.black},question:{marginBottom:23,color:Object(Z.a)(e).primaryTextColor,fontSize:l.j.large,fontWeight:"bold",maxWidth:null!=n?n:"100%"},disclaimer:{color:o.textDisclaimerColor,fontSize:l.j.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},disclaimerText:{margin:0},privacyLink:{marginLeft:5},buttonsContainer:{marginTop:21},subComponentStyles:{submitButton:Object(l.H)({root:[{marginRight:12},i]},Object($.d)(Object($.b)(t),$.a)),cancelButton:Object(l.H)({root:i},Object($.d)(Object($.f)(e),$.a))}};return Object(l.db)(r)})),te=Object(y.c)((function(){return{flexContainer:{display:"flex",marginLeft:18,height:24}}})),ne=Object(y.c)((function(e,t){var n=Object(d.a)()?e.palette.themePrimary:t.primary;return{root:{minHeight:18,marginRight:18,marginTop:7},field:{right:1,width:18,selectors:{":hover::before":{borderColor:n},":hover::after":{borderColor:n,backgroundColor:n},":after":{borderColor:n}}},choiceFieldWrapper:{selectors:{".is-checked::before":{borderColor:n}}}}})),oe=n(1738),ie=n(1585),re=function(e){function t(t){var n=e.call(this,t)||this;return n.radioButtonContainerRef=i.createRef(),n.getOptions=function(e,t,n){var o=ne(e,t);return n.map((function(e,t){return{key:""+t,text:"",ariaLabel:e,styles:o}}))},n.handleOnUserSelection=function(e){n.setState({selectedRating:parseInt(e.key,10)}),q.a.sendTraceTag(590653001,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"User has selected a rating on NpsOneClickRadioButton")},n.renderButtons=Object(y.c)((function(e,t,o){return i.createElement(i.Fragment,null,i.createElement(oe.a,{type:"AppLabelProps",forId:"rating labels",label:o[0],id:"leading anchor"}),i.createElement(ie.a,{id:n.id,key:n.id,type:"AppChoiceGroupProps",label:"",options:n.getOptions(e,t,o),styles:te(),onChange:n.handleOnUserSelection}),i.createElement(oe.a,{type:"AppLabelProps",forId:n.id,label:o[o.length-1],id:"trailing anchor"}))})),n.handleSubmit=function(){n.hasSelectedRating()&&n.props.npsOneClickCommonProps.ratingSendButtonProps.onExecute(n.state.selectedRating),n.props.updateCurrentPageNumber(H.Verbatim),q.a.sendTraceTag(590700805,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"User has submitted a rating of "+n.state.selectedRating+" on NpsOneClickRadioButton")},n.handleCancel=function(){n.props.npsOneClickCommonProps.cancelButtonProps.onExecute(),q.a.sendTraceTag(590653002,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"User has dismissed the NpsOneClickRadioButton")},n.state={},n.id=Object(G.a)("NpsOneClickRadioButton"),n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){this.afterComponentRender(),q.a.sendTraceTag(590700804,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"NpsOneClickRadioButton has been displayed")},t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,r=t.npsOneClickCommonProps,a={href:r.privacyStatementLink,target:"_blank"};return i.createElement(m.a,null,(function(t){var s=ee(t,n,e.state.radioButtonContainerWidth);return i.createElement("div",{className:s.root},r.prompt&&i.createElement("p",{className:s.prompt},r.prompt),r.question&&i.createElement("p",{className:s.question},r.question),i.createElement("div",{className:s.radioButtonsContainer,ref:e.radioButtonContainerRef},e.renderButtons(t,n,r.ratingLabels)),i.createElement("div",{className:s.disclaimer},i.createElement("p",{className:s.disclaimerText},r.disclaimer,i.createElement("span",{className:s.privacyLink},i.createElement(j.a,{handler:a,type:"AppLinkProps",id:"privacy link",text:r.verbatimPrivacyStatement})))),i.createElement("div",{className:s.buttonsContainer},i.createElement(Y.a,Object(o.__assign)({},r.ratingSendButtonProps,{styles:s.subComponentStyles.submitButton(),disabled:!e.hasSelectedRating(),onClick:e.handleSubmit})),i.createElement(Y.a,Object(o.__assign)({},r.cancelButtonProps,{styles:s.subComponentStyles.cancelButton(),onClick:e.handleCancel}))))}))},t.prototype.afterComponentRender=function(){this.radioButtonContainerRef.current&&!this.state.radioButtonContainerWidth&&this.setState({radioButtonContainerWidth:this.radioButtonContainerRef.current.clientWidth})},t.prototype.hasSelectedRating=function(){return void 0!==this.state.selectedRating},t}(i.PureComponent),ae=Object(y.c)((function(e,t,n){var o=Object(c.a)(e),i=Object(Z.a)(e),r={borderRadius:2,height:32,fontWeight:l.k.semibold,letterSpacing:"0",textAlign:"center",position:"relative"},a={frame:{background:o.defaultBackgroundColor,maxWidth:400},verbatimPrompt:{top:8,left:13,fontStyle:"normal",fontWeight:600,fontSize:l.j.medium,lineHeight:20,color:i.primaryTextColor},verbatimDisclaimer:{marginBottom:13,marginTop:5,color:o.textDisclaimerColor,fontSize:l.j.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},email:{marginBottom:13,marginTop:0,fontSize:l.j.medium,color:e.palette.black},submissionDisclaimer:{color:o.textDisclaimerColor,fontSize:l.j.small,fontStyle:"normal",fontWeight:"normal",maxWidth:null!=n?n:"100%",display:"flex"},submissionDisclaimerText:{margin:0},privacyLink:{color:i.primaryTextColor,fontSize:l.j.small,fontStyle:"normal",fontWeight:"normal",marginLeft:5},buttonsContainer:{marginTop:21},subComponentStyles:{submitButton:Object(l.H)({root:[{marginRight:12},r]},Object($.d)(Object($.c)(e,t),$.a)),cancelButton:Object(l.H)({root:r},Object($.d)(Object($.f)(e),$.a))}};return Object(l.db)(a)})),se=Object(y.c)((function(e,t){return{root:{width:"100%"},fieldGroup:{borderColor:Object(d.a)()?e.palette.themePrimary:t.primary}}})),le=Object(y.c)((function(e,t,n){var o=Object(d.a)()?e.palette.themePrimary:t.primary;return{root:{padding:0,border:"none"},checkmark:[n&&[{fill:o}]],checkbox:[n&&[{borderColor:o}],!n&&[{borderColor:Object(d.a)()?e.palette.black:X.a.black}]]}})),ce=Object(y.c)((function(e,t){return{root:{width:"100%",backgroundColor:Object(c.a)(e).defaultBackgroundColor},fieldGroup:{borderColor:Object(d.a)()?e.palette.themePrimary:t.primary},errorMessage:{color:Object(d.a)()?e.palette.black:X.a.black}}})),ue=(Object(y.c)((function(){return{flexContainer:{display:"flex",marginLeft:18,height:24}}})),n(1781)),pe=n(1583),de=n(39),he=function(e){function t(t){var n=e.call(this,t)||this;return n.preventArrowKeysFromChangingFocus=function(e){[de.a.left,de.a.right,de.a.up,de.a.down].includes(e.keyCode)&&e.stopPropagation()},n.validateEmail=function(e){void 0!==e&&/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e.toLowerCase())?n.setState({isEmailValid:!0,errorMessage:""}):n.setState({isEmailValid:!1,errorMessage:n.props.npsOneClickCommonProps.emailValidationErrorMessage})},n.onUserInputChange=function(e){n.setState({userVerbatim:e})},n.onUserEmailInputChange=function(e){n.setState({userEmail:e}),n.validateEmail(e)},n.onContactBoxChange=function(e){e.checked?n.validateEmail(n.state.userEmail):n.setState({userEmail:"",isEmailValid:!1,errorMessage:""}),n.setState({allowEmailContact:e.checked})},n.handleSubmit=function(){var e=JSON.stringify({surveyStrings:JSON.stringify({prompt:Object(o.__assign)({},n.props.npsOneClickCommonProps.promptComponent.data),rating:[Object(o.__assign)({},n.props.npsOneClickCommonProps.ratingComponent.data)]})}),t=n.state.allowEmailContact?n.state.userEmail:"",i=[n.state.userVerbatim,t,e];n.props.npsOneClickCommonProps.verbatimSendButtonProps.onExecute(i),n.props.updateCurrentPageNumber(H.ThankyouPage),q.a.sendTraceTag(587511237,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"User has submitted input on NpsVerbatim text box")},n.handleCancel=function(){n.props.updateCurrentPageNumber(H.ThankyouPage),q.a.sendTraceTag(587511238,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"User has clicked the cancel button to dismiss the NpsVerbatim")},n.state={allowEmailContact:!1,userVerbatim:void 0,isEmailValid:!1},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){q.a.sendTraceTag(587511235,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"NpsVerbatim has been displayed")},t.prototype.componentWillUnmount=function(){q.a.sendTraceTag(587511236,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"NpsVerbatim has been dismissed")},t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,r=t.npsOneClickCommonProps,a={href:r.privacyStatementLink,target:"_blank"};return i.createElement(m.a,null,(function(t){var s=ae(t,n);return i.createElement("div",{className:s.frame},i.createElement("div",{className:s.verbatimPrompt},r.verbatimPrompt),i.createElement("div",{className:s.verbatimDisclaimer},r.verbatimDisclaimer),i.createElement(ue.a,{styles:se(t,n),multiline:!0,value:e.state.userVerbatim,onChange:e.onUserInputChange,onKeyDown:e.preventArrowKeysFromChangingFocus,resizable:!0,type:"AppInputProps",id:"Verbatim Textbox"}),!r.isCommercialHost&&i.createElement("div",{className:s.email},i.createElement(pe.a,{label:r.emailLabel,checked:e.state.allowEmailContact,onExecute:e.onContactBoxChange,styles:le(t,n,e.state.allowEmailContact),checkmarkIcon:e.props.checkmarkIcon,type:"AppCheckboxProps",id:"Email Checkbox"}),i.createElement(ue.a,{styles:ce(t,n),multiline:!1,value:e.state.allowEmailContact?e.state.userEmail:"",onChange:e.onUserEmailInputChange,disabled:!e.state.allowEmailContact,placeholder:r.emailPlaceHolder,type:"AppInputProps",id:"Email Textbox",errorMessage:e.state.errorMessage})),i.createElement("div",{className:s.submissionDisclaimer},i.createElement("p",{className:s.submissionDisclaimerText},r.submissionDisclaimer,i.createElement("span",{className:s.privacyLink},i.createElement(j.a,{handler:a,type:"AppLinkProps",id:"privacy link",text:r.verbatimPrivacyStatement})))),i.createElement("div",{className:s.buttonsContainer},i.createElement(Y.a,Object(o.__assign)({},r.verbatimSendButtonProps,{styles:s.subComponentStyles.submitButton(),onClick:e.handleSubmit,disabled:!e.enableSubmit()})),i.createElement(Y.a,Object(o.__assign)({},r.cancelButtonProps,{styles:s.subComponentStyles.cancelButton(),onClick:e.handleCancel}))))}))},t.prototype.enableSubmit=function(){return this.state.allowEmailContact?this.state.userEmail&&this.state.isEmailValid:this.state.userVerbatim},t}(i.PureComponent),ge=Object(y.c)((function(e,t){var n={frame:{background:Object(c.a)(e).defaultBackgroundColor,minWidth:400,fontSize:l.j.large,lineHeight:24,color:Object(Z.a)(e,t).primaryTextColor}};return Object(l.db)(n)})),me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){var e=this;setTimeout((function(){return e.props.cancelButtonProps.onExecute()}),3e3),q.a.sendTraceTag(587511233,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"Thankyou Page has been displayed with a 3s timer to auto dismiss")},t.prototype.componentWillUnmount=function(){q.a.sendTraceTag(587511234,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"Thankyou Page has been dismissed")},t.prototype.render=function(){var e=this;return i.createElement(m.a,null,(function(t){var n=ge(t,e.props.appColors);return i.createElement("div",{className:n.frame},e.props.thankyouText)}))},t}(i.PureComponent);!function(e){e[e.Rating=0]="Rating",e[e.Verbatim=1]="Verbatim",e[e.ThankyouPage=2]="ThankyouPage"}(H||(H={}));var be=function(e){function t(t){var n=e.call(this,t)||this;return n.updateCurrentPageNumber=function(e){n.setState({currentPage:e})},n.state={currentPage:n.props.npsOneClickCommonProps.currentPage},n}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){q.a.sendTraceTag(587511239,Q.a.msoulscat_Wac_Telemetry,J.a.Info,"NpsOneClickSurvey is currently displaying page # "+this.state.currentPage)},t.prototype.render=function(){var e=i.createElement(i.Fragment,null);if(this.state.currentPage===H.Rating){var t="NPSOneClickRadioButton";e=i.createElement(re,Object(o.__assign)({},this.props,{type:t,updateCurrentPageNumber:this.updateCurrentPageNumber}))}else if(this.state.currentPage===H.Verbatim){t="NPSVerbatim";e=i.createElement(he,Object(o.__assign)({},this.props,{type:t,updateCurrentPageNumber:this.updateCurrentPageNumber,checkmarkIcon:this.props.checkmarkIcon}))}else this.state.currentPage===H.ThankyouPage&&(e=i.createElement(me,{thankyouText:this.props.npsOneClickCommonProps.thankyouText,appColors:this.props.appColors,cancelButtonProps:this.props.npsOneClickCommonProps.cancelButtonProps}));return e},t}(i.PureComponent),fe=function(e){return function(){return i.createElement(be,Object(o.__assign)({},e))}},ye=Object(y.c)((function(e,t){var n={premiumIconContainer:{height:28,marginBottom:12},premiumIcon:{width:20,height:28,cursor:"default"},title:{fontSize:20,lineHeight:28,marginBottom:12,color:e.palette.neutralPrimary,cursor:"default"},contentContainer:{fontSize:12,lineHeight:16,marginBottom:20,color:e.palette.neutralPrimary},message:{marginBottom:12},image:{display:"block",marginLeft:"auto",marginRight:"auto",height:t},screenReaderText:l.ab};return Object(l.db)(n)})),ve=n(1894),Ce=function(e){function t(t){return e.call(this,t)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.title,n=e.content,r=e.titleId,a=e.imageProps,s=e.appColors;return i.createElement(m.a,null,(function(e){var l=ye(e),c=Object(Z.a)(e,s);return i.createElement("div",null,i.createElement("div",{className:l.premiumIconContainer},i.createElement(h.a,Object(o.__assign)({},Object(g.a)("UpgradeProductGlyphColorless_16",c.primaryTextColor),{className:l.premiumIcon})),i.createElement("span",{className:l.screenReaderText},ve.NotificationStrings.PremiumFeatureDiamond)),i.createElement("div",{className:l.title,id:r},t),i.createElement("div",{className:l.contentContainer},i.createElement("div",{className:l.message},n),a&&i.createElement("div",null,i.createElement(F.a,Object(o.__assign)({},a,{className:l.image})))))}))},t}(i.PureComponent),xe=function(e){return function(){return i.createElement(Ce,Object(o.__assign)({},e))}},Se=function(e){if(!e)return!1;switch(e.type){case"NPSOneClick1":case"NPSOneClick2":case"NPSOneClickRadioButton":case"FloodgateTeachingCallout":return!0;case"IdeasCallout":case"TextAboveImage":default:return!1}},Ee=n(1778),we=function(e,t){var n=Object(c.a)(e),o={subComponentStyles:{callout:{calloutMain:[l.f.small,{padding:"8px 12px",backgroundColor:n.defaultBackgroundColor,color:n.textColor,lineHeight:16,maxWidth:310}]}}};return Object(l.H)(o,t)},ke=6*Math.sqrt(2),Te=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;return i.createElement(m.a,null,(function(t){return i.createElement(Ee.a,Object(o.__assign)({},e.props,{calloutProps:Object(o.__assign)({beakWidth:ke},e.props.calloutProps),styles:we(t,e.props.styles)}))}))},t}(i.PureComponent),Ie=n(284),Re=n(1833),Oe=n(1837),Pe=n(106),Fe=function(e){function t(t){var n=e.call(this,t)||this;return n.keyId=0,n.state={entries:{}},Object(Pe.a)(n),t.componentRef.current=n,n}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=[];for(var t in this.state.entries){var n=this.state.entries[t];e.push(this.props.renderItem(t,n))}return e},t.prototype.canRender=function(e){return this.props.canRender(e)},t.prototype.contains=function(e){return!!this.state.entries[e]},t.prototype.add=function(e){if(this.canRender(e)){var t=this.props.keyPrefix+this.keyId;return this.keyId+=1,this.setState((function(n){var i=Object(o.__assign)({},n.entries);return i[t]=Object(o.__assign)({key:t},e),{entries:i}})),t}},t.prototype.remove=function(e){this.state.entries[e]&&this.setState((function(t){var n=Object(o.__assign)({},t.entries);return delete n[e],{entries:n}}))},t.prototype.update=function(e,t){this.state.entries[e]&&this.setState((function(n){var i=Object(o.__assign)({},n.entries);return i[e]=t,{entries:i}}))},t}(i.Component),De=n(1029),_e=n(1835),je=n(1182),Be=n(53),Le=n(152),Me=n(1780),Ae=n(43),We=Object(y.c)((function(e){return function(){var t={type:"calloutClosed",correlation:e};Object(Me.a)().emit("calloutClosed",t)}})),ze=Object(y.c)((function(e,t,n){var i=n.onTargetResolved,r=He(e,t),a=i?function(e,t){i(e,t),r(e,t)}:r;return Object(o.__assign)(Object(o.__assign)({},n),{onTargetResolved:a})})),He=Object(y.c)((function(e,t){return function(n,o){if(Object(Ae.a)()){var i={type:"shouldShowCallout",id:e,targetElement:n};Object(Me.a)().emitWaitUntil("shouldShowCallout",i).then((function(){var e,i,r;e=n,i=t,r=function(t){Object(Le.a)(t.detail.element,e)&&(i(),Object(Me.a)().removeListener("elementExit",r))},Object(Me.a)().addListener("elementExit",r),o()}),(function(e){}))}else o()}}));var Ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.canRender=function(e){var t=e.contentProps.type;return"CalloutProps"===t||"SimpleCalloutProps"===t||"TeachingCalloutProps"===t},t.renderItem=Object(y.c)((function(e,n){var r,a=t.props.hostElement,s=a&&"function"==typeof a?a():a,l=t.addFocusCallback(n),c=l.contentProps,u=l.notificationProps,p=null===(r=(c=t.ensureDismissCallback(e,{contentProps:c},Object(Ae.a)()?[We(e)]:[]).contentProps).calloutProps)||void 0===r?void 0:r.onDismiss;return c=ze(e,p,c),i.createElement(O.a,Object(o.__assign)({key:e,hostElement:s},u),t.renderCallout(c))})),t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props.rendererRef;return i.createElement(je.a,{isExperimentalFeatureEnabled:Be.d},i.createElement(Fe,{componentRef:e,keyPrefix:"callout",canRender:this.canRender,renderItem:this.renderItem}))},t.prototype.renderCallout=function(e){var t,n,r=this.props.appCustomizations,a=r.augmentContentProps,s=r.appColors,l=r.appStrings,c=r.icons,u=void 0,p=e;if(e.content){var d=function(e,t,n){var r,a=(null==n?void 0:n.checkmark)||"";switch(e.type){case"TextAboveImage":return{contentRendererCallback:(r=e,function(e){return i.createElement(B,Object(o.__assign)({},r,{parentContainerMinWidth:e&&e.minWidth}))})};case"NPSOneClickRadioButton":return{contentRendererCallback:fe(Object(o.__assign)(Object(o.__assign)({},e),{appColors:t,checkmarkIcon:a}))};case"IdeasCallout":return{contentRendererCallback:W(e)};case"FloodgateTeachingCallout":return{contentRendererCallback:U(Object(o.__assign)(Object(o.__assign)({},e),{appColors:t}))};case"PremiumUpsellCallout":var s=Object(G.a)("PremiumUpsellCalloutTitle");return{contentRendererCallback:xe(Object(o.__assign)(Object(o.__assign)({},e),{appColors:t,titleId:s})),calloutPropsUpdate:function(e){return Object(o.__assign)(Object(o.__assign)({},e),{calloutProps:Object(o.__assign)(Object(o.__assign)({},e.calloutProps),{ariaLabelledBy:s})})}};default:return Object(D.a)(e)}}(a?a(e.content):e.content,s,c);u=d.contentRendererCallback,d.calloutPropsUpdate&&(p=d.calloutPropsUpdate(e))}switch(p.type){case"SimpleCalloutProps":return i.createElement(Te,Object(o.__assign)({},p));case"CalloutProps":return i.createElement(Re.a,Object(o.__assign)({},p,{appColors:s,closeButtonProps:p.closeButtonProps||{icon:c.closeDark,label:l.closeLabel},contentRendererFunction:u,hasDynamicSizing:null!==(t=p.hasDynamicSizing)&&void 0!==t?t:Se(p.content),jumpToCalloutTargetButtonProps:p.jumpToCalloutTargetButtonEnabled&&c.jumpToTargetDark?{icon:c.jumpToTargetDark,label:_e.a.JumpToCalloutTarget}:void 0}));case"TeachingCalloutProps":return i.createElement(Oe.a,Object(o.__assign)({},p,{appColors:s,closeButtonProps:p.closeButtonProps||{icon:c.closeLight,label:l.closeLabel},contentRendererFunction:u,hasDynamicSizing:null!==(n=p.hasDynamicSizing)&&void 0!==n?n:Se(p.content),useCoachmark:p.useCoachmark,jumpToCalloutTargetButtonProps:p.jumpToCalloutTargetButtonEnabled&&c.jumpToTargetLight?{icon:c.jumpToTargetLight,label:_e.a.JumpToCalloutTarget}:void 0}));default:return Object(D.a)(p)}},t.prototype.ensureDismissCallback=function(e,t,n){var i=this,r=t.contentProps;return{contentProps:Object(o.__assign)(Object(o.__assign)({},r),{calloutProps:Object(o.__assign)(Object(o.__assign)({},r.calloutProps),{onDismiss:function(t){var o,a=i.props.rendererRef;r.calloutProps&&r.calloutProps.onDismiss&&r.calloutProps.onDismiss(t),"SimpleCalloutProps"!==r.type&&Object(De.b)(e,Ie.b.Dismiss,{key:"HasActionButtons",value:""+!(!r.primaryButtonProps&&!r.secondaryButtonProps)}),null===(o=a.current)||void 0===o||o.remove(e),n&&n.forEach((function(e){return e()}))}})})}},t.prototype.addFocusCallback=function(e){var t,n=e.contentProps,i=e.notificationProps,r=n.componentRef;if(!r)return e;var a,s=n;"function"==typeof r?(s=Object(o.__assign)(Object(o.__assign)({},n),{componentRef:function(e){r(e),a=e}}),t=function(){return a&&a.focus()}):t=function(){return r.current&&r.current.focus()};return{contentProps:s,notificationProps:Object(o.__assign)(Object(o.__assign)({},i),{focus:t,isActionable:!0})}},t}(i.Component),Ve=function(e){function t(t){var n=e.call(this,t)||this;return n.state={renderers:t.rendererFactory.map((function(e){var t=i.createRef();return{rendererRef:t,rendererElement:e(t)}}))},Object(Pe.a)(n),t.componentRef.current=n,n}return Object(o.__extends)(t,e),t.prototype.render=function(){return Object(o.__spreadArrays)(this.state.renderers.map((function(e){return e.rendererElement})))},t.prototype.canRender=function(e){var t;return!!(null===(t=this.getRendererRefForProps(e))||void 0===t?void 0:t.current)},t.prototype.contains=function(e){return this.state.renderers.some((function(t){var n;return null===(n=t.rendererRef.current)||void 0===n?void 0:n.contains(e)}))},t.prototype.add=function(e){var t,n;return null===(n=null===(t=this.getRendererRefForProps(e))||void 0===t?void 0:t.current)||void 0===n?void 0:n.add(e)},t.prototype.remove=function(e){var t,n;null===(n=null===(t=this.getRendererRefForKey(e))||void 0===t?void 0:t.current)||void 0===n||n.remove(e)},t.prototype.update=function(e,t){var n,o;null===(o=null===(n=this.getRendererRefForKey(e))||void 0===n?void 0:n.current)||void 0===o||o.update(e,t)},t.prototype.getRendererRefForProps=function(e){var t;return null===(t=Object(s.d)(this.state.renderers,(function(t){var n;return!!(null===(n=t.rendererRef.current)||void 0===n?void 0:n.canRender(e))})))||void 0===t?void 0:t.rendererRef},t.prototype.getRendererRefForKey=function(e){var t;return null===(t=Object(s.d)(this.state.renderers,(function(t){var n;return!!(null===(n=t.rendererRef.current)||void 0===n?void 0:n.contains(e))})))||void 0===t?void 0:t.rendererRef},t}(i.Component),Ge=function(e){return i.createElement(Fe,{key:"toast",componentRef:e,keyPrefix:"toast",canRender:Ue,renderItem:Ke})},Ue=function(e){return"ToastProps"===e.contentProps.type},Ke=Object(y.c)((function(e,t){return i.createElement(a.a,Object(o.__assign)({key:e},t.notificationProps,{toastProps:t.contentProps}))})),qe=function(e){return i.createElement(Fe,{key:"external",componentRef:e,keyPrefix:"external",canRender:Qe,renderItem:Je})},Qe=function(e){return"ExternalNotificationProps"===e.contentProps.type},Je=Object(y.c)((function(e,t){return i.createElement(O.a,Object(o.__assign)({key:e},t.notificationProps),i.createElement(i.Fragment,null))}));n.d(t,"d",(function(){return Ze})),n.d(t,"e",(function(){return $e})),n.d(t,"a",(function(){return et})),n.d(t,"g",(function(){return tt})),n.d(t,"h",(function(){return nt})),n.d(t,"b",(function(){return ot})),n.d(t,"c",(function(){return it})),n.d(t,"f",(function(){return rt}));var Ye,Xe=i.createRef();function Ze(e){var t=document.createElement("div");document.body.appendChild(t),r.render(i.createElement(Ve,{componentRef:Xe,rendererFactory:[function(t){var n;return n={rendererRef:t,hostElement:Ye||function(){return Ye},appCustomizations:e},i.createElement(Ne,Object(o.__assign)({key:"callout"},n))},Ge,qe]}),t)}function $e(e){q.a.shipAssertTag(594072578,Q.a.msoulscat_Wac_Telemetry,!Ye,"Callout notifications initialized multiple times"),Ye=e}function et(e,t){if(!Xe.current)return q.a.sendTraceTag(594072579,Q.a.msoulscat_Wac_Telemetry,J.a.Warning,"Area:ReactNotifications. NotificationsAPI.addNotification called before renderer initialized"),null;var n,i=function(){return n&&tt(n)},r=t&&function(e){var t=e.expirationOptions,n=e.onShow,o=e.telemetryId;return{onShow:n,telemetryId:o,expirationSettings:t}}(function(e,t){if(t.expirationOptions){var n=t.expirationOptions.onExpire;return Object(o.__assign)(Object(o.__assign)({},t),{expirationOptions:Object(o.__assign)(Object(o.__assign)({},t.expirationOptions),{onExpire:function(){n&&n(),e()}})})}return t}((function(){return i}),t));return n=Xe.current.add({contentProps:e,notificationProps:r})||null}function tt(e){var t;null===(t=Xe.current)||void 0===t||t.remove(e)}function nt(e,t){var n;null===(n=Xe.current)||void 0===n||n.update(e,{contentProps:t})}function ot(e){var t=e.primaryButtonProps,n=e.secondaryButtonProps,r=e.showCloseIcon,a=e.target,s=e.title,l=e.hasFocusableControls,c=e.content,u=e.useTeachingStyles,p=Object(o.__rest)(e,["hasFocusableControls","content","useTeachingStyles"]);if("string"==typeof c&&!(s||u||l||(t||n||r)))return{type:"SimpleCalloutProps",target:a,message:c};var d=Object(o.__assign)(Object(o.__assign)({type:"CalloutProps"},p),{componentRef:i.createRef(),hasDynamicSizing:p.hasDynamicSizing});return"string"==typeof c?d.message=c:d.content=c,u?Object(o.__assign)(Object(o.__assign)({},d),{type:"TeachingCalloutProps"}):d}function it(){return{type:"ExternalNotificationProps"}}function rt(e){return function(e){switch(e.type){case"TextAboveImage":case"NPSOneClick1":case"NPSOneClick2":case"NPSOneClickRadioButton":case"IdeasCallout":case"FloodgateTeachingCallout":case"PremiumUpsellCallout":return!0;default:return!1}}(e)}},1789:function(e,t,n){"use strict";var o=n(1198);n.d(t,"a",(function(){return o.a})),n.d(t,"b",(function(){return o.b})),n.d(t,"c",(function(){return o.c}))},1813:function(e,t,n){"use strict";var o=n(1606);n.d(t,"a",(function(){return o.a}))},1832:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(1),i=n(33),r=n(82),a=n(477),s=n(339),l=n(311),c=n(9),u=function(e,t){if(!Object(i.a)())return function(e){return{defaultBackgroundColor:r.a.white,textColor:e.primary,textHoverColor:e.shade10,textPressedColor:e.shade20,hoverBackgroundColor:e.tint40,pressedBackgroundColor:e.tint30,disabledBackgroundColor:e.primary,textDisabledColor:e.tint30,focusDisabledBackgroundColor:e.primary,disabledBorderColor:e.tint30,focusedBackgroundColor:r.a.white,focusedBorderColor:e.primary,toggledBackgroundColor:e.tint40,borderColor:"transparent"}}(t);var n=Object(a.a)(e);return{defaultBackgroundColor:e.palette.white,textColor:n.primaryTextColor,textHoverColor:n.primaryTextHoverColor,textPressedColor:n.primaryTextActiveColor,hoverBackgroundColor:e.palette.themeSecondary,pressedBackgroundColor:e.palette.themeLighterAlt,disabledBackgroundColor:e.palette.themePrimary,textDisabledColor:e.palette.themeLighterAlt,focusDisabledBackgroundColor:e.palette.themePrimary,disabledBorderColor:e.palette.themeLighterAlt,focusedBackgroundColor:e.palette.white,focusedBorderColor:e.palette.themePrimary,toggledBackgroundColor:e.palette.themeSecondary,borderColor:"transparent"}},p=function(e,t){if(!Object(i.a)())return function(e){return{defaultBackgroundColor:e.primary,textColor:r.a.white,hoverBackgroundColor:e.shade10,pressedBackgroundColor:e.shade20,disabledBackgroundColor:e.primary,textDisabledColor:e.tint30,focusDisabledBackgroundColor:e.primary,disabledBorderColor:e.tint30,focusedBackgroundColor:e.primary,focusedBorderColor:r.a.white,toggledBackgroundColor:e.shade20,borderColor:r.a.white}}(t);var n=Object(a.a)(e);return{defaultBackgroundColor:n.primaryDefaultBackgroundColor,textColor:n.defaultTextLabelColorForPrimaryBackground,hoverBackgroundColor:n.primaryHoverBackgroundColor,pressedBackgroundColor:n.primaryPressedBackgroundColor,disabledBackgroundColor:e.palette.themePrimary,textDisabledColor:e.palette.themeLighterAlt,focusDisabledBackgroundColor:e.palette.themePrimary,disabledBorderColor:e.palette.themeLighterAlt,focusedBackgroundColor:e.palette.themePrimary,focusedBorderColor:n.primaryFocusBorderColor,toggledBackgroundColor:e.palette.themeDarker,borderColor:n.primaryFocusBorderColor}},d=Object(c.c)((function(e,t,n){var c=u(e,t),d=p(e,t),h=Object(a.a)(e,t),g=Object(i.a)(),m=Object(o.__assign)(Object(o.__assign)({},d),{disabledBorderColor:"transparent",borderColor:void 0}),b={title:{color:h.defaultTextLabelColorForPrimaryBackground},mainContent:{color:h.defaultTextLabelColorForPrimaryBackground},closeButton:Object(s.d)(m),jumpToCalloutTargetButton:Object(s.d)(m),primaryButton:Object(s.d)(c,{borderWidth:2,gapBetweenOuter:1}),secondaryButton:Object(s.d)(d,s.a),coachmark:{color:h.primaryTextColor,beaconColorOne:h.primaryDefaultBackgroundColor,beaconColorTwo:h.primaryDefaultBackgroundColor},subComponentStyles:{callout:{beakCurtain:{backgroundColor:h.primaryDefaultBackgroundColor},beak:{backgroundColor:h.primaryDefaultBackgroundColor},calloutMain:{backgroundColor:h.primaryDefaultBackgroundColor,color:h.defaultTextLabelColorForPrimaryBackground,selectors:{"a:link, a:visited":{color:h.defaultTextLabelColorForPrimaryBackground},"a:hover":{color:g?e.palette.neutralLighterAlt:r.a.gray10},"a:active":{color:g?e.palette.neutralLighterAlt:r.a.gray20}}}}}};return Object(l.h)(b,n)}))},1833:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var o=n(1),i=n(0),r=n(477),a=n(339),s=n(157),l=n(311),c=n(1834),u=n(952),p=n(1836),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,d=t.styles,h=t.calloutProps,g=function(e){var t=Object(r.a)(e);return{primaryButton:Object(a.d)(Object(a.c)(e,n),a.a),subComponentStyles:{callout:{calloutMain:{selectors:{"a:link, a:visited":{color:t.primaryTextColor},"a:hover":{color:t.primaryTextHoverColor},"a:active":{color:t.primaryTextActiveColor}}}}}}},m=Object(o.__assign)(Object(o.__assign)({},h),Object(c.b)(this.props));return i.createElement(s.a,null,(function(t){return i.createElement(p.a,Object(o.__assign)({},e.props,{calloutProps:m,externalDismissCommandHandler:u.a,actionableAnnouncement:Object(c.a)(e.props),styles:Object(l.h)(g(t),d)}))}))},t}(i.PureComponent)},1834:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var o=n(1835);function i(e){return{"aria-roledescription":"TeachingCalloutProps"===e.type?o.a.TeachingNotification:o.a.Notification}}function r(e){return e.primaryButtonProps||e.secondaryButtonProps||e.firstFocusElement?o.a.Actionable:void 0}},1835:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var o=NotificationStrings},1836:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var o=n(1),i=n(0),r=n(1609),a=n(55),s=n(58),l=n(188),c=function(e){function t(t){var n=e.call(this,t)||this;return n.onFullRenderCompleted=function(){var e=window.performance.now()-n.firstRenderStartMs;a.a.sendTraceTag(593371728,s.a.msoulscat_Wac_Ribbon,l.a.Info,"Callout first render time: "+e+" ms")},n.firstRenderStartMs=window.performance.now(),n}return Object(o.__extends)(t,e),t.prototype.render=function(){return i.createElement(r.a,Object(o.__assign)({},this.props,{onFullRenderCompleted:this.onFullRenderCompleted}))},t}(i.PureComponent)},1837:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var o=n(1),i=n(0),r=n(1832),a=n(1834),s=n(952),l=n(1836),c=n(157),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.appColors,u=t.styles,p=t.calloutProps,d=Object(o.__assign)(Object(o.__assign)({},p),Object(a.b)(this.props));return i.createElement(c.a,null,(function(t){return i.createElement(l.a,Object(o.__assign)({},e.props,{calloutProps:d,externalDismissCommandHandler:s.a,actionableAnnouncement:Object(a.a)(e.props),styles:Object(r.a)(t,n,u)}))}))},t}(i.PureComponent)},1838:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var o=n(1),i=n(0),r=function(e){function t(n){var o=e.call(this,n)||this;return t._defaultContainer?o.state={container:t._defaultContainer}:(o.state={},t._waitingToastCallbacks.push((function(e){return o.setState({container:e})}))),o}return Object(o.__extends)(t,e),t.setDefaultContainer=function(e){this._defaultContainer=e,this._waitingToastCallbacks.length&&(this._waitingToastCallbacks.forEach((function(t){return t(e)})),this._waitingToastCallbacks=[])},t.prototype.componentWillUnmount=function(){this.removeToast()},t.prototype.componentDidUpdate=function(e,t){var n=this.props.toastProps,o=this.state.container;!t.container&&this.state.container&&this.ensureRegisteredWithContainer(),this.toastKey&&o&&e.toastProps!==n&&o.updateToast(this.toastKey,n)},t.prototype.componentDidMount=function(){this.ensureRegisteredWithContainer()},t.prototype.render=function(){return this.state.container?i.createElement(i.Fragment,null):null},t.prototype.ensureRegisteredWithContainer=function(){var e=this,t=this.props,n=t.toastProps,i=Object(o.__rest)(t,["toastProps"]);if(this.state.container&&!this.toastKey){var r=Object(o.__assign)(Object(o.__assign)({},i),{onHide:function(){e.removeToast(),i.onHide&&i.onHide()},telemetryId:this.props.telemetryId||"toast"});this.toastKey=this.state.container.addToast(n,r)}},t.prototype.removeToast=function(){var e=this.state.container;this.toastKey&&e&&e.removeToast(this.toastKey),this.toastKey=void 0},t.defaultProps={showExclusively:!1},t._waitingToastCallbacks=[],t}(i.PureComponent)},1839:function(e,t,n){var o=n(1901),i=n(1607),r={float:"cssFloat"},a=n(1902);function s(e,t,n){var s=r[t];if(void 0===s&&(s=function(e){var t=i(e),n=o(t);return r[t]=r[e]=r[n]=n,n}(t)),s){if(void 0===n)return e.style[s];e.style[s]=a(s,n)}}function l(e,t){for(var n in t)t.hasOwnProperty(n)&&s(e,n,t[n])}function c(){2===arguments.length?"string"==typeof arguments[1]?arguments[0].style.cssText=arguments[1]:l(arguments[0],arguments[1]):s(arguments[0],arguments[1],arguments[2])}e.exports=c,e.exports.set=c,e.exports.get=function(e,t){return Array.isArray(t)?t.reduce((function(t,n){return t[n]=s(e,n||""),t}),{}):s(e,t||"")}},1894:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NotificationStrings={Actionable:"Actionable",JumpToCalloutTarget:"JumpToCalloutTarget",Notification:"Notification",TeachingNotification:"TeachingNotification",PremiumFeatureDiamond:"PremiumFeatureDiamond"}},1895:function(e,t){function n(e,t,n,o){var i,r=null==(i=o)||"number"==typeof i||"boolean"==typeof i?o:n(o),a=t.get(r);return void 0===a&&(a=e.call(this,o),t.set(r,a)),a}function o(e,t,n){var o=Array.prototype.slice.call(arguments,3),i=n(o),r=t.get(i);return void 0===r&&(r=e.apply(this,o),t.set(i,r)),r}function i(e,t,n,o,i){return n.bind(t,e,o,i)}function r(e,t){return i(e,this,1===e.length?n:o,t.cache.create(),t.serializer)}function a(){return JSON.stringify(arguments)}function s(){this.cache=Object.create(null)}s.prototype.has=function(e){return e in this.cache},s.prototype.get=function(e){return this.cache[e]},s.prototype.set=function(e,t){this.cache[e]=t};var l={create:function(){return new s}};e.exports=function(e,t){var n=t&&t.cache?t.cache:l,o=t&&t.serializer?t.serializer:a;return(t&&t.strategy?t.strategy:r)(e,{cache:n,serializer:o})},e.exports.strategies={variadic:function(e,t){return i(e,this,o,t.cache.create(),t.serializer)},monadic:function(e,t){return i(e,this,n,t.cache.create(),t.serializer)}}},1896:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Scrollbars=void 0;var o,i=n(1897),r=(o=i)&&o.__esModule?o:{default:o};t.default=r.default,t.Scrollbars=r.default},1897:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n(1898),a=f(r),s=f(n(1839)),l=n(0),c=f(n(146)),u=f(n(1903)),p=f(n(1904)),d=f(n(1905)),h=f(n(1906)),g=f(n(1907)),m=n(1908),b=n(1909);function f(e){return e&&e.__esModule?e:{default:e}}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function v(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var C=function(e){function t(e){var n;y(this,t);for(var o=arguments.length,i=Array(o>1?o-1:0),r=1;r<o;r++)i[r-1]=arguments[r];var a=v(this,(n=t.__proto__||Object.getPrototypeOf(t)).call.apply(n,[this,e].concat(i)));return a.getScrollLeft=a.getScrollLeft.bind(a),a.getScrollTop=a.getScrollTop.bind(a),a.getScrollWidth=a.getScrollWidth.bind(a),a.getScrollHeight=a.getScrollHeight.bind(a),a.getClientWidth=a.getClientWidth.bind(a),a.getClientHeight=a.getClientHeight.bind(a),a.getValues=a.getValues.bind(a),a.getThumbHorizontalWidth=a.getThumbHorizontalWidth.bind(a),a.getThumbVerticalHeight=a.getThumbVerticalHeight.bind(a),a.getScrollLeftForOffset=a.getScrollLeftForOffset.bind(a),a.getScrollTopForOffset=a.getScrollTopForOffset.bind(a),a.scrollLeft=a.scrollLeft.bind(a),a.scrollTop=a.scrollTop.bind(a),a.scrollToLeft=a.scrollToLeft.bind(a),a.scrollToTop=a.scrollToTop.bind(a),a.scrollToRight=a.scrollToRight.bind(a),a.scrollToBottom=a.scrollToBottom.bind(a),a.handleTrackMouseEnter=a.handleTrackMouseEnter.bind(a),a.handleTrackMouseLeave=a.handleTrackMouseLeave.bind(a),a.handleHorizontalTrackMouseDown=a.handleHorizontalTrackMouseDown.bind(a),a.handleVerticalTrackMouseDown=a.handleVerticalTrackMouseDown.bind(a),a.handleHorizontalThumbMouseDown=a.handleHorizontalThumbMouseDown.bind(a),a.handleVerticalThumbMouseDown=a.handleVerticalThumbMouseDown.bind(a),a.handleWindowResize=a.handleWindowResize.bind(a),a.handleScroll=a.handleScroll.bind(a),a.handleDrag=a.handleDrag.bind(a),a.handleDragEnd=a.handleDragEnd.bind(a),a.state={didMountUniversal:!1},a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,[{key:"componentDidMount",value:function(){this.addListeners(),this.update(),this.componentDidMountUniversal()}},{key:"componentDidMountUniversal",value:function(){this.props.universal&&this.setState({didMountUniversal:!0})}},{key:"componentDidUpdate",value:function(){this.update()}},{key:"componentWillUnmount",value:function(){this.removeListeners(),(0,r.cancel)(this.requestFrame),clearTimeout(this.hideTracksTimeout),clearInterval(this.detectScrollingInterval)}},{key:"getScrollLeft",value:function(){return this.view?this.view.scrollLeft:0}},{key:"getScrollTop",value:function(){return this.view?this.view.scrollTop:0}},{key:"getScrollWidth",value:function(){return this.view?this.view.scrollWidth:0}},{key:"getScrollHeight",value:function(){return this.view?this.view.scrollHeight:0}},{key:"getClientWidth",value:function(){return this.view?this.view.clientWidth:0}},{key:"getClientHeight",value:function(){return this.view?this.view.clientHeight:0}},{key:"getValues",value:function(){var e=this.view||{},t=e.scrollLeft,n=void 0===t?0:t,o=e.scrollTop,i=void 0===o?0:o,r=e.scrollWidth,a=void 0===r?0:r,s=e.scrollHeight,l=void 0===s?0:s,c=e.clientWidth,u=void 0===c?0:c,p=e.clientHeight,d=void 0===p?0:p;return{left:n/(a-u)||0,top:i/(l-d)||0,scrollLeft:n,scrollTop:i,scrollWidth:a,scrollHeight:l,clientWidth:u,clientHeight:d}}},{key:"getThumbHorizontalWidth",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,o=this.view,i=o.scrollWidth,r=o.clientWidth,a=(0,h.default)(this.trackHorizontal),s=Math.ceil(r/i*a);return a===s?0:t||Math.max(s,n)}},{key:"getThumbVerticalHeight",value:function(){var e=this.props,t=e.thumbSize,n=e.thumbMinSize,o=this.view,i=o.scrollHeight,r=o.clientHeight,a=(0,g.default)(this.trackVertical),s=Math.ceil(r/i*a);return a===s?0:t||Math.max(s,n)}},{key:"getScrollLeftForOffset",value:function(e){var t=this.view,n=t.scrollWidth,o=t.clientWidth;return e/((0,h.default)(this.trackHorizontal)-this.getThumbHorizontalWidth())*(n-o)}},{key:"getScrollTopForOffset",value:function(e){var t=this.view,n=t.scrollHeight,o=t.clientHeight;return e/((0,g.default)(this.trackVertical)-this.getThumbVerticalHeight())*(n-o)}},{key:"scrollLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollLeft=e)}},{key:"scrollTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.view&&(this.view.scrollTop=e)}},{key:"scrollToLeft",value:function(){this.view&&(this.view.scrollLeft=0)}},{key:"scrollToTop",value:function(){this.view&&(this.view.scrollTop=0)}},{key:"scrollToRight",value:function(){this.view&&(this.view.scrollLeft=this.view.scrollWidth)}},{key:"scrollToBottom",value:function(){this.view&&(this.view.scrollTop=this.view.scrollHeight)}},{key:"addListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,o=this.thumbHorizontal,i=this.thumbVertical;e.addEventListener("scroll",this.handleScroll),(0,p.default)()&&(t.addEventListener("mouseenter",this.handleTrackMouseEnter),t.addEventListener("mouseleave",this.handleTrackMouseLeave),t.addEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.addEventListener("mouseenter",this.handleTrackMouseEnter),n.addEventListener("mouseleave",this.handleTrackMouseLeave),n.addEventListener("mousedown",this.handleVerticalTrackMouseDown),o.addEventListener("mousedown",this.handleHorizontalThumbMouseDown),i.addEventListener("mousedown",this.handleVerticalThumbMouseDown),window.addEventListener("resize",this.handleWindowResize))}}},{key:"removeListeners",value:function(){if("undefined"!=typeof document&&this.view){var e=this.view,t=this.trackHorizontal,n=this.trackVertical,o=this.thumbHorizontal,i=this.thumbVertical;e.removeEventListener("scroll",this.handleScroll),(0,p.default)()&&(t.removeEventListener("mouseenter",this.handleTrackMouseEnter),t.removeEventListener("mouseleave",this.handleTrackMouseLeave),t.removeEventListener("mousedown",this.handleHorizontalTrackMouseDown),n.removeEventListener("mouseenter",this.handleTrackMouseEnter),n.removeEventListener("mouseleave",this.handleTrackMouseLeave),n.removeEventListener("mousedown",this.handleVerticalTrackMouseDown),o.removeEventListener("mousedown",this.handleHorizontalThumbMouseDown),i.removeEventListener("mousedown",this.handleVerticalThumbMouseDown),window.removeEventListener("resize",this.handleWindowResize),this.teardownDragging())}}},{key:"handleScroll",value:function(e){var t=this,n=this.props,o=n.onScroll,i=n.onScrollFrame;o&&o(e),this.update((function(e){var n=e.scrollLeft,o=e.scrollTop;t.viewScrollLeft=n,t.viewScrollTop=o,i&&i(e)})),this.detectScrolling()}},{key:"handleScrollStart",value:function(){var e=this.props.onScrollStart;e&&e(),this.handleScrollStartAutoHide()}},{key:"handleScrollStartAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleScrollStop",value:function(){var e=this.props.onScrollStop;e&&e(),this.handleScrollStopAutoHide()}},{key:"handleScrollStopAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleWindowResize",value:function(){this.update()}},{key:"handleHorizontalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientX,o=t.getBoundingClientRect().left,i=this.getThumbHorizontalWidth(),r=Math.abs(o-n)-i/2;this.view.scrollLeft=this.getScrollLeftForOffset(r)}},{key:"handleVerticalTrackMouseDown",value:function(e){e.preventDefault();var t=e.target,n=e.clientY,o=t.getBoundingClientRect().top,i=this.getThumbVerticalHeight(),r=Math.abs(o-n)-i/2;this.view.scrollTop=this.getScrollTopForOffset(r)}},{key:"handleHorizontalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientX,o=t.offsetWidth,i=t.getBoundingClientRect().left;this.prevPageX=o-(n-i)}},{key:"handleVerticalThumbMouseDown",value:function(e){e.preventDefault(),this.handleDragStart(e);var t=e.target,n=e.clientY,o=t.offsetHeight,i=t.getBoundingClientRect().top;this.prevPageY=o-(n-i)}},{key:"setupDragging",value:function(){(0,s.default)(document.body,m.disableSelectStyle),document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.handleDragEnd),document.onselectstart=d.default}},{key:"teardownDragging",value:function(){(0,s.default)(document.body,m.disableSelectStyleReset),document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.handleDragEnd),document.onselectstart=void 0}},{key:"handleDragStart",value:function(e){this.dragging=!0,e.stopImmediatePropagation(),this.setupDragging()}},{key:"handleDrag",value:function(e){if(this.prevPageX){var t=e.clientX,n=-this.trackHorizontal.getBoundingClientRect().left+t-(this.getThumbHorizontalWidth()-this.prevPageX);this.view.scrollLeft=this.getScrollLeftForOffset(n)}if(this.prevPageY){var o=e.clientY,i=-this.trackVertical.getBoundingClientRect().top+o-(this.getThumbVerticalHeight()-this.prevPageY);this.view.scrollTop=this.getScrollTopForOffset(i)}return!1}},{key:"handleDragEnd",value:function(){this.dragging=!1,this.prevPageX=this.prevPageY=0,this.teardownDragging(),this.handleDragEndAutoHide()}},{key:"handleDragEndAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"handleTrackMouseEnter",value:function(){this.trackMouseOver=!0,this.handleTrackMouseEnterAutoHide()}},{key:"handleTrackMouseEnterAutoHide",value:function(){this.props.autoHide&&this.showTracks()}},{key:"handleTrackMouseLeave",value:function(){this.trackMouseOver=!1,this.handleTrackMouseLeaveAutoHide()}},{key:"handleTrackMouseLeaveAutoHide",value:function(){this.props.autoHide&&this.hideTracks()}},{key:"showTracks",value:function(){clearTimeout(this.hideTracksTimeout),(0,s.default)(this.trackHorizontal,{opacity:1}),(0,s.default)(this.trackVertical,{opacity:1})}},{key:"hideTracks",value:function(){var e=this;if(!this.dragging&&!this.scrolling&&!this.trackMouseOver){var t=this.props.autoHideTimeout;clearTimeout(this.hideTracksTimeout),this.hideTracksTimeout=setTimeout((function(){(0,s.default)(e.trackHorizontal,{opacity:0}),(0,s.default)(e.trackVertical,{opacity:0})}),t)}}},{key:"detectScrolling",value:function(){var e=this;this.scrolling||(this.scrolling=!0,this.handleScrollStart(),this.detectScrollingInterval=setInterval((function(){e.lastViewScrollLeft===e.viewScrollLeft&&e.lastViewScrollTop===e.viewScrollTop&&(clearInterval(e.detectScrollingInterval),e.scrolling=!1,e.handleScrollStop()),e.lastViewScrollLeft=e.viewScrollLeft,e.lastViewScrollTop=e.viewScrollTop}),100))}},{key:"raf",value:function(e){var t=this;this.requestFrame&&a.default.cancel(this.requestFrame),this.requestFrame=(0,a.default)((function(){t.requestFrame=void 0,e()}))}},{key:"update",value:function(e){var t=this;this.raf((function(){return t._update(e)}))}},{key:"_update",value:function(e){var t=this.props,n=t.onUpdate,o=t.hideTracksWhenNotNeeded,i=this.getValues();if((0,p.default)()){var r=i.scrollLeft,a=i.clientWidth,l=i.scrollWidth,c=(0,h.default)(this.trackHorizontal),u=this.getThumbHorizontalWidth(),d={width:u,transform:"translateX("+r/(l-a)*(c-u)+"px)"},m=i.scrollTop,b=i.clientHeight,f=i.scrollHeight,y=(0,g.default)(this.trackVertical),v=this.getThumbVerticalHeight(),C={height:v,transform:"translateY("+m/(f-b)*(y-v)+"px)"};if(o){var x={visibility:l>a?"visible":"hidden"},S={visibility:f>b?"visible":"hidden"};(0,s.default)(this.trackHorizontal,x),(0,s.default)(this.trackVertical,S)}(0,s.default)(this.thumbHorizontal,d),(0,s.default)(this.thumbVertical,C)}n&&n(i),"function"==typeof e&&e(i)}},{key:"render",value:function(){var e=this,t=(0,p.default)(),n=this.props,i=(n.onScroll,n.onScrollFrame,n.onScrollStart,n.onScrollStop,n.onUpdate,n.renderView),r=n.renderTrackHorizontal,a=n.renderTrackVertical,s=n.renderThumbHorizontal,c=n.renderThumbVertical,d=n.tagName,h=(n.hideTracksWhenNotNeeded,n.autoHide),g=(n.autoHideTimeout,n.autoHideDuration),b=(n.thumbSize,n.thumbMinSize,n.universal),f=n.autoHeight,y=n.autoHeightMin,v=n.autoHeightMax,C=n.style,x=n.children,S=function(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(n,["onScroll","onScrollFrame","onScrollStart","onScrollStop","onUpdate","renderView","renderTrackHorizontal","renderTrackVertical","renderThumbHorizontal","renderThumbVertical","tagName","hideTracksWhenNotNeeded","autoHide","autoHideTimeout","autoHideDuration","thumbSize","thumbMinSize","universal","autoHeight","autoHeightMin","autoHeightMax","style","children"]),E=this.state.didMountUniversal,w=o({},m.containerStyleDefault,f&&o({},m.containerStyleAutoHeight,{minHeight:y,maxHeight:v}),C),k=o({},m.viewStyleDefault,{marginRight:t?-t:0,marginBottom:t?-t:0},f&&o({},m.viewStyleAutoHeight,{minHeight:(0,u.default)(y)?"calc("+y+" + "+t+"px)":y+t,maxHeight:(0,u.default)(v)?"calc("+v+" + "+t+"px)":v+t}),f&&b&&!E&&{minHeight:y,maxHeight:v},b&&!E&&m.viewStyleUniversalInitial),T={transition:"opacity "+g+"ms",opacity:0},I=o({},m.trackHorizontalStyleDefault,h&&T,(!t||b&&!E)&&{display:"none"}),R=o({},m.trackVerticalStyleDefault,h&&T,(!t||b&&!E)&&{display:"none"});return(0,l.createElement)(d,o({},S,{style:w,ref:function(t){e.container=t}}),[(0,l.cloneElement)(i({style:k}),{key:"view",ref:function(t){e.view=t}},x),(0,l.cloneElement)(r({style:I}),{key:"trackHorizontal",ref:function(t){e.trackHorizontal=t}},(0,l.cloneElement)(s({style:m.thumbHorizontalStyleDefault}),{ref:function(t){e.thumbHorizontal=t}})),(0,l.cloneElement)(a({style:R}),{key:"trackVertical",ref:function(t){e.trackVertical=t}},(0,l.cloneElement)(c({style:m.thumbVerticalStyleDefault}),{ref:function(t){e.thumbVertical=t}}))])}}]),t}(l.Component);t.default=C,C.propTypes={onScroll:c.default.func,onScrollFrame:c.default.func,onScrollStart:c.default.func,onScrollStop:c.default.func,onUpdate:c.default.func,renderView:c.default.func,renderTrackHorizontal:c.default.func,renderTrackVertical:c.default.func,renderThumbHorizontal:c.default.func,renderThumbVertical:c.default.func,tagName:c.default.string,thumbSize:c.default.number,thumbMinSize:c.default.number,hideTracksWhenNotNeeded:c.default.bool,autoHide:c.default.bool,autoHideTimeout:c.default.number,autoHideDuration:c.default.number,autoHeight:c.default.bool,autoHeightMin:c.default.oneOfType([c.default.number,c.default.string]),autoHeightMax:c.default.oneOfType([c.default.number,c.default.string]),universal:c.default.bool,style:c.default.object,children:c.default.node},C.defaultProps={renderView:b.renderViewDefault,renderTrackHorizontal:b.renderTrackHorizontalDefault,renderTrackVertical:b.renderTrackVerticalDefault,renderThumbHorizontal:b.renderThumbHorizontalDefault,renderThumbVertical:b.renderThumbVerticalDefault,tagName:"div",thumbMinSize:30,hideTracksWhenNotNeeded:!1,autoHide:!1,autoHideTimeout:1e3,autoHideDuration:200,autoHeight:!1,autoHeightMin:0,autoHeightMax:200,universal:!1}},1898:function(e,t,n){(function(t){for(var o=n(1899),i="undefined"==typeof window?t:window,r=["moz","webkit"],a="AnimationFrame",s=i["request"+a],l=i["cancel"+a]||i["cancelRequest"+a],c=0;!s&&c<r.length;c++)s=i[r[c]+"Request"+a],l=i[r[c]+"Cancel"+a]||i[r[c]+"CancelRequest"+a];if(!s||!l){var u=0,p=0,d=[];s=function(e){if(0===d.length){var t=o(),n=Math.max(0,1e3/60-(t-u));u=n+t,setTimeout((function(){var e=d.slice(0);d.length=0;for(var t=0;t<e.length;t++)if(!e[t].cancelled)try{e[t].callback(u)}catch(e){setTimeout((function(){throw e}),0)}}),Math.round(n))}return d.push({handle:++p,callback:e,cancelled:!1}),p},l=function(e){for(var t=0;t<d.length;t++)d[t].handle===e&&(d[t].cancelled=!0)}}e.exports=function(e){return s.call(i,e)},e.exports.cancel=function(){l.apply(i,arguments)},e.exports.polyfill=function(e){e||(e=i),e.requestAnimationFrame=s,e.cancelAnimationFrame=l}}).call(this,n(409))},1899:function(e,t,n){(function(t){(function(){var n,o,i,r,a,s;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(n()-a)/1e6},o=t.hrtime,r=(n=function(){var e;return 1e9*(e=o())[0]+e[1]})(),s=1e9*t.uptime(),a=r-s):Date.now?(e.exports=function(){return Date.now()-i},i=Date.now()):(e.exports=function(){return(new Date).getTime()-i},i=(new Date).getTime())}).call(this)}).call(this,n(1900))},1900:function(e,t){var n,o,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{o="function"==typeof clearTimeout?clearTimeout:a}catch(e){o=a}}();var l,c=[],u=!1,p=-1;function d(){u&&l&&(u=!1,l.length?c=l.concat(c):p=-1,c.length&&h())}function h(){if(!u){var e=s(d);u=!0;for(var t=c.length;t;){for(l=c,c=[];++p<t;)l&&l[p].run();p=-1,t=c.length}l=null,u=!1,function(e){if(o===clearTimeout)return clearTimeout(e);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(e);try{o(e)}catch(t){try{return o.call(null,e)}catch(t){return o.call(this,e)}}}(e)}}function g(e,t){this.fun=e,this.array=t}function m(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new g(e,t)),1!==c.length||u||s(h)},g.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=m,i.addListener=m,i.once=m,i.off=m,i.removeListener=m,i.removeAllListeners=m,i.emit=m,i.prependListener=m,i.prependOnceListener=m,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},1901:function(e,t){var n=null,o=["Webkit","Moz","O","ms"];e.exports=function(e){n||(n=document.createElement("div"));var t=n.style;if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),r=o.length;r>=0;r--){var a=o[r]+i;if(a in t)return a}return!1}},1902:function(e,t){var n={animationIterationCount:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridColumn:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,stopOpacity:!0,strokeDashoffset:!0,strokeOpacity:!0,strokeWidth:!0};e.exports=function(e,t){return"number"!=typeof t||n[e]?t:t+"px"}},1903:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"==typeof e}},1904:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(!1!==a)return a;if("undefined"!=typeof document){var e=document.createElement("div");(0,r.default)(e,{width:100,height:100,position:"absolute",top:-9999,overflow:"scroll",MsOverflowStyle:"scrollbar"}),document.body.appendChild(e),a=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}else a=0;return a||0};var o,i=n(1839),r=(o=i)&&o.__esModule?o:{default:o};var a=!1},1905:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return!1}},1906:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientWidth,n=getComputedStyle(e),o=n.paddingLeft,i=n.paddingRight;return t-parseFloat(o)-parseFloat(i)}},1907:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.clientHeight,n=getComputedStyle(e),o=n.paddingTop,i=n.paddingBottom;return t-parseFloat(o)-parseFloat(i)}},1908:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.containerStyleDefault={position:"relative",overflow:"hidden",width:"100%",height:"100%"},t.containerStyleAutoHeight={height:"auto"},t.viewStyleDefault={position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"scroll",WebkitOverflowScrolling:"touch"},t.viewStyleAutoHeight={position:"relative",top:void 0,left:void 0,right:void 0,bottom:void 0},t.viewStyleUniversalInitial={overflow:"hidden",marginRight:0,marginBottom:0},t.trackHorizontalStyleDefault={position:"absolute",height:6},t.trackVerticalStyleDefault={position:"absolute",width:6},t.thumbHorizontalStyleDefault={position:"relative",display:"block",height:"100%"},t.thumbVerticalStyleDefault={position:"relative",display:"block",width:"100%"},t.disableSelectStyle={userSelect:"none"},t.disableSelectStyleReset={userSelect:""}},1909:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e};t.renderViewDefault=function(e){return a.default.createElement("div",e)},t.renderTrackHorizontalDefault=function(e){var t=e.style,n=s(e,["style"]),i=o({},t,{right:2,bottom:2,left:2,borderRadius:3});return a.default.createElement("div",o({style:i},n))},t.renderTrackVerticalDefault=function(e){var t=e.style,n=s(e,["style"]),i=o({},t,{right:2,bottom:2,top:2,borderRadius:3});return a.default.createElement("div",o({style:i},n))},t.renderThumbHorizontalDefault=function(e){var t=e.style,n=s(e,["style"]),i=o({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return a.default.createElement("div",o({style:i},n))},t.renderThumbVerticalDefault=function(e){var t=e.style,n=s(e,["style"]),i=o({},t,{cursor:"pointer",borderRadius:"inherit",backgroundColor:"rgba(0,0,0,.2)"});return a.default.createElement("div",o({style:i},n))};var i,r=n(0),a=(i=r)&&i.__esModule?i:{default:i};function s(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}},2036:function(e,t,n){"use strict";n.r(t);var o=n(1209),i=n(24),r=n.n(i),a=n(138),s=n(317),l=!1;var c,u={initializeCalloutNotifications:function(e){l||(Object(o.d)({appColors:Object(a.a)(),appStrings:Object(s.a)(),icons:{closeDark:r.a.CancelGlyph_16,closeLight:r.a.CancelGlyphWhite_16,jumpToTargetDark:r.a.AccessMoveUpSection_16,jumpToTargetLight:r.a.AccessMoveUpSectionWhite_16,checkmark:r.a.Checkmark_16}}),l=!0),Object(o.e)(e)},addNotification:o.a,removeNotification:o.g,updateNotification:o.h,callout:o.b,externalNotification:o.c,isCustomContentSupported:o.f},p=n(1),d=n(0),h=n(45);!function(e){e[e.Left=1]="Left",e[e.Right=2]="Right"}(c||(c={}));var g,m,b,f=n(1127),y=n(720),v=n(55),C=n(58),x=n(779),S={shimmerGradient:{animationDirection:"reverse"}},E=n(116),w=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){if(this.props.isPlaceholder){var e=Object(p.__assign)({},ke);return Object(E.a)()&&(e=Object(p.__assign)(Object(p.__assign)({},e),{rtlShimmerStyles:S})),d.createElement(x.a,{style:{marginTop:"7px"},styles:e})}return v.a.shipAssertTag(595357774,C.a.msoulscat_ES_EWAJS,null!=this.props.ruleName&&""!==this.props.ruleName,"ConditionalFormattingTaskPaneReact.RulePreview.Render: rule name is empty."),d.createElement(y.a,{value:this.props.ruleName,styles:ke,borderless:!0,readOnly:!0,tabIndex:-1,"data-is-focusable":!1,ariaLabel:this.props.ruleName})},t}(d.Component),k=n(27),T=n.n(k),I=n(179),R=n(39),O=n(21),P=n(4),F=function(){return _(!0)},D=function(e){return e?"rgb(96, 94, 92)":"rgb(184, 0, 0)"},_=function(e){return{borderColor:D(e),borderStyle:"solid"}},j=function(e){var t={root:{height:"26px"}};return{root:Object(p.__assign)(Object(p.__assign)({},_(e)),{maxWidth:"287px"}),pickingIcon:t,cancelButton:t,applyButton:t}},B=function(e,t){var n;return void 0===e&&(e=!0),void 0===t&&(t=!1),(n={outline:"none !important",borderWidth:(t?"2px":"1px")+" !important",borderColor:D(e)+" !important",borderStyle:"solid"})[P.l]={borderColor:"Highlight !important"},n},L={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},M=n(778),A=n(54),W=function(e){function t(t){var n=e.call(this,t)||this;return n.editRuleOnKeyDown=n.editRuleOnKeyDown.bind(n),n.deleteRuleOnKeyDown=n.deleteRuleOnKeyDown.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return this.props.showCommands?Object(O.c)("ConditionalFormattingRuleEditor")?d.createElement("div",null,d.createElement(M.a,{content:this.props.enableEdit?ExcelRibbonStrings.ConditionalFormattingRuleEdit:ExcelRibbonStrings.ConditionalFormattingEditingRuleNotSupportedTooltipContent,directionalHint:A.DirectionalHint.bottomCenter},d.createElement(I.a,{id:"CondFmtEditRuleIconId-"+this.props.ruleId,role:"button",iconName:T.a.EditGeneric_24,styles:this.getCommandIconStyle(this.props.enableEdit),onClick:this.props.enableEdit?this.props.editRule:void 0,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.editRuleOnKeyDown,"aria-label":ExcelRibbonStrings.ConditionalFormattingRuleEdit})),d.createElement(M.a,{content:ExcelRibbonStrings.ConditionalFormattingRuleDelete,directionalHint:A.DirectionalHint.bottomCenter},d.createElement(I.a,{id:"CondFmtDeleteRuleIconId-"+this.props.ruleId,role:"button",iconName:T.a.TrashCan_16,styles:this.getCommandIconStyle(),onClick:this.props.onRuleDelete,"data-is-focusable":!0,tabIndex:-1,onKeyDown:this.deleteRuleOnKeyDown,"aria-label":ExcelRibbonStrings.ConditionalFormattingRuleDelete}))):d.createElement("div",null,d.createElement(M.a,{content:ExcelRibbonStrings.ConditionalFormattingRuleDelete,directionalHint:A.DirectionalHint.bottomCenter},d.createElement(I.a,{iconName:T.a.TrashCan_16,styles:this.getCommandIconStyle(),onClick:this.props.onRuleDelete}))):d.createElement("div",null)},t.prototype.editRuleOnKeyDown=function(e){var t=null;switch(e.keyCode){case R.a.tab:t=document.getElementById("CondFmtDeleteRuleIconId-"+this.props.ruleId);break;case R.a.escape:t=document.getElementById(this.props.ruleId);break;case R.a.enter:this.props.editRule(),e.preventDefault()}t&&(e.stopPropagation(),e.preventDefault(),t.focus())},t.prototype.deleteRuleOnKeyDown=function(e){var t=null;switch(e.keyCode){case R.a.tab:this.props.enableEdit?t=document.getElementById("CondFmtEditRuleIconId-"+this.props.ruleId):(e.stopPropagation(),e.preventDefault());break;case R.a.escape:t=document.getElementById(this.props.ruleId);break;case R.a.enter:this.props.onRuleDelete(),e.stopPropagation()}t&&(e.stopPropagation(),e.preventDefault(),t.focus())},t.prototype.getCommandIconStyle=function(e){var t;return void 0===e&&(e=!0),{root:{height:"16px",width:"16px",marginTop:"2px",marginLeft:"1px",padding:"3px",opacity:e?void 0:"0.3",pointerEvents:e?void 0:"none",cursor:e?"pointer":"default",selectors:{":hover":(t={background:"#E1DFDD"},t[P.l]=e?B():{color:"GrayText"},t),":focus":B(),":focus:after":{border:"none",outline:"none"},":active":{border:"none",outline:"none"}}}}},t}(d.Component),z=n(152),H=n(474),N=n(548),V=n(1781),G=n(82),U={root:{height:"28px",background:G.a.white,alignItems:"center",border:"1px solid "+G.a.gray130,borderRadius:"2px",direction:"ltr"}},K={root:{width:"100%",height:"100%"},fieldGroup:{alignItems:"center",height:"100%",border:"none"},wrapper:{height:"100%"},field:{height:"100%",fontSize:"12px",fontFamily:ExcelRibbonStrings.UserInterfaceFontName}},q={root:{width:"100%"}},Q={display:"flex",alignItems:"center"},J={background:"Highlight",color:"HighlightText",fill:"HighlightText"},Y={root:{padding:"0px",height:"24px",verticalAlign:"middle",selectors:{":hover":(g={background:G.a.gray40},g[P.l]=J,g),":active":{background:G.a.gray90},":focus":(m={},m[P.l]=J,m)}}},X={root:{width:"20px",height:"100%"}},Z={root:{backgroundColor:"transparent",cursor:"initial"}},$=n(188),ee=function(e,t){return e+t},te="",ne="-ApplyButton",oe="-RootComponent",ie="-CancelButton",re="-PickingIcon",ae="-ActionAnnouncer",se="blur",le="click",ce="keypress",ue=function(e){function t(t){var n=e.call(this,t)||this;return n.getValue=function(){return n.state.value},n.shouldIgnoreFocusEvent=function(e){var t;return Object(z.a)(n.rootComponent.current,e.relatedTarget)||(null===(t=n.props.shouldIgnoreFocusEvents)||void 0===t?void 0:t.call(n,e))},n.shouldIgnoreBlurEvent=function(e){var t;return Object(z.a)(n.rootComponent.current,e.relatedTarget)||(null===(t=n.props.shouldIgnoreBlurEvents)||void 0===t?void 0:t.call(n,e))},n.onFocus=function(e){n.shouldIgnoreFocusEvent(e)||n.onStartPicking()},n.onBlur=function(e){n.shouldIgnoreBlurEvent(e)||n.onApplyChanges({type:se})},n.getComponentId=function(e){return ee(n.props.id,e)},n.onChange=function(e){n.onStartPicking(),n.setState({value:e}),n.props.onChange&&n.props.onChange(e)},n.updateAnnouncer=function(e){var t=document.getElementById(n.getComponentId(ae));null==t||t.setAttribute("aria-label",e)},n.onStartPicking=function(){n.state.picking||n.setState({picking:!0},(function(){n.props.onStartPicking(),n.updateAnnouncer(ExcelRibbonStrings.CellPickingTooltipContent)}))},n.onApplyChanges=function(e){var t;n.state.picking&&(v.a.sendTraceTag(572070094,C.a.msoulscat_ES_EWAJS,$.a.Info,"RangePicker.onApplyChanges: Changes were applied using "+(null==e?void 0:e.type)),n.updateAnnouncer(n.lastAppliedValue!==n.state.value||(null==e?void 0:e.type)===le?ExcelRibbonStrings.RangePickerApplyChangesExecutedMessage:""),n.lastAppliedValue=n.state.value,null===(t=document.getElementById(n.getComponentId(ae)))||void 0===t||t.focus(),n.setState({picking:!1}),n.props.onApplyChanges())},n.onCancelChanges=function(e){var t;n.state.picking&&(v.a.sendTraceTag(572070095,C.a.msoulscat_ES_EWAJS,$.a.Info,"RangePicker.onCancelChanges: Changes were discarded using "+(null==e?void 0:e.type)),n.updateAnnouncer(n.lastAppliedValue!==n.state.value||(null==e?void 0:e.type)===le?ExcelRibbonStrings.RangePickerDiscardChangesExecutedMessage:""),null===(t=document.getElementById(n.getComponentId(ae)))||void 0===t||t.focus(),n.setState({picking:!1,value:n.lastAppliedValue}),n.props.onCancelChanges())},n.onTextFieldKeyUp=function(e){n.state.picking&&(e.keyCode===R.a.enter?(n.setState({canFocusOnAnnouncer:!0},(function(){n.onApplyChanges({type:ce})})),e.stopPropagation()):e.keyCode===R.a.escape&&(n.setState({canFocusOnAnnouncer:!0},(function(){n.props.autoApply?n.onApplyChanges({type:ce}):n.onCancelChanges({type:ce})})),e.stopPropagation()))},n.onAnnouncerFocus=function(){n.setState({canFocusOnAnnouncer:!1})},n.isPicking=function(){return n.state.picking},n.getButtons=function(){var e,t,o;return!n.state.picking||n.props.autoApply?[{id:n.getComponentId(re),icon:T.a.RangeDrag_32,tooltip:ExcelRibbonStrings.CellPickingTooltipContent,style:null===(e=n.getStyles())||void 0===e?void 0:e.pickingIcon}]:[{id:n.getComponentId(ie),icon:T.a.DeleteHover_16,onClick:n.onCancelChanges,ariaLabel:ExcelRibbonStrings.RangePickerDiscardChanges,tooltip:ExcelRibbonStrings.RangePickerDiscardChanges,style:null===(t=n.getStyles())||void 0===t?void 0:t.cancelButton},{id:n.getComponentId(ne),icon:T.a.Checkmark_16,onClick:n.onApplyChanges,ariaLabel:ExcelRibbonStrings.RangePickerApplyChanges,tooltip:ExcelRibbonStrings.RangePickerApplyChanges,style:null===(o=n.getStyles())||void 0===o?void 0:o.applyButton}]},n.state={picking:!1,value:n.props.value||"",valueExternallyControlled:n.props.value||"",canFocusOnAnnouncer:!1},n.lastAppliedValue=n.state.value,n.textField=d.createRef(),n.rootComponent=d.createRef(),n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return e.value!==t.valueExternallyControlled?{value:e.value,valueExternallyControlled:e.value}:{}},t.prototype.render=function(){var e,t,n=this;return d.createElement("div",{id:this.getComponentId(oe),ref:this.rootComponent,onFocus:this.onFocus,onBlur:this.onBlur},d.createElement(H.a,{horizontal:!0,horizontalAlign:"space-between",onKeyUp:this.onTextFieldKeyUp,styles:Object(P.H)(U,{root:null===(e=this.getStyles())||void 0===e?void 0:e.root})},d.createElement(H.a.Item,{styles:q},d.createElement(V.a,{ref:this.textField,id:this.getComponentId(te),type:"AppInputProps",value:this.state.value,styles:Object(P.H)(K,null===(t=this.getStyles())||void 0===t?void 0:t.textField),onChange:this.onChange,autoComplete:"off",label:this.props.ariaLabel,hideLabel:!0})),d.createElement(H.a.Item,null,d.createElement("div",{style:Q},this.getButtons().map((function(e){return n.createButton(e.icon,e.id,e.onClick,e.tooltip,e.ariaLabel,e.style)}))))),d.createElement("div",{id:this.getComponentId(ae),"aria-live":"assertive","aria-label":"",tabIndex:this.state.canFocusOnAnnouncer?0:void 0,onFocus:this.onAnnouncerFocus}))},t.prototype.createButton=function(e,t,n,o,i,r){var a=Object(P.H)(Y,r,n?void 0:Z),s=d.createElement(N.a,{id:t,key:t,onClick:n,disabled:!n,iconProps:{iconName:e,styles:X},styles:a,tabIndex:n?void 0:-1,ariaLabel:i});return o?d.createElement(M.a,{content:o},s):s},t.prototype.getStyles=function(){return this.isPicking()&&this.props.pickingStyles?this.props.pickingStyles:this.props.styles},t}(d.Component),pe=function(e){function t(t){var n=e.call(this,t)||this;return n.shouldIgnoreBlurEvents=function(e){var t=document.getElementById(n.props.rangePickerController.getGridDomElementId());return n.state.ignoreBlurEvents||Object(z.a)(t,e.relatedTarget)},n.onStartPicking=function(){n.props.rangePickerController.startPicker(n.getTextboxComponentId(),n.props.sheetName||null,n.onChange,n.setShouldIgnoreBlurEvents,{supportOnlyRanges:!!n.props.supportOnlyRanges,useAbsoluteRef:!1!==n.props.useAbsoluteRef,blockSwitchingSheets:!!n.props.blockSwitchingSheets}),n.props.onStartPicking&&n.props.onStartPicking()},n.onCancelChanges=function(){n.setState({value:n.lastAppliedValue,sheetName:n.lastAppliedSheet}),n.props.onCancelChanges&&n.props.onCancelChanges(n.lastAppliedValue,n.lastAppliedSheet),n.props.rangePickerController.stopPicker(n.getTextboxComponentId())},n.onApplyChanges=function(){n.lastAppliedValue=n.state.value,n.lastAppliedSheet=n.state.sheetName,n.props.onApplyChanges&&n.props.onApplyChanges(n.lastAppliedValue,n.lastAppliedSheet),n.props.rangePickerController.stopPicker(n.getTextboxComponentId())},n.onChange=function(e){var t=n.getSheetName();n.setState({value:e,sheetName:t}),n.props.onChange&&n.props.onChange(e,t)},n.setShouldIgnoreBlurEvents=function(e){n.setState({ignoreBlurEvents:e})},n.getTextboxComponentId=function(){return ee(n.props.id,te)},n.getSheetName=function(){var e=n.props.rangePickerController.getSheetName();return e||void 0},n.state={value:n.props.value||"",valueExternallyControlled:n.props.value||"",sheetName:n.props.sheetName,sheetNameExternallyControlled:n.props.sheetName||"",ignoreBlurEvents:!1},n.lastAppliedValue=n.state.value,n.lastAppliedSheet=n.state.sheetName,n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n={};return e.value!==t.valueExternallyControlled&&(n={value:e.value,valueExternallyControlled:e.value}),e.sheetName!==t.sheetNameExternallyControlled&&(n=Object(p.__assign)({sheetName:e.sheetName,sheetNameExternallyControlled:e.sheetName},n)),n},t.prototype.render=function(){return d.createElement(ue,{id:this.props.id,autoApply:this.props.autoApply,onStartPicking:this.onStartPicking,onApplyChanges:this.onApplyChanges,onCancelChanges:this.onCancelChanges,onChange:this.onChange,value:this.state.value,shouldIgnoreBlurEvents:this.shouldIgnoreBlurEvents,styles:this.props.styles,pickingStyles:this.props.pickingStyles,ariaLabel:this.props.ariaLabel})},t.prototype.componentWillUnmount=function(){this.props.rangePickerController.disposeRangePicker(this.getTextboxComponentId())},t}(d.Component),de=function(){function e(){}return e.updateData=function(t){var n,o,i,r;t.callbacks?(v.a.shipAssertTag(595711942,C.a.msoulscat_ES_EWAJS,null!=t.callbacks.onRuleFilteringOptionsChange,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleFilteringOptionsChange not set"),v.a.shipAssertTag(595357775,C.a.msoulscat_ES_EWAJS,null!=t.callbacks.onRuleDelete,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: onRuleDelete not set"),v.a.shipAssertTag(573850571,C.a.msoulscat_ES_EWAJS,null!=t.callbacks.getFormulaErrorType,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: getFormulaErrorType not set"),v.a.shipAssertTag(573850572,C.a.msoulscat_ES_EWAJS,null!=t.callbacks.getRangeErrorType,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: getRangeErrorType not set")):v.a.shipAssertTag(595402902,C.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: callbacks object is not set"),e.firstPaneElementId=(null===(n=t.UIElementsIds)||void 0===n?void 0:n.firstPaneElementId)||t.firstPaneElementId||"",e.ruleManagerId=(null===(o=t.UIElementsIds)||void 0===o?void 0:o.ruleManagerId)||"ConditionalFormattingTaskPaneRuleManagerId",e.loadingRuleListId=(null===(i=t.UIElementsIds)||void 0===i?void 0:i.loadingRuleListId)||"ConditionalFormattingTaskPaneLoadingRuleListId",e.ruleListId=(null===(r=t.UIElementsIds)||void 0===r?void 0:r.ruleListId)||"ConditionalFormattingTaskPaneRuleListId",e.onRuleFilteringOptionsChange=t.callbacks.onRuleFilteringOptionsChange||function(){},e.onRuleHoverStateChange=t.callbacks.onRuleHoverStateChange||function(){},e.onRuleDelete=t.callbacks.onRuleDelete||function(){},e.setFocusOnToolbarFirstElement=t.callbacks.setFocusOnToolbarFirstElement||function(){},e.onTaskPaneViewChange=t.callbacks.changeTaskPaneView||function(){},e.onDeleteRulesByFilter=t.callbacks.onDeleteRulesByFilter||function(){},e.onRuleAdded=t.callbacks.onRuleAdded||function(){},e.onRuleEdited=t.callbacks.onRuleEdited||function(){},e.addNewRuleFromTaskPane=t.callbacks.addNewRuleFromTaskPane||function(){},e.getFormulaErrorType=t.callbacks.getFormulaErrorType||function(){return 1},e.getRangeErrorType=t.callbacks.getRangeErrorType||function(){return 2},e.rangePickerController=t.rangePickerController||{startPicker:function(){},stopPicker:function(){},disposeRangePicker:function(){},getGridDomElementId:function(){return""},getSheetName:function(){return""}}},e.setFocusOnPaneFirstElement=function(){if(e.firstPaneElementId){var t=document.getElementById(e.firstPaneElementId);t&&t.focus()}},e.getRequiredFirstPaneElementId=function(){return e.firstPaneElementId},e.getRequiredRuleManagerId=function(){return e.ruleManagerId},e.getRequiredLoadingRuleListId=function(){return e.loadingRuleListId},e.getRequiredRuleListId=function(){return e.ruleListId},e}(),he=function(e){function t(t){var n=e.call(this,t)||this;return n.getRangePickerProps=function(){var e=Object(p.__assign)({rangePickerController:de.rangePickerController},n.props);return void 0!==e.pickingStyles?(e.pickingStyles=Object(p.__assign)({},e.pickingStyles),e.pickingStyles.root=Object(P.H)(n.getPickingStyle(),e.pickingStyles.root)):e.pickingStyles={root:n.getPickingStyle()},e},n.getPickingStyle=function(){return B(!n.props.hasError,!0)},n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(pe,Object(p.__assign)({},this.getRangePickerProps()))},t}(d.Component),ge=n(53),me=function(e){function t(t){var n=e.call(this,t)||this;return n.mouseOver=function(){n.setState({hovering:!0})},n.mouseOut=function(){n.setState({hovering:!1})},n.onStartPicking=function(){n.setState({picking:!0}),n.props.updateIsPicking(!0)},n.onStopPicking=function(){n.setState({picking:!1}),n.props.updateIsPicking(!1)},n.state={hovering:!1,picking:!1},n}return Object(p.__extends)(t,e),t.prototype.render=function(){if(this.props.isPlaceholder){var e=Object(p.__assign)({},ke);return Object(E.a)()&&(e=Object(p.__assign)(Object(p.__assign)({},e),{rtlShimmerStyles:S})),d.createElement(x.a,{style:{marginTop:"7px"},styles:e})}return v.a.shipAssertTag(595357773,C.a.msoulscat_ES_EWAJS,null!=this.props.range&&""!==this.props.range,"ConditionalFormattingTaskPaneReact.RulePreview.Render: rule range is empty."),Object(ge.d)("ConditionalFormattingRuleEditor"),d.createElement(y.a,{value:this.props.range,style:{textAlign:Object(E.a)()?"right":"left",direction:"ltr"},styles:ke,borderless:!0,onMouseEnter:this.mouseOver,onMouseLeave:this.mouseOut,readOnly:!0,tabIndex:-1,"data-is-focusable":!1,ariaLabel:this.props.range})},t}(d.Component),be=n(427);function fe(e,t,n,o){if(t.length<=e||n.length<=e||0===t[e])return"none";var i=o+"px";switch(t[e]){case 3:case 9:i+=" dashed";break;case 11:case 4:i+=" dotted";break;default:i+=" solid"}return n[e]?i+=" "+n[e]:i+=" black",i}function ye(e){var t="";return(e.isTextUnderlined||e.isTextDoubleUnderlined)&&(t="underline "),e.isTextStrikethrough&&(t+="line-through"),t||"none"}!function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right"}(b||(b={}));var ve=new Map;ve.set(0,"to right"),ve.set(180,"to left"),ve.set(90,"to bottom"),ve.set(270,"to top"),ve.set(45,"to right bottom"),ve.set(225,"to left top"),ve.set(135,"to left bottom"),ve.set(315,"to right top");var Ce=function(e){function t(t){var n=e.call(this,t)||this;return n.previewBorderWidth=1,n.rulePreviewStyle={width:"72px",height:"16px",border:n.previewBorderWidth+"px solid #d2d0ce",borderRadius:"1px"},n}return Object(p.__extends)(t,e),t.prototype.render=function(){if(this.props.rule.isPlaceholder)return d.createElement(x.a,{style:this.rulePreviewStyle,styles:Object(E.a)()?S:void 0});switch(this.props.rule.ruleType){case 3:return this.renderCustomFormatPreview();case 0:return this.renderColorScalePreview();case 1:return this.renderDataBarPreview();case 2:return this.renderIconSetPreview();default:return v.a.shipAssertTag(595702673,C.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RulePreview.Render: unexpected rule type received."),d.createElement("div",{style:this.rulePreviewStyle})}},t.prototype.renderCustomFormatPreview=function(){return d.createElement("div",{style:Object(p.__assign)(Object(p.__assign)({},this.rulePreviewStyle),this.getCustomFormatStyle()),"aria-hidden":"true"},ExcelRibbonStrings.ConditionalFormattingCustomStylePreviewSampleText)},t.prototype.renderColorScalePreview=function(){var e=this.props.rule.colorScaleFormat;v.a.shipAssertTag(595706326,C.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderColorScalePreview: colorScaleFormat not set"),v.a.shipAssertTag(595706327,C.a.msoulscat_ES_EWAJS,null!=e.minimumColor&&""!==e.minimumColor&&null!=e.maximumColor&&""!==e.maximumColor,"ConditionalFormattingTaskPaneReact.RulePreview.renderColorScalePreview: colorScaleFormat values not set correctly");var t={};return t=e.midpointColor?{background:"linear-gradient(to right, "+e.minimumColor+", "+e.midpointColor+", "+e.maximumColor+")"}:{background:"linear-gradient(to right, "+e.minimumColor+", "+e.maximumColor+")"},d.createElement("div",{style:Object(p.__assign)(Object(p.__assign)({},this.rulePreviewStyle),t)})},t.prototype.renderIconSetPreview=function(){var e=this.props.rule.iconSetFormat;return v.a.shipAssertTag(595706328,C.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderIconSetPreview: IconSetFormat not set"),v.a.shipAssertTag(595706329,C.a.msoulscat_ES_EWAJS,null!=e.icons,"ConditionalFormattingTaskPaneReact.RulePreview.renderIconSetPreview: ruleIconSetFormat values not set correctly"),d.createElement("div",{style:Object(p.__assign)(Object(p.__assign)({},this.rulePreviewStyle),{display:"flex",border:"none",flexBasis:"100%",justifyContent:"space-between",direction:"ltr"})},be.a.getIconNamesArray(e.icons,e.isReverseIconsOrder).map((function(e,t){return d.createElement(I.a,{iconName:e,key:t,style:{height:"13px",width:"13px"}})})))},t.prototype.renderDataBarPreview=function(){var e=this.props.rule.dataBarFormat;v.a.shipAssertTag(595706330,C.a.msoulscat_ES_EWAJS,null!=e,"ConditionalFormattingTaskPaneReact.RulePreview.renderDataBarPreview: dataBarFormat not set"),v.a.shipAssertTag(595706331,C.a.msoulscat_ES_EWAJS,null!=e.fillColor&&""!==e.fillColor,"ConditionalFormattingTaskPaneReact.RulePreview.renderDataBarPreview: dataBarFormat values not set correctly");var t={};t=e.isGradientFill?{backgroundImage:"linear-gradient(to "+(e.isLTRDirection?"right":"left")+", "+e.fillColor+" , white)"}:{backgroundColor:e.fillColor};var n={};return e.borderColor&&(n={border:"0.7px solid "+e.borderColor}),d.createElement("div",{style:Object(p.__assign)(Object(p.__assign)({},this.rulePreviewStyle),{display:"flex",padding:"0.5px",flexDirection:e.isLTRDirection?"row":"row-reverse",direction:"ltr"})},d.createElement("div",{style:Object(p.__assign)(Object(p.__assign)(Object(p.__assign)({},t),{width:"80%"}),n)}))},t.prototype.getCustomFormatStyle=function(){var e;if(!this.props.rule.customFormat)return v.a.shipAssertTag(595706332,C.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingTaskPaneReact.RulePreview.getCustomFormatStyle: ruleCustomFormat not set"),{};var t,n=this.props.rule.customFormat,o={};n.borderFormat&&n.borderFormat.color&&n.borderFormat.lineStyle&&((t=n.borderFormat.lineStyle).length>=4&&(0!==t[b.Top]||0!==t[b.Bottom]||0!==t[b.Left]||0!==t[b.Right]))&&(o={border:null,borderTop:fe(b.Top,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth),borderBottom:fe(b.Bottom,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth),borderRight:fe(b.Right,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth),borderLeft:fe(b.Left,n.borderFormat.lineStyle,n.borderFormat.color,this.previewBorderWidth)});var i=null!==(e=function(e){if(!e||!e.gradientStops)return null;if(e.isLinearGradient){var t=e.gradientStops.join(",");return{background:"linear-gradient("+(n=e.degree,(ve.get(n)||"")+", ")+t+")"}}var n,o,i,r;return e.radialGradientPosition&&2===e.gradientStops.length?e.radialGradientPosition.isCenter?{background:"radial-gradient("+e.gradientStops[0]+", "+e.gradientStops[1]+" 70%)"}:{background:(o=e.radialGradientPosition,i=e.gradientStops[0]||"",r=e.gradientStops[1]||"","radial-gradient(farthest-side, "+i+" , "+r+(o.isBottom?") top ":") bottom ")+(o.isRight?"left":"right")+"/200% 200%")}:null}(n.gradientFill))&&void 0!==e?e:{backgroundColor:n.backgroundColor||"#FFFFFF"};return Object(p.__assign)(Object(p.__assign)(Object(p.__assign)({},i),{textAlign:"center",fontWeight:n.isTextBold?"bold":"normal",fontStyle:n.isTextItalic?"italic":"normal",color:n.textColor||"#000000",textDecorationLine:ye(n),textDecorationStyle:n.isTextDoubleUnderlined?"double":"solid",fontSize:"12px"}),o)},t}(d.Component),xe=n(437);function Se(e){var t=document.getElementById(kn);(null==t?void 0:t.firstChild)&&t.removeChild(t.firstChild);var n=document.createElement("div");n.setAttribute("aria-label",e),n.setAttribute("aria-live","assertive"),null==t||t.appendChild(n)}var Ee=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(M.a,{content:ExcelRibbonStrings.ConditionalFormattingDeleteAllRulesTooltip,directionalHint:A.DirectionalHint.bottomCenter},Object(O.c)("ConditionalFormattingRuleEditor")?d.createElement(xe.a,{id:"CondFmtDeleteAllRulesButton","aria-label":ExcelRibbonStrings.ConditionalFormattingDeleteAllRulesTooltip,styles:rt(),iconProps:{iconName:T.a.TrashCan_16,style:{width:"16px",height:"16px"}},onClick:this.onDeleteAllRulesSelected}):d.createElement(xe.a,{id:"CondFmtDeleteAllRulesButton","aria-label":ExcelRibbonStrings.ConditionalFormattingDeleteAllRulesTooltip,styles:we(),text:ExcelRibbonStrings.ConditionalFormattingDeleteAllRules,iconProps:{iconName:T.a.TrashCan_16,style:{width:"16px",height:"16px"}},onClick:this.onDeleteAllRulesSelected}))},t.prototype.onDeleteAllRulesSelected=function(e){de.onDeleteRulesByFilter(),Se(ExcelRibbonStrings.ConditionalFormattingAllRulesDeleted)},t}(d.Component),we=function(){var e,t,n;return{root:{fontSize:"inherit",paddingRight:"6px",paddingLeft:"0px",selectors:{":focus":{selectors:(e={},e[P.l]=[{backgroundColor:"Highlight",color:"HighlightText"}],e)}}},rootHovered:{color:"#217346",selectors:(t={},t[P.l]=[{backgroundColor:"Highlight",color:"HighlightText"}],t)},label:{marginLeft:"0px",marginRight:"0px",selectors:(n={},n[P.l]=[{color:"ButtonText !important"}],n)}}},ke={root:{width:"170px",height:"28px"},field:{color:"#252423",fontSize:"12px",cursor:"default",padding:"0px"}},Te=function(e){function t(t){var n,o=e.call(this,t)||this;return o.ruleCardStyle={root:{minWidth:"262px",minHeight:"58px",maxWidth:"262px",maxHeight:"58px",marginTop:"9px",marginBottom:"9px",padding:"8px 11px 8px 11px",borderRadius:"2px",boxShadow:"0px 1px 3px 0px #eaeaea",selectors:{":hover":(n={borderColor:"#c8c8c8",borderStyle:"solid"},n[P.l]={borderColor:"Highlight"},n),":focus,:focus-within,:focus:after":B()}}},o.ruleCardLineStyle={display:"flex",height:"28px"},o.stopConditionalStyle={alignSelf:"center",height:"14px"},o.stopConditionalIconStyle={height:"12px",width:"12px",paddingRight:"3px"},o.ruleElementIdPrefix="CondFmtRule",o.shouldShowCommands=function(){var e=o.state.hovering||Object(O.c)("ConditionalFormattingRuleEditor")&&o.state.focused,t=o.props.rule.isPlaceholder||o.state.picking;return e&&!t},o.mouseOver=function(){o.setState((function(e){return e.hovering?null:{hovering:!0,ownUpdate:!0}})),o.props.rule.isPlaceholder||de.onRuleHoverStateChange(!0,o.props.rule.ruleId,o.props.rule.ruleRange)},o.mouseOut=function(){o.state.hovering&&(o.setState({hovering:!1,ownUpdate:!0}),o.props.rule.isPlaceholder||de.onRuleHoverStateChange(!1,o.props.rule.ruleId,o.props.rule.ruleRange))},o.onFocus=function(){o.setState((function(e){return e.focused?null:{focused:!0,ownUpdate:!0}}))},o.onBlur=function(){o.state.focused&&o.setState({focused:!1,ownUpdate:!0})},o.state={hasError:!1,hovering:!1,picking:!1,focused:!1,isDeleted:!1,ownUpdate:!0},o.onRuleDelete=o.onRuleDelete.bind(o),o.updateIsPicking=o.updateIsPicking.bind(o),o.editRule=o.editRule.bind(o),o.onKeyDown=o.onKeyDown.bind(o),o}return Object(p.__extends)(t,e),t.getDerivedStateFromError=function(){return{hasError:!0,ownUpdate:!0}},t.getDerivedStateFromProps=function(e,t){return t.ownUpdate?{ownUpdate:!1}:{hasError:!1,isDeleted:!1}},t.prototype.componentDidCatch=function(e,t){v.a.sendTraceTag(595706333,C.a.msoulscat_ES_EWAJS,$.a.Error,"ConditionalFormattingTaskPaneReact.Rule: Rule component failed to render: "+e.toString()+" , "+t.componentStack)},t.prototype.componentWillUnmount=function(){this.mouseOut()},t.prototype.render=function(){return this.state.hasError||this.state.isDeleted?d.createElement("div",null):d.createElement(f.a,{tabIndex:0===this.props.index?0:-1,"data-is-focusable":!0,styles:this.ruleCardStyle,onMouseOver:this.mouseOver,onMouseLeave:this.mouseOut,onFocus:this.onFocus,onBlur:this.onBlur,id:this.ruleElementIdPrefix+this.props.index,onKeyDown:this.onKeyDown,"aria-label":this.prepareRuleLabel(),role:"listitem"},d.createElement("div",{style:Object(p.__assign)(Object(p.__assign)({},this.ruleCardLineStyle),{marginBottom:"4px"})},d.createElement("div",{style:this.stopConditionalStyle},!this.props.rule.isPlaceholder&&this.props.rule.stopIfTrue?d.createElement(M.a,{content:ExcelRibbonStrings.ConditionalFormattingStopIfTrueText},d.createElement(I.a,{iconName:T.a.StopConditional_12,style:this.stopConditionalIconStyle})):null),d.createElement("div",{style:{flexGrow:2}},d.createElement(w,{ruleName:this.props.rule.ruleName,isPlaceholder:this.props.rule.isPlaceholder||!1})),d.createElement("div",{style:{marginTop:"8px"}},d.createElement(Ce,{rule:this.props.rule})," ")),d.createElement("div",{style:this.ruleCardLineStyle},d.createElement("div",{style:{flexGrow:2}},d.createElement(me,{id:"ConditionalFormattingRuleRange."+this.props.rule.ruleId,range:this.props.rule.ruleRange,isPlaceholder:this.props.rule.isPlaceholder||!1,updateIsPicking:this.updateIsPicking})),d.createElement(W,{showCommands:this.shouldShowCommands(),enableEdit:this.isRuleEditable(),onRuleDelete:this.onRuleDelete,editRule:this.editRule,ruleId:this.ruleElementIdPrefix+this.props.index})))},t.prototype.updateIsPicking=function(e){this.state.picking!==e&&this.setState({picking:e,ownUpdate:!0})},t.prototype.isRuleEditable=function(){return!!Object(O.c)("ConditionalFormattingRuleEditor")&&(v.a.shipAssertTag(573933140,C.a.msoulscat_ES_EWAJS,this.props.rule.isPlaceholder||3===this.props.rule.ruleType||null!==this.props.rule.dataBarFormat||null!==this.props.rule.colorScaleFormat||null!==this.props.rule.iconSetFormat,"ConditionalFormattingTaskPaneReact.Rule.isRuleEditable: rule does not have custom format."),null!=this.props.rule.editOptions||3!==this.props.rule.ruleType)},t.prototype.editRule=function(){this.props.editRule(this.props.rule)},t.prototype.prepareRuleLabel=function(){if(this.props.rule.isPlaceholder)return ExcelRibbonStrings.ConditionalFormattingLoadingRule;var e=(this.props.rule.stopIfTrue?ExcelRibbonStrings.ConditionalFormattingRuleAppliesToRangeHasStopIfTrue:ExcelRibbonStrings.ConditionalFormattingRuleAppliesToRange).replace("{0}",this.props.rule.ruleName).replace("{1}",this.props.rule.ruleRange);return this.isRuleEditable()?e=e.concat(ExcelRibbonStrings.ConditionalFormattingRuleHasTwoOptions):(e=e.concat(ExcelRibbonStrings.ConditionalFormattingRuleHasDeleteButton),Object(O.c)("ConditionalFormattingRuleEditor")&&(e=e.concat(ExcelRibbonStrings.ConditionalFormattingEditingRuleNotSupportedTooltipContent))),e},t.prototype.onRuleDelete=function(){var e=this;Se(ExcelRibbonStrings.ConditionalFormattingRuleDeleted),this.setState({isDeleted:!0,hovering:!1,focused:!1,ownUpdate:!0}),this.props.rule.isPlaceholder&&v.a.shipAssertTag(593826331,C.a.msoulscat_ES_EWAJS,null!=this.props.rule.ruleName&&""!==this.props.rule.ruleName,"ConditionalFormattingTaskPaneReact.Rule.onRuleDelete: rule is a place holder."),de.onRuleHoverStateChange(!1,this.props.rule.ruleId,this.props.rule.ruleRange),setTimeout((function(){e.setFocusAfterDelete()}),100),this.props.onRuleDelete(this.props.rule.ruleId)},t.prototype.setFocusAfterDelete=function(){var e=document.getElementById(this.ruleElementIdPrefix+(this.props.index+1));e||(e=document.getElementById(this.ruleElementIdPrefix+(this.props.index-1)))?e.focus():de.setFocusOnPaneFirstElement()},t.prototype.onKeyDown=function(e){var t=null;switch(e.keyCode){case R.a.up:0!==this.props.index&&(t=document.getElementById(this.ruleElementIdPrefix+(this.props.index-1)));break;case R.a.down:this.props.isLastRule||(t=document.getElementById(this.ruleElementIdPrefix+(this.props.index+1)));break;case R.a.tab:e.shiftKey?t=document.getElementById("CondFmtDeleteAllRulesButton"):de.setFocusOnToolbarFirstElement(),e.preventDefault();break;case R.a.del:this.onRuleDelete(),e.preventDefault();break;case R.a.enter:if(Object(O.c)("ConditionalFormattingRuleEditor")){var n=this.ruleElementIdPrefix+this.props.index;(t=document.getElementById("CondFmtEditRuleIconId-"+n))&&this.isRuleEditable()||(t=document.getElementById("CondFmtDeleteRuleIconId-"+n))}}t&&t.focus()},t}(d.Component),Ie=n(1896),Re=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.scrollStyle={minWidth:t.props.scrollMinWidth},t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Ie.Scrollbars,{autoHide:!1,style:this.scrollStyle,renderView:this.renderView,renderThumbHorizontal:this.renderThumbHorizontal,renderThumbVertical:this.renderThumbVertical,renderTrackVertical:this.renderTrackVertical},this.props.children)},t.prototype.renderView=function(){return d.createElement("div",{className:Object(P.eb)({overflow:"scroll",position:"absolute",top:"0px",bottom:"0px",right:"0px",left:"0px","-ms-overflow-style":"none","scrollbar-width":"none",selectors:{"::-webkit-scrollbar":{display:"none"}}})})},t.prototype.renderThumbHorizontal=function(){return d.createElement("div",{style:{display:"hidden"}})},t.prototype.renderTrackVertical=function(){var e={position:"absolute",bottom:"2px",right:Object(E.a)()?"292px":"3px",top:"10px",width:"10px",cursor:"default"};return d.createElement("div",{style:e})},t.prototype.renderThumbVertical=function(){return d.createElement("div",{style:{display:"block",width:"6px",backgroundColor:"#C8C6C4",borderRadius:"3px"}})},t}(d.Component),Oe=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this,t=d.createElement("div",{role:"list",id:this.getRuleListId()},this.props.rules.map((function(t,n){return d.createElement(Te,{key:t.ruleId,index:n,rule:t,onRuleDelete:e.props.onRuleDelete,editRule:e.props.editRule,isLastRule:n===Object.keys(e.props.rules).length-1})})));return d.createElement(Re,{scrollMinWidth:"304px"},d.createElement("div",{style:{position:"absolute",display:"flex",flexDirection:"column",overflow:"hidden"}},t))},t.prototype.getRuleListId=function(){return this.props.rules&&0!==this.props.rules.length&&this.props.rules[0].isPlaceholder?de.getRequiredLoadingRuleListId():de.getRequiredRuleListId()},t}(d.Component),Pe=n(336),Fe=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.emptyContainerLabelStyle=Object(p.__assign)(Object(p.__assign)({},ot),{paddingTop:"16px",fontWeight:400}),t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Pe.a,{"aria-label":ExcelRibbonStrings.ConditionalFormattingEmptyPane,style:this.emptyContainerLabelStyle,id:"EmptyRuleContainerLabel"},ExcelRibbonStrings.ConditionalFormattingEmptyPane)},t}(d.Component),De=n(1144),_e={backgroundColor:"transparent",fontSize:"12px"},je={dropdown:{border:"1px solid transparent",width:"max-content",color:"#217346",fontSize:"12px",selectors:{":focus":B(),":focus:after":{outline:"none",border:"1px solid transparent"}}},title:{border:"none",color:"#217346 !important",backgroundColor:"transparent",height:"22px",marginBottom:"5px",paddingLeft:"4px",lineHeight:"23px"},root:{color:"#217346"},dropdownOptionText:_e,caretDownWrapper:{maxHeight:"12px",lineHeight:"23px"},dropdownItem:{minHeight:"24px",color:"#252423"},dropdownItemSelected:{minHeight:"24px"}},Be={alignItems:"baseline",marginTop:"9px"},Le=T.a.CommonControlChevronDown_12,Me={root:{height:"12px",width:"12px"}},Ae=function(){return d.createElement(I.a,{iconName:Le,styles:Me})},We=function(e){function t(t){var n=e.call(this,t)||this;return n.onUpdateFilteringOption=n.onUpdateFilteringOption.bind(n),n}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){de.setFocusOnPaneFirstElement()},t.prototype.render=function(){return d.createElement(H.a,{style:Be,horizontal:!0,tokens:{childrenGap:2},verticalAlign:"end"},d.createElement(Pe.a,{style:{fontSize:"12px",paddingTop:"0px",paddingBottom:"0px",marginBottom:"8px"},id:"ConditionalFormattingFilterMenuPrefix"},ExcelRibbonStrings.ConditionalFormattingFilterMenuPrefix),d.createElement(De.a,{role:"combobox",options:t.filterOptions,selectedKey:this.props.ruleFilterOption,styles:je,onRenderCaretDown:Ae,onChange:this.onUpdateFilteringOption,"aria-labelledby":"EmptyRuleContainerLabel ConditionalFormattingFilterMenuPrefix",id:de.getRequiredFirstPaneElementId()}))},t.prototype.onUpdateFilteringOption=function(e,t){if(!t)throw new Error("undefined filtering option.");var n;if(0===t.key)n=0;else{if(1!==t.key)throw new Error("RuleManager.onUpdateFilteringOption Unknown filtering type.");n=1}de.onRuleFilteringOptionsChange(n)},t.filterOptions=[{key:1,text:ExcelRibbonStrings.ConditionalFormattingFilterMenuSheet},{key:0,text:ExcelRibbonStrings.ConditionalFormattingFilterMenuSelection}],t}(d.Component),ze=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isLoading:!1},n.timeout=null,n}return Object(p.__extends)(t,e),t.prototype.render=function(){return this.state.isLoading?this.props.loadingElement():d.createElement("div",null)},t.prototype.componentDidMount=function(){var e=this;this.state.isLoading||(this.timeout=setTimeout((function(){e.setState({isLoading:!0})}),this.props.showLoadingAfter))},t.prototype.componentWillUnmount=function(){clearTimeout(this.timeout)},t}(d.Component),He=n(1141),Ne={marginLeft:"9px"},Ve=Object(p.__assign)(Object(p.__assign)({},Ne),{color:"#252423",paddingTop:"16px"}),Ge=Object(p.__assign)(Object(p.__assign)({},Ne),{fontSize:"12px",color:"#252423",fontWeight:400,paddingBottom:"16px"}),Ue={root:Ne},Ke=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",null,d.createElement(Pe.a,{style:Ve},this.props.errorTitle),d.createElement(Pe.a,{style:Ge},this.props.errorMsg),this.props.infoLink&&this.props.infoLinkText?d.createElement(He.a,{href:this.props.infoLink,target:"_blank",styles:Ue},this.props.infoLinkText):"")},t}(d.Component),qe=new Map;qe.set(1,{errorTitle:ExcelRibbonStrings.ConditionalFormattingTooManyRulesErrorTitle,errorMsg:ExcelRibbonStrings.ConditionalFormattingTooManyRulesErrorMessage,infoLink:"https://support.office.com/article/fed60dfa-1d3f-4e13-9ecb-f1951ff89d7f",infoLinkText:ExcelRibbonStrings.ConditionalFormattingInfoURLText});var Qe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return Object(O.c)("ConditionalFormattingRuleEditor")?d.createElement(M.a,{content:ExcelRibbonStrings.ConditionalFormattingNewRuleTooltip,directionalHint:A.DirectionalHint.bottomCenter},d.createElement(xe.a,{"aria-label":ExcelRibbonStrings.ConditionalFormattingNewRuleTooltip,styles:rt(),iconProps:{iconName:T.a.plussignglyph_16,style:{width:"16px",height:"16px"}},onClick:this.onAddNewRuleSelected})):d.createElement("div",null)},t.prototype.onAddNewRuleSelected=function(e){de.addNewRuleFromTaskPane()},t}(d.Component),Je=function(){function e(e){this.wasModified=!1,this.data=e,this.originalData={sheetName:e.sheetName}}return Object.defineProperty(e.prototype,"rangeString",{get:function(){return this.data.rangeString},set:function(e){this.data.rangeString=e,this.wasModified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sheetName",{get:function(){return this.data.sheetName},set:function(e){this.data.sheetName=e,this.wasModified=!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activeCell",{get:function(){return this.data.activeCell},set:function(e){this.data.activeCell=e,this.wasModified=!0},enumerable:!0,configurable:!0}),e.prototype.update=function(e){"rangeString"in e&&(this.rangeString=e.rangeString),"sheetName"in e&&(this.sheetName=e.sheetName),"activeCell"in e&&(this.activeCell=e.activeCell)},e.prototype.isDirty=function(){return this.wasModified},e.prototype.getErrorType=function(e){return this.rangeString&&this.rangeString.length>1e3?3:e||this.sheetName===this.originalData.sheetName?de.getRangeErrorType(this.rangeString):4},e.prototype.getErrorMessage=function(e){switch(this.getErrorType(e)){case 1:case 2:return ExcelRibbonStrings.ConditionalFormattingInvalidRangeError;case 3:return ExcelRibbonStrings.ConditionalFormattingValueTooLongError.replace("{0}",1e3.toString());case 4:return ExcelRibbonStrings.ConditionalFormattingChangeRangeSheetNameError;default:return null}},e.prototype.isValid=function(e){return 0===this.getErrorType(e)},e}(),Ye=function(){function e(e,t,n,o,i,r,a,s){void 0===t&&(t=null),void 0===o&&(o=!1),void 0===r&&(r=null),void 0===a&&(a=null),void 0===s&&(s=null),this.ruleInputData=e,this.stopIfTrue=o,this.guid=t,this.range=new Je(Object(p.__assign)({},n)),this.ruleFormat=i,this.dataBarFormat=r,this.colorScaleFormat=a,this.iconSetFormat=s}return e.prototype.getRuleInputData=function(){return this.ruleInputData},e.prototype.setRuleInputData=function(e){this.ruleInputData=e},e.prototype.getGuid=function(){return this.guid},e.prototype.setGuid=function(e){this.guid=e},e.prototype.getRange=function(){return this.range},e.prototype.updateRange=function(e){null==this.range?this.range=new Je(Object(p.__assign)({},e)):this.range.update(e)},e.prototype.getStopIfTrue=function(){return this.stopIfTrue},e.prototype.setStopIfTrue=function(e){this.stopIfTrue=e},e.prototype.getQuickFormat=function(){return this.ruleFormat.quickFormat},e.prototype.setQuickFormat=function(e){this.ruleFormat.quickFormat=e},e.prototype.getCustomFormat=function(){return this.ruleFormat.customFormat},e.prototype.getRuleFormat=function(){return this.ruleFormat},e.prototype.isNewRule=function(){return null===this.getGuid()||void 0===this.getGuid()},e.prototype.canFocusOnRuleInput=function(){return this.getRuleInputData().canFocusOnRuleInput()},e.prototype.getDataBarFormat=function(){return this.dataBarFormat},e.prototype.getColorScaleFormat=function(){return this.colorScaleFormat},e.prototype.getIconSetFormat=function(){return this.iconSetFormat},e}();function Xe(e,t,n){var o,i,r;void 0===n&&(n=null);var a=null,s={rangeString:null!==(o=t.range)&&void 0!==o?o:void 0,sheetName:null!==(i=t.ruleRangeSheetName)&&void 0!==i?i:void 0,activeCell:null!==(r=t.activeCell)&&void 0!==r?r:void 0};if(t.addRuleType){var l=function(e){var t=Ze.get(e);if(t)return t;throw new Error("Unsupported ruleType")}(t.addRuleType);if(a=e.createRuleInputData(l),n&&n.isNewRule()&&n.getRuleInputData()){var c=n.getRuleInputData().getRuleInputValue();return a.getInputType()===n.getRuleInputData().getInputType()&&c&&a.setRuleInputValue(c),new Ye(a,t.guid,s,n.getStopIfTrue(),{quickFormat:n.getQuickFormat(),customFormat:null})}}else t.guid&&(t.options&&t.options.command?a=e.createRuleInputData(t.options.command,t.options,t.dataBarFormat):(t.dataBarFormat||t.colorScaleFormat||t.iconSetFormat)&&(a=e.createRuleInputData(0,t.options,t.dataBarFormat,t.colorScaleFormat,t.iconSetFormat)));return a||(v.a.shipAssertTag(573687755,C.a.msoulscat_ES_EWAJS,!1,"ConditionalFormattingHelper.createRuleData: RuleInputData is null"),a=e.createDefaultRuleInputDataByRuleTypeOption(null)),new Ye(a,t.guid,s,!!t.stopIfTrue&&t.stopIfTrue,{quickFormat:t.guid&&t.customFormat?-1:0,customFormat:t.customFormat||null},t.dataBarFormat||null,t.colorScaleFormat||null,t.iconSetFormat||null)}var Ze=new Map;function $e(e,t){var n,o;if(e&&t){if(e.backgroundColor!==t.backgroundColor||e.textColor!==t.textColor||e.isTextBold!==t.isTextBold||e.isTextItalic!==t.isTextItalic||e.isTextStrikethrough!==t.isTextStrikethrough||e.isTextUnderlined!==t.isTextUnderlined||e.isTextDoubleUnderlined!==t.isTextDoubleUnderlined)return!1;if(e.borderFormat&&t.borderFormat){if(e.borderFormat.lineStyle&&t.borderFormat.lineStyle)for(var i=0;i<e.borderFormat.lineStyle.length;i+=1)if(e.borderFormat.lineStyle[i]!==t.borderFormat.lineStyle[i])return!1;if(e.borderFormat.color&&t.borderFormat.color)for(i=0;i<e.borderFormat.color.length;i+=1)if((null===(n=e.borderFormat.color[i])||void 0===n?void 0:n.toLowerCase())!==(null===(o=t.borderFormat.color[i])||void 0===o?void 0:o.toLowerCase()))return!1;if(e.borderFormat.thickness&&t.borderFormat.thickness)for(i=0;i<e.borderFormat.thickness.length;i+=1)if(e.borderFormat.thickness[i]!==t.borderFormat.thickness[i])return!1}else if(e.borderFormat&&!t.borderFormat||!e.borderFormat&&t.borderFormat)return!1;if(e.gradientFill)return!1}return!0}Ze.set("HighlightCellsGT",1),Ze.set("HighlightCellsLT",2),Ze.set("HighlightCellsBetween",3),Ze.set("HighlightCellsEQ",4),Ze.set("HighlightCellsContains",5),Ze.set("HighlightCellsDate",6),Ze.set("HighlightCellsDupe",7),Ze.set("TopBottomTop10",8),Ze.set("TopBottomBot10",10),Ze.set("TopBottomTop10P",9),Ze.set("TopBottomBot10P",11),Ze.set("TopBottomAA",12),Ze.set("TopBottomBA",13);var et,tt,nt,ot={color:"#252423",fontSize:"12px"},it={background:"Highlight",color:"HighlightText",fill:"HighlightText"},rt=function(){var e,t;return{root:{paddingRight:"4px",selectors:{":hover":(e={background:"#E1DFDD"},e[P.l]=it,e),":focus":(t={},t[P.l]=it,t)}}}},at=function(e){function t(t){var n=e.call(this,t)||this;return n.createLoadingElement=function(){return d.createElement(Oe,{rules:n.createPlaceholderRulesList(),onRuleDelete:n.onRuleDelete,editRule:n.editRule})},n.state={isLastRuleDeleted:!1},n.onRuleDelete=n.onRuleDelete.bind(n),n.editRule=n.editRule.bind(n),n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(){return{isLastRuleDeleted:!1}},t.prototype.render=function(){return d.createElement("div",{id:de.getRequiredRuleManagerId(),style:Object(p.__assign)({position:"absolute",height:"100%",display:"flex",flexDirection:"column"},{marginLeft:"17px",marginRight:"17px",right:"0px",left:"0px"})},d.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},d.createElement(We,{ruleFilterOption:this.props.ruleFilterOption}),d.createElement("div",null,d.createElement(Qe,null),d.createElement(Ee,null))),this.getRulesContainerComponent())},t.prototype.getRulesContainerComponent=function(){return this.props.error?d.createElement(Ke,Object(p.__assign)({},qe.get(this.props.error))):this.props.isLoading?d.createElement(ze,{showLoadingAfter:wn,loadingElement:this.createLoadingElement}):0===Object.keys(this.props.rules).length||this.state.isLastRuleDeleted?d.createElement(Fe,null):d.createElement(Oe,{rules:(e=this.props.rules,e.sort((function(e,t){return e.priority-t.priority}))),onRuleDelete:this.onRuleDelete,editRule:this.editRule});var e},t.prototype.onRuleDelete=function(e){Object.keys(this.props.rules).length<=1&&this.setState({isLastRuleDeleted:!0}),de.onRuleDelete(e)},t.prototype.editRule=function(e){this.props.onChangeViewRequest(2,e)},t.prototype.createPlaceholderRule=function(e){return{isPlaceholder:!0,ruleName:"",ruleType:0,ruleRange:"",ruleId:e,priority:0,stopIfTrue:!1,colorScaleFormat:null,dataBarFormat:null,customFormat:null,iconSetFormat:null}},t.prototype.createPlaceholderRulesList=function(){for(var e=[],t=0;t<4;t+=1)e.push(this.createPlaceholderRule(t.toString()));return e},t}(d.Component);!function(e){e[e.CellValue=0]="CellValue",e[e.SpecificText=1]="SpecificText",e[e.DateOccurring=2]="DateOccurring",e[e.DuplicateValues=3]="DuplicateValues",e[e.UniqueValues=4]="UniqueValues",e[e.Blanks=5]="Blanks",e[e.NoBlanks=6]="NoBlanks",e[e.Errors=7]="Errors",e[e.NoErrors=8]="NoErrors"}(et||(et={})),function(e){e[e.HighlightCellsWith=0]="HighlightCellsWith",e[e.TopBottom=1]="TopBottom",e[e.DataBars=2]="DataBars",e[e.ColorScales=3]="ColorScales",e[e.IconSets=4]="IconSets",e[e.Formula=5]="Formula"}(tt||(tt={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.AboveAverage=2]="AboveAverage",e[e.BelowAverage=3]="BelowAverage",e[e.EqualOrAboveAverage=4]="EqualOrAboveAverage",e[e.EqualOrBelowAverage=5]="EqualOrBelowAverage"}(nt||(nt={}));var st=function(){function e(e,t){this.command=e,this.inputValue=t,this.shouldShowErrorWhenInvalid=!0,this.inputWasChanged=!1}return e.prototype.getCommandType=function(){return this.command},e.prototype.setCommandType=function(e){this.command=e},e.prototype.getRuleInputValue=function(){return this.inputValue},e.prototype.setRuleInputValue=function(e){this.setShouldShowErrorWhenInvalid(!0),this.inputValue=e},e.prototype.shouldShowError=function(){return this.shouldShowErrorWhenInvalid&&!this.isValid()},e.prototype.getShouldShowErrorWhenInvalid=function(){return this.shouldShowErrorWhenInvalid},e.prototype.setShouldShowErrorWhenInvalid=function(e){this.shouldShowErrorWhenInvalid=e},e.prototype.wasChanged=function(){return this.inputWasChanged},e.prototype.setWasChanged=function(){this.inputWasChanged=!0},e.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!0},e.prototype.getError=function(){return null},e.prototype.canFocusOnRuleInput=function(){return!1},e}(),lt=function(e){function t(t,n){void 0===n&&(n=null);var o=e.call(this,t,n)||this;return o.minValue=1,o.percentMaxValue=100,o.maxValue=1e3,o.defaultInputValue=10,o.isAverageRule()||null!==n||o.setRuleInputValue(o.getDefaultValue()),o}return Object(p.__extends)(t,e),t.prototype.isPercentRule=function(){return 9===this.getCommandType()||11===this.getCommandType()},t.prototype.getInputType=function(){return tt.TopBottom},t.prototype.isAverageRule=function(){return 12===this.getCommandType()||13===this.getCommandType()||75===this.getCommandType()||76===this.getCommandType()},t.prototype.isTopRule=function(){return 8===this.getCommandType()||9===this.getCommandType()},t.prototype.isBottomRule=function(){return 10===this.getCommandType()||11===this.getCommandType()},t.prototype.isValid=function(){if(this.isAverageRule())return!0;var e=this.getRuleInputValue();if(!isNaN(e)&&null!=e){var t=parseInt(e,10);if(t.toString()===e.toString()&&t>=this.getMinValue()&&t<=this.getMaxValue())return!0}return!1},t.prototype.getError=function(){return v.a.shipAssertTag(587310853,C.a.msoulscat_ES_EWAJS,!this.isAverageRule(),"TopBottomRuleInput.getErrorMessage: Average rule has no input value."),this.isValid()?null:ExcelRibbonStrings.ConditionalFormattingTopBottomValueTextboxOnError.replace("{0}",this.getMinValue().toString()).replace("{1}",this.getMaxValue().toString())},t.prototype.getMinValue=function(){return this.minValue},t.prototype.getMaxValue=function(){return this.isPercentRule()?this.percentMaxValue:this.maxValue},t.prototype.updateConditionalFormattingOptions=function(e){e.value=this.getRuleInputValue(),e.command=this.getCommandType()},t.prototype.getDefaultValue=function(){return this.defaultInputValue},t.prototype.canFocusOnRuleInput=function(){return!this.isAverageRule()},t}(st),ct=function(e){function t(t,n){var o=e.call(this,t,n)||this;return o.defaultInputValue="",o.ruleFormulaValueMaxLength=255,null==n&&o.setRuleInputValue(o.getDefaultValue()),o.shouldShowErrorWhenInvalid=!1,o}return Object(p.__extends)(t,e),t.prototype.getInputType=function(){return 63===this.getCommandType()?tt.Formula:tt.HighlightCellsWith},t.prototype.canFocusOnRuleInput=function(){return!0},t.prototype.isValid=function(){return this.isValidValue(this.getRuleInputValue())},t.prototype.getError=function(){return this.getErrorForValue(this.getRuleInputValue())},t.prototype.getErrorIfNeeded=function(){return this.shouldShowErrorWhenInvalid?this.getError():null},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType(),this.updateFormulaValueOptions(e)},t.prototype.updateFormulaValueOptions=function(e){e.formula1=this.getRuleInputValue(),e.formula2=null},t.prototype.isValidValue=function(e){return 0===this.getErrorTypeForValue(e)},t.prototype.getErrorForValue=function(e){switch(this.getErrorTypeForValue(e)){case 1:return this.getInputType()===tt.Formula?ExcelRibbonStrings.ConditionalFormattingFormulaValueTextboxError:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueTextboxOnError;case 2:return ExcelRibbonStrings.ConditionalFormattingValueTooLongError.replace("{0}",this.ruleFormulaValueMaxLength.toString());case 3:return ExcelRibbonStrings.ConditionalFormattingFormulaRepresentingRangeError;default:return null}},t.prototype.getDefaultValue=function(){return this.defaultInputValue},t.prototype.getErrorTypeForValue=function(e){return e&&e.length>this.ruleFormulaValueMaxLength?2:de.getFormulaErrorType(e)},t}(st),ut=function(e){function t(t,n,o){void 0===n&&(n=null),void 0===o&&(o=null);var i=e.call(this,t,[n,o])||this,r=n,a=o;return null===n&&(r=i.getDefaultValue()),i.isTwoInputValuesRuleType()&&null===o&&(a=i.getDefaultValue()),r===n&&a===o||i.setRuleInputValue([r,a]),i.shouldShowErrorWhenInvalid=!1,i}return Object(p.__extends)(t,e),t.prototype.isTwoInputValuesRuleType=function(){return 3===this.getCommandType()||70===this.getCommandType()},t.prototype.isValid=function(){return!!this.isValidValue(this.getRuleInputValue()[0])&&!(this.isTwoInputValuesRuleType()&&!this.isValidValue(this.getRuleInputValue()[1]))},t.prototype.getError=function(){var e=this;return this.getRuleInputValue().map((function(t){return e.getErrorForValue(t)}))},t.prototype.getErrorIfNeeded=function(){return this.shouldShowErrorWhenInvalid?this.getError():this.getRuleInputValue().map((function(){return null}))},t.prototype.updateFormulaValueOptions=function(e){e.formula1=this.getRuleInputValue()[0],this.isTwoInputValuesRuleType()?e.formula2=this.getRuleInputValue()[1]:e.formula2=null},t}(ct),pt=function(e){function t(t,n){return void 0===n&&(n=!0),e.call(this,t,n)||this}return Object(p.__extends)(t,e),t.prototype.getInputType=function(){return tt.HighlightCellsWith},t.prototype.isValid=function(){return!0},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType(),7===this.getCommandType()&&(e.unique=!this.getRuleInputValue())},t}(st),dt=function(e){function t(t,n){return void 0===n&&(n=1),e.call(this,t,n)||this}return Object(p.__extends)(t,e),t.prototype.getInputType=function(){return tt.HighlightCellsWith},t.prototype.isValid=function(){return!0},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType(),e.timePeriod=this.getRuleInputValue()},t}(st),ht=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return Object(p.__extends)(t,e),t.prototype.getInputType=function(){return tt.DataBars},t.prototype.isValid=function(){return!0},t.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!1},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType()},t}(st),gt=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return Object(p.__extends)(t,e),t.prototype.getInputType=function(){return tt.ColorScales},t.prototype.isValid=function(){return!0},t.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!1},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType()},t}(st),mt=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return Object(p.__extends)(t,e),t.prototype.getInputType=function(){return tt.IconSets},t.prototype.isValid=function(){return!0},t.prototype.doesSupportStopIfTrueOrFormatInput=function(){return!1},t.prototype.updateConditionalFormattingOptions=function(e){e.command=this.getCommandType()},t}(st),bt=function(){function e(){}return e.prototype.createRuleInputData=function(e,t,n,o,i){switch(void 0===t&&(t=null),void 0===n&&(n=null),void 0===o&&(o=null),void 0===i&&(i=null),e){case 8:case 10:case 9:case 11:case 12:case 13:case 75:case 76:return new lt(e,t?t.value:null);case 1:case 2:case 4:case 68:case 69:case 71:return new ut(e,t?t.formula1:null);case 3:case 70:return new ut(e,t?t.formula1:null,t?t.formula2:null);case 5:case 72:case 73:case 74:return new ct(e,t?t.formula1:null);case 7:return new pt(7,!t||!t.unique||!t.unique);case 64:case 65:case 66:case 67:return new pt(e);case 6:return new dt(6,t&&null!==t.timePeriod&&void 0!==t.timePeriod?t.timePeriod:void 0);case 15:return new ht(15,n);case 28:return new gt(28,o);case 39:return new mt(39,i);case 63:return new ct(63,t?t.formula1:null);case 0:if(null!==n)return new ht(0,n);if(null!==o)return new gt(0,o);if(null!==i)return new mt(0,i);throw new Error("Unsupported ConditionalFormattingCommandType.Nil with no dataBarFormat");default:throw new Error("Unsupported ConditionalFormattingCommandType")}},e.prototype.createDefaultRuleInputDataByRuleTypeOption=function(e,t){var n;switch(void 0===e&&(e=null),void 0===t&&(t=null),e){case tt.TopBottom:(n=this.createRuleInputData(8)).setWasChanged();break;case tt.HighlightCellsWith:(n=this.createRuleInputData(1)).setWasChanged();break;case tt.DataBars:(n=null!=t?this.createRuleInputData(0,null,t):this.createRuleInputData(15)).setWasChanged();break;case tt.ColorScales:(n=null!=t?this.createRuleInputData(0,null,null,t):this.createRuleInputData(28)).setWasChanged();break;case tt.IconSets:(n=null!=t?this.createRuleInputData(0,null,null,null,t):this.createRuleInputData(39)).setWasChanged();break;case tt.Formula:(n=this.createRuleInputData(63)).setWasChanged();break;case null:n=this.createRuleInputData(1);break;default:throw new Error("Unsupported RuleTypeOption")}return n},e.prototype.createDefaultRuleInputDataByHighlightCellsWithOption=function(e){var t;switch(e){case et.CellValue:t=this.createRuleInputData(1);break;case et.SpecificText:t=this.createRuleInputData(5);break;case et.DateOccurring:t=this.createRuleInputData(6);break;case et.DuplicateValues:t=this.createRuleInputData(7);break;case et.UniqueValues:t=this.createRuleInputData(7,{unique:!0});break;case et.Blanks:t=this.createRuleInputData(64);break;case et.NoBlanks:t=this.createRuleInputData(65);break;case et.Errors:t=this.createRuleInputData(66);break;case et.NoErrors:t=this.createRuleInputData(67)}return t.setWasChanged(),t},e}(),ft=Object(E.a)()?Object(p.__assign)({marginRight:"10px"},L):Object(p.__assign)({marginLeft:"10px"},L),yt={lineHeight:"normal",width:"100%"},vt={lineHeight:"normal",marginTop:"4px"};function Ct(e){var t=e.isOpen?B(!0,!0):{};return{label:{fontSize:"12px",height:"14px",marginBottom:"4px",padding:"0px"},title:Object(p.__assign)(Object(p.__assign)({},t),{height:"28px",lineHeight:"normal",selectors:{":active:hover":{borderColor:"#217344"},":active:not(:hover)":{borderColor:"#217344"}}}),dropdown:{maxWidth:"287px",fontSize:"12px",selectors:{":active":{outline:"none"},":focus::after":B(!0,!0)}},dropdownItem:{direction:Object(E.a)()?"rtl":"ltr",minHeight:"28px",fontSize:"12px"},dropdownItemSelected:{direction:Object(E.a)()?"rtl":"ltr",minHeight:"28px",fontSize:"12px"}}}var xt=function(e){function t(t){var n=e.call(this,t)||this;return n.onRenderOption=function(e){return e?d.createElement("div",{style:yt},d.createElement(St,{text:e.text,item:e.data&&e.data.item})):(v.a.sendTraceTag(591927251,C.a.msoulscat_ES_EWAJS,$.a.Warning,"ConditionalFormattingTaskPaneReact.CFDropdown.RenderOption: option is undefined."),d.createElement("div",null))},n.onRenderTitle=function(e){return e&&e[0]?d.createElement("div",{style:vt},d.createElement(St,{text:e[0].text,item:e[0].data&&e[0].data.item})):(v.a.sendTraceTag(591927252,C.a.msoulscat_ES_EWAJS,$.a.Warning,"ConditionalFormattingTaskPaneReact.CFDropdown.RenderTitle: options list is "+(void 0===e?"undefined.":"empty.")),d.createElement("div",null))},n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(De.a,{role:"combobox listbox",id:this.props.id,label:this.props.label,ariaLabel:this.props.ariaLabel||this.props.label,options:this.props.options,styles:Ct,onRenderOption:this.onRenderOption,onRenderTitle:this.onRenderTitle,onRenderCaretDown:Ae,onChange:this.props.onChange?this.props.onChange:void 0,selectedKey:void 0===this.props.selectedKey||null===this.props.selectedKey?this.props.options[0].key:this.props.selectedKey,disabled:this.props.disabled})},t}(d.Component),St=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{display:"flex"}},d.createElement("div",null,this.props.item),d.createElement("span",{style:ft},this.props.text))},t}(d.Component),Et=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.RuleTypeDropdown",label:ExcelRibbonStrings.ConditionalFormattingRuleTypeMenuPrefix,options:kt,onChange:this.onChange,selectedKey:this.props.selectedKey?this.props.selectedKey:kt[0].key})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(d.Component),wt={height:"24px",width:"24px",marginTop:"-3px"},kt=[{key:tt.HighlightCellsWith,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeHighlightCellsWith,data:{item:d.createElement(I.a,{iconName:T.a.FlyoutAnchorCFHighlightCells_32,style:wt})}},{key:tt.TopBottom,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeTopBottom,data:{item:d.createElement(I.a,{iconName:T.a.FormattingRuleTop10_32,style:wt})}},{key:tt.DataBars,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeDataBars,data:{item:d.createElement(I.a,{iconName:T.a.FormattingRuleDataBar_32,style:wt})}},{key:tt.ColorScales,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeColorScale,data:{item:d.createElement(I.a,{iconName:T.a.FormattingRuleGrad3_32,style:wt})}},{key:tt.IconSets,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeIconSets,data:{item:d.createElement(I.a,{iconName:T.a.FormattingRuleIconSet_32,style:wt})}},{key:tt.Formula,text:ExcelRibbonStrings.ConditionalFormattingRuleTypeFormula,data:{item:d.createElement(I.a,{iconName:T.a.ShapeSheetShowFormulas_32,style:wt})}}],Tt=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.TopBottomDropdown",options:It,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingOperatorDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(d.Component),It=[{key:nt.Top,text:ExcelRibbonStrings.ConditionalFormattingTopBottomTop},{key:nt.Bottom,text:ExcelRibbonStrings.ConditionalFormattingTopBottomBottom},{key:nt.AboveAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomAverageAbove},{key:nt.BelowAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomAverageBelow},{key:nt.EqualOrAboveAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomEqualOrAboveAverage},{key:nt.EqualOrBelowAverage,text:ExcelRibbonStrings.ConditionalFormattingTopBottomEqualOrBelowAverage}],Rt=n(1138),Ot=n(1125),Pt=n(1148),Ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tooltipStyle={calloutProps:{backgroundColor:"rgb(184, 0, 0)",styles:{beakCurtain:{backgroundColor:"rgb(184, 0, 0)"}}},styles:{content:{color:"white"}}},t.getErrorMessage=function(){return t.props.errorMessage||void 0},t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(M.a,{id:"ConditionalFormattingRuleInputErrorLabel",content:this.getErrorMessage(),tooltipProps:this.tooltipStyle,setAriaDescribedBy:!1,role:"alert"},this.props.children)},t}(d.Component),Dt=function(e){function t(t){var n=e.call(this,t)||this;return n.inputElementsMarginLeft="5px",n.spinButtonHight="28px",n.spinButtonMinWidth="70px",n.checkBoxMarginTop="4px",n.topBottomDropdownMinWidth="130px",n.onIncrement=function(e){var t=parseInt(e,10);n.onInputValueChanged(isNaN(t)?n.props.ruleInputData.getMinValue().toString():(t+1).toString()),Se(ExcelRibbonStrings.ConditionalFormattingSpinButtonValueIncreased)},n.onDecrement=function(e){var t=parseInt(e,10);n.onInputValueChanged(isNaN(t)?n.props.ruleInputData.getMinValue().toString():(t-1).toString()),Se(ExcelRibbonStrings.ConditionalFormattingSpinButtonValueDecreased)},n.onTopBottomChange=n.onTopBottomChange.bind(n),n.onPercentChange=n.onPercentChange.bind(n),n.onIncrement=n.onIncrement.bind(n),n.onDecrement=n.onDecrement.bind(n),n.onChange=n.onChange.bind(n),n.onInputValueChanged=n.onInputValueChanged.bind(n),n.getTopBottomInputContent=n.getTopBottomInputContent.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},d.createElement("div",{style:{display:"flex",flexDirection:"row",marginTop:"4px",flexWrap:"wrap"}},this.getTopBottomDropdown(),this.getTopBottomInputContent()))},t.prototype.getTopBottomDropdown=function(){return d.createElement("div",{style:{minWidth:this.topBottomDropdownMinWidth}},d.createElement(Tt,{selectedKey:this.getTopBottomOption(this.props.ruleInputData.getCommandType()),onChange:this.onTopBottomChange}))},t.prototype.getTopBottomInputContent=function(){return this.props.ruleInputData.isAverageRule()?d.createElement("div",null):d.createElement(d.Fragment,null,this.getTopBottomSpinButton(),this.getTopBottomPercentCheckbox())},t.prototype.getTopBottomPercentCheckbox=function(){var e={root:{marginLeft:this.inputElementsMarginLeft,marginTop:this.checkBoxMarginTop},checkbox:{borderRadius:"0%"},label:{fontSize:"12px"}};return d.createElement(Rt.a,{id:"TopBottomIsPercentCheckbox",styles:e,checked:this.props.ruleInputData.isPercentRule(),onChange:this.onPercentChange,label:ExcelRibbonStrings.ConditionalFormattingTopBottomPercent,theme:Object(P.K)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}})})},t.prototype.getTopBottomSpinButton=function(){var e=this.props.ruleInputData.isValid(),t=_(e),n=B(e,!0),o={width:this.spinButtonMinWidth,marginLeft:this.inputElementsMarginLeft},i={root:{minWidth:this.spinButtonMinWidth,height:this.spinButtonHight},input:{fontSize:"12px",minWidth:"0px"},spinButtonWrapper:{selectors:{"::after":t,":hover::after":t,":focus::after":t}},spinButtonWrapperFocused:{selectors:{":focus":n,"::after":n,":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},r=this.props.ruleInputData.getRuleInputValue().toString(),a=this.props.ruleInputData.getError();return d.createElement("div",{style:o},d.createElement(Ft,{errorMessage:a},d.createElement(Ot.b,{id:"TopBottomSpinButton",style:{minWidth:this.spinButtonMinWidth,height:this.spinButtonHight},styles:i,value:r,min:this.props.ruleInputData.getMinValue(),max:this.props.ruleInputData.getMaxValue(),onIncrement:this.onIncrement,onDecrement:this.onDecrement,onChange:this.onChange,theme:Object(P.K)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}}),inputProps:{id:de.getRequiredFirstPaneElementId()},"aria-labelledby":"ConditionalFormatting.RuleEditor.TopBottomDropdown ConditionalFormattingTopBottomRuleError",incrementButtonAriaLabel:ExcelRibbonStrings.ConditionalFormattingIncreaseSpinButton,decrementButtonAriaLabel:ExcelRibbonStrings.ConditionalFormattingDecreaseSpinButton})),d.createElement(Pt.a,{id:"ConditionalFormattingTopBottomRuleError",message:a||void 0}))},t.prototype.onChange=function(e){this.onInputValueChanged(e.target.value)},t.prototype.onInputValueChanged=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onPercentChange=function(e,t){if(null!=t){var n=this.props.ruleInputData;n.isTopRule()?this.onCommandTypeChange(t?9:8):n.isBottomRule()&&this.onCommandTypeChange(t?11:10)}},t.prototype.onTopBottomChange=function(e){var t=this.props.ruleInputData;this.onCommandTypeChange(this.getCommandType(e,t.isPercentRule()))},t.prototype.onCommandTypeChange=function(e){var t=this.props.ruleInputData,n=new lt(e,t.getRuleInputValue());n.setWasChanged(),this.props.onInputChange(n)},t.prototype.getCommandType=function(e,t){switch(e){case nt.Top:return t?9:8;case nt.Bottom:return t?11:10;case nt.AboveAverage:return 12;case nt.BelowAverage:return 13;case nt.EqualOrAboveAverage:return 75;case nt.EqualOrBelowAverage:return 76}},t.prototype.getTopBottomOption=function(e){switch(e){case 8:case 9:return nt.Top;case 10:case 11:return nt.Bottom;case 12:return nt.AboveAverage;case 13:return nt.BelowAverage;case 75:return nt.EqualOrAboveAverage;case 76:return nt.EqualOrBelowAverage;default:throw Error("getTopBottomOption: Unsupported Command Type")}},t}(d.Component),_t=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.QuickFormatDropdown",label:ExcelRibbonStrings.ConditionalFormatWithMenuPrefix,options:this.createFormatOptionsList(),onChange:this.onChange,selectedKey:this.props.selectedFormat.quickFormat})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t.prototype.createFormatOptionsList=function(){var e=[];if(Lt.forEach((function(t){e.push({key:t.key,text:t.text,data:{item:jt(t.customFormat)}})})),this.props.selectedFormat.customFormat){var t=function(e){for(var t=0;t<Lt.length;t+=1)if($e(e,Lt[t].customFormat))return t;return-1}(this.props.selectedFormat.customFormat);-1!==t?e[t].key=-1:e.unshift({key:-1,text:ExcelRibbonStrings.ConditionalFormattingCustomFormatText,data:{item:d.createElement(Ce,{rule:{ruleType:3,customFormat:this.props.selectedFormat.customFormat}})}})}return e},t}(d.Component),jt=function(e){return d.createElement(Ce,{rule:{ruleType:3,customFormat:e}})},Bt=function(e){return{isTextBold:!1,isTextItalic:!1,isTextStrikethrough:!1,isTextUnderlined:!1,isTextDoubleUnderlined:!1,backgroundColor:e.backgroundColor?e.backgroundColor:null,textColor:e.textColor?e.textColor:null,borderFormat:e.borderColor?{lineStyle:Object(p.__spreadArrays)(Array(4)).map((function(e){return 1})),color:Object(p.__spreadArrays)(Array(4)).map((function(t){return e.borderColor})),thickness:Object(p.__spreadArrays)(Array(4)).map((function(e){return 1}))}:{lineStyle:[0,0,0,0],color:["#000000","#000000","#000000","#000000"],thickness:[0,0,0,0]}}},Lt=[{key:0,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedFillRedText,customFormat:Bt({textColor:"#9C0006",backgroundColor:"#FFC7CE"})},{key:1,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatYellowFillYellowText,customFormat:Bt({textColor:"#9C5700",backgroundColor:"#FFEB9C"})},{key:2,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatGreenFillGreenText,customFormat:Bt({textColor:"#006100",backgroundColor:"#C6EFCE"})},{key:3,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedFill,customFormat:Bt({backgroundColor:"#FFC7CE"})},{key:4,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedText,customFormat:Bt({textColor:"#9C0006"})},{key:5,text:ExcelRibbonStrings.ConditionalFormattingQuickFormatRedBorder,customFormat:Bt({borderColor:"#9C0006"})}];var Mt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{marginTop:"12px"}},this.getFormatDropdown())},t.prototype.getFormatDropdown=function(){return d.createElement(_t,{selectedFormat:this.props.selectedFormat,onChange:this.props.onChange})},t}(d.Component),At=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.CellValueDropdown",options:Wt,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingOperatorDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(d.Component),Wt=[{key:1,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueGreaterThan},{key:2,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueLessThan},{key:3,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueBetween},{key:4,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueEqualTo},{key:68,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueGreaterThanOrEqualsTo},{key:69,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueLessThanOrEqualsTo},{key:70,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueNotBetween},{key:71,text:ExcelRibbonStrings.ConditionalFormattingHighlightCellValueNotEqualTo}],zt=function(e){function t(t){var n=e.call(this,t)||this;return n.onCellValueChange=n.onCellValueChange.bind(n),n.onFirstValueChange=n.onFirstValueChange.bind(n),n.onSecondValueChange=n.onSecondValueChange.bind(n),n.getCellValueInputContent=n.getCellValueInputContent.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.getCellValueDropdown(),d.createElement("div",{style:{marginTop:"4px"}},this.getCellValueInputContent()))},t.prototype.getCellValueDropdown=function(){return d.createElement(At,{selectedKey:this.props.ruleInputData.getCommandType(),onChange:this.onCellValueChange})},t.prototype.getCellValueInputContent=function(){return this.props.ruleInputData.isTwoInputValuesRuleType()?d.createElement("div",{style:{display:"flex",flexDirection:"row"}},d.createElement("div",{style:{flexGrow:1,width:"100%"}},this.getCellValueInputComponent(0,this.onFirstValueChange,ExcelRibbonStrings.ConditionalFormattingFormula1TextBox)),this.getTwoInputValuesLabel(),d.createElement("div",{style:{flexGrow:1,width:"100%"}},this.getCellValueInputComponent(1,this.onSecondValueChange,ExcelRibbonStrings.ConditionalFormattingFormula2TextBox,"SecondValueInput","CellValueTwoInputTextField"))):this.getCellValueInputComponent(0,this.onFirstValueChange,ExcelRibbonStrings.ConditionalFormattingFormulaTextBox)},t.prototype.getTwoInputValuesLabel=function(){var e={root:{height:"14px",fontSize:"12px",padding:"9px"}};return d.createElement(Pe.a,{styles:e},ExcelRibbonStrings.ConditionalFormattingHighlightCellValueBetweenAnd)},t.prototype.getCellValueInputComponent=function(e,t,n,o,i){void 0===o&&(o=de.getRequiredFirstPaneElementId()),void 0===i&&(i="CellValueTextField");var r=this.props.ruleInputData.getErrorIfNeeded()[e],a=o+"CellValueRuleError";return d.createElement("div",{"aria-labelledby":"ConditionalFormatting.RuleEditor.CellValueDropdown "+a},d.createElement(Ft,{errorMessage:r},d.createElement(he,{id:o,name:i,autoApply:!0,value:this.props.ruleInputData.getRuleInputValue()[e],styles:j(null===r),onChange:t,hasError:null!==r,ariaLabel:n})),d.createElement(Pt.a,{id:a,message:r||void 0}))},t.prototype.onFirstValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue([e,t.getRuleInputValue()[1]]),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onSecondValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue([t.getRuleInputValue()[0],e]),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onCellValueChange=function(e){var t=this.props.ruleInputData,n=new ut(e,t.getRuleInputValue()[0],t.getRuleInputValue()[1]);n.setWasChanged(),this.props.onInputChange(n)},t}(d.Component),Ht=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.DateOccurringDropdown",options:Nt,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingDateDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(d.Component),Nt=[{key:1,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateYesterday},{key:0,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateToday},{key:6,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateTomorrow},{key:2,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateLast7Days},{key:4,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateLastWeek},{key:3,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateThisWeek},{key:7,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateNextWeek},{key:5,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateLastMonth},{key:9,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateThisMonth},{key:8,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateNextMonth}],Vt=function(e){function t(t){var n=e.call(this,t)||this;return n.onDateOccurringValueChange=n.onDateOccurringValueChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Ht,{selectedKey:this.props.ruleInputData.getRuleInputValue(),onChange:this.onDateOccurringValueChange})},t.prototype.onDateOccurringValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t}(d.Component),Gt=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.HighlightCellsWithDropdown",options:Ut,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingValueDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(d.Component),Ut=[{key:et.CellValue,text:ExcelRibbonStrings.ConditionalFormattingHighlightWithCellValue},{key:et.SpecificText,text:ExcelRibbonStrings.ConditionalFormattingHighlightSpecificText},{key:et.DateOccurring,text:ExcelRibbonStrings.ConditionalFormattingHighlightDateOccurring},{key:et.DuplicateValues,text:ExcelRibbonStrings.ConditionalFormattingHighlightDuplicateValues},{key:et.UniqueValues,text:ExcelRibbonStrings.ConditionalFormattingHighlightDuplicateValuesUnique},{key:et.Blanks,text:ExcelRibbonStrings.ConditionalFormattingHighlightBlanks},{key:et.NoBlanks,text:ExcelRibbonStrings.ConditionalFormattingHighlightNoBlanks},{key:et.Errors,text:ExcelRibbonStrings.ConditionalFormattingHighlightErrors},{key:et.NoErrors,text:ExcelRibbonStrings.ConditionalFormattingHighlightNoErrors}],Kt=function(e){function t(t){var n=e.call(this,t)||this;return n.onChange=n.onChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(xt,{id:"ConditionalFormatting.RuleEditor.SpecificTextDropdown",options:qt,onChange:this.onChange,selectedKey:this.props.selectedKey,ariaLabel:ExcelRibbonStrings.ConditionalFormattingOperatorDropdownType})},t.prototype.onChange=function(e,t){t&&this.props.onChange&&this.props.onChange(t.key)},t}(d.Component),qt=[{key:5,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextContaining},{key:72,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextNotContaining},{key:73,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextBeginningWith},{key:74,text:ExcelRibbonStrings.ConditionalFormattingHighlightTextEndingWith}],Qt=function(e){function t(t){var n=e.call(this,t)||this;return n.onSpecificTextChange=n.onSpecificTextChange.bind(n),n.onTextValueChange=n.onTextValueChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.getSpecificTextDropdown(),d.createElement("div",{style:{marginTop:"4px"}},this.getTextField(this.props.ruleInputData.getRuleInputValue(),this.onTextValueChange)))},t.prototype.getSpecificTextDropdown=function(){return d.createElement(Kt,{selectedKey:this.props.ruleInputData.getCommandType(),onChange:this.onSpecificTextChange})},t.prototype.getTextField=function(e,t){var n=this.props.ruleInputData.getErrorIfNeeded();return d.createElement("div",{"aria-labelledby":"ConditionalFormatting.RuleEditor.SpecificTextDropdown ConditionalFormattingSpecificTextRuleError"},d.createElement(Ft,{errorMessage:n},d.createElement(he,{id:de.getRequiredFirstPaneElementId(),name:"SpecificTextTextField",autoApply:!0,value:e,styles:j(null===n),onChange:t,hasError:null!==n,ariaLabel:ExcelRibbonStrings.ConditionalFormattingTextBoxName})),d.createElement(Pt.a,{id:"ConditionalFormattingSpecificTextRuleError",message:n||void 0}))},t.prototype.onTextValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.onSpecificTextChange=function(e){var t=this.props.ruleInputData,n=new ct(e,t.getRuleInputValue());n.setWasChanged(),this.props.onInputChange(n)},t}(d.Component),Jt=function(e){function t(t){var n=e.call(this,t)||this;return n.getHighlightCellsWithInputContent=n.getHighlightCellsWithInputContent.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},d.createElement("div",{style:{marginTop:"4px"}},this.getHighlightCellsWithDropdown(),d.createElement("div",{style:{marginTop:"4px"}},this.getHighlightCellsWithInputContent())))},t.prototype.getHighlightCellsWithDropdown=function(){return d.createElement(Gt,{selectedKey:this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType()),onChange:this.props.onHighlightCellsWithChange})},t.prototype.getHighlightCellsWithInputContent=function(){switch(this.getHighlightCellsWithOption(this.props.ruleInputData.getCommandType())){case et.CellValue:return d.createElement(zt,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case et.SpecificText:return d.createElement(Qt,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case et.DateOccurring:return d.createElement(Vt,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case et.DuplicateValues:case et.UniqueValues:case et.Blanks:case et.NoBlanks:case et.Errors:case et.NoErrors:return d.createElement("div",null)}},t.prototype.getHighlightCellsWithOption=function(e){switch(e){case 1:case 2:case 4:case 3:case 68:case 69:case 71:case 70:return et.CellValue;case 5:case 72:case 73:case 74:return et.SpecificText;case 6:return et.DateOccurring;case 7:return!0===this.props.ruleInputData.getRuleInputValue()?et.DuplicateValues:et.UniqueValues;case 64:return et.Blanks;case 65:return et.NoBlanks;case 66:return et.Errors;case 67:return et.NoErrors;default:throw Error("getHighlightCellsWithOption: Unsupported ConditionalFormattingCommandType")}},t}(d.Component),Yt=n(522),Xt=n(325),Zt="conditionalFormatting-GalleryDropdownBlockItem-",$t=function(e){function t(t){var n=e.call(this,t)||this;return n.onInnerItemClick=n.onInnerItemClick.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e,t,n,o=Zt+this.props.commandType,i={root:{cursor:"pointer",display:"flex",border:"none",padding:"3px",outline:"none",height:"auto",width:this.props.width?this.props.width:void 0,minWidth:"auto",justifyContent:this.props.justifyContent?this.props.justifyContent:"center",backgroundColor:this.props.selectedItemId===o?"rgb(237, 235, 233)":"unset",selectors:(e={":focus::after":{outline:"none",border:"none"},":focus,:focus-within,:active":(t={},t[P.l]={background:"Highlight"},t)},e[P.l]={border:"none"},e)},flexContainer:{width:"100%"},rootHovered:(n={backgroundColor:"rgb(243, 242, 241)"},n[P.l]={background:"Highlight"},n)};return d.createElement(M.a,{content:this.props.hideTooltip?void 0:this.props.text,directionalHint:A.DirectionalHint.bottomCenter},d.createElement(Xt.a,{id:o,styles:i,onClick:this.onInnerItemClick,ariaLabel:this.props.text+(this.props.blockLabel||"")},this.props.data))},t.prototype.onInnerItemClick=function(){this.props.onItemClick(this.props.commandType)},t}(d.Component),en=n(1139),tn=function(e){function t(t){var n=e.call(this,t)||this;return n.getItemRowsGenerator=function(e,t){var n;return Object(p.__generator)(this,(function(o){switch(o.label){case 0:n=0,o.label=1;case 1:return n<e.length?[4,e.slice(n,n+t)]:[3,4];case 2:o.sent(),o.label=3;case 3:return n+=t,[3,1];case 4:return[2]}}))},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.props.itemsNumberInLine<1)throw new Error("itemsNumberInLine is less than 1");var t={content:{},root:{padding:"4px 0px 0px 0px",marginBottom:"-4px",selectors:{"::before":{backgroundColor:"#d2d0ce"}}}};return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},this.props.label?d.createElement(Pe.a,{"aria-label":this.props.label},this.props.label):d.createElement("div",null),this.getItemRows(this.props.itemsProps,this.props.itemsNumberInLine).map((function(t,n){return d.createElement("div",{key:n,style:{display:"flex",justifyContent:"space-between",flexDirection:"row",marginTop:"4px"}},t.map((function(t,o){return d.createElement($t,Object(p.__assign)({},t,{blockLabel:e.props.label,key:n+"."+o}))})))})),this.props.seperatorAfterBlock?d.createElement(en.a,{styles:t}):d.createElement("div",null))},t.prototype.getItemRows=function(e,t){var n=this.getItemRowsGenerator(e,t),o=[];if(n)for(var i=n.next();!i.done;)o.push(i.value),i=n.next();return o},t}(d.Component),nn=function(e){function t(t){var n=e.call(this,t)||this;return n.dismissCallout=function(){},n.populateMenu=function(e,t){n.dismissCallout=t;var o=e.props;return d.createElement(Yt.a,{role:"dialog",target:"."+o.buttonArea,style:{display:"flex"},styles:{root:{boxShadow:"rgba(0, 0, 0, 0.133) 0px 3.2px 7.2px 0px, rgba(0, 0, 0, 0.11) 0px 0.6px 1.8px 0px",backgroundColor:"white",width:"285px",maxHeight:"285px",overflowY:"auto"}},directionalHint:A.DirectionalHint.bottomCenter,isBeakVisible:!1,tabIndex:-1,onKeyDown:n.onKeyDown,onKeyDownCapture:n.onKeyDownCapture,setInitialFocus:!0,onFocus:n.setFocus},d.createElement("div",{onClick:t,role:"list",id:"ConditionalFormattingGalleryDropdownBlockList",style:{display:"flex",flexDirection:"column",justifyContent:"space-between",overflowX:"hidden",overflowY:"hidden",width:"270px",margin:"8px"}},n.props.itemsDropdownBlocksProps.map((function(e){return d.createElement(tn,Object(p.__assign)({},e,{key:e.id}))}))))},n.setFocus=function(e){var t;Object(z.a)(e.currentTarget,e.relatedTarget)||null===(t=document.getElementById(n.props.selectedItem.id))||void 0===t||t.focus()},n.getBlock=function(e){return n.props.itemsDropdownBlocksProps[e]},n.getItem=function(e){return n.getBlock(e.blockIndex).itemsProps[e.itemIndexInBlock]},n.onKeyDown=n.onKeyDown.bind(n),n.populateMenu=n.populateMenu.bind(n),n.onKeyDownCapture=n.onKeyDownCapture.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e={root:Object(p.__assign)(Object(p.__assign)({},L),{fontSize:"12px",fontWeight:"normal",height:"24px",border:"none",textAlign:"left",padding:"0px",paddingTop:"5px",cursor:"pointer",selectors:{":active":{outline:"none",border:"none"},":focus":{outline:"none",border:"none"},":focus::after":{outline:"none",border:"none"}}})},t={height:"28px",width:"285px",cursor:"pointer",padding:"0px",paddingRight:Object(E.a)()?"0px":"3px",paddingLeft:Object(E.a)()?"3px":"0px",selectors:{":focus::after":{outline:"none",border:"none"},"svg > path.OfficeIconColors_HighContrast":{fill:"buttonText !important"}}},n={root:t,rootHovered:[t,Object(p.__assign)(Object(p.__assign)({},F()),{background:"white"})],rootExpanded:[t,Object(p.__assign)(Object(p.__assign)({},F()),{background:"white"})],rootFocused:[t,B(!0,!0)],rootPressed:[t,Object(p.__assign)(Object(p.__assign)({},F()),{background:"white"})],menuIcon:{height:"14px",width:"12px"}},o=Object(P.db)({buttonArea:{height:"28px"}});return d.createElement("div",{style:{display:"flex",flexDirection:"column"}},d.createElement("div",{className:o.buttonArea},d.createElement(Xt.a,{role:"combobox listbox",styles:n,menuProps:{items:[{key:"ConditionalFormattingGalleryDropdownMenuItem",onRender:this.populateMenu,props:o}]},menuIconProps:{iconName:T.a.CommonControlChevronDown_12},ariaLabel:ExcelRibbonStrings.ConditionalFormattingFormatDropdownType},d.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"left",paddingLeft:"8px",height:"28px",width:"255px"}},this.props.selectedItem.preview?d.createElement("div",{style:{marginTop:"5px",marginRight:"8px"}},this.props.selectedItem.preview):d.createElement("div",null),d.createElement(Pe.a,{id:this.props.id+"-label",styles:e,tabIndex:-1,"data-is-focusable":!1},this.props.selectedItem.text)))))},t.prototype.onKeyDown=function(e){if(document.activeElement){var t=document.activeElement.id,n=void 0,o=null;switch(e.keyCode){case R.a.up:n=this.getItemIdToFocus(t,0),e.preventDefault();break;case R.a.down:n=this.getItemIdToFocus(t,1),e.preventDefault();break;case R.a.right:n=this.getItemIdToFocus(t,Object(E.a)()?3:2),e.preventDefault();break;case R.a.left:n=this.getItemIdToFocus(t,Object(E.a)()?2:3),e.preventDefault();break;case R.a.tab:n=e.shiftKey?"ConditionalFormatting.RuleEditor.RuleTypeDropdown":de.getRequiredFirstPaneElementId(),e.preventDefault()}n&&(o=document.getElementById(n))&&o.focus()}else v.a.sendTraceTag(573415824,C.a.msoulscat_ES_EWAJS,$.a.Error,"ConditionalFormattingTaskPaneReact.GalleryDropdown: couldn't find  activeElement")},t.prototype.onKeyDownCapture=function(e){e.keyCode===R.a.escape&&this.dismissCallout()},t.prototype.getItemIdToFocus=function(e,n){var o=this.getItemPosition(e,this.props.selectedItem.id);if(o)switch(n){case 1:return this.getLineDownItemId(o);case 0:return this.getLineUpItemId(o);case 3:var i=this.getItem(this.getPrevItemPosition(o));return t.getItemIdFromCommand(i.commandType);case 2:var r=this.getItem(this.getNextItemPosition(o));return t.getItemIdFromCommand(r.commandType)}return v.a.shipAssertTag(573413458,C.a.msoulscat_ES_EWAJS,!1,"currentItemId not found in the GalleryDropdown items. ID: "+e),this.props.selectedItem.id},t.prototype.getItemPosition=function(e,n){for(var o=null,i=0;i<this.props.itemsDropdownBlocksProps.length;i+=1)for(var r=this.props.itemsDropdownBlocksProps[i],a=0;a<r.itemsProps.length;a+=1){var s=r.itemsProps[a],l=t.getItemIdFromCommand(s.commandType);if(l===e)return{blockIndex:i,itemIndexInBlock:a};l===n&&(o={blockIndex:i,itemIndexInBlock:a})}return o},t.prototype.getNextItemPosition=function(e){var t=this.getBlock(e.blockIndex).itemsProps.length,n=this.props.itemsDropdownBlocksProps.length;return e.itemIndexInBlock+1>=t?{blockIndex:(e.blockIndex+1)%n,itemIndexInBlock:0}:{blockIndex:e.blockIndex,itemIndexInBlock:e.itemIndexInBlock+1}},t.prototype.getPrevItemPosition=function(e){var t=this.props.itemsDropdownBlocksProps.length,n=(t+e.blockIndex-1)%t,o=this.props.itemsDropdownBlocksProps[n].itemsProps.length;return e.itemIndexInBlock-1<0?{blockIndex:n,itemIndexInBlock:o-1}:{blockIndex:e.blockIndex,itemIndexInBlock:e.itemIndexInBlock-1}},t.getItemIdFromCommand=function(e){return Zt+e},t.prototype.getLineDownItemId=function(e){var n,o=this.props.itemsDropdownBlocksProps[e.blockIndex],i=e.itemIndexInBlock%o.itemsNumberInLine+1,r=o.itemsProps.length/o.itemsNumberInLine===Math.floor(o.itemsProps.length/o.itemsNumberInLine),a=Math.floor(o.itemsProps.length/o.itemsNumberInLine);if(a=r?a-1:a,Math.floor(e.itemIndexInBlock/o.itemsNumberInLine)!==a)n=e.itemIndexInBlock+o.itemsNumberInLine<=o.itemsProps.length-1?t.getItemIdFromCommand(o.itemsProps[e.itemIndexInBlock+o.itemsNumberInLine].commandType):t.getItemIdFromCommand(o.itemsProps[o.itemsProps.length-1].commandType);else{var s=e.blockIndex===this.props.itemsDropdownBlocksProps.length-1?0:e.blockIndex+1,l=this.props.itemsDropdownBlocksProps[s];n=i<=l.itemsProps.length?t.getItemIdFromCommand(l.itemsProps[i-1].commandType):t.getItemIdFromCommand(l.itemsProps[l.itemsProps.length-1].commandType)}return n},t.prototype.getLineUpItemId=function(e){var n,o=this.props.itemsDropdownBlocksProps[e.blockIndex],i=e.itemIndexInBlock%o.itemsNumberInLine+1;if(e.itemIndexInBlock-o.itemsNumberInLine>=0)n=t.getItemIdFromCommand(o.itemsProps[e.itemIndexInBlock-o.itemsNumberInLine].commandType);else{var r=0===e.blockIndex?this.props.itemsDropdownBlocksProps.length-1:e.blockIndex-1,a=this.props.itemsDropdownBlocksProps[r],s=a.itemsProps.length/a.itemsNumberInLine===Math.floor(a.itemsProps.length/a.itemsNumberInLine),l=Math.floor(a.itemsProps.length/a.itemsNumberInLine);n=(l=s?l-1:l)*a.itemsNumberInLine+i<a.itemsProps.length?t.getItemIdFromCommand(a.itemsProps[l*a.itemsNumberInLine+i-1].commandType):t.getItemIdFromCommand(a.itemsProps[a.itemsProps.length-1].commandType)}return n},t}(d.Component),on=function(e){function t(t){var n=e.call(this,t)||this;return n.onDataBarValueChange=n.onDataBarValueChange.bind(n),n.selectedItem={id:Zt+n.props.ruleInputData.getCommandType(),text:""},n.dataBarQuickFormatCommand=0,n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.ruleInputData.getCommandType();return 0===e&&(this.dataBarQuickFormatCommand=function(e){for(var t=0;t<sn.length;t+=1)if(ln(e,sn[t].customFormat))return sn[t].key;return null}(this.props.ruleInputData.getRuleInputValue())||this.dataBarQuickFormatCommand),this.selectedItem.id=Zt+this.props.ruleInputData.getCommandType(),this.selectedItem.text=rn.get(e||this.dataBarQuickFormatCommand),this.selectedItem.preview=this.getDataBarFormatPreviewElement(e?function(e){for(var t=0;t<sn.length;t+=1)if(e===sn[t].key)return sn[t].customFormat;return null}(e):this.props.ruleInputData.getRuleInputValue()),d.createElement("div",{style:{marginTop:"4px"}},d.createElement(nn,{id:"ConditionalFormattingDataBarDropdown",itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))},t.prototype.onDataBarValueChange=function(e){var t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.createItemsDropdownBlockPropsList=function(){var e=[this.getIconItemProps(15,T.a.DataBarBlueGradient_32),this.getIconItemProps(16,T.a.DataBarGreenGradient_32),this.getIconItemProps(17,T.a.DataBarRedGradient_32),this.getIconItemProps(18,T.a.DataBarOrangeGradient_32),this.getIconItemProps(19,T.a.DataBarLightBlueGradient_32),this.getIconItemProps(20,T.a.DataBarPurpleGradient_32)],t={id:"ConditionalFormattingGradientDataBarBlock",label:ExcelRibbonStrings.GradientFill,itemsProps:e,itemsNumberInLine:3},n=[this.getIconItemProps(21,T.a.DataBarBlueSolid_32),this.getIconItemProps(22,T.a.DataBarGreenSolid_32),this.getIconItemProps(23,T.a.DataBarRedSolid_32),this.getIconItemProps(24,T.a.DataBarOrangeSolid_32),this.getIconItemProps(25,T.a.DataBarLightBlueSolid_32),this.getIconItemProps(26,T.a.DataBarPurpleSolid_32)],o=[t,{id:"ConditionalFormattingSolidDataBarBlock",label:ExcelRibbonStrings.SolidFill,itemsProps:n,itemsNumberInLine:3}];if(null!==this.props.ruleInputData.getRuleInputValue()&&0===this.dataBarQuickFormatCommand){var i=this.getItemProps(0,this.getDataBarFormatPreview(),!0);i.justifyContent="left",i.width="100%";var r={id:"ConditionalFormattingPreviewDataBarBlock",itemsProps:[i],itemsNumberInLine:1,seperatorAfterBlock:!0};o.unshift(r)}return o},t.prototype.getIconItemProps=function(e,t){return this.getItemProps(e,this.getItemIconContent(t))},t.prototype.getItemProps=function(e,t,n){void 0===n&&(n=!1);var o=e;return 0!==this.dataBarQuickFormatCommand&&this.dataBarQuickFormatCommand===e&&(o=0),{commandType:o,text:rn.get(e),data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onDataBarValueChange,hideTooltip:n}},t.prototype.getItemIconContent=function(e){return d.createElement(I.a,{iconName:e,style:{height:"50px",width:"50px"}})},t.prototype.getDataBarFormatPreview=function(){var e=Object(p.__assign)({fontSize:"12px",marginRight:Object(E.a)()?"10px":void 0,marginLeft:Object(E.a)()?void 0:"10px"},L);if(null!=this.props.ruleInputData.getRuleInputValue())return d.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},d.createElement("div",null,this.getDataBarFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),d.createElement("span",{style:e},ExcelRibbonStrings.ConditionalFormattingCustomFormatText));throw new Error("Data bar input value is null")},t.prototype.getDataBarFormatPreviewElement=function(e){return null!=e?d.createElement(Ce,{rule:{ruleType:1,dataBarFormat:e}}):d.createElement("div",null)},t}(d.Component),rn=new Map;rn.set(0,ExcelRibbonStrings.ConditionalFormattingCustomFormatText),rn.set(15,ExcelRibbonStrings.ConditionalFormattingDataBarsBlueDataBar),rn.set(16,ExcelRibbonStrings.ConditionalFormattingDataBarsGreenDataBar),rn.set(17,ExcelRibbonStrings.ConditionalFormattingDataBarsRedDataBar),rn.set(18,ExcelRibbonStrings.ConditionalFormattingDataBarsOrangeDataBar),rn.set(19,ExcelRibbonStrings.ConditionalFormattingDataBarsLightBlueDataBar),rn.set(20,ExcelRibbonStrings.ConditionalFormattingDataBarsPurpleDataBar),rn.set(21,ExcelRibbonStrings.ConditionalFormattingDataBarsBlueDataBar),rn.set(22,ExcelRibbonStrings.ConditionalFormattingDataBarsGreenDataBar),rn.set(23,ExcelRibbonStrings.ConditionalFormattingDataBarsRedDataBar),rn.set(24,ExcelRibbonStrings.ConditionalFormattingDataBarsOrangeDataBar),rn.set(25,ExcelRibbonStrings.ConditionalFormattingDataBarsLightBlueDataBar),rn.set(26,ExcelRibbonStrings.ConditionalFormattingDataBarsPurpleDataBar);var an=function(e){return{isGradientFill:e.isGradientFill,borderColor:e.borderColor,fillColor:e.fillColor,isLTRDirection:!0}},sn=[{key:15,customFormat:an({isGradientFill:!0,borderColor:"#638EC6",fillColor:"#638EC6"})},{key:16,customFormat:an({isGradientFill:!0,borderColor:"#63C384",fillColor:"#63C384"})},{key:17,customFormat:an({isGradientFill:!0,borderColor:"#FF555A",fillColor:"#FF555A"})},{key:18,customFormat:an({isGradientFill:!0,borderColor:"#FFB628",fillColor:"#FFB628"})},{key:19,customFormat:an({isGradientFill:!0,borderColor:"#008AEF",fillColor:"#008AEF"})},{key:20,customFormat:an({isGradientFill:!0,borderColor:"#D6007B",fillColor:"#D6007B"})},{key:21,customFormat:an({isGradientFill:!1,borderColor:null,fillColor:"#638EC6"})},{key:22,customFormat:an({isGradientFill:!1,borderColor:null,fillColor:"#63C384"})},{key:23,customFormat:an({isGradientFill:!1,borderColor:null,fillColor:"#FF555A"})},{key:24,customFormat:an({isGradientFill:!1,borderColor:null,fillColor:"#FFB628"})},{key:25,customFormat:an({isGradientFill:!1,borderColor:null,fillColor:"#008AEF"})},{key:26,customFormat:an({isGradientFill:!1,borderColor:null,fillColor:"#D6007B"})}];function ln(e,t){return!(!e||!t)&&(e.isGradientFill===t.isGradientFill&&e.borderColor===t.borderColor&&e.fillColor===t.fillColor)}var cn=function(e){function t(t){var n=e.call(this,t)||this;return n.onColorScaleValueChange=n.onColorScaleValueChange.bind(n),n.selectedItem={id:Zt+n.props.ruleInputData.getCommandType(),text:""},n.colorScaleQuickFormatCommand=0,n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.ruleInputData.getCommandType();return 0===e&&(this.colorScaleQuickFormatCommand=function(e){for(var t=0;t<dn.length;t+=1)if(hn(e,dn[t].customFormat))return dn[t].key;return null}(this.props.ruleInputData.getRuleInputValue())||this.colorScaleQuickFormatCommand),this.selectedItem.id=Zt+this.props.ruleInputData.getCommandType(),this.selectedItem.text=un.get(e||this.colorScaleQuickFormatCommand),this.selectedItem.preview=this.getColorScaleFormatPreviewElement(e?function(e){for(var t=0;t<dn.length;t+=1)if(e===dn[t].key)return dn[t].customFormat;return null}(e):this.props.ruleInputData.getRuleInputValue()),d.createElement("div",{style:{marginTop:"4px"}},d.createElement(nn,{id:"ConditionalFormattingColorScaleDropdown",itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))},t.prototype.onColorScaleValueChange=function(e){var t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.createItemsDropdownBlockPropsList=function(){var e=[{id:"ConditionalFormattingColorScaleBlock",itemsProps:[this.getIconItemProps(28,T.a.ColorScaleGYR_32),this.getIconItemProps(27,T.a.ColorScaleRYG_32),this.getIconItemProps(29,T.a.ColorScaleGWR_32),this.getIconItemProps(30,T.a.ColorScaleRWG_32),this.getIconItemProps(31,T.a.ColorScaleBWR_32),this.getIconItemProps(32,T.a.ColorScaleRWB_32),this.getIconItemProps(35,T.a.ColorScaleWR_32),this.getIconItemProps(36,T.a.ColorScaleRW_32),this.getIconItemProps(38,T.a.ColorScaleGW_32),this.getIconItemProps(37,T.a.ColorScaleWG_32),this.getIconItemProps(33,T.a.ColorScaleGY_32),this.getIconItemProps(34,T.a.ColorScaleYG_32)],itemsNumberInLine:4}];if(null!=this.props.ruleInputData.getRuleInputValue()&&0===this.colorScaleQuickFormatCommand){var t=this.getItemProps(0,this.getColorScaleFormatPreview(),!0);t.justifyContent="left",t.width="100%";var n={id:"ConditionalFormattingPreviewColorScaleBlock",itemsProps:[t],itemsNumberInLine:1,seperatorAfterBlock:!0};e.unshift(n)}return e},t.prototype.getIconItemProps=function(e,t){return this.getItemProps(e,this.getItemIconContent(t))},t.prototype.getItemProps=function(e,t,n){void 0===n&&(n=!1);var o=e;return 0!==this.colorScaleQuickFormatCommand&&this.colorScaleQuickFormatCommand===e&&(o=0),{commandType:o,text:un.get(e),data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onColorScaleValueChange,hideTooltip:n}},t.prototype.getItemIconContent=function(e){return d.createElement(I.a,{iconName:e,style:{height:"50px",width:"50px"}})},t.prototype.getColorScaleFormatPreview=function(){var e=Object(p.__assign)({fontSize:"12px",marginRight:Object(E.a)()?"10px":void 0,marginLeft:Object(E.a)()?void 0:"10px"},L);if(null!=this.props.ruleInputData.getRuleInputValue())return d.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},d.createElement("div",null,this.getColorScaleFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),d.createElement("span",{style:e},ExcelRibbonStrings.ConditionalFormattingCustomFormatText));throw new Error("Color scale input value is null")},t.prototype.getColorScaleFormatPreviewElement=function(e){return null!=e?d.createElement(Ce,{rule:{ruleType:0,colorScaleFormat:e}}):d.createElement("div",null)},t}(d.Component),un=new Map;un.set(0,ExcelRibbonStrings.ConditionalFormattingCustomFormatText),un.set(27,ExcelRibbonStrings.ConditionalFormattingColorScalesRYG),un.set(28,ExcelRibbonStrings.ConditionalFormattingColorScalesGYR),un.set(29,ExcelRibbonStrings.ConditionalFormattingColorScalesGWR),un.set(30,ExcelRibbonStrings.ConditionalFormattingColorScalesRWG),un.set(31,ExcelRibbonStrings.ConditionalFormattingColorScalesBWR),un.set(32,ExcelRibbonStrings.ConditionalFormattingColorScalesRWB),un.set(33,ExcelRibbonStrings.ConditionalFormattingColorScalesGY),un.set(34,ExcelRibbonStrings.ConditionalFormattingColorScalesYG),un.set(35,ExcelRibbonStrings.ConditionalFormattingColorScalesWR),un.set(36,ExcelRibbonStrings.ConditionalFormattingColorScalesRW),un.set(37,ExcelRibbonStrings.ConditionalFormattingColorScalesWG),un.set(38,ExcelRibbonStrings.ConditionalFormattingColorScalesGW);var pn=function(e){return{maximumColor:e.maximumColor,midpointColor:e.midpointColor,minimumColor:e.minimumColor}},dn=[{key:27,customFormat:pn({maximumColor:"#F8696B",midpointColor:"#FFEB84",minimumColor:"#63BE7B"})},{key:28,customFormat:pn({maximumColor:"#63BE7B",midpointColor:"#FFEB84",minimumColor:"#F8696B"})},{key:29,customFormat:pn({maximumColor:"#63BE7B",midpointColor:"#FCFCFF",minimumColor:"#F8696B"})},{key:30,customFormat:pn({maximumColor:"#F8696B",midpointColor:"#FCFCFF",minimumColor:"#63BE7B"})},{key:31,customFormat:pn({maximumColor:"#5A8AC6",midpointColor:"#FCFCFF",minimumColor:"#F8696B"})},{key:32,customFormat:pn({maximumColor:"#F8696B",midpointColor:"#FCFCFF",minimumColor:"#5A8AC6"})},{key:33,customFormat:pn({maximumColor:"#63BE7B",midpointColor:null,minimumColor:"#FFEF9C"})},{key:34,customFormat:pn({maximumColor:"#FFEF9C",midpointColor:null,minimumColor:"#63BE7B"})},{key:35,customFormat:pn({maximumColor:"#FCFCFF",midpointColor:null,minimumColor:"#F8696B"})},{key:36,customFormat:pn({maximumColor:"#F8696B",midpointColor:null,minimumColor:"#FCFCFF"})},{key:37,customFormat:pn({maximumColor:"#FCFCFF",midpointColor:null,minimumColor:"#63BE7B"})},{key:38,customFormat:pn({maximumColor:"#63BE7B",midpointColor:null,minimumColor:"#FCFCFF"})}];function hn(e,t){return!(!e||!t)&&(e.maximumColor===t.maximumColor&&e.midpointColor===t.midpointColor&&e.minimumColor===t.minimumColor)}var gn=function(e){function t(t){var n=e.call(this,t)||this;return n.onIconSetValueChange=n.onIconSetValueChange.bind(n),n.selectedItem={id:Zt+n.props.ruleInputData.getCommandType(),text:""},n.iconSetQuickFormatCommand=0,n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e,t,n=this.props.ruleInputData.getCommandType();0===n&&(this.iconSetQuickFormatCommand=(e=this.props.ruleInputData.getRuleInputValue(),t=null,be.b.forEach((function(n){(function(e,t){if(e&&t&&void 0!==e.icons&&null!==e.icons){if(e.icons.length!==t.icons.length)return!1;for(var n=0;n<t.icons.length;n+=1)if(e.icons[n].iconSet!==t.icons[n].iconSet||e.icons[n].index!==t.icons[n].index)return!1;return!0}return!1})(e,mn(n.iconFormats))&&(t=n.command)})),t||this.iconSetQuickFormatCommand));var o=bn(n||this.iconSetQuickFormatCommand);return this.selectedItem.id=Zt+this.props.ruleInputData.getCommandType(),this.selectedItem.text=o.text,this.selectedItem.preview=this.getIconSetFormatPreviewElement(n?mn(o.iconFormats):this.props.ruleInputData.getRuleInputValue()),d.createElement("div",{style:{marginTop:"4px"}},d.createElement(nn,{id:"ConditionalFormattingIconSetDropdown",itemsDropdownBlocksProps:this.createItemsDropdownBlockPropsList(),selectedItem:this.selectedItem}))},t.prototype.onIconSetValueChange=function(e){var t=this.props.ruleInputData;t.setCommandType(e),t.setWasChanged(),this.props.onInputChange(t)},t.prototype.createItemsDropdownBlockPropsList=function(){var e=[this.getIconItemProps(39),this.getIconItemProps(40),this.getIconItemProps(57),this.getIconItemProps(48),this.getIconItemProps(47),this.getIconItemProps(53),this.getIconItemProps(52)],t={id:"ConditionalFormattingDirectionalIconSetBlock",label:ExcelRibbonStrings.IconSetsDirectional,itemsProps:e,itemsNumberInLine:2},n=[this.getIconItemProps(42),this.getIconItemProps(43),this.getIconItemProps(44),this.getIconItemProps(51),this.getIconItemProps(49)],o={id:"ConditionalFormattingShapesIconSetBlock",label:ExcelRibbonStrings.IconSetsShapes,itemsProps:n,itemsNumberInLine:2},i=[this.getIconItemProps(45),this.getIconItemProps(46),this.getIconItemProps(41)],r={id:"ConditionalFormattingIndicatorsIconSetBlock",label:ExcelRibbonStrings.IconSetsIndicators,itemsProps:i,itemsNumberInLine:2},a=[this.getIconItemProps(56),this.getIconItemProps(50),this.getIconItemProps(55),this.getIconItemProps(54),this.getIconItemProps(58)],s=[t,o,r,{id:"ConditionalFormattingRatingsIconSetBlock",label:ExcelRibbonStrings.IconSetsRatings,itemsProps:a,itemsNumberInLine:2}];if(null!=this.props.ruleInputData.getRuleInputValue()&&0===this.iconSetQuickFormatCommand){var l=this.getItemProps(0,this.getIconSetFormatPreview(),!0);l.justifyContent="left",l.width="100%";var c={id:"ConditionalFormattingPreviewIconSetBlock",itemsProps:[l],itemsNumberInLine:1,seperatorAfterBlock:!0};s.unshift(c)}return s},t.prototype.getIconItemProps=function(e){return this.getItemProps(e,this.getItemContent(e))},t.prototype.getItemProps=function(e,t,n){void 0===n&&(n=!1);var o=e;return 0!==this.iconSetQuickFormatCommand&&this.iconSetQuickFormatCommand===e&&(o=0),{commandType:o,text:bn(e).text,data:t,selectedItemId:this.selectedItem.id,onItemClick:this.onIconSetValueChange,hideTooltip:n}},t.prototype.getItemContent=function(e){var t=[];return bn(e).icons.forEach((function(e){t.push(e)})),t.reverse(),d.createElement("div",{style:{display:"flex",border:"none",flexBasis:"100%",direction:"ltr",height:"20px",width:"110px"}},t.map((function(e){return d.createElement(I.a,{iconName:e,style:{height:"20px",width:"20px",marginLeft:"1px",marginRight:"1px"}})})))},t.prototype.getIconSetFormatPreview=function(){var e=Object(p.__assign)({fontSize:"12px",marginRight:Object(E.a)()?"10px":void 0,marginLeft:Object(E.a)()?void 0:"10px"},L);if(null!=this.props.ruleInputData.getRuleInputValue())return d.createElement("div",{style:{display:"flex",padding:"0px",width:"100%",justifyContent:"left"}},d.createElement("div",null,this.getIconSetFormatPreviewElement(this.props.ruleInputData.getRuleInputValue())),d.createElement("span",{style:e},ExcelRibbonStrings.ConditionalFormattingCustomFormatText));throw new Error("Icon set input value is null")},t.prototype.getIconSetFormatPreviewElement=function(e){return null!=e?d.createElement("div",{style:{display:"flex",maxWidth:"100px",padding:"0px"}},d.createElement(Ce,{rule:{ruleType:2,iconSetFormat:e}})):d.createElement("div",null)},t}(d.Component),mn=function(e){return{icons:e,isReverseIconsOrder:!1}};function bn(e){var t=null;return be.b.forEach((function(n){e===n.command&&(t=n)})),t}var fn=function(e){function t(t){var n=e.call(this,t)||this;return n.onFormulaValueChange=n.onFormulaValueChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.ruleInputData.getErrorIfNeeded();return d.createElement(d.Fragment,null,d.createElement(Pe.a,{id:"ConditionalFormattingFormulaRuleLabel",style:{fontSize:"12px"}},ExcelRibbonStrings.ConditionalFormattingFormatFormulaTrue),d.createElement("div",{"aria-labelledby":"ConditionalFormattingFormulaRuleLabel ConditionalFormattingFormulaRuleError"},d.createElement(Ft,{errorMessage:e},d.createElement(he,{id:de.getRequiredFirstPaneElementId(),name:"FormulaRuleTextField",autoApply:!0,value:this.props.ruleInputData.getRuleInputValue(),styles:j(null===e),onChange:this.onFormulaValueChange,hasError:null!==e,ariaLabel:ExcelRibbonStrings.ConditionalFormattingFormulaTextBox})),d.createElement(Pt.a,{id:"ConditionalFormattingFormulaRuleError",message:e||void 0})))},t.prototype.onFormulaValueChange=function(e){var t=this.props.ruleInputData;t.setRuleInputValue(e),t.setWasChanged(),this.props.onInputChange(t)},t}(d.Component),yn=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{marginTop:"12px",marginLeft:"2px"}},d.createElement(Et,{selectedKey:this.props.ruleInputData.getInputType(),onChange:this.props.onRuleTypeChange}),this.getInputContent(),this.getFormatContent())},t.prototype.getInputContent=function(){switch(this.props.ruleInputData.getInputType()){case tt.TopBottom:return d.createElement("div",{style:{marginTop:"4px"}},d.createElement(Dt,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange}));case tt.HighlightCellsWith:return d.createElement(Jt,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange,onHighlightCellsWithChange:this.props.onHighlightCellsWithChange});case tt.DataBars:return d.createElement(on,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case tt.ColorScales:return d.createElement(cn,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case tt.IconSets:return d.createElement(gn,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange});case tt.Formula:return d.createElement(fn,{ruleInputData:this.props.ruleInputData,onInputChange:this.props.onInputChange})}return d.createElement("div",null)},t.prototype.getFormatContent=function(){return this.props.ruleInputData.doesSupportStopIfTrueOrFormatInput()?d.createElement(Mt,{selectedFormat:this.props.ruleFormat,onChange:this.props.onFormatChange}):d.createElement("div",null)},t}(d.Component),vn=n(286),Cn=n(1016),xn=n(1762),Sn=function(e){function t(t){var n=e.call(this,t)||this;return n.beforeYouGoCloseButtonId="ConditionalFormattingBeforeYouGoDialogCloseButton",n.beforeYouGoApplyButtonId="ConditionalFormattingBeforeYouGoDialogApplyButton",n.beforeYouGoDiscardButtonId="ConditionalFormattingBeforeYouGoDialogDiscardButton",n.onKeyDownCloseButtonBeforeYouGo=n.onKeyDownCloseButtonBeforeYouGo.bind(n),n.onKeyDownDiscardButtonBeforeYouGo=n.onKeyDownDiscardButtonBeforeYouGo.bind(n),n.onKeyDownApplyButtonBeforeYouGo=n.onKeyDownApplyButtonBeforeYouGo.bind(n),n}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){var e;null===(e=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===e||e.focus()},t.prototype.render=function(){return d.createElement(Yt.a,{role:"dialog",onDismiss:this.props.rejectViewChange,directionalHint:A.DirectionalHint.topCenter,coverTarget:!0,target:this.props.beforeYouGoRef.current,isBeakVisible:!1,shouldRestoreFocus:!1,styles:{root:{boxShadow:"rgba(0, 0, 0, 0.22) 0px 25.6px 57.6px 0px, rgba(0, 0, 0, 0.18) 0px 4.8px 14.4px 0px",backgroundColor:"white",overflow:"hidden"}}},d.createElement("div",{style:{height:"150px",width:"270px",display:"flex",flexDirection:"column",justifyContent:"space-between",overflowY:"hidden",overflowX:"hidden"}},d.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"space-between"}},d.createElement(Cn.a,{styles:{root:{fontSize:"22px",color:"#217346",margin:"20px",marginBottom:"15px"}}},ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogTitle),d.createElement(M.a,{content:ExcelRibbonStrings.Close,directionalHint:A.DirectionalHint.leftTopEdge},d.createElement(xn.a,{type:"AppIconButtonProps",iconProps:Object(vn.a)(r.a.CancelGlyph_16),onClick:this.props.rejectViewChange,id:this.beforeYouGoCloseButtonId,"aria-label":ExcelRibbonStrings.Close,onKeyDown:this.onKeyDownCloseButtonBeforeYouGo}))),d.createElement("div",null,d.createElement(Cn.a,{styles:{root:{fontSize:"14px",color:"rgb(133, 133, 133)",marginLeft:"20px"}}},ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogMessage)),d.createElement("div",{style:{display:"flex",alignSelf:"flex-end",margin:"15px"}},d.createElement(Xt.a,{id:this.beforeYouGoApplyButtonId,styles:this.props.primaryButtonStyle,onClick:this.props.applyChangesAndConfirmViewChange,text:ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogApplyChanges,onKeyDown:this.onKeyDownApplyButtonBeforeYouGo,autoFocus:!0}),d.createElement(Xt.a,{id:this.beforeYouGoDiscardButtonId,styles:{root:this.props.buttonStyle},style:{marginLeft:"10px"},onClick:this.props.resetChangesAndConfirmViewChange,text:ExcelRibbonStrings.ConditionalFormattingBeforeYouGoDialogDiscardChanges,onKeyDown:this.onKeyDownDiscardButtonBeforeYouGo}))))},t.prototype.onKeyDownDiscardButtonBeforeYouGo=function(e){var t,n;"Tab"===e.key?(e.shiftKey?null===(t=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===t||t.focus():null===(n=document.getElementById(this.beforeYouGoCloseButtonId))||void 0===n||n.focus(),e.preventDefault()):"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.resetChangesAndConfirmViewChange())},t.prototype.onKeyDownCloseButtonBeforeYouGo=function(e){var t,n;"Tab"===e.key?(e.shiftKey?null===(t=document.getElementById(this.beforeYouGoDiscardButtonId))||void 0===t||t.focus():null===(n=document.getElementById(this.beforeYouGoApplyButtonId))||void 0===n||n.focus(),e.preventDefault()):"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.rejectViewChange())},t.prototype.onKeyDownApplyButtonBeforeYouGo=function(e){"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this.props.applyChangesAndConfirmViewChange())},t}(d.Component),En=function(e){function t(n){var o,i=e.call(this,n)||this;return i.rangeErrorMessageId="CondFmtRangeErrorMessage",i.beforeYouGoRef=d.createRef(),i.buttonStyle={fontSize:"12px",height:"28px"},i.primaryButtonStyle={root:Object(p.__assign)(Object(p.__assign)({},i.buttonStyle),(o={backgroundColor:"#217346",color:"white"},o[":focus:after"]={outlineColor:"white !important"},o)),rootHovered:{backgroundColor:"#0e5c2f",color:"white"}},i.state={ruleData:Xe(t.RuleInputFactory,n.rule),ownUpdate:!0},i.applyChanges=i.applyChanges.bind(i),i.applyChangesAndConfirmViewChange=i.applyChangesAndConfirmViewChange.bind(i),i.resetChangesAndConfirmViewChange=i.resetChangesAndConfirmViewChange.bind(i),i.applyChangesAndMoveToManagerView=i.applyChangesAndMoveToManagerView.bind(i),i.resetChangesAndMoveToManagerView=i.resetChangesAndMoveToManagerView.bind(i),i.getBeforeYouGoDialog=i.getBeforeYouGoDialog.bind(i),i.rejectViewChange=i.rejectViewChange.bind(i),i.onTypeChange=i.onTypeChange.bind(i),i.onHighlightCellsWithChange=i.onHighlightCellsWithChange.bind(i),i.onInputChange=i.onInputChange.bind(i),i.setRuleInputOnState=i.setRuleInputOnState.bind(i),i.onFormatChange=i.onFormatChange.bind(i),i.onApplyRangeChanges=i.onApplyRangeChanges.bind(i),i.onStopIfTrueChange=i.onStopIfTrueChange.bind(i),i}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,n){return n.ownUpdate||!e.rule||e.showConfirmation?{ruleData:n.ruleData,ownUpdate:!1}:{ruleData:Xe(t.RuleInputFactory,e.rule),ownUpdate:!1}},t.prototype.componentDidMount=function(){de.setFocusOnPaneFirstElement()},t.prototype.render=function(){return d.createElement("div",{id:"ConditionalFormattingTaskPaneRuleEditorId",style:Object(p.__assign)({position:"absolute",height:"100%"},{marginLeft:"17px",marginRight:"17px",right:"0px",left:"0px"})},d.createElement(Re,{scrollMinWidth:"304px"},d.createElement("div",{style:{position:"absolute",height:"100%",display:"flex",flexDirection:"column",justifyContent:"space-between",marginRight:Object(E.a)()?"0px":"17px",marginLeft:Object(E.a)()?"17px":"0px",right:"0px",left:"0px"}},d.createElement("div",null,d.createElement(He.a,{styles:{root:{padding:"2px",color:"#217346",selectors:{":hover":{color:"#0e5c2f"},":focus":Object(p.__assign)(Object(p.__assign)({},B()),{color:"#217346",boxShadow:"none !important",borderRadius:"0px"}),":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},onClick:this.resetChangesAndMoveToManagerView},ExcelRibbonStrings.ConditionalFormattingGoToManageRules),this.getRuleRangeContent(),this.getStopIfTrueCheckbox(),d.createElement("div",{ref:this.beforeYouGoRef},this.getRuleInputContent()),this.getBeforeYouGoDialog()),d.createElement("div",{id:"ConditionalFormattingRuleEditorFooter",style:{alignSelf:"flex-end",marginBottom:"15px",marginTop:"15px"}},d.createElement(Xt.a,{id:this.state.ruleData.canFocusOnRuleInput()?"ConditionalFormattingRuleEditorDoneButton":de.getRequiredFirstPaneElementId(),styles:this.primaryButtonStyle,style:{marginLeft:"8px",marginRight:"8px"},onClick:this.applyChangesAndMoveToManagerView,text:ExcelRibbonStrings.ConditionalFormattingRuleEditWindowDone,disabled:this.shouldDisableDoneButton()}),d.createElement(Xt.a,{styles:{root:this.buttonStyle},onClick:this.resetChangesAndMoveToManagerView,text:ExcelRibbonStrings.ConditionalFormattingRuleEditWindowCancel})))))},t.prototype.componentDidCatch=function(e,t){v.a.sendTraceTag(579736727,C.a.msoulscat_ES_EWAJS,$.a.Error,"ConditionalFormattingTaskPaneReact.RuleEditor: RuleEditor component failed to render: "+e.toString()+" , "+t.componentStack)},t.prototype.getRuleRangeContent=function(){var e={root:{height:"14px",fontSize:"12px",padding:"0px"}},t=this.state.ruleData.getRange().getErrorMessage(this.state.ruleData.isNewRule());return d.createElement("div",{style:{marginTop:"12px"}},d.createElement(Pe.a,{styles:e},ExcelRibbonStrings.ConditionalFormattingApplyToRange),d.createElement("div",{style:{marginTop:"4px"},"aria-label":ExcelRibbonStrings.ConditionalFormattingApplyToRange+(t||"")},d.createElement("div",{id:this.rangeErrorMessageId}),d.createElement(Ft,{errorMessage:t},d.createElement(he,{id:"ConditionalFormattingRuleRangeTextField",supportOnlyRanges:!0,useAbsoluteRef:!1,blockSwitchingSheets:!this.state.ruleData.isNewRule(),value:this.state.ruleData.getRange().rangeString,sheetName:this.state.ruleData.getRange().sheetName,onApplyChanges:this.onApplyRangeChanges,styles:{root:Object(p.__assign)({},_(null===t))},hasError:null!==t}))))},t.prototype.getStopIfTrueCheckbox=function(){var e,t=this.state.ruleData.getRuleInputData();if(t&&!t.doesSupportStopIfTrueOrFormatInput())return d.createElement("div",{style:{height:"20px"}});var n={root:{height:"16px",width:"16px",padding:"3px",selectors:{":hover":{cursor:"help"},":focus":B(),":active":{outline:"none",border:"none"},":focus:after":{outline:"none",border:"none"}}}},o={checkbox:{borderRadius:"0%",height:"16px",width:"16px",marginTop:"1px",marginLeft:"1px"},label:{fontSize:"12px"},root:[(e={},e[P.l]={":focus,:focus-within,:active,:focus:after":B()},e)]};return d.createElement("div",{style:{marginTop:"4px",display:"flex",flexDirection:"row",marginLeft:"3px"}},d.createElement(Rt.a,{id:"ConditionalFormattingRuleStopIfTrueCheckbox",styles:o,checked:this.state.ruleData.getStopIfTrue(),onChange:this.onStopIfTrueChange,label:ExcelRibbonStrings.ConditionalFormattingStopIfTrue,theme:Object(P.K)({semanticColors:{inputBorderHovered:"#217346",inputBackgroundChecked:"#217346"},palette:{themeDark:"#217346"}})}),d.createElement(M.a,{content:ExcelRibbonStrings.ConditionalFormattingStopIfTrueTooltipContent,styles:{root:{width:"16px",height:"16px",marginLeft:"3px"}}},d.createElement(I.a,Object(p.__assign)({role:"tooltip"},Object(vn.a)(T.a.Info_20),{styles:n,"aria-label":ExcelRibbonStrings.ConditionalFormattingStopIfTrueTooltipContent,tabIndex:0}))))},t.prototype.getRuleInputContent=function(){var e=this.state.ruleData.getRuleInputData();return e?d.createElement(yn,{ruleInputData:e,ruleFormat:this.state.ruleData.getRuleFormat(),onRuleTypeChange:this.onTypeChange,onHighlightCellsWithChange:this.onHighlightCellsWithChange,onInputChange:this.onInputChange,onFormatChange:this.onFormatChange}):d.createElement("div",null)},t.prototype.isRuleRangeValid=function(){return this.state.ruleData.getRange().isValid(this.state.ruleData.isNewRule())},t.prototype.isRuleDataValid=function(){var e=!0,t=this.state.ruleData.getRuleInputData();return t&&(e=e&&t.isValid()),e=e&&this.isRuleRangeValid()},t.prototype.wasRuleInputChanged=function(){var e=this.state.ruleData.getRuleInputData();return!!e&&e.wasChanged()},t.prototype.shouldDisableDoneButton=function(){var e,t=this.isRuleRangeValid(),n=!(null===(e=this.state.ruleData.getRuleInputData())||void 0===e?void 0:e.shouldShowError());return!t||!n},t.prototype.applyChangesAndConfirmViewChange=function(){var e=this;this.applyChanges()?setTimeout((function(){e.props.onConfirmationResponse(!0)}),100):this.rejectViewChange()},t.prototype.resetChangesAndConfirmViewChange=function(){this.props.onConfirmationResponse(!0)},t.prototype.rejectViewChange=function(){this.props.onConfirmationResponse(!1)},t.prototype.applyChangesAndMoveToManagerView=function(){var e=this;this.applyChanges()&&setTimeout((function(){e.props.onChangeViewRequest(1)}),100)},t.prototype.resetChangesAndMoveToManagerView=function(){this.props.onChangeViewRequest(1)},t.prototype.applyChanges=function(){if(this.isRuleDataValid()){var e={quickFormat:this.state.ruleData.getQuickFormat()},t=!this.state.ruleData.isNewRule(),n=this.state.ruleData.getRuleInputData();t&&!this.wasRuleInputChanged()?e.command=0:n&&n.updateConditionalFormattingOptions(e);var o=this.state.ruleData.getStopIfTrue();if(n){var i=n.getInputType();i!==tt.DataBars&&i!==tt.ColorScales&&i!==tt.IconSets||(o=!1)}var r={guid:this.state.ruleData.getGuid(),range:this.state.ruleData.getRange().isDirty()||!t?this.state.ruleData.getRange().rangeString:null,ruleRangeSheetName:this.state.ruleData.getRange().sheetName,activeCell:this.state.ruleData.getRange().activeCell,stopIfTrue:o,options:e};return t?de.onRuleEdited(r):(de.onRuleAdded(r),this.state.ruleData.getRange().isDirty()&&v.a.sendTraceTag(562120323,C.a.msoulscat_ES_EWAJS,$.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: New rule added with modified rule range")),Se(ExcelRibbonStrings.ConditionalFormattingRuleEditWindowDoneActionMessage),!0}if(!this.shouldDisableDoneButton()){v.a.sendTraceTag(575501088,C.a.msoulscat_ES_EWAJS,$.a.Info,"ConditionalFormattingTaskPaneReact.RuleEditor: Apply changes while in initial view on "+(null!=this.state.ruleData.getGuid()?"exsiting":"new")+" rule");var a=this.state.ruleData.getRuleInputData();null!=a&&(a.setShouldShowErrorWhenInvalid(!0),this.setRuleInputOnState(a))}return!1},t.prototype.getBeforeYouGoDialog=function(){return this.props.showConfirmation?this.wasRuleInputChanged()?d.createElement(Sn,{beforeYouGoRef:this.beforeYouGoRef,rejectViewChange:this.rejectViewChange,applyChangesAndConfirmViewChange:this.applyChangesAndConfirmViewChange,resetChangesAndConfirmViewChange:this.resetChangesAndConfirmViewChange,primaryButtonStyle:this.primaryButtonStyle,buttonStyle:this.buttonStyle}):(this.resetChangesAndConfirmViewChange(),d.createElement("div",null)):d.createElement("div",null)},t.prototype.onTypeChange=function(e){var n=null;if(!this.state.ruleData.isNewRule())switch(e){case tt.DataBars:n=this.state.ruleData.getDataBarFormat();break;case tt.ColorScales:n=this.state.ruleData.getColorScaleFormat();break;case tt.IconSets:n=this.state.ruleData.getIconSetFormat()}this.setRuleInputOnState(t.RuleInputFactory.createDefaultRuleInputDataByRuleTypeOption(e,n))},t.prototype.onHighlightCellsWithChange=function(e){this.setRuleInputOnState(t.RuleInputFactory.createDefaultRuleInputDataByHighlightCellsWithOption(e))},t.prototype.onStopIfTrueChange=function(e,t){if(null!=t){var n=this.state.ruleData;n.setStopIfTrue(t),this.setState({ruleData:n,ownUpdate:!0})}},t.prototype.onInputChange=function(e){this.setRuleInputOnState(e)},t.prototype.setRangeErrorMessageAlert=function(){var e=document.getElementById(this.rangeErrorMessageId);if(e){e.setAttribute("aria-label",""),e.setAttribute("role","");var t=this.state.ruleData.getRange().getErrorMessage(this.state.ruleData.isNewRule());t&&(e.setAttribute("aria-label",t),e.setAttribute("role","alert"))}},t.prototype.onApplyRangeChanges=function(e,t){var n=this.state.ruleData;n.updateRange({rangeString:e,sheetName:t,activeCell:null}),this.setState({ruleData:n,ownUpdate:!0}),this.setRangeErrorMessageAlert()},t.prototype.onFormatChange=function(e){var t=this.state.ruleData;t.setQuickFormat(e),this.setState({ruleData:t,ownUpdate:!0})},t.prototype.setRuleInputOnState=function(e){var t=this.state.ruleData;t.setRuleInputData(e),this.setState({ruleData:t,ownUpdate:!0})},t.RuleInputFactory=new bt,t}(d.Component),wn=400,kn="CondFmtLiveRegion",Tn=function(e){function t(t){var n=e.call(this,t)||this;return n.state={viewType:t.taskPaneViewType,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0,ruleForEdit:t.rule||null},de.updateData(t),n.onUserConfirmationResponse=n.onUserConfirmationResponse.bind(n),n.onChangeViewRequest=n.onChangeViewRequest.bind(n),n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n;if(t.isUpdateInitiatedFromReactSide)return{isUpdateInitiatedFromReactSide:!1};var o,i=e.taskPaneViewType,r=null!==(n=e.rule)&&void 0!==n?n:t.ruleForEdit;return 2===t.viewType?o={viewType:t.viewType,requestedView:i,requireConfirmation:!0,ruleForEdit:r}:(o={viewType:i,requireConfirmation:!1,requestedView:null,ruleForEdit:r},function(e,t){e!==t&&de.onTaskPaneViewChange(t)}(t.viewType,i)),o},t.prototype.componentDidCatch=function(e,t){v.a.sendTraceTag(595657362,C.a.msoulscat_ES_EWAJS,$.a.Error,"ConditionalFormattingTaskPaneReact.ConditionalFormattingTaskPane: component failed to render: "+e.toString()+" , "+t.componentStack)},t.prototype.render=function(){return d.createElement("div",{className:Object(P.eb)({background:"#EDEBE9"})},d.createElement("div",{id:kn}),this.getTaskpaneContent(this.state.viewType))},t.prototype.getTaskpaneContent=function(e){return 1===e?d.createElement(at,{rules:this.props.rules||[],isLoading:null==this.props.rules,onChangeViewRequest:this.onChangeViewRequest,error:this.props.error||0,ruleFilterOption:this.props.ruleFilterOption}):Object(O.c)("ConditionalFormattingRuleEditor")&&2===e?d.createElement(En,{rule:this.state.ruleForEdit,onChangeViewRequest:this.onChangeViewRequest,showConfirmation:this.state.requireConfirmation,onConfirmationResponse:this.onUserConfirmationResponse}):d.createElement("div",null)},t.prototype.onChangeViewRequest=function(e,t){void 0===t&&(t=null);var n=null;t&&(n={guid:t.ruleId,addRuleType:null,range:t.ruleRange,ruleRangeSheetName:t.ruleRangeSheetName,options:t.editOptions,stopIfTrue:t.stopIfTrue,customFormat:t.customFormat||null,dataBarFormat:t.dataBarFormat||null,colorScaleFormat:t.colorScaleFormat||null,iconSetFormat:t.iconSetFormat||null}),this.setState({viewType:e,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0,ruleForEdit:n}),de.onTaskPaneViewChange(e)},t.prototype.onUserConfirmationResponse=function(e){var t=this.state.requestedView;null!=t?e?(this.setState({viewType:t,requireConfirmation:!1,requestedView:null,isUpdateInitiatedFromReactSide:!0}),de.onTaskPaneViewChange(t)):this.setState({requireConfirmation:!1,requestedView:null,ruleForEdit:null,isUpdateInitiatedFromReactSide:!0}):v.a.shipAssertTag(594872280,C.a.msoulscat_ES_EWAJS,!1,"requestedView must have value.")},t}(d.Component),In=n(9),Rn=n(1711),On=n(1586);var Pn=function(e){var t=e.children;return d.createElement(On.a,{theme:Fn()},t)},Fn=Object(In.c)((function(){return Object(P.K)({palette:{themePrimary:"#107c41",themeLighterAlt:"#f1faf5",themeLighter:"#caead8",themeLight:"#a0d8b9",themeTertiary:"#55b17e",themeSecondary:"#218d51",themeDarkAlt:"#0f703b",themeDark:"#0c5f32",themeDarker:"#094624",neutralLighterAlt:"#faf9f8",neutralLighter:"#f3f2f1",neutralLight:"#edebe9",neutralQuaternaryAlt:"#e1dfdd",neutralQuaternary:"#d0d0d0",neutralTertiaryAlt:"#c8c6c4",neutralTertiary:"#a19f9d",neutralSecondary:"#605e5c",neutralPrimaryAlt:"#3b3a39",neutralPrimary:"#323130",neutralDark:"#201f1e",black:"#000000",white:"#ffffff"}})})),Dn=Fn(),_n=Object(In.c)((function(){return Object(P.eb)({height:"100%",padding:"0 16px"})})),jn=Object(In.c)((function(){return Object(P.eb)({padding:8,outline:"none",borderRadius:"3px",boxSizing:"border-box",boxShadow:Rn.a.depth8,border:"1px solid transparent",background:Dn.palette.white,":focus-within":{borderColor:Dn.palette.themePrimary}})})),Bn=n(470),Ln=n(170),Mn=n(555),An=n(699),Wn=n(450),zn={Apply:T.a.Checkmark_16,Ignore:T.a.DeleteServer_20},Hn={icon:{width:14},root:{height:"unset",fontSize:12}},Nn=function(e){var t=e.title,n=e.applyString,o=e.ignoreString,i=e.onApply,r=e.onIgnore,a=e.onClick,s=e.onFocusChange,l=e.disableApply,c=void 0!==l&&l,u=e.disableIgnore,p=void 0!==u&&u,h=e.children,g=e.isSelected;return d.createElement(H.a,{"data-is-focusable":!0,onClick:a,onBlur:null==s?void 0:s.bind(null,!1),onFocus:null==s?void 0:s.bind(null,!0),"aria-selected":g,className:jn()},d.createElement(Pe.a,{style:{marginBottom:8}},t),h,d.createElement(en.a,{styles:{root:{padding:"1px 0"}}}),d.createElement(Bn.a,{direction:Ln.a.horizontal},d.createElement(H.a,{horizontal:!0,horizontalAlign:"start"},d.createElement(xe.a,{disabled:c,onClick:i,iconProps:{iconName:zn.Apply},styles:Hn},n),d.createElement(xe.a,{disabled:p,onClick:r,iconProps:{iconName:zn.Ignore},styles:Hn},o))))};function Vn(e){var t;return null!==(t=null==e?void 0:e.filter(Gn))&&void 0!==t?t:[]}function Gn(e){return null!=e}var Un={TextInconsistencyIssue_Apply:"Replace",TextInconsistencyIssue_Ignore:"Ignore",TextInconsistencyIssue_Title:"Text is inconsistent",TextInconsistencyIssue_VariationsDropdownTitle:"replace suggested with:",TextInconsistencyIssue_VariationsDetails:"It looks like {value} in column {columnName} has {variationsNumber} variations"},Kn=function(e){var t,n,o,i,r=e.issue,a=Vn(r.variations).map((function(e){var t=e.value;return{key:null!=t?t:"",text:null!=t?t:""}})),s=d.useState(new Set(a.map((function(e){return e.key})))),l=s[0],c=s[1],u=d.useState(r.value),p=u[0],h=u[1],g=d.useCallback((function(e,t){c((function(n){var o=new Set(n);return t?o.add(e):o.delete(e),o}))}),[]),m=d.useCallback((function(e,t,n,o){var i,r;h(null!==(r=null!==(i=null==t?void 0:t.text)&&void 0!==i?i:o)&&void 0!==r?r:null)}),[]);return d.createElement(Nn,{title:Un.TextInconsistencyIssue_Title,applyString:Un.TextInconsistencyIssue_Apply,ignoreString:Un.TextInconsistencyIssue_Ignore,disableApply:0===l.size||null===p||""===p},d.createElement(Cn.a,{variant:"medium",block:!0},Un.TextInconsistencyIssue_VariationsDetails.replace("{value}",null!==(t=r.value)&&void 0!==t?t:"").replace("{columnName}",null!==(n=r.columName)&&void 0!==n?n:"").replace("{variationsNumber}",String(null!==(i=null===(o=r.variations)||void 0===o?void 0:o.length)&&void 0!==i?i:0))),d.createElement(Bn.a,null,d.createElement(H.a,{verticalAlign:"center",horizontal:!0,wrap:!0,style:{outline:"none"}},a.map((function(e){return d.createElement(Rt.a,{key:e.key,label:e.key,checked:l.has(e.key),onRenderLabel:qn,styles:{root:{width:"50%",marginTop:8},label:{width:"100%",whiteSpace:"nowrap"}},onChange:function(t,n){return void 0===n&&(n=!1),g(e.key,n)}})})))),d.createElement(Bn.a,null,d.createElement(An.a,{allowFreeform:!0,text:null!=p?p:void 0,onChange:m,styles:{label:{marginTop:8}},label:Un.TextInconsistencyIssue_VariationsDropdownTitle,useComboBoxAsMenuWidth:!0,options:a})))},qn=function(e,t){return d.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis"}},d.createElement(M.a,{content:null==e?void 0:e.label,overflowMode:Wn.a.Parent},null==t?void 0:t(e)))},Qn=Object(P.eb)({marginInlineEnd:16,".ms-List-cell":{marginBlockEnd:8}}),Jn=function(e){var t=e.suggestions;return d.createElement(Re,{scrollMinWidth:"300px"},d.createElement(Bn.a,{direction:Ln.a.vertical},d.createElement(Mn.a,{"data-testid":"SuggestionsList",className:Qn,items:t,onRenderCell:Yn})))};function Yn(e,t){if(void 0===t&&(t=-1),!e||t<0)return null;switch(e.type){case 0:return d.createElement(Kn,{key:e.id,issue:e});default:return v.a.sendTraceTag(571093407,C.a.msoulscat_ES_EWAJS,$.a.Warning,"SuggestionsManager.renderSuggestion: unknown suggestion type "+e.type),null}}var Xn=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.emptyContainerLabelStyle={color:"#252423",fontSize:"12px",paddingTop:"16px",fontWeight:400},t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Pe.a,{"data-testid":"DataCleansingEmptyState",style:this.emptyContainerLabelStyle,"aria-label":ExcelRibbonStrings.DataCleansingEmptyPane},ExcelRibbonStrings.DataCleansingEmptyPane)},t}(d.Component),Zn=function(e){var t=Vn(e.issues);return d.createElement(Pn,null,d.createElement("div",{className:_n()},t.length>0?d.createElement(Jn,{suggestions:t}):d.createElement(Xn,null)))},$n=n(897),eo=n(143),to=n(1765),no=n(930),oo=n(919),io=n(1175),ro=n(184),ao=n(479),so=Object(In.c)((function(e,t,n){return Object(P.H)(Object(io.a)(e,!!t),Object(oo.a)(!0,n))})),lo=n(157),co=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this;return d.createElement(lo.a,null,(function(t){var n=Object(io.b)(e.props,ro.a.Small,so(t,e.props.hideChevron,e.props.styles));return d.createElement(no.a,Object(p.__assign)({},e.props,{styles:Object(ao.b)(t,n),dataAutomationType:"TaskPaneActionFlyoutAnchor",keytipProps:void 0}))}))},t}(d.PureComponent),uo=(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(no.a,Object(p.__assign)({},this.props,{styles:Object(oo.a)(!1,this.props.styles),dataAutomationType:"TaskPaneFlyoutAnchor",keytipProps:void 0}))}}(d.PureComponent),{marginLeft:"4px",display:"inline-block"}),po={float:"right",display:"flex"},ho=function(e,t){return{root:Object(P.eb)({height:"24px",paddingLeft:"275px",background:"#edebe9",position:"fixed",zIndex:1,float:"right"},(e||t)&&{paddingLeft:"247px"}),button:Object(P.eb)([uo])}},go=(Object(P.eb)({marginTop:"24px",width:"303px",position:"fixed",zIndex:1,background:"#edebe9"}),Object(P.eb)({height:"24px",paddingLeft:"16px"}),{checkbox:{background:"#FFFFFF"}}),mo=Object(In.c)((function(){return Object(P.eb)({color:Object(a.a)().primary})})),bo={root:Object(P.eb)({padding:"2px 16px"})},fo=n(1140),yo=n(261),vo=n(136),Co=n(108);function xo(){return Object(a.a)().primary}var So={marginLeft:"5px",display:"inline-block"},Eo="ExternalLinksContainer-root",wo="ExternalLinksContainer-button",ko=Object(In.c)((function(e){var t,n;return Object(P.db)({root:[Eo,{height:"48px",padding:"2px 16px",selectors:(t={},t[":hover"]={background:"#e7e6e4"},t[":focus"]={outline:"none",border:"1px solid #323130"},t)}],buttonContainer:[po],button:[wo,uo,{visibility:"hidden",selectors:(n={},n["."+Eo+":hover &"]={visibility:"visible"},n["."+Eo+":focus &"]={visibility:"visible"},n["."+Eo+":focus-within &"]={visibility:"visible"},n)},e&&{visibility:"visible"}],spinner:Object(P.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:xo(),color:xo(),marginTop:"3px",marginLeft:"3px"}}})})})),To={root:Object(P.eb)({height:"24px",float:"left",marginRight:"4px",width:"76%"}),text:Object(P.eb)([So,{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",padding:"0px",position:"relative",width:"86%"}]),icon:Object(P.eb)({height:"22px",width:"22px"})},Io={root:Object(P.eb)({marginLeft:"28px"}),errorText:Object(P.eb)(So),icon:Object(P.eb)({height:"16px",width:"16px"})},Ro=n(1603),Oo=function(e){function t(t){var n=e.call(this,t)||this;return n.container=d.createRef(),n.getMenuDefinition=function(){var e={sections:[{controls:[{type:"AppButtonProps",id:"openWorkbook-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksOpenWorkbookLabel,disabled:!n.props.link.hostEditUrl,icon:T.a.GoToWorkbook_20,onExecute:Po(n.props.link.hostEditUrl)}]}]};return n.isBreakLinksEnabled&&e.sections[0].controls.push({type:"AppButtonProps",id:"breakLink-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksBreakLinksLabel,icon:T.a.DeleteHyperlink_20,onExecute:Fo(n.props.link.originalUrl,n.props.link.onButtonExecuteV2),disabled:!1}),n.isFindNextLinkEnabled&&e.sections[0].controls.push({type:"AppButtonProps",id:"findNextLink-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksFindNextLinkLabel,icon:T.a.GoToLink_20,onExecute:Do(n.props.link.originalUrl,n.props.link.onButtonExecuteV2),disabled:!1}),n.isChangeSourceEnabled&&e.sections[0].controls.push({type:"AppButtonProps",id:"changeSource-"+n.props.link.originalUrl,label:ExcelRibbonStrings.ExternalLinksEditSourceLabel,icon:T.a.DeleteHyperlink_20,onExecute:function(){return n.onChangeSource()},disabled:!1}),e},n.externalLinksControlInMenuRendererFunction=Object(vo.e)(Co.a,Object(s.a)()),n.onRefreshButtonExecute=function(){n.props.link&&n.props.link.onButtonExecuteV2?(n.setState({isServerResponsePending:!0}),n.props.link.onButtonExecuteV2(0,n.props.link.originalUrl,(function(){n.setState({isServerResponsePending:!1})})),v.a.sendTraceTag(595637534,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane refresh button clicked.")):v.a.shipAssertTag(595650711,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onRefreshButtonExecute not set.")},n.onFocus=function(){n.setState({showButtons:!0})},n.onBlur=function(){n.setState({showButtons:!1})},n.onKeyDown=function(e){n.props.onKeyDown(n.container,e)},n.onChangeSource=function(){if(n.props.link&&n.props.link.onChangeSourceButtonExecute){n.props.link.onChangeSourceButtonExecute(n.props.link.originalUrl,""),v.a.sendTraceTag(572331906,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane Change Source button clicked.")}else v.a.shipAssertTag(572331907,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onChangeSourceButtonExecute not set.")},n.isFriendlyDateEnabled=Object(O.c)("WebExternalLinksFriendlyDate"),n.isBreakLinksEnabled=Object(O.c)("WebExternalLinksBreakLink"),n.isFindNextLinkEnabled=Object(O.c)("WebExternalLinksFindNextLink"),n.isChangeSourceEnabled=Object(O.c)("WebExternalLinksChangeSource"),n.state={showButtons:!1,isServerResponsePending:!1},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=ko(this.state.showButtons),t=this.props.link.lastRefreshed,n=this.isFriendlyDateEnabled&&this.state.isServerResponsePending||this.props.link.isUpdating,o=this.isFriendlyDateEnabled&&t&&!isNaN(t.getTime())?d.createElement(Ro.a,{date:t,formatter:this.props.dateFormatter}):"",i=this.props.link.statusMessage;return d.createElement("div",{className:e.root,id:"ExternalLinksContainerId-"+this.props.id,ref:this.container,"data-is-focusable":!0,tabIndex:1===this.props.id?0:-1,onKeyDown:this.onKeyDown,"aria-label":this.props.link.workbookName+". "+i,"aria-describedby":this.props.link.errorLongDesc,role:"listitem"},d.createElement("div",{title:this.props.link.displayUrl,className:To.root},d.createElement(I.a,{className:To.icon,iconName:T.a.SaveAsExcelXlsx_20}),d.createElement(Pe.a,{className:To.text},this.props.link.workbookName)),d.createElement("div",{className:e.buttonContainer},d.createElement("div",{className:e.button},n?d.createElement(fo.a,{className:e.spinner,size:yo.a.small}):d.createElement(to.a,{id:"ExternalLinksTaskPaneRefreshButtonId-"+this.props.id,title:ExcelRibbonStrings.ExternalLinksRefreshButtonText,label:ExcelRibbonStrings.ExternalLinksRefreshButtonText,disabled:this.props.link.refreshDisabled,type:"AppButtonProps",icon:T.a.Sync_20,hideLabel:!0,onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onExecute:this.onRefreshButtonExecute})),d.createElement("div",{className:ko(this.state.showButtons).button},d.createElement(co,{id:"ExternalLinksTaskPaneEllipsesFlyoutId-"+this.props.id,title:ExcelRibbonStrings.ExternalLinksMoreOptionsButtonText,label:ExcelRibbonStrings.ExternalLinksMoreOptionsButtonText,type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHint:A.DirectionalHint.bottomRightEdge,icon:r.a.HintBarEllipses_20,menuDefinition:this.getMenuDefinition(),onFocus:this.onFocus,onBlur:this.onBlur,onAfterMenuDismiss:this.onBlur,controlInMenuRendererFunction:this.externalLinksControlInMenuRendererFunction}))),this.props.link.errorLongDesc?d.createElement("div",{title:this.props.link.errorLongDesc,className:Io.root},d.createElement(I.a,{className:Io.icon,iconName:T.a.AlertWarning_16}),d.createElement("div",{className:Io.errorText},i)):d.createElement("div",{title:this.props.link.errorLongDesc,className:Io.root},n?this.props.busyUiString:this.isFriendlyDateEnabled?d.createElement(d.Fragment,null,this.props.lastRefreshedUiString," ",o):d.createElement(d.Fragment,null,i)))},t}(d.Component),Po=function(e){return function(){e?(window.open(e,"_blank"),v.a.sendTraceTag(595637535,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane open workbook button clicked.")):v.a.shipAssertTag(595650712,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane hostEditUrl not set.")}},Fo=function(e,t){return function(){t?(t(3,e,null),v.a.sendTraceTag(593762060,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane break link button clicked.")):v.a.shipAssertTag(593762061,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onBreakLinkButtonExecute not set.")}},Do=function(e,t){return function(){t?(t(7,e,null),v.a.sendTraceTag(592544162,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane find next link button clicked.")):v.a.shipAssertTag(592544163,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPane onFindNextLinkButtonExecute not set.")}},_o=n(86),jo=function(e){function t(t){var n=e.call(this,t)||this;return n.domElement=d.createRef(),n.switchFocus=n.switchFocus.bind(n),n.onRenderListItem=n.onRenderListItem.bind(n),n}return Object(p.__extends)(t,e),t.prototype.getLearnMoreLink=function(){return"https://support.microsoft.com/en-us/office/create-an-external-reference-link-to-a-cell-range-in-another-workbook-c98d1803-dd75-4668-ac6a-d7cca2a9b95f#ID0EADAAA=Web"},t.prototype.render=function(){var e=this.getLearnMoreLink();return Object(O.c)("WebExternalLinksNoLinkOnTaskpane")&&0===this.props.links.length?d.createElement("div",{ref:this.domElement,className:bo.root},d.createElement("p",null,ExcelRibbonStrings.ExternalLinksNoLinkText),e&&d.createElement(He.a,{className:mo(),target:"_blank",href:e},ExcelRibbonStrings.ExternalLinksLearnToCreateText)):d.createElement("div",{ref:this.domElement},d.createElement(Mn.a,{role:"list",items:this.props.links,onRenderCell:this.onRenderListItem}))},t.prototype.switchFocus=function(e,t){if(t&&this.domElement.current&&e.current)if(t.which===R.a.down){var n=Object(_o.j)(this.domElement.current,e.current,!1,!1,!0,!1,!1,!1);n&&n.focus()}else if(t.which===R.a.up){var o=Object(eo.a)(e.current,!1),i=Object(_o.j)(this.domElement.current,null!=o?o.previousElementSibling:null,!1,!1,!1,!1,!1,!1);i&&i.focus()}},t.prototype.onRenderListItem=function(e,t){if(void 0!==e)return d.createElement(Oo,{link:e,id:void 0!==t?t+1:0,onKeyDown:this.switchFocus,dateFormatter:this.props.dateFormatter,busyUiString:this.props.busyUiString,lastRefreshedUiString:this.props.lastRefreshedUiString})},t}(d.Component),Bo=n(578),Lo=function(e){function t(t){var n=e.call(this,t)||this;n.domElement=d.createRef(),n.onAutoRefreshExecute=function(){n.props.onAutoUpdateExecute?(n.props.onAutoUpdateExecute(6),v.a.sendTraceTag(595161494,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane auto refresh checkbox clicked.")):v.a.shipAssertTag(595161495,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPaneonAutoUpdateExecutenotset.")},n.onRefreshAllButtonExecute=function(){n.props.onRefreshAllButtonExecuteV2?(n.setState({isServerResponsePending:!0}),n.props.onRefreshAllButtonExecuteV2((function(){n.setState({isServerResponsePending:!1})})),v.a.sendTraceTag(595637536,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane RefreshAll button clicked.")):v.a.shipAssertTag(595646292,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPaneonRefreshAllButtonExecutenotset.")},n.onBreakAllLinksButtonExecute=function(){n.props.onBreakAllLinksButtonExecute?(n.props.onBreakAllLinksButtonExecute(),v.a.sendTraceTag(593356554,C.a.msoulscat_ES_EWAJS,$.a.Info,"ExternalLinksTaskPane BreakAllLinks button clicked.")):v.a.shipAssertTag(593356555,C.a.msoulscat_ES_EWAJS,!1,"ExternalLinksTaskPaneonBreakAllLinksButtonExecutenotset.")},n.onFocus=function(){if(n.domElement.current){var e=Object(eo.a)(n.domElement.current,!0);e&&e.classList.add("is-focusVisible","ms-Fabric--isFocusVisible")}},n.getMenuDefinition=function(){var e={sections:[{controls:[]}]};return n.props.autoUpdatesEnabled&&e.sections[0].controls.push({type:"AppCheckboxProps",label:ExcelRibbonStrings.ExternalLinksAutomaticRefreshCheckBoxLabel,id:"AutomaticRefreshCheckbox",title:ExcelRibbonStrings.ExternalLinksAutomaticRefreshToolTip,styles:go,checkmarkIcon:Co.a.checkboxCheckmark,checked:n.props.autoRefreshEnabled,onExecute:n.onAutoRefreshExecute,disabled:!1}),n.isBreakLinksEnabled&&e.sections[0].controls.push({type:"AppButtonProps",label:ExcelRibbonStrings.ExternalLinksBreakAllLinksLabel,id:"BreakLinkButton",disabled:n.props.breakAllLinksDisabled,icon:T.a.DeleteHyperlink_20,onExecute:n.onBreakAllLinksButtonExecute}),e},n.externalLinksControlInMenuRendererFunction=Object(vo.e)(Co.a,Object(s.a)()),n.isFriendlyDateEnabled=Object(O.c)("WebExternalLinksFriendlyDate"),n.isBreakLinksEnabled=Object(O.c)("WebExternalLinksBreakLink"),n.state={isServerResponsePending:!1};var o=t.uiCulture?t.uiCulture:"en-US",i=t.dataCulture?t.dataCulture:"en-US",r=Object(p.__assign)({},FriendlyDatesStrings),a=new Bo.a(o,i,r,!0);return n.dateFormatter=a.format.bind(a),n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e,t={paneBody:Object(P.eb)({height:"100%",display:"contents"}),subHeader:Object(P.eb)({height:"28px",padding:"0px 16px",fontSize:"14px",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif'})},n=this.props.autoUpdatesEnabled,o=this.props.externalLinkInfoList;return this.isFriendlyDateEnabled&&this.state.isServerResponsePending&&(o=null===(e=this.props.externalLinkInfoList)||void 0===e?void 0:e.map((function(e){var t=e||void 0;return t&&(t.isUpdating=!0),t}))),null!=this.props.externalLinkInfoList&&d.createElement($n.a,null,d.createElement("div",{ref:this.domElement,className:t.paneBody},d.createElement("div",{className:ho(n,this.isBreakLinksEnabled).root},d.createElement("div",{className:ho(n,this.isBreakLinksEnabled).button},d.createElement(to.a,{id:"ExternalLinksTaskPaneRefreshAllButtonId",title:ExcelRibbonStrings.ExternalLinksRefreshAllButtonText,label:ExcelRibbonStrings.ExternalLinksRefreshAllButtonText,disabled:this.props.refreshAllDisabled,type:"AppButtonProps",icon:T.a.Sync_20,hideLabel:!0,onFocus:this.onFocus,onExecute:this.onRefreshAllButtonExecute})),(this.isBreakLinksEnabled||n)&&d.createElement("div",{className:ho(n,this.isBreakLinksEnabled).button},d.createElement(co,{id:"ExternalLinksTaskPaneMainEllipsesFlyoutId",title:ExcelRibbonStrings.ExternalLinksMoreOptionsButtonText,label:ExcelRibbonStrings.ExternalLinksMoreOptionsButtonText,type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHint:A.DirectionalHint.bottomRightEdge,icon:r.a.HintBarEllipses_20,menuDefinition:this.getMenuDefinition(),onFocus:this.onFocus,controlInMenuRendererFunction:this.externalLinksControlInMenuRendererFunction}))),d.createElement("div",null),d.createElement("div",{className:Object(P.eb)({paddingTop:"24px"})},d.createElement(jo,{links:o,dateFormatter:this.dateFormatter,busyUiString:this.props.busyUiString?this.props.busyUiString:"",lastRefreshedUiString:this.props.lastRefreshedUiString?this.props.lastRefreshedUiString:""}))))},t}(d.Component),Mo=Object(In.c)((function(){return Object(P.db)({root:{display:"flex",flexDirection:"column",height:"100%",paddingLeft:"16px",paddingRight:"16px"},description:{fontSize:"12px",marginBottom:"8px"},controlGroup:{marginBottom:"8px"}})})),Ao={dropdown:{width:"100px",fontSize:"12px"},title:{height:"24px",lineHeight:"24px"},caretDownWrapper:{height:"24px",lineHeight:"24px"},dropdownItem:{minHeight:"24px",fontSize:"12px"},dropdownItemSelected:{minHeight:"24px",fontSize:"12px"}},Wo=Object(In.c)((function(){return Object(P.eb)([{marginBottom:"16px"}])})),zo=n(532),Ho=n(1047),No=n(684),Vo=n(117),Go=n(1583),Uo=n(1717),Ko=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Go.a,Object(p.__assign)({},this.props,{styles:this.props.styles?Object(Uo.b)(this.props.styles,ro.a.Small):Object(Uo.a)(ro.a.Small)}))},t}(d.PureComponent),qo=Object(In.c)((function(e,t,n){return Object(P.db)({root:{display:"flex",alignItems:"center",width:"100%",height:"100%",boxSizing:"border-box",paddingLeft:e?t?"2px":"18px":0},icon:{height:"16px",width:"16px"},label:{fontSize:n?"9pt":"8pt",fontWeight:n?"bold":"normal",color:n?"#262626":"#5e5e5e",padding:"0 0 0 4px",textOverflow:"ellipsis",overflow:"hidden",flex:"1"}})})),Qo={root:{height:"12px",width:"12px",marginRight:"2px",marginLeft:"2px",padding:0},checkbox:{height:"12px",width:"12px"},checkmark:{fontSize:"12px",height:"12px",width:"12px"}},Jo=Object(In.c)((function(e){return{root:{paddingLeft:16*e,minHeight:"18px",borderBottom:0,minWidth:"100% !important",width:"100% !important"},cell:{padding:"0px 4px 0px 0px",minHeight:"16px",overflow:"visible",width:"100% !important"},fields:{width:"100% !important"}}})),Yo=function(e){function t(t){var n=e.call(this,t)||this;return n.onRenderFieldListItem=function(e,t,o){if(null==e)return null;var i=n.getFieldListItemIconName(e,n.props.isDataModel),r=n.props.nestingDepth>0&&(e.isCollapsible||!e.isCollapsible&&""===i&&e.showCheckBox),a=qo(r,e.isCollapsible,e.isChecked);return d.createElement("div",{className:a.root},e.isCollapsible?d.createElement(I.a,{className:a.icon,iconName:e.isCollapsed?T.a.XLFieldListExpanderPlus_16:T.a.XLFieldListExpanderMinus_16}):null,""!==i?d.createElement(I.a,{className:a.icon,iconName:i}):null,e.showCheckBox?d.createElement("div",{onClick:n.onCheckBoxDivClick},d.createElement(Ko,{id:"fieldListItem_"+e.id+"_checkbox",type:"AppCheckboxProps",label:"",styles:Qo,checked:e.isChecked,checkmarkIcon:Co.a.checkboxCheckmark,onExecute:n.onCheckboxChange})):null,d.createElement("div",{title:e.name?e.name:"",className:a.label},e.name))},n.getFieldListItemIconName=function(e,t){if(e.isMoreFields)return T.a.XLFieldListFieldsOpenIcon_16;switch(e.type){case 11:return t?T.a.XLFieldListWbkTableIcon_16:T.a.XLFieldListDimensionIcon_16;case 19:return T.a.XLFieldListValues_16;case 29:case 31:return T.a.XLFieldListKPIIcon_16;case 23:return e.isCollapsed?T.a.Folder_16:T.a.Open_16;case 13:return e.isCollapsed?T.a.XLFieldListSetsClosedIcon_16:T.a.XLFieldListSetsOpenIcon_16;default:return""}},n.onFieldClick=function(){n.props.onFieldExpandCollapse&&n.props.item.isCollapsible&&n.props.onFieldExpandCollapse(n.props.item.id)},n.onCheckBoxDivClick=function(e){e.stopPropagation()},n.onFieldKeyDown=function(e){var t=n.props.item;switch(e.key){case"Enter":e.preventDefault();break;case"ArrowLeft":case"ArrowRight":t.isCollapsible&&n.onFieldClick();break;case" ":e.preventDefault(),t.showCheckBox&&n.props.onFieldCheckedChanged&&n.props.onFieldCheckedChanged(t.id,!t.isChecked)}},n.onCheckboxChange=function(e){n.props.onFieldCheckedChanged&&n.props.onFieldCheckedChanged(n.props.item.id,e.checked)},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,n=e.itemIndex;return d.createElement("div",{id:"fieldListItem_"+t.id,onClick:this.onFieldClick,onKeyDown:this.onFieldKeyDown},d.createElement(No.a,{columns:[{key:"fieldListItem",name:"field list item",minWidth:0,isResizable:!0,onRender:this.onRenderFieldListItem}],dragDropEvents:this.props.dragDropEvents,dragDropHelper:this.props.dragDropHelper,item:t,itemIndex:n,selectionMode:Vo.c.none,styles:Jo(this.props.nestingDepth)}))},t}(d.Component),Xo=function(e){function t(n){var o=e.call(this,n)||this;return o.dragDropHelper=new zo.a({selection:new Ho.a}),o.onRenderFieldListCell=function(e,n,i){if(e&&"number"==typeof n&&n>-1){var r=e.showSeparator||11===e.type||19===e.type||29===e.type||13===e.type;return d.createElement("div",null,d.createElement(Yo,{item:e,itemIndex:n,nestingDepth:o.props.nestingDepth,isDataModel:o.props.isDataModel,dragDropEvents:o.dragDropEvents,dragDropHelper:o.dragDropHelper,onFieldCheckedChanged:o.props.onFieldCheckedChanged,onFieldExpandCollapse:o.props.onFieldExpandCollapse}),e.children&&e.children.length>0?d.createElement("div",null,d.createElement(t,{items:e.children,nestingDepth:o.props.nestingDepth+1,isDataModel:o.props.isDataModel,onFieldExpandCollapse:o.props.onFieldExpandCollapse,onFieldCheckedChanged:o.props.onFieldCheckedChanged,onFieldMove:o.props.onFieldMove,setDragItemInfo:o.props.setDragItemInfo,getDragItemInfo:o.props.getDragItemInfo})):null,r?d.createElement("div",{className:Wo()}):null)}return null},o.dragDropEvents=o.getDragDropEvents(),o}return Object(p.__extends)(t,e),t.prototype.render=function(){return this.props.items?d.createElement(Mn.a,{items:this.props.items,onRenderCell:this.onRenderFieldListCell}):null},t.prototype.getDragDropEvents=function(){var e=this;return{canDrop:function(){return!0},canDrag:function(e){return!!e&&e.canDrag},onDrop:function(){var t=e.props.getDragItemInfo();0!==t.dragItemSourceAxis&&e.props.onFieldMove&&null!=t.dragItem&&e.props.onFieldMove(t.dragItem.id,t.dragItemSourceAxis,0,0)},onDragStart:function(t){null!=t&&e.props.setDragItemInfo(0,t)}}},t}(d.Component),Zo=Object(In.c)((function(e){return Object(P.db)({root:{marginBottom:e?0:"16px"},title:{fontSize:"12px",alignItems:"center",display:"flex",fontWeight:500,height:"16px"},titleIcon:{height:"16px",width:"16px",marginRight:"4px"},content:{background:"#FFFFFF",border:"1px solid #b0b0b0",boxSizing:"border-box",overflowY:"auto"}})})),$o=Object(In.c)((function(e){return{height:-1===e?"auto":18*e+2}})),ei=Object(In.c)((function(e){return Object(P.eb)([{height:"18px",width:"100%",boxSizing:"border-box",borderTop:e?"1px solid #0f9900":"1px solid transparent"}])})),ti=Object(In.c)((function(){return Object(P.eb)([{borderTop:"1px solid #0f9900"}])})),ni=Object(In.c)((function(){return Object(P.db)({root:{display:"flex",alignItems:"center",width:"100%",height:"100%"},label:{fontSize:"8pt",color:"#5e5e5e",padding:"0 0 0 4px",textOverflow:"ellipsis",overflow:"hidden"}})})),oi={root:{paddingLeft:"4px",minHeight:"18px",height:"18px",borderBottom:0,minWidth:"100% !important",width:"100% !important"},cell:{padding:"0px 4px 0px 0px",minHeight:"16px",overflow:"visible",width:"100% !important"},fields:{width:"100% !important"}},ii=function(e){function t(t){var n=e.call(this,t)||this;return n.onFieldKeyDown=function(e){e.key},n.onRenderFieldWellItem=function(e,t,n){if(!e)return null;var o=ni();return d.createElement("div",{className:o.root},d.createElement("div",{className:o.label,title:e.name},e.name))},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.item,n=e.itemIndex;return d.createElement("div",{id:"fieldWell_field"+t.id,onKeyDown:this.onFieldKeyDown},d.createElement(No.a,{columns:[{key:"fieldWellItem",name:"field well item",minWidth:0,isResizable:!0,onRender:this.onRenderFieldWellItem}],dragDropEvents:this.props.dragDropEvents,dragDropHelper:this.props.dragDropHelper,item:t,itemIndex:n,selectionMode:Vo.c.none,styles:oi}))},t}(d.Component),ri=function(e){function t(t){var n=e.call(this,t)||this;return n.dragDropHelper=new zo.a({selection:new Ho.a}),n.getFieldWellTitleIconName=function(e){switch(e){case 4:return T.a.XLFieldListFilter_16;case 1:return T.a.XLFieldListRows_16;case 2:return T.a.XLFieldListColumns_16;case 8:return T.a.XLFieldListValues_16;default:return""}},n.onRenderListRow=function(e,t,o){return e&&"number"==typeof t&&t>-1?d.createElement(ii,{item:e,itemIndex:t,dragDropEvents:n.dragDropEvents,dragDropHelper:n.dragDropHelper}):null},n.onEmptyRowDragOver=function(e){e.preventDefault()},n.onEmptyRowDrop=function(e){if(e.preventDefault(),n.setState({isDraggingToEmptyRow:!1}),null!=n.props.items&&null!=n.props.onFieldMove){var t=n.props.getDragItemInfo(),o=n.props.items.length;null==t.dragItem||o>0&&n.props.items[o-1].id===t.dragItem.id||n.props.onFieldMove(t.dragItem.id,t.dragItemSourceAxis,n.props.type,n.props.items.length)}},n.onEmptyRowDragEnter=function(){n.setState({isDraggingToEmptyRow:!0})},n.onEmptyRowDragLeave=function(){n.setState({isDraggingToEmptyRow:!1})},n.dragDropEvents=n.getDragDropEvents(),n.state={isDraggingToEmptyRow:!1},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.type,n=e.items,o=this.getFieldWellTitleIconName(t),i=Zo(8===this.props.type);return d.createElement("div",{className:i.root},d.createElement("div",{className:i.title},""!==o?d.createElement(I.a,{className:i.titleIcon,iconName:o}):null,this.props.title),d.createElement("div",{className:i.content,style:$o(this.props.rowsLimitToOverflow)},d.createElement(Bn.a,{direction:Ln.a.vertical},n?d.createElement(Mn.a,{items:n,onRenderCell:this.onRenderListRow}):null),d.createElement("div",{className:ei(this.state.isDraggingToEmptyRow),onDragOver:this.onEmptyRowDragOver,onDrop:this.onEmptyRowDrop,onDragEnter:this.onEmptyRowDragEnter,onDragLeave:this.onEmptyRowDragLeave})))},t.prototype.getDragDropEvents=function(){var e=this;return{canDrop:function(){return!0},canDrag:function(){return!0},onDrop:function(t){if(null!=t&&null!=e.props.items&&null!=e.props.onFieldMove){var n=e.props.getDragItemInfo();if(null!=n.dragItem&&t.id!==n.dragItem.id){var o=e.props.items.indexOf(t);e.props.onFieldMove(n.dragItem.id,n.dragItemSourceAxis,e.props.type,o)}}},onDragStart:function(t){t&&e.props.setDragItemInfo(e.props.type,t)},onDragEnter:function(){return ti()}}},t}(d.Component),ai=Object(In.c)((function(){return Object(P.db)({root:{display:"flex",flex:"1",flexDirection:"row",height:"100%",overflow:"hidden",paddingBottom:"16px"},fieldListArea:{background:"#FFFFFF",border:"1px solid #b0b0b0",boxSizing:"border-box",height:"100%",flex:"1",overflowY:"auto",display:"flex",flexDirection:"column"},fieldListEmptyArea:{flex:"1"},fieldWellsArea:{height:"100%",background:"#EDEBE9",overflowY:"hidden",flex:"1"},resizeBar:{height:"100%",width:"10px",background:"#EDEBE9",cursor:"col-resize",boxSizing:"border-box",border:"1px solid #EDEBE9"}})}));function si(e,t,n,o,i){var r=e.current.offsetHeight-64-48-8;r<72?(r=72,e.current.style.overflowY="auto"):e.current.style.overflowY="hidden";var a=r/18-.1,s=t+n+o+i+4;if(!(a<s))return[-1,-1,-1,-1];var l=[{type:4,size:t+1},{type:2,size:n+1},{type:1,size:o+1},{type:8,size:i+1}];l.sort((function(e,t){return t.size-e.size}));var c=s-a,u=new Map;l[0].size-l[1].size>=c?u.set(l[0].type,l[0].size-c):(c-=l[0].size-l[1].size,2*(l[1].size-l[2].size)>=c?(u.set(l[0].type,l[1].size-c/2),u.set(l[1].type,l[1].size-c/2)):(c-=2*(l[1].size-l[2].size),3*(l[2].size-l[3].size)>=c?(u.set(l[0].type,l[2].size-c/3),u.set(l[1].type,l[2].size-c/3),u.set(l[2].type,l[2].size-c/3)):l.forEach((function(e){u.set(e.type,a/4)}))));return[4,2,1,8].forEach((function(e){u.has(e)||u.set(e,-1)})),[u.get(4),u.get(2),u.get(1),u.get(8)]}var li=n(956),ci=function(){function e(){}return e.prototype.register=function(e,t){if(void 0===window.ResizeObserver?this.observer=new li.a(t):this.observer=new window.ResizeObserver(t),this.observer)for(var n=0;n<e.length;n+=1)this.observer.observe(e[n])},e.prototype.dispose=function(){this.observer&&(this.observer.disconnect(),delete this.observer)},e}(),ui=function(e){function t(t){var n=e.call(this,t)||this;return n.setDragItemInfo=function(e,t){n.dragItemInfo={dragItemSourceAxis:e,dragItem:t}},n.getDragItemInfo=function(){return n.dragItemInfo},n.onFieldListEmptyAreaDragOver=function(e){e.preventDefault()},n.onFieldListEmptyAreaDrop=function(e){e.preventDefault();var t=n.getDragItemInfo();0!==t.dragItemSourceAxis&&n.props.onFieldMove&&null!=t.dragItem&&n.props.onFieldMove(t.dragItem.id,t.dragItemSourceAxis,0,0)},n.updateFieldListWidth=function(e){var t=(n.fieldListRef.current.offsetWidth+e)/(n.dragDropAreaRef.current.offsetWidth-10);t<.3&&(t=.3),t>.7&&(t=.7),n.fieldListRef.current.style.flex="none",n.fieldListRef.current.style.width="calc((100% - 10px) *"+t+")"},n.onResizeBarKeyDown=function(e){"ArrowLeft"===e.key?n.updateFieldListWidth(-10):"ArrowRight"===e.key&&n.updateFieldListWidth(10)},n.onResizeBarMouseDown=function(e){n.resizeBarXPosition=e.clientX},n.onMouseMove=function(e){if(null!=n.resizeBarXPosition){var t=e.clientX-n.resizeBarXPosition;n.resizeBarXPosition=e.clientX,n.updateFieldListWidth(t)}},n.onMouseUp=function(){null!=n.resizeBarXPosition&&(n.resizeBarXPosition=null)},n.dragItemInfo={dragItemSourceAxis:0,dragItem:null},n.fieldListRef=d.createRef(),n.dragDropAreaRef=d.createRef(),n.resizeBarXPosition=null,n.fieldListWidth=null,n.resizeObserver=new ci,n.fieldWellAreaHeight=0,n.state={filterWellRowsLimit:-1,columnsWellRowsLimit:-1,rowsWellRowsLimit:-1,valuesWellRowsLimit:-1,filtersWellItemsLength:-1,columnsWellItemsLength:-1,rowsWellItemsLength:-1,valuesWellItemsLength:-1,fieldWellsRef:d.createRef()},n}return Object(p.__extends)(t,e),t.prototype.componentWillUnmount=function(){document.removeEventListener("mousemove",this.onMouseMove),document.removeEventListener("mouseup",this.onMouseUp),this.resizeObserver&&this.resizeObserver.dispose()},t.prototype.componentDidMount=function(){var e=this;document.addEventListener("mousemove",this.onMouseMove),document.addEventListener("mouseup",this.onMouseUp),this.fieldWellAreaHeight=this.state.fieldWellsRef.current.offsetHeight,this.resizeObserver.register([this.state.fieldWellsRef.current],(function(){window.requestAnimationFrame((function(){var t=e.state.fieldWellsRef.current.offsetHeight;if(t!==e.fieldWellAreaHeight){e.fieldWellAreaHeight=t;var n=e.props.fieldWellsItems;if(n){var o=si(e.state.fieldWellsRef,n.filtersWellItems.length,n.columnsWellItems.length,n.rowsWellItems.length,n.valuesWellItems.length);e.setState({filterWellRowsLimit:o[0],columnsWellRowsLimit:o[1],rowsWellRowsLimit:o[2],valuesWellRowsLimit:o[3]})}}}))}))},t.prototype.componentDidUpdate=function(){if(null==this.fieldListWidth){var e=this.fieldListRef.current.offsetWidth;this.fieldListWidth=e}},t.getDerivedStateFromProps=function(e,t){var n=e.fieldWellsItems;if(null==n||null==t.fieldWellsRef.current)return null;var o=n.filtersWellItems.length,i=n.columnsWellItems.length,r=n.rowsWellItems.length,a=n.valuesWellItems.length;if(t.filtersWellItemsLength===o&&t.columnsWellItemsLength===i&&t.rowsWellItemsLength===r&&t.valuesWellItemsLength===a)return null;var s=si(t.fieldWellsRef,o,i,r,a);return{filterWellRowsLimit:s[0],columnsWellRowsLimit:s[1],rowsWellRowsLimit:s[2],valuesWellRowsLimit:s[3],filtersWellItemsLength:o,columnsWellItemsLength:i,rowsWellItemsLength:r,valuesWellItemsLength:a}},t.prototype.render=function(){var e=ai(),t={onFieldMove:this.props.onFieldMove,setDragItemInfo:this.setDragItemInfo,getDragItemInfo:this.getDragItemInfo},n=this.props,o=n.fieldListItems,i=n.fieldWellsItems;return d.createElement("div",{className:e.root,ref:this.dragDropAreaRef},d.createElement("div",{className:e.fieldListArea,ref:this.fieldListRef},d.createElement(Bn.a,{direction:Ln.a.vertical},d.createElement(Xo,Object(p.__assign)({items:o,nestingDepth:0,isDataModel:this.props.isDataModel,onFieldExpandCollapse:this.props.onFieldExpandCollapse,onFieldCheckedChanged:this.props.onFieldCheckedChanged},t))),d.createElement("div",{className:e.fieldListEmptyArea,onDragOver:this.onFieldListEmptyAreaDragOver,onDrop:this.onFieldListEmptyAreaDrop})),d.createElement("div",{className:e.resizeBar,tabIndex:0,onMouseDown:this.onResizeBarMouseDown,onKeyDown:this.onResizeBarKeyDown}),d.createElement("div",{className:e.fieldWellsArea,ref:this.state.fieldWellsRef},d.createElement(ri,Object(p.__assign)({type:4,title:"Filters",rowsLimitToOverflow:this.state.filterWellRowsLimit,items:i?i.filtersWellItems:null},t)),d.createElement(ri,Object(p.__assign)({type:2,title:"Columns",rowsLimitToOverflow:this.state.columnsWellRowsLimit,items:i?i.columnsWellItems:null},t)),d.createElement(ri,Object(p.__assign)({type:1,title:"Rows",rowsLimitToOverflow:this.state.rowsWellRowsLimit,items:i?i.rowsWellItems:null},t)),d.createElement(ri,Object(p.__assign)({type:8,title:"Values",rowsLimitToOverflow:this.state.valuesWellRowsLimit,items:i?i.valuesWellItems:null},t))))},t}(d.Component),pi=[{key:0,text:"All"},{key:1,text:"Active"}],di=function(e){function t(t){var n=e.call(this,t)||this;return n.onTabChanged=function(e,t){n.props.onSelectedTabChanged&&t&&n.props.onSelectedTabChanged(Number(t.key))},n.state={fieldListItems:null,fieldWellsItems:null,isDataModel:!1,selectedTab:-1},n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e){return 0===e.dataUpdateType?{fieldListItems:e.fieldListItems,isDataModel:e.isDataModel,selectedTab:e.selectedTab}:1===e.dataUpdateType?{fieldWellsItems:e.fieldWellsItems}:null},t.prototype.render=function(){var e=Mo();return(null!=this.props.fieldListItems||null!=this.props.fieldWellsItems)&&d.createElement("div",{className:e.root},d.createElement("div",{className:e.description},"Choose fields to add to the report and drag them between the areas below:"),d.createElement("div",{className:e.controlGroup},this.state.isDataModel?d.createElement(De.a,{id:"allActiveTabs",role:"combobox",options:pi,styles:Ao,selectedKey:this.state.selectedTab,onChange:this.onTabChanged}):null),d.createElement(ui,{fieldListItems:this.state.fieldListItems,fieldWellsItems:this.state.fieldWellsItems,isDataModel:this.state.isDataModel,onFieldMove:this.props.onFieldMove,onFieldExpandCollapse:this.props.onFieldExpandCollapse,onFieldCheckedChanged:this.props.onFieldCheckedChanged}))},t}(d.Component),hi={fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',color:"#252423"},gi={fontSize:"12px",fontWeight:400},mi={paddingTop:"4px",paddingBottom:"4px"},bi={marginTop:0,marginBottom:"4px"},fi={marginTop:"4px",marginBottom:"24px"},yi={fontSize:"12px",fontWeight:600,marginBottom:"4px"},vi={marginTop:"4px",marginBottom:"16px"},Ci={marginTop:"16px",marginBottom:"16px"},xi=Object(In.c)((function(){return Object(P.db)({firstRoot:[vi],root:[Ci],label:[yi,mi,hi]})})),Si=Object(In.c)((function(){return Object(P.eb)({marginBottom:"24px"})})),Ei=Object(In.c)((function(){return Object(P.eb)([gi,mi,hi])})),wi=Object(In.c)((function(){return Object(ge.d)("WacTaskPaneInfra")?Object(P.eb)({height:"100%",paddingLeft:"16px",paddingRight:"16px",overflowY:"auto"}):""})),ki={paddingTop:"3px",paddingBottom:"3px",display:"inline-block",fontSize:"14px",lineHeight:"24px",outline:"none",color:"#252423",verticalAlign:"middle",width:"248px"},Ti=Object(In.c)((function(){return Object(P.db)({root:{height:"auto",border:"1px solid transparent",marginLeft:"-16px",paddingLeft:"16px",marginRight:"-16px",paddingRight:"16px",selectors:{":hover":{background:"#E1DFDD"},":focus":{border:"1px solid #605E5C",outline:"none"},":active":{background:"#C8C6C4"}}},labelExpanded:[ki,hi],labelCollapsed:[ki,hi,{fontWeight:400}],icon:{height:"12px",width:"12px",marginRight:"8px",verticalAlign:"middle",selectors:{"svg > path.OfficeIconColors_DynamicColor":{fill:"#3A3A38"}}}})})),Ii=Object(In.c)((function(e){return Object(P.eb)([fi,{marginLeft:"20px",display:e?"block":"none"}])})),Ri=Object(In.c)((function(){return Object(P.eb)([gi,hi,vi,{paddingTop:0,paddingBottom:0}])})),Oi=function(e){function t(t){var n=e.call(this,t)||this;return n.state={isCollapsed:t.collapse},n.onToggleDisplay=n.onToggleDisplay.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=Ti();return d.createElement(Bn.a,null,d.createElement("div",{className:e.root,id:"sectionHeader"+this.props.divId,"data-is-focusable":!0,role:"button","aria-expanded":!this.state.isCollapsed,onClick:this.onToggleDisplay,onMouseUp:this.onMouseUp},d.createElement(I.a,{className:e.icon,iconName:this.state.isCollapsed?r.a.CommonControlChevronRight_12:r.a.CommonControlChevronDownGlyph_12}),d.createElement(Pe.a,{className:this.state.isCollapsed?e.labelCollapsed:e.labelExpanded},this.props.displayName)))},t.prototype.onToggleDisplay=function(){var e=this.props.divId,t=document.getElementById(e);null!==t&&("none"===window.getComputedStyle(t).display?(t.style.display="block",this.setState({isCollapsed:!1})):(t.style.display="none",this.setState({isCollapsed:!0})))},t.prototype.onMouseUp=function(){document.getElementById("sectionHeader"+this.props.divId).blur()},t}(d.PureComponent),Pi=n(92),Fi=Object(In.c)((function(e){return function(t){var n=t.disabled,o=t.focused,i=t.multiline,r=t.theme,a=Object(Pi.a)(r);return Object(P.db)({root:{selectors:{"input[type=text]":{padding:"0 8px"},"&& label":{cursor:"auto"}}},wrapper:{},fieldGroup:[{backgroundColor:a.inputBackgroundColor,height:24,border:"1px solid "+a.inputBorderColor,borderRadius:2},i&&{height:"auto",minHeight:72},!o&&!n&&{selectors:{":hover":{borderColor:a.textFieldHoverBorderColor}}},o&&{borderColor:a.inputFocusBorderColor},n&&{backgroundColor:a.disabledBackgroundColor,borderColor:a.inputBorderColor}],field:[{fontSize:12,height:16,marginTop:3,padding:"0 8px",color:a.inputTextColor,selectors:{"::selection":{backgroundColor:a.inputSelectionBackgroundColor,color:a.inputSelectionTextColor}}},n&&{color:a.inputTextDisabledColor,selectors:{"::placeholder":{color:a.inputTextDisabledColor,opacity:1},":-ms-input-placeholder":{color:a.inputTextDisabledColor,opacity:1}}}],icon:{},description:{},errorMessage:{},prefix:{},suffix:{},subComponentStyles:{label:{root:[{fontWeight:600,fontSize:12},n&&{color:a.textFieldLabelColor}]}}},e)}})),Di=n(81),_i=Object(Di.a)(),ji=d.forwardRef((function(e,t){return d.createElement(V.a,Object(p.__assign)({},e,{styles:Fi(_i(e.styles)),ref:t}))})),Bi={root:[bi],subComponentStyles:{label:{root:[mi,hi]}},field:[hi]},Li=function(e){function t(t){var n=e.call(this,t)||this;return n.lastCommitValue=n.props.value,n.currentValue=n.props.value,n.state={value:n.props.value},n.onTextChange=n.onTextChange.bind(n),n.onTextBlur=n.onTextBlur.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n.commitCurrentValue=n.commitCurrentValue.bind(n),n}return Object(p.__extends)(t,e),t.prototype.componentWillReceiveProps=function(e){e.needCommit&&this.commitCurrentValue(),this.lastCommitValue!==e.value&&(this.lastCommitValue=e.value,this.currentValue=e.value,this.setState({value:e.value}))},t.prototype.componentWillUnmount=function(){this.commitCurrentValue()},t.prototype.render=function(){var e={role:"textbox",id:this.props.id,value:this.state.value,multiline:this.props.multiline,disabled:this.props.disabled,styles:Bi,onChange:this.onTextChange,onBlur:this.onTextBlur,onKeyDown:this.onKeyDown};return this.props.label?d.createElement(ji,Object(p.__assign)({type:"AppInputProps",label:this.props.label},e)):d.createElement(ji,Object(p.__assign)({type:"AppInputProps"},e))},t.prototype.onTextChange=function(e){this.currentValue=e||"",this.setState({value:e||""})},t.prototype.commitCurrentValue=function(){this.currentValue!==this.lastCommitValue&&(this.props.onSettingChange?(this.lastCommitValue=this.currentValue,this.props.onSettingChange(this.props.actionType,this.currentValue||"",0)):this.props.onSettingChangeWithFloat&&(this.lastCommitValue=this.currentValue,this.props.onSettingChangeWithFloat(this.props.actionType,this.currentValue||"",0,0)))},t.prototype.onTextBlur=function(){this.commitCurrentValue()},t.prototype.onKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),this.commitCurrentValue())},t}(d.PureComponent),Mi=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.PivotTableSettingsAltTextSectionHeader,divId:"altTextSection",paneId:"pivotTableSettings",collapse:!this.props.expandByDefault}),d.createElement("div",{id:"altTextSection",className:Ii(this.props.expandByDefault)},d.createElement(Pe.a,{className:Ri()},ExcelRibbonStrings.PivotTableSettingsAltTextSectionDescription),d.createElement(Li,{id:"altText",label:ExcelRibbonStrings.PivotTableSettingsAltTextTitle,value:this.props.altText,multiline:!1,disabled:!1,actionType:16,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged}),d.createElement(Li,{id:"altTextSummary",label:ExcelRibbonStrings.PivotTableSettingsAltTextDescription,value:this.props.altTextSummary,multiline:!0,disabled:!1,actionType:17,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})))},t}(d.PureComponent),Ai={root:[bi,{paddingLeft:"3px",paddingRight:"3px",marginRight:"4px"}],rootFocused:{borderColor:"#605E5C"},rootDisabled:{borderColor:"#BEBBB8"},label:[hi]},Wi=function(e){function t(t){var n=e.call(this,t)||this;return n.onButtonClick=n.onButtonClick.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(to.b,{type:"AppButtonProps",label:this.props.label,id:this.props.id,styles:Ai,onExecute:this.onButtonClick,disabled:this.props.disabled})},t.prototype.onButtonClick=function(){this.props.onSettingChange&&this.props.onSettingChange(this.props.actionType,"",this.props.valueToSet)},t}(d.PureComponent),zi={root:[bi,{height:"auto",lineHeight:"normal",minHeight:"24px",paddingLeft:0,paddingRight:0}],checkbox:{background:"#FFFFFF"},label:[hi]},Hi=function(e){function t(t){var n=e.call(this,t)||this;return n.state={checked:n.props.checked},n.onCheckboxChange=n.onCheckboxChange.bind(n),n.onCheckboxExecute=n.onCheckboxExecute.bind(n),n.onCheckboxKeyDown=n.onCheckboxKeyDown.bind(n),n}return Object(p.__extends)(t,e),t.prototype.componentWillReceiveProps=function(e){this.setState({checked:e.checked})},t.prototype.render=function(){return d.createElement("div",{onKeyDown:this.onCheckboxKeyDown,role:"checkbox","aria-checked":this.state.checked},d.createElement(Ko,{type:"AppCheckboxProps",label:this.props.label,id:this.props.id,styles:zi,checked:this.state.checked,checkmarkIcon:Co.a.checkboxCheckmark,onExecute:this.onCheckboxExecute,disabled:this.props.disabled}))},t.prototype.onCheckboxChange=function(e){this.setState({checked:e}),this.props.onSettingChange?this.props.onSettingChange(this.props.actionType,"",Number(e)):this.props.onSettingChangeWithFloat&&this.props.onSettingChangeWithFloat(this.props.actionType,"",Number(e),0)},t.prototype.onCheckboxExecute=function(e){this.onCheckboxChange(e.checked)},t.prototype.onCheckboxKeyDown=function(e){"Enter"===e.key&&(e.preventDefault(),this.onCheckboxChange(!this.state.checked))},t}(d.PureComponent),Ni=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=xi();return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.PivotTableSettingsGrandSubTotalsSectionHeader,divId:"grandTotalsAndSubtotals",paneId:"pivotTableSettings",collapse:!this.props.expandByDefault}),d.createElement("div",{id:"grandTotalsAndSubtotals",className:Ii(this.props.expandByDefault)},d.createElement("div",{className:e.firstRoot},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsGrandTotalsGroupHeader),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsGrandTotalsShowForRows,id:"rwGrandTotalOn",checked:this.props.rwGrandTotalOn,actionType:2,onSettingChange:this.props.onSettingChange,disabled:!1}),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsGrandTotalsShowForColumns,id:"colGrandTotalOn",checked:this.props.colGrandTotalOn,actionType:3,onSettingChange:this.props.onSettingChange,disabled:!1})),d.createElement("div",{className:e.root},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsSubTotalsGroupHeader),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsSubTotalsDoNotShow,id:"subTotalsDoNotShow",actionType:18,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsSubTotalsShowOnTop,id:"subTotalsShowOnTop",actionType:18,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsSubTotalsShowOnBottom,id:"subTotalsShowOnBottom",actionType:18,valueToSet:2,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}))))},t}(d.PureComponent),Vi=Object(In.c)((function(e){return{root:[bi,{height:"auto",selectors:{"::after":{content:"''",display:"block",clear:"both"}}}],spinButtonWrapper:{width:e?"80px":"42px",minWidth:e?"80px":"42px",height:"24px",selectors:{"::after":{borderColor:G.a.gray60},":hover::after":{borderColor:G.a.gray80},":focus::after":{borderColor:G.a.gray130,borderWidth:"1px"}}},arrowButtonsContainer:{width:"12px",backgroundColor:G.a.white,selectors:{i:{width:"8px",height:"8px",lineHeight:"8px"},":hover":{backgroundColor:G.a.gray20},button:{width:"12px",backgroundColor:"transparent",selectors:{":hover":{backgroundColor:G.a.gray40},":active":{backgroundColor:G.a.gray50}}}}},input:[hi,{minWidth:"12px",fontSize:"12px",paddingLeft:"4px",paddingRight:"4px",selectors:{"::selection":G.a.gray120}}],label:[gi,hi,{paddingTop:0,paddingBottom:0,lineHeight:"normal"}],labelWrapper:[{height:"auto",minHeight:"24px",width:e?"calc(100% - 80px)":"calc(100% - 48px)"},e?{marginRight:0}:{marginLeft:0}],labelWrapperStart:{height:"auto",marginRight:0},labelWrapperEnd:{height:"auto",marginLeft:0}}})),Gi=n(71);Number.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e};var Ui=function(e){function t(t){var n=e.call(this,t)||this;return n.currentValue=n.props.value+n.props.unit,n.lastCommitValue=n.currentValue,n.state={value:n.currentValue},n.onValueChange=n.onValueChange.bind(n),n.onIncrement=n.onIncrement.bind(n),n.onDecrement=n.onDecrement.bind(n),n.validateAndCommitCurrentValue=n.validateAndCommitCurrentValue.bind(n),n}return Object(p.__extends)(t,e),t.prototype.componentWillReceiveProps=function(e){e.needCommit&&this.validateAndCommitCurrentValue(),this.lastCommitValue!==e.value&&(this.currentValue=e.value+e.unit,this.lastCommitValue=this.currentValue,this.setState({value:this.currentValue}))},t.prototype.componentWillUnmount=function(){this.validateAndCommitCurrentValue()},t.prototype.render=function(){return d.createElement(Ot.b,{id:this.props.id,value:this.state.value,disabled:this.props.disabled,styles:Vi(this.props.labelOnLeft),label:this.props.label,labelPosition:this.props.labelOnLeft?Gi.a.start:Gi.a.end,incrementButtonIcon:{iconName:r.a.CommonControlChevronUp_8},decrementButtonIcon:{iconName:r.a.CommonControlChevronDown_8},min:this.props.min,max:this.props.max,onChange:this.onValueChange,onIncrement:this.onIncrement,onDecrement:this.onDecrement,onBlur:this.validateAndCommitCurrentValue,onValidate:this.validateAndCommitCurrentValue})},t.prototype.getNumberValue=function(e,t){if(""===e.trim())return null;if(""===this.props.unit){var n=Number(e);return isNaN(n)||t&&!Number.isInteger(n)?null:n}var o=e.replace(/\s+/g,""),i=t?parseInt(o,10):parseFloat(o);return i.toString()===o||i.toString()+this.props.unit===o?i:null},t.prototype.isNumberInRange=function(e){return e<=this.props.max&&e>=this.props.min},t.prototype.onValueChange=function(e){this.currentValue=e.target.value||""},t.prototype.commitValue=function(e){this.props.onSettingChange?(this.lastCommitValue=this.currentValue,this.props.onSettingChange(this.props.actionType,"",e)):this.props.onSettingChangeWithFloat&&(this.lastCommitValue=this.currentValue,this.props.onSettingChangeWithFloat(this.props.actionType,"",this.props.isInteger?e:0,this.props.isInteger?0:e))},t.prototype.processFloat=function(e,t){return parseFloat(this.toFixedHelper(e,t))},t.prototype.toFixedHelper=function(e,t){return(Math.round(e*Math.pow(10,t))/Math.pow(10,t)).toFixed(t)},t.prototype.validateAndCommitCurrentValue=function(){if(this.currentValue!==this.lastCommitValue&&(""===this.props.unit||this.currentValue+this.props.unit!==this.lastCommitValue)){var e=this.getNumberValue(this.currentValue,this.props.isInteger);if(null===e||!this.isNumberInRange(e))return this.currentValue=this.lastCommitValue,void this.setState({value:this.currentValue});this.props.isInteger||(e=this.processFloat(e,this.props.precision)),this.currentValue=e.toString()+this.props.unit,this.setState({value:this.currentValue}),this.commitValue(e)}},t.prototype.onIncrement=function(e){var t=this.getNumberValue(e,this.props.isInteger);null!==t&&this.isNumberInRange(t+this.props.step)&&(t+=this.props.step,this.props.isInteger||(t=this.processFloat(t,this.props.stepPrecision)),this.currentValue=t.toString()+this.props.unit,this.setState({value:this.currentValue}),this.commitValue(t))},t.prototype.onDecrement=function(e){var t=this.getNumberValue(e,this.props.isInteger);null!==t&&this.isNumberInRange(t-this.props.step)&&(t-=this.props.step,this.props.isInteger||(t=this.processFloat(t,this.props.stepPrecision)),this.currentValue=t.toString()+this.props.unit,this.setState({value:this.currentValue}),this.commitValue(t))},t}(d.PureComponent),Ki=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=xi();return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.PivotTableSettingsLayoutSectionHeader,divId:"layoutSection",paneId:"pivotTableSettings",collapse:!this.props.expandByDefault}),d.createElement("div",{id:"layoutSection",className:Ii(this.props.expandByDefault)},d.createElement("div",{className:e.firstRoot},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsLayoutColumnsGroupHeader),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsLayoutColumnsSeparate,id:"compactOff",actionType:19,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsLayoutCompact,id:"compactOn",actionType:19,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),d.createElement(Ui,{id:"indentIncrement",value:this.props.indentIncrement.toString(),min:0,max:127,step:1,stepPrecision:0,label:ExcelRibbonStrings.PivotTableSettingsLayoutCompactIndent,labelOnLeft:!1,disabled:this.props.hasLessThanTwoRowFields,isInteger:!0,precision:0,unit:"",actionType:20,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})),d.createElement("div",{className:e.root},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsLayoutItemLabelsGroupHeader),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsLayoutRepeatLabels,id:"repeatLabelOn",actionType:4,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsLayoutDoNotRepeatLabels,id:"repeatLabelOff",actionType:4,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields})),d.createElement("div",{className:e.root},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsLayoutBlankLineGroupHeader),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsLayoutBlankLine,id:"blankLineOn",actionType:5,valueToSet:1,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}),d.createElement(Wi,{label:ExcelRibbonStrings.PivotTableSettingsLayoutNoBlankLine,id:"blankLineOff",actionType:5,valueToSet:0,onSettingChange:this.props.onSettingChange,disabled:this.props.hasLessThanTwoRowFields}))))},t}(d.PureComponent),qi=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.PivotTableSettingsRefreshSaveSectionHeader,divId:"refreshAndSave",paneId:"pivotTableSettings",collapse:!this.props.expandByDefault}),d.createElement("div",{id:"refreshAndSave",className:Ii(this.props.expandByDefault)},d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsRefreshSaveSourceDataWithFile,id:"saveSourceDataWithFile",checked:this.props.saveSourceDataWithFile,actionType:14,onSettingChange:this.props.onSettingChange,disabled:this.props.disableSaveSourceData}),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsRefreshSaveRefreshOnLoad,id:"refreshOnLoad",checked:this.props.refreshOnLoad,actionType:15,onSettingChange:this.props.onSettingChange,disabled:!1})))},t}(d.PureComponent),Qi=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=xi();return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.PivotTableSettingsSortDisplaySectionHeader,divId:"sortAndDisplay",paneId:"pivotTableSettings",collapse:!this.props.expandByDefault}),d.createElement("div",{id:"sortAndDisplay",className:Ii(this.props.expandByDefault)},d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayAutoFit,id:"autoFormatOnUpdate",checked:this.props.autoFormatOnUpdate,actionType:6,onSettingChange:this.props.onSettingChange,disabled:!1}),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayShowExpandCollapse,id:"showDrillIndicators",checked:this.props.showDrillIndicators,actionType:7,onSettingChange:this.props.onSettingChange,disabled:!1}),this.props.isNativePivotTable?null:d.createElement("div",{className:e.root},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.PivotTableSettingsSortDisplayItemsWithNoDataGroupHeader),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayItemsWithNoDataShowOnRows,id:"showItemsWithNoDataOnRw",checked:this.props.showItemsWithNoDataOnRw,actionType:8,onSettingChange:this.props.onSettingChange,disabled:!1}),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayItemsWithNoDataShowOnColumns,id:"showItemsWithNoDataOnCol",checked:this.props.showItemsWithNoDataOnCol,actionType:9,onSettingChange:this.props.onSettingChange,disabled:!1})),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayErrorString,id:"displayErrorString",checked:this.props.displayErrorString,actionType:10,onSettingChange:this.props.onSettingChange,disabled:!1}),d.createElement(Li,{id:"errorString",value:this.props.errorString,disabled:!this.props.displayErrorString,multiline:!1,actionType:12,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged}),d.createElement(Hi,{label:ExcelRibbonStrings.PivotTableSettingsSortDisplayNullString,id:"displayNullString",checked:this.props.displayNullString,actionType:11,onSettingChange:this.props.onSettingChange,disabled:!1}),d.createElement(Li,{id:"nullString",value:this.props.nullString,disabled:!this.props.displayNullString,multiline:!1,actionType:13,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})))},t}(d.PureComponent),Ji=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return null!=this.props.settingsInfo&&d.createElement("div",{className:wi()},d.createElement("div",{className:Si()},d.createElement(Li,{id:"PivotTableName",label:ExcelRibbonStrings.PivotTableSettingsPivotTableName,value:this.props.settingsInfo.pivotTableName,multiline:!1,disabled:!1,actionType:1,onSettingChange:this.props.onSettingChange,needCommit:this.props.isRangeChanged})),d.createElement(Ni,{colGrandTotalOn:this.props.settingsInfo.colGrandTotalOn,rwGrandTotalOn:this.props.settingsInfo.rwGrandTotalOn,onSettingChange:this.props.onSettingChange,expandByDefault:this.props.expandAllByDefault,hasLessThanTwoRowFields:this.props.hasLessThanTwoRowFields}),d.createElement(Ki,{indentIncrement:this.props.settingsInfo.indentIncrement,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,expandByDefault:this.props.expandAllByDefault,hasLessThanTwoRowFields:this.props.hasLessThanTwoRowFields}),d.createElement(Qi,{autoFormatOnUpdate:this.props.settingsInfo.autoFormatOnUpdate,showDrillIndicators:this.props.settingsInfo.showDrillIndicators,showItemsWithNoDataOnRw:this.props.settingsInfo.showItemsWithNoDataOnRw,showItemsWithNoDataOnCol:this.props.settingsInfo.showItemsWithNoDataOnCol,displayErrorString:this.props.settingsInfo.displayErrorString,displayNullString:this.props.settingsInfo.displayNullString,errorString:this.props.settingsInfo.errorString,nullString:this.props.settingsInfo.nullString,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,isNativePivotTable:this.props.isNativePivotTable,expandByDefault:this.props.expandAllByDefault}),d.createElement(qi,{saveSourceDataWithFile:this.props.settingsInfo.saveSourceDataWithFile,refreshOnLoad:this.props.settingsInfo.refreshOnLoad,onSettingChange:this.props.onSettingChange,expandByDefault:this.props.expandAllByDefault,disableSaveSourceData:!this.props.isNativePivotTable}),d.createElement(Mi,{altText:this.props.settingsInfo.altText,altTextSummary:this.props.settingsInfo.altTextSummary,onSettingChange:this.props.onSettingChange,isRangeChanged:this.props.isRangeChanged,expandByDefault:this.props.expandAllByDefault}))},t}(d.Component),Yi={height:"100%",display:"contents"},Xi={root:{padding:"0px 16px",fontSize:"14px",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif'},label:{padding:"0px",fontWeight:"600",height:"28px",width:"100%"}},Zi=(Object(P.eb)({marginTop:"24px",width:"303px",position:"fixed",zIndex:1,background:G.a.gray30}),Object(P.eb)({height:"24px",paddingLeft:"16px"}),n(1577)),$i=n(1738),er=n(1576),tr=n(786),nr=n(32),or=n(346),ir={root:"ms-CardItem"},rr={padding:0},ar={margin:0},sr=Object(er.a)((function(e){var t=Object(tr.b)(e,{root:H.a.Item});return Object(tr.c)(t.root,Object(p.__assign)({},e))}),{displayName:"CardItem",styles:function(e,t,n){var o=Object(P.R)(ir,t);return{root:[t.fonts.large,o.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[rr,e.fill&&ar]}}),lr={root:"ms-CardSection"},cr={padding:0},ur={margin:0},pr=Object(er.a)((function(e){var t=e.children,n=Object(p.__rest)(e,["children"]);if(d.Children.count(t)<1)return null;var o=Object(tr.b)(e,{root:H.a});return Object(tr.c)(o.root,Object(p.__assign)({},n),t)}),{displayName:"CardSection",styles:function(e,t,n){var o=Object(P.R)(lr,t);return{root:[t.fonts.large,o.root,{margin:n.margin,padding:n.padding}]}},tokens:function(e,t){return[cr,e.fill&&ur]}});function dr(e){return!!e&&"object"==typeof e&&!!e.type}var hr={root:"ms-Card"},gr=function(e,t){return{boxShadow:t.effects.elevation4,childrenGap:12,childrenMargin:0,cursor:"default",height:"inherit",highContrastBoxShadow:"0 1.6px 3.6px 0 Highlight, 0 0.3px 0.9px 0 Highlight",minHeight:"348px",minWidth:"212px",maxWidth:"286px"}},mr={height:"auto",minWidth:"300px",maxWidth:"500px"},br=function(e,t){var n=t.effects;return{borderFocused:"1px solid black",boxShadowFocused:n.elevation8,boxShadowHovered:n.elevation8,cursor:"pointer",highContrastBoxShadowHovered:"0 3.2px 7.2px 0 Highlight, 0 0.6px 1.8px 0 Highlight"}},fr={Item:sr,Section:pr},yr=Object(er.a)((function(e){var t=Object(tr.b)(e,{root:H.a}),n=e.children,o=(e.styles,e.tokens),i=e.horizontal,r=e.onClick,a=e.onKeyDown,s=Object(p.__rest)(e,["children","styles","tokens","horizontal","onClick","onKeyDown"]),l=Object(nr.j)(s,nr.k),c=o&&o.childrenGap,u=o&&o.childrenMargin,h=d.Children.count(n),g=d.Children.map(n,(function(e,t){if(!e)return null;var n,o=dr(n=e)&&n.type.displayName===sr.displayName,r=function(e){return dr(e)&&e.type.displayName===pr.displayName}(e);if(o||r){if(!c&&!u)return e;var a=e.props,s=a.fill,l=a.tokens,g=Object(p.__rest)(a,["fill","tokens"]),m=0;if(u&&!s){var b=0===t?u:0,f=t===h-1?u:0;m=i?u+"px "+f+"px "+u+"px "+b+"px":b+"px "+u+"px "+f+"px"}var y=Object(p.__assign)({margin:m,childrenGap:r?c:void 0},l);return d.cloneElement(e,Object(p.__assign)({tokens:y},g))}return Object(or.b)("The children of a Card component should be of type CardItem or CardSection."),e}));return Object(tr.c)(t.root,Object(p.__assign)({onClick:r,onKeyDown:function(e){a?a(e):r&&e&&(e.which===R.a.enter||e.which===R.a.space)&&(r(),e.preventDefault())},role:r?"button":"presentation",tabIndex:r?0:-1},l,{horizontal:i,horizontalAlign:i?"start":"stretch",tokens:o,verticalAlign:"start",verticalFill:!0}),g)}),{displayName:"Card",styles:function(e,t,n){var o,i,r;return{root:[Object(P.R)(hr,t).root,{borderRadius:"2px",boxShadow:n.boxShadow,cursor:n.cursor,height:n.height,maxWidth:n.maxWidth,minWidth:n.minWidth,outline:"none",transition:"box-shadow 0.5s ease",width:n.width,selectors:(o={":focus":{border:n.borderFocused,boxShadow:n.boxShadowFocused,selectors:(i={},i[P.l]={boxShadow:n.highContrastBoxShadowFocused},i)},":hover":{boxShadow:n.boxShadowHovered,selectors:(r={},r[P.l]={boxShadow:n.highContrastBoxShadowHovered},r)}},o[P.l]={boxShadow:n.highContrastBoxShadow},o)}]}},tokens:function(e,t){return[gr,e.horizontal&&mr,e.onClick&&br]},statics:fr}),vr=n(12),Cr={childrenGap:2,margin:"0px 6px"},xr={root:{width:"80%"}},Sr=Object(In.c)((function(e){return{root:[{float:"left",padding:"0",width:"97%"}],label:[e&&{whiteSpace:"nowrap",fontWeight:"600",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",padding:"0px 0px 2px 0px",position:"relative",width:"100%"},!e&&{whiteSpace:"nowrap",fontWeight:"normal",overflow:"hidden",textOverflow:"ellipsis",marginTop:"0px",marginLeft:"7px",padding:"0px 0px 0px 0px",fontSize:"12px"}]}})),Er={height:"22px",width:"22px"},wr={width:20,height:20,alignItems:"center",paddingRight:0,paddingLeft:"5px"},kr=function(e){function t(t){var n=e.call(this,t)||this;return n.getErrorString=function(e){switch(e){case 3:return ExcelRibbonStrings.DownloadFailed;case 4:return ExcelRibbonStrings.DownloadDidNotComplete;case 1:return ExcelRibbonStrings.LoadToWorksheetFailed;case 2:return ExcelRibbonStrings.LoadToDataModelFailed;default:return v.a.sendTraceTag(574374984,C.a.msoulscat_ES_EWAJS,$.a.Error,"QueryErrorComponent: Unknown query error"),""}},n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement($i.a,{type:"AppLabelProps",id:"QueryError-"+this.props.id,forId:"QueryError-"+this.props.id,label:this.getErrorString(this.props.query.queryError),styles:Sr(!1),iconProps:{iconName:T.a.AlertWarning_20,style:wr}})},t}(d.Component),Tr=n(1699),Ir=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onRefresh=function(){},t.onMoveToGroup=function(){},t.getMenuDefinition=function(){var e={sections:[{controls:[]}]};return e.sections[0].controls.push({type:"AppButtonProps",label:"Refresh",id:"RefreshButton",title:ExcelRibbonStrings.Refresh,icon:T.a.Sync_20,onExecute:t.onRefresh,disabled:!0}),e.sections[0].controls.push({type:"AppButtonProps",label:"Move To Group",id:"MoveToGroupButton",disabled:!0,onExecute:t.onMoveToGroup}),e},t.controlInMenuRendererFunction=Object(vo.e)(Co.a,Object(Tr.a)()),t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(yr.Item,null,d.createElement(co,{id:"QueryContainerTaskPaneEllipsesFlyoutId-"+this.props.id,title:ExcelRibbonStrings.OverflowWellLabel,label:ExcelRibbonStrings.OverflowWellLabel,type:"AppFlyoutAnchorProps",hideLabel:!0,hideChevron:!0,directionalHint:A.DirectionalHint.bottomRightEdge,icon:r.a.HintBarEllipses_20,menuDefinition:this.getMenuDefinition(),controlInMenuRendererFunction:this.controlInMenuRendererFunction,onAfterMenuDismiss:this.props.onAfterMenuDismiss}))},t}(d.Component),Rr=function(e){function t(t){var n=e.call(this,t)||this;return n.fillObjectTypeToString=function(e){switch(e){case 1:return ExcelRibbonStrings.LoadedToConnectionOnly;case 0:return ExcelRibbonStrings.LoadedToTable;case 2:return ExcelRibbonStrings.LoadedToPivotTable;case 3:return ExcelRibbonStrings.LoadedToPivotChart;default:return v.a.sendTraceTag(573191066,C.a.msoulscat_ES_EWAJS,$.a.Error,"QueryProperties: Unknown fill object type"),""}},n.onHover=function(){n.setState({isHovered:!0})},n.onNotHover=function(){n.setState({isHovered:!1})},n.onFocus=function(){n.setState({isFocused:!0})},n.onBlur=function(){n.setState({isFocused:!1})},n.getLoadedToRow=function(e,t){return e?t.loadedToDataModel?ExcelRibbonStrings.LoadedTo.replace("{0}",ExcelRibbonStrings.DataModel):n.fillObjectTypeToString(t.fillObjectType):t.loadedToDataModel?ExcelRibbonStrings.LoadedToDataModel.replace("{0}",n.fillObjectTypeToString(t.fillObjectType)):ExcelRibbonStrings.LoadedTo.replace("{0}",n.fillObjectTypeToString(t.fillObjectType))},n.state={isHovered:!1,isFocused:!1},n}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){if(1===this.props.id){var e=document.getElementById("PowerQueryContainerId-1");e&&e.focus()}},t.prototype.render=function(){var e,t,n,o=0!==this.props.query.queryError,i=1===this.props.query.fillObjectType;return d.createElement(yr,{id:"PowerQueryContainerId-"+this.props.id,horizontal:!0,tokens:Cr,styles:(e=this.props.nestingDepth,{root:{height:"85px",padding:"2px 0px 2px 16px",margin:"3px 0px 3px 0px",boxShadow:"none",background:"none",paddingLeft:16+20*e+"px",selectors:(t={},t[":hover"]=[{backgroundColor:"#EBEBEB"},vr.o],t[":focus"]={border:"1px solid "+G.a.black,selectors:(n={},n[":focus"]=[{backgroundColor:"#E0E0E0"},vr.o],n[":focus:hover"]=[{backgroundColor:"#D6D6D6"},vr.o],n[":active"]=[{backgroundColor:"#D6D6D6"},vr.o],n)},t)}}),"data-is-focusable":!0,onFocus:this.onFocus,onBlur:this.onBlur,onMouseOver:this.onHover,onMouseLeave:this.onNotHover},d.createElement(yr.Item,null,d.createElement(I.a,{style:Er,iconName:T.a.Table_20})),d.createElement(yr.Section,{styles:xr},d.createElement(Zi.a,null,d.createElement($i.a,{type:"AppLabelProps",id:"QueryName-"+this.props.id,forId:"QueryName-"+this.props.id,label:this.props.query.name,styles:Sr(!0),customTooltip:this.props.query.name})),o?d.createElement(kr,{query:this.props.query,id:this.props.id}):(!i||this.props.query.loadedToDataModel)&&d.createElement($i.a,{type:"AppLabelProps",id:"QueryRowsLoaded-"+this.props.id,forId:"QueryRowsLoaded-"+this.props.id,label:this.props.query.rowsLoaded>1?ExcelRibbonStrings.QueryRowsLoaded.replace("{0}",(new Intl.NumberFormat).format(this.props.query.rowsLoaded)):ExcelRibbonStrings.QueryRowLoaded,styles:Sr(!1)}),d.createElement($i.a,{type:"AppLabelProps",id:"QueryLastRefreshed-"+this.props.id,forId:"QueryLastRefreshed-"+this.props.id,label:ExcelRibbonStrings.QueryLastRefreshed.replace("{0}",new Date(this.props.query.lastRefresh).toLocaleString()),styles:Sr(!1)}),d.createElement($i.a,{type:"AppLabelProps",id:"QueryLoadedTo-"+this.props.id,forId:"QueryLoadedTo-"+this.props.id,label:this.getLoadedToRow(i,this.props.query),styles:Sr(!1)})),Object(ge.d)("PowerQueryTaskPaneQueryGroups")&&(this.state.isFocused||this.state.isHovered)&&d.createElement(Ir,{id:this.props.id,onAfterMenuDismiss:this.onBlur}))},t}(d.Component),Or=n(1151),Pr=function(e){function t(t){var n=e.call(this,t)||this;return n.subGroupOtherQueriesPrefix="SubGroupOtherQueries-",n.onRenderListItem=function(e,t,o){if(void 0!==t){var i=ExcelRibbonStrings.QueryAriaLabel.replace("{0}",(o+1).toString()).replace("{1}",n.props.queries.length.toString());return d.createElement("div",{"aria-label":i},d.createElement(Rr,{query:t,id:void 0!==o?o+1:0,nestingDepth:t.nestingDepth}))}},n.onRenderGroup=function(e,t){var o,i;return(null===(o=null==e?void 0:e.group)||void 0===o?void 0:o.name)&&-1!==(null===(i=null==e?void 0:e.group)||void 0===i?void 0:i.name).search(n.subGroupOtherQueriesPrefix)?d.createElement(d.Fragment,null," "):t(e)},n.groupProps={onRenderShowAll:n.onRenderGroup,onRenderFooter:n.onRenderGroup,onRenderHeader:n.onRenderGroup},n.onRenderListItem=n.onRenderListItem.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Or.a,{items:this.props.queries,onRenderCell:this.onRenderListItem,selectionMode:Vo.c.none,focusZoneProps:{isCircularNavigation:!1,preventDefaultWhenHandled:!1,direction:Ln.a.vertical},groups:this.props.groups,groupProps:this.groupProps,compact:!0})},t}(d.Component),Fr=n(1782),Dr=function(e){function t(t){var n=e.call(this,t)||this;return n.getQueriesCountLabel=function(e){return 1===e?ExcelRibbonStrings.OneQueryTaskpaneHeadline:ExcelRibbonStrings.QueriesCountTaskpaneHeadline.replace("{0}",e.toString())},n.filterQueries=function(){var e;return null===(e=n.props.queries)||void 0===e?void 0:e.filter((function(e,t){return!(!e||!e.name)||(v.a.sendTraceTag(572326940,C.a.msoulscat_ES_EWAJS,$.a.Error,"PowerQueryTaskPane.ctor: Unknown query name in index"+t),!1)}))},n.filterGroups=function(){var e;return null===(e=n.props.groups)||void 0===e?void 0:e.filter((function(e,t){return!!(e&&e.name&&e.key)||(v.a.sendTraceTag(571610240,C.a.msoulscat_ES_EWAJS,$.a.Error,"PowerQueryTaskPane.ctor: Unknown group name or key in index"+t),!1)}))},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.filterQueries(),t=this.filterGroups();return d.createElement("div",null,null==e&&d.createElement("div",{className:Object(P.eb)({display:"flex",height:"70%",justifyContent:"center",alignItems:"center"})},d.createElement(Fr.a,{type:"AppSpinnerProps",id:"PowerQueryTaskPaneSpinner",appColors:Object(a.a)(),label:ExcelRibbonStrings.SpinnerLoadingLabel})),null!=e&&d.createElement("div",{"aria-live":"assertive","aria-label":ExcelRibbonStrings.QueriesTaskpaneAriaLabel,style:Yi},d.createElement($i.a,{type:"AppLabelProps",id:"QueriesCount",forId:"QueriesCount-"+e.length,label:this.getQueriesCountLabel(e.length),styles:Xi}),d.createElement(Pr,{queries:e,groups:t})))},t}(d.Component),_r=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.PivotTableSettingsAltTextSectionHeader,divId:"slicerAltTextSection",paneId:"slicerSettings",collapse:!1}),d.createElement("div",{id:"slicerAltTextSection",className:Ii(!0)},d.createElement(Pe.a,{className:Ri()},ExcelRibbonStrings.SlicerSettingsAltTextSectionDescription),d.createElement(Li,{id:"altTextTitle",label:ExcelRibbonStrings.PivotTableSettingsAltTextTitle,value:this.props.altTextTitle,multiline:!1,disabled:!1,actionType:14,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(Li,{id:"altTextDescription",label:ExcelRibbonStrings.PivotTableSettingsAltTextDescription,value:this.props.altTextDescription,multiline:!0,disabled:!1,actionType:15,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})))},t}(d.PureComponent),jr=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.SlicerSettingsPropertiesSectionHeader,divId:"slicerProperties",paneId:"slicerSettings",collapse:!1}),d.createElement("div",{id:"slicerProperties",className:Ii(!0)},d.createElement(Hi,{label:ExcelRibbonStrings.SlicerSettingsPrintObject,id:"slicerPrintObject",checked:this.props.printObject,actionType:12,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),d.createElement(Hi,{label:ExcelRibbonStrings.SlicerSettingsLock,id:"slicerLocked",checked:this.props.isLocked,actionType:13,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1})))},t}(d.PureComponent),Br={root:{marginTop:"24px",selectors:{".ms-ChoiceField-wrapper":{minHeight:"24px",marginTop:0},".ms-ChoiceField":[bi,{minHeight:"24px"}],".ms-ChoiceField .ms-ChoiceFieldLabel":[hi,{fontSize:"12px",paddingLeft:"22px"}],".ms-ChoiceField-field::before, .ms-ChoiceField-field:hover::before":{width:"16px",height:"16px",borderColor:G.a.gray110,top:"2px"},".ms-ChoiceField-field:hover::after, .ms-ChoiceField-field:focus::after, .ms-ChoiceField-field.is-checked::after":{width:"8px",height:"8px",top:"6px",left:"4px",borderColor:G.a.gray130},".ms-ChoiceField-field.is-checked::after":{borderWidth:"4px"}}}},Lr=n(899),Mr=function(e){function t(t){var n=e.call(this,t)||this;return n.state={selectedKey:n.props.selectedKey},n.onChoiceChange=n.onChoiceChange.bind(n),n}return Object(p.__extends)(t,e),t.prototype.componentWillReceiveProps=function(e){this.state.selectedKey!==e.selectedKey&&this.setState({selectedKey:e.selectedKey})},t.prototype.render=function(){return d.createElement(Lr.a,{id:this.props.id,selectedKey:this.state.selectedKey,options:this.props.options,styles:Br,onChange:this.onChoiceChange})},t.prototype.onChoiceChange=function(e,t){void 0!==t&&(this.setState({selectedKey:t.key}),this.props.onSettingChangeWithFloat&&this.props.onSettingChangeWithFloat(this.props.actionType,"",Number(t.key),0))},t}(d.Component),Ar=function(e){function t(t){return e.call(this,t)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=xi();return d.createElement("div",null,d.createElement(Oi,{displayName:ExcelRibbonStrings.SlicerSettingsSizePositionSectionHeader,divId:"sizeAndPositionSection",paneId:"slicerSettings",collapse:!1}),d.createElement("div",{id:"sizeAndPositionSection",className:Ii(!0)},d.createElement("div",{className:e.firstRoot},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.SlicerSettingsButtonSettingsGroupHeader),d.createElement(Ui,{id:"buttonsPerRow",value:this.props.buttonsPerRow.toString(),min:1,max:2e4,step:1,stepPrecision:0,label:ExcelRibbonStrings.SlicerSettingsButtonNumberPerRow,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!0,precision:0,unit:"",actionType:3,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(Ui,{id:"buttonHeight",value:this.props.buttonHeight.toString(),min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsHeight,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:'"',actionType:4,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(Ui,{id:"buttonWidth",value:this.props.buttonWidth.toString(),min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsWidth,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:'"',actionType:5,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),d.createElement("div",{className:e.root},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.SlicerSettingsSlicerSizeGroupHeader),d.createElement(Ui,{id:"slicerHeight",value:this.props.slicerHeight.toString(),min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsHeight,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:'"',actionType:6,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(Ui,{id:"slicerWidth",value:this.props.slicerWidth.toString(),min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsWidth,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:'"',actionType:7,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),d.createElement("div",{className:e.root},d.createElement(Pe.a,{className:e.label},ExcelRibbonStrings.SlicerSettingsSlicerPositionGroupHeader),d.createElement(Ui,{id:"horizontalPosition",value:this.props.horizontal.toString(),min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsHorizontalPosition,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:'"',actionType:8,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(Ui,{id:"verticalPosition",value:this.props.vertical.toString(),min:0,max:2348,step:.1,stepPrecision:1,label:ExcelRibbonStrings.SlicerSettingsVerticalPosition,labelOnLeft:!0,disabled:this.props.disableResizeAndMove,isInteger:!1,precision:2,unit:'"',actionType:9,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})),d.createElement(Hi,{label:ExcelRibbonStrings.SlicerSettingsDisableResizeAndMove,id:"disableResizeAndMove",checked:this.props.disableResizeAndMove,actionType:10,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),d.createElement(Mr,{id:"slicerAnchorType",actionType:11,selectedKey:this.props.slicerAnchorType.toString(),options:[{key:(0).toString(),text:ExcelRibbonStrings.SlicerSettingsMoveAndSizeWithCells},{key:1..toString(),text:ExcelRibbonStrings.SlicerSettingsMoveButDoNotSizeWithCells},{key:2..toString(),text:ExcelRibbonStrings.SlicerSettingsDoNotMoveOrSizeWithCells}],onSettingChangeWithFloat:this.props.onSettingChangeWithFloat})))},t}(d.PureComponent),Wr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.settingsInfo;return null!=e&&d.createElement("div",{className:wi()},d.createElement("div",{className:Si()},d.createElement(Li,{id:"slicerCaption",label:ExcelRibbonStrings.SlicerSettingsTitle,value:e.caption,multiline:!1,disabled:!1,actionType:1,needCommit:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(Hi,{id:"displaySlicerHeader",label:ExcelRibbonStrings.SlicerSettingsShowHeader,checked:e.displayHeader,actionType:2,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat,disabled:!1}),d.createElement(Pe.a,{className:Ei()},ExcelRibbonStrings.SlicerSettingsDataSource+": "+e.dataSource),d.createElement(Pe.a,{className:Ei()},ExcelRibbonStrings.SlicerSettingsName+": "+e.name)),d.createElement(Ar,{buttonsPerRow:e.buttonsPerRow,buttonHeight:e.buttonHeight,buttonWidth:e.buttonWidth,slicerHeight:e.height,slicerWidth:e.width,horizontal:e.horizontalPosition,vertical:e.verticalPosition,disableResizeAndMove:e.disableResizeAndMove,slicerAnchorType:e.anchorType,isSlicerSwitched:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(jr,{printObject:e.printObject,isLocked:e.locked,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}),d.createElement(_r,{altTextTitle:e.altTextTitle,altTextDescription:e.altTextDescription,isSlicerSwitched:this.props.isSlicerSwitched,onSettingChangeWithFloat:this.props.onSettingChangeWithFloat}))},t}(d.Component),zr={boxSizing:"content-box",fontSize:"12px",fontStretch:"normal",fontStyle:"normal",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',lineHeight:"normal",fontWeight:600,letterSpacing:"normal",textAlign:"left"};function Hr(){return Object(a.a)().primary}var Nr,Vr,Gr,Ur,Kr,qr,Qr,Jr,Yr={color:Hr(),textAlign:"center"},Xr={root:{height:"50%",margin:"auto"},label:[zr,Yr]},Zr=n(900),$r={selectors:(Nr={},Nr[P.l]={outline:"1px solid Highlight",color:"Highlight"},Nr)},ea={background:"#edebe9",border:"1px solid #c8c6c4",borderRadius:"2px",fontWeight:"normal",overflowY:"auto",height:"80%",minHeight:"31px",maxHeight:"61px",boxSizing:"border-box",color:"#252423",padding:"4px"},ta={color:"#323130",fontSize:"12px",paddingTop:"2px",marginBottom:"6px"},na=function(){return Object(P.eb)({display:"flex",flexDirection:"column",height:"15%",maxHeight:"85px"})},oa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.misspelledWorBoxRootClassName=na(),t.misspelledWordBox=d.createRef(),t.cellContent=d.createRef(),t.misspelledWord=d.createRef(),t.scrollSelectedItemIntoView=function(){t.misspelledWord&&t.misspelledWord.current&&t.misspelledWord.current.scrollIntoView({block:"center"})},t}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){this.scrollSelectedItemIntoView()},t.prototype.componentDidUpdate=function(){this.scrollSelectedItemIntoView()},t.prototype.render=function(){var e=this.processSearchQuery(this.props),t=e.preMisspelledWordText,n=e.misspelledWordText,o=e.postMisspelledWordText,i=function(){var e;return{cellContent:Object(P.eb)([zr,ea,{selectors:(e={},e[":focus"]=Object(p.__assign)({outline:"none",border:"1px solid #323130 "},$r),e)}]),misspelledWord:Object(P.eb)({backgroundImage:"url('data:image/gif;base64,R0lGODlhBQAEAJECAP////8AAAAAAAAAACH5BAEAAAIALAAAAAAFAAQAAAIIlGAXCCHrTCgAOw==')",backgroundPosition:"bottom left",backgroundRepeat:"repeat-x"}),misspelledWordTitle:Object(P.eb)(zr,ta)}}(),r=1===this.props.misspelledWordType?ExcelRibbonStrings.SpellCheckRepeatedWordText:ExcelRibbonStrings.SpellCheckNotInDictionaryText;return d.createElement("div",{ref:this.misspelledWordBox,className:this.misspelledWorBoxRootClassName},d.createElement("div",{className:i.misspelledWordTitle},r),d.createElement("div",{id:"SpellCheckTaskPaneCellContentId",tabIndex:0,ref:this.cellContent,className:i.cellContent,role:"text","aria-label":ExcelRibbonStrings.SpellCheckAriaSpellingErrorText+". "+r+". "+n+". "+ExcelRibbonStrings.SpellCheckAriaOriginalSentenceText+". "+ExcelRibbonStrings.SpellCheckAriaReadOnlyText+". "+this.props.misspelledWordCellContent},t,d.createElement("span",{ref:this.misspelledWord,className:i.misspelledWord},n),o))},t.prototype.processSearchQuery=function(e){var t="",n="",o="";if(e){var i=e.misspelledWordCellContent,r=e.misspelledWordBeginIndex,a=e.misspelledWordEndIndex;t=i?i.substring(0,r):"",n=i?i.substring(r,a):"",o=i?i.substring(a):""}else v.a.shipAssertTag(595731299,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane Invalid data received.");return{preMisspelledWordText:t,misspelledWordText:n,postMisspelledWordText:o}},t.prototype.focus=function(){this.misspelledWordBox&&this.misspelledWordBox.current&&this.misspelledWordBox.current.focus()},t}(d.PureComponent),ia=n(924),ra={root:(Vr={height:"26px",background:"#ffffff",border:"1px solid #bebbb8",marginRight:"8px",marginTop:"9px",minWidth:"87px",width:"auto"},Vr[P.l]={MsHighContrastAdjust:"auto"},Vr),rootHovered:{backgroundColor:"#e1dfdd",commonHighContrastHoverFocusStyles:vr.o},rootPressed:{backgroundColor:"#c8c6c4"},rootFocused:{border:"1px solid #323130 ",backgroundColor:"#c8c6c4",commonHighContrastHoverFocusStyles:vr.o},label:[zr,{marginLeft:"0px",marginRight:"0px",textAlign:"center"}]},aa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onIgnoreButtonExecute=function(){t.props.showSpinner(),t.props.onIgnoreButtonExecute?t.props.onIgnoreButtonExecute():v.a.shipAssertTag(595730589,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onIgnoreButtonExecute not set.")},t.onIgnoreAllOrDeleteButtonExecute=function(){t.props.showSpinner(),t.props.onIgnoreAllOrDeleteButtonExecute?t.props.onIgnoreAllOrDeleteButtonExecute():v.a.shipAssertTag(595730590,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onIgnoreAllButtonExecute not set.")},t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{height:"auto",width:"100%",marginBottom:"24px"}},d.createElement(ia.a,{id:"SpellCheckTaskPaneIgnoreButtonId",type:"AppButtonProps",label:ExcelRibbonStrings.SpellCheckIgnoreButtonText,onExecute:this.onIgnoreButtonExecute,styles:ra,disabled:this.props.disableButtons}),d.createElement(ia.a,{id:"SpellCheckTaskPaneIgnoreAllButtonId",type:"AppButtonProps",label:1===this.props.misspelledWordType?ExcelRibbonStrings.SpellCheckDeleteRepeatedWordButtonText:ExcelRibbonStrings.SpellCheckIgnoreAllButtonText,onExecute:this.onIgnoreAllOrDeleteButtonExecute,styles:ra,disabled:this.props.disableButtons}))},t}(d.PureComponent),sa={width:"100%",color:"#323130",fontSize:"12px",background:"#edebe9"},la={border:"1px solid #bebbb8",boxSizing:"border-box",fontWeight:"normal",padding:"5px",textAlign:"left",width:"auto",height:"auto",background:"#ffffff",color:"#252423"},ca={root:{borderRadius:"2px",height:"100%",width:"auto",selectors:(Gr={},Gr[" :focus"]={outline:"none",border:"1px solid #323130 ",selectors:(Ur={},Ur[" .ms-Dropdown-title"]={outline:"none",border:"none",top:"unset !important",left:"unset !important"},Ur)},Gr)},dropdownItem:{selectors:{":hover":{background:"#e1dfdd",commonHighContrastHoverFocusStyles:vr.o},":active":{background:"#c8c6c4"}}},dropdownOptionText:[zr,{fontWeight:"normal"}],dropdownItemsWrapper:{border:"1px solid transparent"},dropdownItemSelected:{backgroundColor:"#edebe9"},label:[zr,sa],title:[zr,la]},ua=n(38),pa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.languageList=[],t.state={selectedItem:void 0},t.onSelectedLanguageChanged=function(e,n){t.props.showSpinner(),n&&t.setState({selectedItem:n}),t.props.onLanguageChangeExecute&&n?t.props.onLanguageChangeExecute(n.key.toString()):v.a.shipAssertTag(595730638,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane Error while changing the proofing language.")},t.onRenderCaretDown=function(){return d.createElement(I.a,{iconName:Co.a.downChevron?Co.a.downChevron.icon12:"CommonControlChevronDownGlyph_12",style:{height:"12px",width:"12px"}})},t}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return e&&e.currentLocale?{selectedItem:{key:e.currentLocale.localeId,text:e.currentLocale.localeName}}:null},t.prototype.render=function(){var e=this.state.selectedItem;return 0===this.languageList.length&&this.props.supportedLocaleInfoList&&this.props.supportedLocaleInfoList.length>0&&this.updateSupportedLanguageList(this.props),d.createElement("div",{style:this.props.isLanguageErrorTab?{boxSizing:"border-box",left:"0px",width:"100%"}:{bottom:"26px",boxSizing:"border-box",display:"inline-flex",flexDirection:"column",position:"inherit",width:"100%"}},d.createElement(De.a,{label:ExcelRibbonStrings.SpellCheckDictionaryLanguageText,options:this.languageList,placeholder:ExcelRibbonStrings.SpellCheckLanguageListPlaceHolder,selectedKey:e?e.key:"",onChange:this.onSelectedLanguageChanged,disabled:this.props.disableList,styles:ca,onRenderCaretDown:this.onRenderCaretDown,calloutProps:{calloutMaxHeight:180,bounds:ua.getBoundingWindowWithPaddingFabric}}))},t.prototype.updateSupportedLanguageList=function(e){if(e.supportedLocaleInfoList){for(var t=0,n=e.supportedLocaleInfoList;t<n.length;t++){var o=n[t],i=o?o.localeId:null,r=o?o.localeName:null;i&&r&&this.languageList.push({key:i.toUpperCase(),text:r})}this.languageList.sort(this.compareLocale)}},t.prototype.compareLocale=function(e,t){return e.text.localeCompare(t.text)},t}(d.PureComponent),da=n(1708),ha={root:(Kr={border:"1px solid #bebbb8",background:"#ffffff",boxShadow:"0 2px 4px -0.8px rgba(0, 0, 0, 0.1)",height:"32px",width:"100%",padding:"4px 8px"},Kr[P.l]={MsHighContrastAdjust:"auto"},Kr),rootHovered:{background:"#e1dfdd",commonHighContrastHoverFocusStyles:vr.o},rootPressed:{background:"#c8c6c4"},rootDisabled:{background:"transparent !important",boxShadow:"unset",opacity:.33,border:"1px solid #bebbb8 !important"},label:[zr,{padding:"0px",textOverflow:"ellipsis",overflow:"hidden",margin:"0px"}],splitButtonContainer:{borderRadius:"2px",height:"32px",marginBottom:"9px",width:"100%"},splitButtonContainerDisabled:{selectors:{":focus":{border:"1px solid #323130 "}}},splitButtonDividerDisabled:{height:"0px",width:"0px"},splitButtonDivider:{top:"50%",transform:"translateY(-50%)"},labelDisabled:[zr,{fontWeight:"normal",padding:"0px",textOverflow:"ellipsis",overflow:"hidden",margin:"0px"}],splitButtonContainerFocused:{selectors:(qr={},qr[" .splitPrimaryButton"]={border:"1px solid #323130 ",borderRight:"none !important"},qr[" .splitMenuButton"]={border:"1px solid #323130 ",borderLeft:"none !important"},qr)},splitButtonMenuIconDisabled:{height:"0px",width:"0px"},splitButtonMenuIcon:{height:"12px",width:"12px",margin:"8px 9px"},splitButtonMenuButtonDisabled:{display:"none"},splitButtonMenuButtonExpanded:{background:"#e1dfdd",height:"32px"},textContainer:[zr],splitButtonMenuButton:{background:"#ffffff",border:"1px solid #bebbb8",boxShadow:"2px 2px 4px -0.8px rgba(0, 0, 0, 0.1)",height:"32px",selectors:(Qr={},Qr[P.l]={MsHighContrastAdjust:"auto"},Qr[":hover"]={background:"#e1dfdd",commonHighContrastHoverFocusStyles:vr.o},Qr[":active"]={background:"#c8c6c4"},Qr),width:"auto",minWidth:"32px",marginLeft:"0px"}},ga=n(1701),ma={marginLeft:"0px",marginRight:"0px",textAlign:"center"},ba=Object(In.c)((function(e){return Object(P.db)({root:{height:24,lineHeight:24,selectors:{":hover":{background:"#e1dfdd"},":active":{background:"#c8c6c4"}}},linkContent:{height:22},icon:{height:16,width:16,lineHeight:16},label:[zr,ma],subMenuIcon:{height:12}},e)})),fa=Object(In.c)((function(e){return function(t){var n=t.controlProps,o=t.location;return n.filter((function(e){return Object(vo.i)(e)>0})).map((function(t){var n=Object(p.__assign)(Object(p.__assign)({},t),{location:o,appStrings:e});switch(n.type){case"AppButtonProps":return Object(vo.b)(Object(ga.a)(n.id,n.location),Object(p.__assign)(Object(p.__assign)({},n),{shouldTakeFocus:void 0===n.shouldTakeFocus||n.shouldTakeFocus}),ba());default:throw new Error("The control of type "+n.type+" is not valid in a  Box menu")}}))}})),ya=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onChangeButtonExecute=function(){t.props.showSpinner(),t.props.onChangeButtonExecute&&t.props.suggestion?t.props.onChangeButtonExecute(t.props.suggestion.changeId):v.a.shipAssertTag(595731297,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onChangeButtonExecute not set.")},t.onChangeAllButtonExecute=function(){t.props.showSpinner(),t.props.onChangeAllButtonExecute&&t.props.suggestion?t.props.onChangeAllButtonExecute(t.props.suggestion.changeAllId):v.a.shipAssertTag(595731298,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onChangeAllButtonExecute not set.")},t.getMenuDefinition=function(){var e="SpellCheckTaskPaneChangeAllId";return t.props.suggestion&&(e+=t.props.suggestion.changeAllId),{sections:[{controls:[{type:"AppButtonProps",id:e,label:ExcelRibbonStrings.SpellCheckChangeAllButtonText,onExecute:t.onChangeAllButtonExecute}]}]}},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.suggestion,t=e?e.suggestionText:"",n=!!this.props.disableButtons&&this.props.disableButtons;return n||t&&0!==t.length||(n=!0),d.createElement(da.a,{styles:ha,id:"SpellCheckTaskPaneSuggestionButtonId",type:"AppSplitButtonProps",onExecute:this.onChangeButtonExecute,label:t||ExcelRibbonStrings.SpellCheckNoSuggestionText,hideLabel:!1,controlInMenuRendererFunction:fa(Object(s.a)()),downChevronIcon:Co.a?Co.a.downChevron:"CommonControlChevronDownGlyph_12",icon:"",menuDefinition:this.getMenuDefinition(),disabled:n,useTargetAsMinWidth:!1,ariaDescription:ExcelRibbonStrings.SpellCheckSuggestionsTitle,ariaRoleDescription:OfficeCommonStrings.SplitButtonRoleDescription})},t}(d.PureComponent),va={color:"#323130",fontSize:"12px",marginTop:"17px",marginBottom:"6px"},Ca={root:{width:"100%",boxSizing:"border-box",margin:"0px",background:"#f5f5f5 !important",display:"flex",justifyContent:"center"},iconContainer:{margin:"4px 4px 4px 4px"},text:[zr,{float:"left",width:"100%",margin:"4px",color:"#201F1E",fontSize:"12px",fontWeight:"normal"}]},xa={root:Object(P.eb)({opacity:.55,background:"transparent",border:"1px solid #bebbb8",height:"136px",marginTop:"4px",marginBottom:"9px",width:"100%",selectors:(Jr={},Jr[":focus"]=Object(p.__assign)({outline:"none",border:"1px solid #323130 "},$r),Jr)}),text:Object(P.eb)([zr,{margin:"0px",padding:"0px",position:"relative",textAlign:"center",top:"50%",transform:"translateY(-50%)"}])},Sa=n(1146),Ea=n(88),wa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.misspelledWordBox=d.createRef(),t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.misspelledWordBoxContent,t=this.props.previousChangeAllActionInfo,n=this.props.suggestionBoxContent,o=!!n&&!!n.suggestions;return d.createElement("div",{className:Object(P.eb)([{height:"100%",display:"flex",flexDirection:"column",minHeight:"500px",overflow:"hidden",paddingLeft:"16px",paddingRight:"16px",position:"relative",animationName:Object(P.bb)({from:{opacity:0},to:{opacity:1}}),animationDuration:"0.25s",animationTimingFunction:"ease-in"}])},d.createElement(oa,{ref:this.misspelledWordBox,misspelledWordType:e?e.misspelledWordType:0,misspelledWordBeginIndex:e?e.misspelledWordBeginIndex:0,misspelledWordEndIndex:e?e.misspelledWordEndIndex:0,misspelledWordCellContent:e?e.misspelledWordCellContent:""}),this.renderSuggestionTitle(this.props),o?this.createSuggestionsView(this.props):this.createNoSuggestionsView(),d.createElement("div",{style:{display:"inline-flex",flexDirection:"column",alignItems:"flex-start",flexGrow:1,marginBottom:"32px"}},d.createElement(aa,Object(p.__assign)({disableButtons:this.props.disableButtons,misspelledWordType:e?e.misspelledWordType:null,showSpinner:this.props.showSpinner},this.props.userActionButtons)),t&&t.changeCount&&d.createElement("div",{style:{width:"100%",background:"#f5f5f5 !important"}},d.createElement(Sa.a,{messageBarType:Ea.a.info,styles:Ca},d.createElement("span",null,ExcelRibbonStrings.SpellCheckPreviousChangeInfoText.replace("{0}",t.changeCount.toString()).replace("{1}",t.suggestionApplied?t.suggestionApplied:""))))),d.createElement(pa,Object(p.__assign)({disableList:this.props.disableButtons,showSpinner:this.props.showSpinner},this.props.localeInfo)))},t.prototype.renderSuggestionTitle=function(e){var t=(e.suggestionBoxContent?e.suggestionBoxContent.suggestions:null)?ExcelRibbonStrings.SpellCheckSuggestionsTitle:ExcelRibbonStrings.SpellCheckNoSuggestionsTitle;return d.createElement("div",{id:"SpellCheckTaskPaneSuggestionsTitleId",role:"heading","aria-level":1,className:Object(P.eb)([zr,va])},t)},t.prototype.createSuggestionsView=function(e){var t=this.props.suggestionBoxContent,n=t?t.suggestions:null;if(n){var o=n.map((function(n){return d.createElement("div",{role:"listitem",key:n.id},d.createElement(ya,{suggestion:n,disableButtons:e.disableButtons,onChangeButtonExecute:t?t.onChangeButtonExecute:null,onChangeAllButtonExecute:t?t.onChangeAllButtonExecute:null,showSpinner:e.showSpinner}))}));return d.createElement("div",{role:"list","aria-label":ExcelRibbonStrings.SpellCheckSuggestionsTitle},o)}return null},t.prototype.createNoSuggestionsView=function(){return d.createElement("div",{tabIndex:0,className:xa.root,"aria-label":ExcelRibbonStrings.SpellCheckSuggestionsTitle+". "+ExcelRibbonStrings.SpellCheckNoSuggestionFoundText},d.createElement("p",{className:xa.text},ExcelRibbonStrings.SpellCheckNoSuggestionFoundText))},t.prototype.focus=function(){this.misspelledWordBox&&this.misspelledWordBox.current&&this.misspelledWordBox.current.focus()},t}(d.PureComponent);function ka(){return Object(a.a)()}var Ta,Ia={root:{backgroundColor:"#ffffff !important",borderRadius:"2px",border:"1px solid #bebbb8",height:"26px",marginTop:"16px"},rootHovered:{backgroundColor:"#e1dfdd"},rootPressed:{backgroundColor:"#c8c6c4"},rootFocused:{border:"1px solid #323130 "},label:[zr,{marginLeft:"0px",marginRight:"0px",textAlign:"center"}]},Ra={fontSize:"14px",fontWeight:"normal",boxSizing:"border-box",paddingLeft:"8px",width:"calc(100% - 35px)"},Oa={root:{marginTop:"24px",padding:"0px",background:"#f5f5f5"},iconContainer:{marginLeft:"4px"},text:[zr,{color:"#201F1E",fontWeight:"normal",fontSize:"12px",float:"left"}]},Pa={link:{color:"#0078D4",textDecoration:"none",":visited":{color:"#0078D4",textDecoration:"none"},":focus":{border:"1px solid #323130 ",outline:"none"}}},Fa=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onRecheckClick=function(){v.a.sendTraceTag(595718999,C.a.msoulscat_ES_EWAJS,$.a.Info,"SpellCheckTaskPane Recheck button clicked on notification on active tab "+t.props.activeTab+" ."),t.props.showSpinner(),t.props.onRecheckExecute?t.props.onRecheckExecute():v.a.shipAssertTag(595718812,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onRecheckExecute not set.")},t.onMessageButtonExecute=function(){v.a.sendTraceTag(595719e3,C.a.msoulscat_ES_EWAJS,$.a.Info,"SpellCheckTaskPane Message button clicked on active tab "+t.props.activeTab+" ."),t.props.showSpinner(),t.props.onButtonExecute?t.props.onButtonExecute(t.props.activeTab):v.a.shipAssertTag(595731296,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane onMessageButtonExecute not set.")},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=Ia,t=!1,n="",o=Object(P.eb)({border:"1px solid transparent",boxSizing:"border-box",fill:ka().primary,float:"left",height:"20px",width:"20px",padding:"auto",display:"inline-flex",marginTop:"1px"}),i=!!this.props.showOutOfSyncNotification&&this.props.showOutOfSyncNotification;switch(i&&5!==this.props.activeTab&&6!==this.props.activeTab&&8!==this.props.activeTab&&(i=!1,v.a.sendTraceTag(595718811,C.a.msoulscat_ES_EWAJS,$.a.Error,"SpellCheckTaskPane Error :: show out of sync notification received on incorrect tab "+this.props.activeTab+" .")),this.props.activeTab){case 3:case 2:t=!0,n=T.a.Info_20;break;case 7:case 4:t=!0,n=T.a.AlertWarning_20,o=Object(P.eb)({border:"1px solid transparent",boxSizing:"border-box",fill:ka().primary,float:"left",height:"20px",width:"20px",padding:"auto",display:"inline-flex",marginTop:"0px"});break;case 6:case 5:case 8:t=!0,n=Co.a?Co.a.checkboxCheckmark:"CheckmarkWithDynamicColor_12",o=Object(P.eb)({borderRadius:"50%",border:"1px solid "+ka().primary,boxSizing:"border-box",fill:ka().primary,float:"left",height:"20px",padding:"auto",display:"inline-flex",width:"20px",marginTop:"4px"})}return d.createElement("div",{className:Object(P.eb)([{display:"flex",flexDirection:"column",justifyContent:"flex-start",marginTop:"5px",paddingLeft:"16px",paddingRight:"16px",animationName:Object(P.bb)({from:{opacity:0},to:{opacity:1}}),animationDuration:"0.25s",animationTimingFunction:"ease-in"}])},d.createElement("div",{style:{display:"flex"}},t&&d.createElement(I.a,{className:o,iconName:n}),0!==this.props.message.length&&d.createElement("div",{className:Object(P.eb)([zr,Ra])},this.props.message)),d.createElement("div",null,4===this.props.activeTab&&this.showSupportedLanguageList()),this.props.showButton&&d.createElement(ia.a,{id:"SpellCheckTaskPaneMessageButtonId",type:"AppButtonProps",label:this.props.buttonLabel,onExecute:this.onMessageButtonExecute,styles:e,disabled:this.props.disableButtons,role:"button",ariaDescription:this.props.message}),d.createElement("div",{role:"alert","aria-live":"polite"},i&&d.createElement(Sa.a,{messageBarType:Ea.a.info,styles:Oa},d.createElement("span",{"aria-hidden":"true",id:"SpellCheckTaskPaneContentChangedId",style:{lineHeight:"normal"}},ExcelRibbonStrings.SpellCheckWorkbookContentChangedText),d.createElement("a",{href:"#",id:"SpellCheckTaskPaneCheckAgainId",onClick:this.onRecheckClick,"aria-labelledby":"SpellCheckTaskPaneContentChangedId SpellCheckTaskPaneCheckAgainId",style:Pa.link,"aria-disabled":!1,role:"button"},ExcelRibbonStrings.SpellCheckCheckAgainText))))},t.prototype.showSupportedLanguageList=function(){return this.props.localeInfo&&this.props.localeInfo.supportedLocaleInfoList&&this.props.localeInfo.supportedLocaleInfoList.length||v.a.shipAssertTag(595730639,C.a.msoulscat_ES_EWAJS,!1,"SpellCheckTaskPane.showSupportedLanguageList Invalid supported language list received."),d.createElement("div",null,d.createElement(pa,{disableList:this.props.disableButtons,showSpinner:this.props.showSpinner,currentLocale:{localeId:"EN-US"},supportedLocaleInfoList:this.props.localeInfo?this.props.localeInfo.supportedLocaleInfoList:null,onLanguageChangeExecute:this.props.localeInfo?this.props.localeInfo.onLanguageChangeExecute:null,isLanguageErrorTab:!0}))},t}(d.PureComponent),Da=n(174),_a=Object(Da.initStopwatchFactory)((function(e){return v.a.sendTraceTag(595657359,C.a.msoulscat_ES_EWAJS,$.a.Info,e)})),ja=function(e){function t(t){var n=e.call(this,t)||this;return n.spellCheck=d.createRef(),n.spellCheckPane=d.createRef(),n.showButtonMessageTab=!1,n.message="",n.buttonLabel="",n.buttonClick=!1,n.showSpinner=function(e){void 0===e&&(e=!0),e&&!n.state.showLoading?n.stopWatch.reset():!e&&n.state.showLoading&&(n.buttonClick=!0),n.setState({showLoading:e,disableButtons:e})},n.state={showLoading:t.showLoadingIcon,disableButtons:!1},n.showSpinner=n.showSpinner.bind(n),n.stopWatch=_a("SpellCheckTaskPane.SpellCheckSpinnerDuration"),n}return Object(p.__extends)(t,e),t.prototype.componentDidMount=function(){this.registerInformationIcon()},t.prototype.componentDidUpdate=function(){if(this.spellCheckPane&&this.spellCheckPane.current&&(this.spellCheckPane.current.scrollTop=0),!this.state.showLoading&&this.buttonClick){var e=this.spellCheckPane.current.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"]), div[data-is-focusable="true"]');e&&e[0]&&e[0].focus()}this.buttonClick&&(this.stopWatch.stop(),this.buttonClick=!1)},t.prototype.componentWillUnmount=function(){this.unRegisterInformationIcon()},t.prototype.componentWillReceiveProps=function(e){e.showLoadingIcon!==this.state.showLoading&&this.showSpinner(e.showLoadingIcon)},t.prototype.render=function(){var e=1===this.props.activeTab;return e||this.createMessageTabTexts(this.props.activeTab,this.props.localeInfoContent?this.props.localeInfoContent.currentLocale:null,this.props.worksheetName),d.createElement("div",{ref:this.spellCheckPane,className:Object(P.eb)({height:"100%",overflowX:"hidden",overflowY:"auto",display:"contents",background:"#edebe9"})},e&&d.createElement(wa,{ref:this.spellCheck,disableButtons:this.state.disableButtons,misspelledWordBoxContent:this.props.misspelledWordBoxContent,suggestionBoxContent:this.props.suggestionBoxContent,userActionButtons:this.props.userActionButtons,localeInfo:this.props.localeInfoContent,showSpinner:this.showSpinner,previousChangeAllActionInfo:this.props.previousChangeAllActionInfo}),!e&&d.createElement(Fa,{message:this.message,disableButtons:this.state.disableButtons,activeTab:this.props.activeTab,showButton:this.showButtonMessageTab,buttonLabel:this.buttonLabel,showSpinner:this.showSpinner,localeInfo:this.props.localeInfoContent,onButtonExecute:this.props.onMessageButtonExecute,showOutOfSyncNotification:this.props.showOutOfSyncNotification,onRecheckExecute:this.props.onRecheckExecute}),this.state.showLoading&&d.createElement(Zr.a,{className:Object(P.eb)({height:"auto",zIndex:2,backgroundColor:"rgba(237, 235, 233, .8)",position:"absolute",marginTop:"44px"})},d.createElement(fo.a,{styles:Xr,className:Object(P.eb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:Hr(),color:Hr(),margin:"0px"}}}),size:yo.a.large,label:ExcelRibbonStrings.SpellCheckSpinnerText})))},t.prototype.createMessageTabTexts=function(e,t,n){switch(this.message="",this.showButtonMessageTab=!1,this.buttonLabel="",e){case 4:var o="";t?o=t.localeName:v.a.sendTraceTag(595730640,C.a.msoulscat_ES_EWAJS,$.a.Error,"SpellCheckTaskPane invalid current locale received."),this.message=ExcelRibbonStrings.SpellCheckLanguageErrorText.replace("{0}",o);break;case 2:this.message=ExcelRibbonStrings.SpellCheckResumeText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckResumeButtonText;break;case 3:this.message=ExcelRibbonStrings.SpellCheckSwitchWorkSheetErrorText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckReCheckButtonText;break;case 6:this.message=ExcelRibbonStrings.SpellCheckCompleteText;break;case 5:this.props.worksheetName||v.a.sendTraceTag(595730641,C.a.msoulscat_ES_EWAJS,$.a.Error,"SpellCheckTaskPane invalid worksheet received."),this.message=ExcelRibbonStrings.SpellCheckSwitchWorkSheetText.replace("{0}",n||""),this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckCheckOtherSheetsButtonText;break;case 8:this.message=ExcelRibbonStrings.SpellCheckCompleteOnRangeText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckReCheckButtonText;break;case 7:default:this.message=ExcelRibbonStrings.SpellCheckErrorText,this.showButtonMessageTab=!0,this.buttonLabel=ExcelRibbonStrings.SpellCheckTryAgainButtonText}},t.prototype.unRegisterInformationIcon=function(){Object(P.nb)(["Info"])},t.prototype.registerInformationIcon=function(){Object(P.jb)({icons:{Info:d.createElement(I.a,{className:Object(P.eb)({boxSizing:"border-box",fill:"#605e5c",float:"left",height:"16px",width:"16px",padding:"auto",display:"inline-flex"}),iconName:T.a.Info_20})}})},t}(d.Component),Ba=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=d.createRef(),t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{style:{position:"relative",height:"100%"},ref:this.container})},t.prototype.componentDidMount=function(){this.container&&this.container.current&&this.container.current.appendChild(this.props.getContent())},t}(d.PureComponent),La=(Ta=function(){return{root:["ExcelLegacyTaskPaneContainer",{height:"100%"}]}}(),{root:Object(P.eb)(Ta.root)}),Ma=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.container=d.createRef(),t}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{className:La.root,ref:this.container})},t.prototype.componentDidMount=function(){this.container&&this.container.current&&this.container.current.appendChild(this.props.getContent())},t}(d.PureComponent);function Aa(e,t,n){return d.createElement("div",{id:"ExcelTaskPaneContentWrapper",style:{position:"relative",height:"100%",overflow:"hidden"}},function(e,t,n){switch(t.type){case"ConditionalFormattingTaskPaneProps":return d.createElement(Tn,Object(p.__assign)({},t));case"DataCleansingTaskPaneProps":return d.createElement(Zn,Object(p.__assign)({},t));case"EmbeddedTaskPaneProps":return d.createElement(Ba,Object(p.__assign)({},t));case"ExcelLegacyTaskPaneWacInfraProps":return d.createElement(Ma,Object(p.__assign)({},t));case"ExternalLinksTaskPaneProps":return d.createElement(Lo,Object(p.__assign)({},t));case"FieldListTaskPaneProps":return d.createElement(di,Object(p.__assign)({},t));case"PivotTableSettingsTaskPaneProps":return d.createElement(Ji,Object(p.__assign)({},t));case"PowerQueryTaskPaneProps":return d.createElement(Dr,Object(p.__assign)({},t));case"SlicerSettingsTaskPaneProps":return d.createElement(Wr,Object(p.__assign)({},t));case"SpellCheckTaskPaneProps":return d.createElement(ja,Object(p.__assign)({},t));default:throw new Error("Rendering an unspecified TaskPane Type. Trying to render pane with id: "+e+" , props.type: "+t.type)}}(e,t))}var Wa=n(59),za=n.n(Wa);function Ha(e,t){switch(e.type){case"ConditionalFormattingTaskPaneProps":return za.a.ConditionalFormatting_20;case"ExcelLegacyTaskPaneWacInfraProps":return function(e,t){if("1"===t)return T.a.SxShowFieldDman_20;if("7"===t)return T.a.CommentsPane_20;if("8"===t)return T.a.AccessibilityChecker_20;return}(0,t);case"ExternalLinksTaskPaneProps":return T.a.Links_20;case"FieldListTaskPaneProps":return T.a.XLFieldListValues_20;case"PivotTableSettingsTaskPaneProps":return T.a.Properties_20;case"PowerQueryTaskPaneProps":return T.a.ShowQueryPane_20;case"SlicerSettingsTaskPaneProps":return T.a.CreateSlicer_20;case"SpellCheckTaskPaneProps":return T.a.Spelling_20;default:return}}var Na=n(15),Va=n(1767),Ga=n(566),Ua=n(405),Ka=n(210),qa=n(33),Qa=n(1595),Ja=n(141),Ya=function(e){return e+"-panel"},Xa={background:"#EDEBE9",title:"#252423",border:"#D2D0CE"},Za=function(e,t){return Object(qa.a)()?function(e,t){var n=e.palette.neutralLighter,o=Object(Ja.a)()?e.palette.neutralTertiary:e.palette.neutralQuaternaryAlt;return t&&(n="#F3F3F3",Qa.b.getInstance().getThemeMode()===Qa.a.Dark&&(n="#292827")),{border:o,background:n,title:e.palette.neutralDark}}(e,t):Object(p.__assign)(Object(p.__assign)({},Xa),{background:t?"#F3F3F3":"#EDEBE9"})},$a={backgroundColor:G.a.white},es=Object(In.c)((function(e,t,n){var o,i=Za(e,n),r={backgroundColor:i.background,borderColor:G.a.gray160};return{root:[{width:40,height:40,backgroundColor:i.background,marginBottom:1,selectors:(o={},o[vr.b]=[r,{selectors:{":hover":$a}}],o[vr.a]={outline:"none",border:"none"},o)},t&&[vr.u,vr.o]],rootPressed:{backgroundColor:i.background},rootHovered:$a,rootFocused:[r,{selectors:{":hover":$a}}]}})),ts=Object(In.c)((function(e,t,n){return Object(Ua.b)(e,Object(ao.b)(e,es(e,t,n)))})),ns=Object(In.c)((function(e,t,n,o,i){var r=Object(vr.y)(o),a=Za(e,i);return{resizeGroupRoot:[{position:"relative",backgroundColor:a.background,height:"100%"},t>1&&n&&{borderLeft:"1px solid "+G.a.gray50}],buttonContainer:[{position:"relative",height:"100%",width:t>1?40:0,transition:"width "+r+"ms ease",display:"inline-block",backgroundColor:a.background},vr.v]}})),os=Object(In.c)((function(e){return Object(P.H)({root:{left:"auto",position:"absolute"}},e)})),is=Object(In.c)((function(e){return{resizeGroupRoot:Object(P.eb)(e.resizeGroupRoot),buttonContainer:Object(P.eb)(e.buttonContainer)}})),rs=Object(In.c)((function(){return Object(In.c)((function(e,t){return Object(Ga.b)()(e,t,!1)}))})),as=Object(In.c)((function(e,t){return{wrapper:{width:40},pivotHeader:ts(e,!1,t),selectedPivotHeader:ts(e,!0,t)}})),ss=Object(In.c)((function(e,t){return{overflowButton:ts(e,!1,t)}})),ls=Object(In.c)((function(e,t){return os(Object(P.H)(t,{root:{transition:e+" 400ms cubic-bezier(0.17, 0.17, 0.00, 1.00)"}}))})),cs={taskPaneModels:{},leftTaskPanes:[],rightTaskPanes:[]},us=function(e,t){if(void 0===e&&(e=cs),null===e)return cs;switch(t.type){case Na.s:var n=Object(p.__assign)({},e.taskPaneModels);return t.payload.taskPanes.forEach((function(t){var o=n[t.id];t.isPersistedTaskPane&&(o?o&&o.hidden&&(t.hidden=!1):t.hidden=!0);var i=e.taskPaneModels[t.id];t.resizeWidth=i&&i.resizeWidth?i.resizeWidth:t.width,n[t.id]=t})),Object(p.__assign)(Object(p.__assign)({},e),{taskPaneModels:n});case Na.hc:return Object(p.__assign)(Object(p.__assign)({},e),{taskPaneModels:ps(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case Na.ic:return Object(p.__assign)(Object(p.__assign)({},e),{taskPaneModels:ds(e.taskPaneModels,t,e.taskPaneModels[t.payload.taskPaneId])});case Na.t:return hs(e,t.payload.taskPaneIds,t.payload.location);case Na.N:return gs(e,t.payload.taskPaneIds,t.payload.location);case Na.qb:return ys(e,t.payload.taskPaneId);case Na.Q:var o=e.selectedTaskPaneId,i=e.taskPaneModels,r=ms(e.rightTaskPanes,i).length>1;return vs(i,r,t.payload.middleContainer,o,t.payload.selectedPaneId),e;case Na.R:var a=ms(e.rightTaskPanes,e.taskPaneModels),s=a.length>0?a[0]:void 0;return ys(e,s);default:return e}},ps=function(e,t,n){var o;if(n){var i=Object(p.__assign)(Object(p.__assign)({},n),{renderContent:t.payload.renderContent});return Object(p.__assign)(Object(p.__assign)({},e),((o={})[t.payload.taskPaneId]=i,o))}return e},ds=function(e,t,n){var o;if(n){var i=Object(p.__assign)(Object(p.__assign)({},n),{resizeWidth:t.payload.resizeWidth});return v.a.sendTraceTag(595077188,C.a.msoulscat_Wac_TaskPane,$.a.Info,"TaskPane has been resized"),Object(p.__assign)(Object(p.__assign)({},e),((o={})[t.payload.taskPaneId]=i,o))}return e},hs=function(e,t,n){for(var o=Object(p.__spreadArrays)(bs(e,n)),i=0,r=t;i<r.length;i++){var a=r[i];-1===o.indexOf(a)&&o.push(a)}return n===c.Right&&o.length>1&&xs(o,e),fs(e,n,o)},gs=function(e,t,n){for(var o=Object(p.__spreadArrays)(bs(e,n)),i=Object(p.__assign)({},e.taskPaneModels),r=e.selectedTaskPaneId,a=r?ms(o,i).indexOf(r):-1,s=0,l=t;s<l.length;s++){var u=l[s],d=o.indexOf(u),h=i[u];h&&h.isPersistedTaskPane?i[u]=Object(p.__assign)(Object(p.__assign)({},h),{hidden:!0}):d>=0&&o.splice(d,1)}if(n===c.Right&&r&&t.indexOf(r)>=0){var g=ms(o,i);if(r=void 0,g.length>0){a>=g.length&&(a=g.length-1);for(var m=a;m<g.length;m+=1){var b=g[m],f=i[b];if(f&&!f.hidden){r=b;break}}}}return Object(p.__assign)(Object(p.__assign)({},fs(e,n,o)),{taskPaneModels:i,selectedTaskPaneId:r})},ms=function(e,t){return e.filter((function(e){var n=t[e];return n&&!n.hidden}))},bs=function(e,t){return t===c.Left?e.leftTaskPanes:e.rightTaskPanes},fs=function(e,t,n){return t===c.Left?Object(p.__assign)(Object(p.__assign)({},e),{leftTaskPanes:n}):Object(p.__assign)(Object(p.__assign)({},e),{rightTaskPanes:n})},ys=function(e,t){return Object(p.__assign)(Object(p.__assign)({},e),{selectedTaskPaneId:t})},vs=function(e,t,n,o,i){var r=i||o,a=r?e[r]:void 0,s=(a?a.enableResize&&a.resizeWidth?a.resizeWidth:a.width:0)+Cs(t,a)+"px";Object(E.a)()?n.style.left=s:n.style.right=s},Cs=function(e,t){return t?e?42:1:e?41:0},xs=function(e,t){var n=e.reduce((function(e,n){var o=t.taskPaneModels[n];return o&&o.hidden?e-1:e}),e.length);2===n?v.a.sendTraceTag(595855454,C.a.msoulscat_Wac_TaskPane,$.a.Info,"2 simultaneous panes open"):n>2&&v.a.sendTraceTag(595855455,C.a.msoulscat_Wac_TaskPane,$.a.Info,n+" simultaneous panes open")};function Ss(){Va.b.register("taskPaneDataModel",us)}var Es=n(203),ws=n(16);function ks(e){return Array.isArray(e)?e:[e]}function Ts(e){return Object(ws.a)(Na.s,{taskPanes:ks(e)})}function Is(e,t){return Object(ws.a)(Na.ic,{taskPaneId:e,resizeWidth:t})}function Rs(e,t){return Object(ws.a)(Na.N,{taskPaneIds:ks(e),location:t})}function Os(e){return Object(ws.a)(Na.qb,{taskPaneId:e})}function Ps(e,t){return Object(ws.a)(Na.Q,{middleContainer:e,selectedPaneId:t})}var Fs,Ds=n(215),_s=Object(In.c)((function(e,t,n,o,i,r,a,s,l){var u=Za(e,l),p=t===c.Left?0:"auto",d=t===c.Left?"auto":0,h="1px "+u.border+" solid",g=Object(vr.y)(s);return Object(P.H)({root:[{height:"100%",display:"flex",flexShrink:0,position:"absolute",left:p,right:d,background:u.background,boxSizing:"border-box"},t===c.Left&&{borderRight:h},t===c.Right&&{borderLeft:h},i&&{width:"100%"}],taskPaneContainer:[{display:"inline-block",height:"100%",position:"relative",width:o||i?"100%":n,transition:"width "+g+"ms ease"},vr.v]},r,a)})),js=Object(In.c)((function(e){return{root:Object(P.eb)(e.root),taskPaneContainer:Object(P.eb)(e.taskPaneContainer)}})),Bs=Object(In.c)((function(e,t,n,o,i,r,a,s){var l=Za(e,s),c={root:{position:"absolute",height:"100%",background:l.background},container:[{width:t,height:"100%",background:l.background,overflowY:"auto"}],header:{padding:16,height:54,width:"100%",boxSizing:"border-box",display:"flex",flexDirection:"row"},title:[{height:22,fontWeight:P.k.semibold,fontSize:16,color:l.title,display:"inline-block",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",flexGrow:1},i&&{paddingLeft:8}],contentWrapper:[{width:r?"100%":t,height:"calc(100% - "+(o?0:54)+"px)",marginLeft:"auto",marginRight:"auto"},a&&{overflowY:"auto"}],contentWrapperGap:[{height:"100%"},a&&{paddingBottom:25}]};return Object(P.db)(c,n)})),Ls=Object(In.c)((function(e){var t=Object(Pi.a)(e);return{root:{height:22,width:22,flexBasis:"20px",flexShrink:0,padding:0},rootHovered:{backgroundColor:G.a.gray40},rootFocused:{backgroundColor:G.a.gray20,borderColor:t.focusedBorderColor}}})),Ms=(Object(In.c)((function(e){return Object(In.c)((function(t,n,o,i,r,a){var s,l=Object(vr.y)(r),u=Za(t,a),p=e===c.Left?"right":"left",d="1px "+u.border+" solid";return{root:[{width:0,float:p,position:"initial",transition:"width "+l+"ms ease",selectors:(s={},s["&.taskpane-enter-active"]={width:n},s["&.taskpane-enter-done"]={width:n},s["&.taskpane-exit-active"]={width:0},s),minHeight:"calc(50vh - 125px)"},o&&!1===i&&{width:n},e===c.Left&&{left:0,borderRight:d},e===c.Right&&{right:0,borderLeft:d},vr.v],container:{position:"relative",float:p}}}))})),{visibility:"visible",opacity:1}),As={visibility:"hidden",opacity:0},Ws=function(e){return e?vr.E:225},zs=Object(In.c)((function(e){var t=Object(vr.y)(e);return"opacity "+t+"ms ease, visibility 0ms linear "+t+"ms"})),Hs=Object(In.c)((function(e){return"opacity "+Ws(e)+"ms ease"})),Ns=Object(In.c)((function(e){return"opacity "+Ws(e)+"ms ease "+Object(vr.y)(e)+"ms"})),Vs=Object(In.c)((function(e){return"opacity "+Ws(e)+"ms ease, visibility 0ms linear "+Object(vr.y)(e)+"ms"})),Gs=Object(In.c)((function(e){return"opacity "+Object(vr.y)(e)+"ms ease, visibility 0ms linear"})),Us=Object(In.c)((function(e){return"opacity "+Ws(e)+"ms ease "+Object(vr.y)(e)+"ms, visibility 0ms linear"})),Ks=Object(In.c)((function(e,t,n,o,i,r){var a;return{root:[Object(p.__assign)(Object(p.__assign)({},Ms),{width:"100%",transition:zs(r),selectors:(a={},a["&.taskpane-enter-active"]=[Ms,{transition:i?Ns(r):Hs(r)}],a["&.taskpane-enter-done"]=Ms,a["&.taskpane-exit-active"]=[As,{transition:Vs(r)}],a)}),e&&!t&&[Ms,{transition:Us(r)}],e&&!t&&!i&&{transition:Gs(r)},!e&&[As,{position:"absolute",top:0}],t&&As,vr.v],container:[(n||o)&&{width:"100%"}],contentWrapper:n&&{width:"100%"}}})),qs=Object(In.c)((function(e){return{root:Object(P.eb)(e.root),container:Object(P.eb)(e.container),header:Object(P.eb)(e.header),title:Object(P.eb)(e.title),contentWrapper:Object(P.eb)(e.contentWrapper),contentWrapperGap:Object(P.eb)(e.contentWrapperGap)}})),Qs=Object(In.c)((function(){return{enterActive:"taskpane-enter-active",enterDone:"taskpane-enter-done",exitActive:"taskpane-exit-active"}})),Js=n(47),Ys=n(144);!function(e){e[e.Action=0]="Action",e[e.Resize=1]="Resize",e[e.Close=2]="Close"}(Fs||(Fs={}));var Xs,Zs=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.root=d.createRef(),t.closeButton=d.createRef(),t.actionButton=d.createRef(),t.contentWrapper=d.createRef(),t.taskPaneTitleId="TaskPaneTitle",t.shiftTabButton=Fs.Close,t.onCloseButtonExecute=function(){var e=t.props,n=e.closeButtonProps,o=e.id;n&&n.onExecute&&n.onExecute(o)},t.onCloseButtonKeyDown=function(e){var n=t.props.closeButtonProps;n&&n.onTabKeyDown&&(t.canHandleTab(e)||t.canHandleShiftTab(e,Fs.Close))&&n.onTabKeyDown(e)},t.onActionButtonExecute=function(){var e=t.props,n=e.actionButtonProps,o=e.id;n&&n.onExecute&&n.onExecute(o)},t.onActionButtonKeyDown=function(e){var n=t.props.actionButtonProps;n&&n.onTabKeyDown&&t.canHandleShiftTab(e,Fs.Action)&&n.onTabKeyDown(e)},t.onKeyDown=function(e){switch(e.key){case"Esc":case"Escape":!t.props.hideHeader&&t.onCloseButtonExecute()}},t.setShiftTabButton=function(){var e=t.props.actionButtonProps;e&&e.onTabKeyDown?t.shiftTabButton=Fs.Action:t.shiftTabButton=Fs.Close},t.canHandleShiftTab=function(e,n){return"Tab"===e.key&&e.shiftKey&&t.shiftTabButton===n},t.canHandleTab=function(e){return"Tab"===e.key&&!e.shiftKey},t}return Object(p.__extends)(t,e),t.prototype.componentDidUpdate=function(){this.setShiftTabButton()},t.prototype.componentDidMount=function(){this.setShiftTabButton()},t.prototype.render=function(){var e=this,t=this.props,n=t.title,o=t.renderContent,i=t.hideHeader,r=t.closeButtonProps,a=t.actionButtonProps,s=t.width,l=t.styles,c=t.stretchBodyToContainer,u=t.id,h=t.role,g=t.roleDescription,m=t.addVerticalScrollSpace,b=Object(nr.j)(this.props,["data-is-visible"]);return d.createElement(lo.a,null,(function(t){var f=Object(ao.b)(t,Ls(t));return d.createElement(Ys.a.Consumer,null,(function(y){var v=qs(Bs(t,s,l,i,a,c,m,Object(Js.a)(y,Js.c.taskPaneBackgroundRefreshIsEnabled)));return d.createElement("div",Object(p.__assign)({id:Ya(u)},b,{ref:e.root,className:v.root,onKeyDown:e.onKeyDown,"aria-labelledby":i?void 0:u+e.taskPaneTitleId,role:h,"aria-roledescription":g}),d.createElement("div",{className:v.container},!i&&d.createElement("div",{className:v.header},a&&d.createElement(ia.a,{type:"AppButtonProps",id:"TaskPaneActionButton"+u,label:a.label,ref:e.actionButton,hideLabel:!0,styles:f,icon:a.icon,onExecute:e.onActionButtonExecute,onKeyDown:e.onActionButtonKeyDown}),d.createElement("div",{id:u+e.taskPaneTitleId,className:v.title,title:n,role:"heading","aria-level":1},n),r&&d.createElement(ia.a,{type:"AppButtonProps",id:"TaskPaneCloseBtn"+u,label:r.label,ref:e.closeButton,hideLabel:!0,icon:r.icon,styles:f,onExecute:e.onCloseButtonExecute,onKeyDown:e.onCloseButtonKeyDown})),d.createElement("div",{className:v.contentWrapper,ref:e.contentWrapper},d.createElement("div",{className:v.contentWrapperGap},o&&o()))))}))}))},t.prototype.getDOMRef=function(){return this.root.current},t.prototype.focus=function(){if(this.actionButton&&this.actionButton.current)this.actionButton.current.focus();else if(this.closeButton&&this.closeButton.current)this.closeButton.current.focus();else if(this.contentWrapper&&this.contentWrapper.current){var e=Object(_o.e)(this.contentWrapper.current,this.contentWrapper.current.firstChild,!0);e&&e.focus()}},t}(d.PureComponent),$s=n(349),el=n(514),tl=n(551),nl=n(1720),ol=n(745),il=n(1771),rl=n(1165),al=n(476),sl=n(908),ll=n(201),cl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabStripContainer=null,t.innerTabStrip=null,t.indicatorContainer=d.createRef(),t.containsElement=function(e){return t.innerTabStrip&&t.innerTabStrip.containsElement(e)},t.renderResizedTabStrip=function(e){var n=t.props,o=n.selectedPaneId,i=n.onTabButtonExecute,r=n.indicatorStyles,a=n.overflowMenuIcon,s=n.overflowMenuLabel,l=n.onOverflowMenuOpen,c=n.onOverflowMenuClose,u=n.tabContainerLabel,h=n.onFocus;return function(n){var g=n.taskPanes.length>1;return d.createElement("div",{className:e.buttonContainer},g&&d.createElement(ul,Object(p.__assign)({ref:function(e){return t.innerTabStrip=e}},t.splitTabsIntoOverflow(n),{selectedPaneId:o,onTabButtonExecute:i,tabStripContainer:t.tabStripContainer,indicatorStyles:r,overflowMenuIcon:a,overflowMenuLabel:s,onOverflowMenuOpen:l,onOverflowMenuClose:c,indicatorContainer:t.indicatorContainer,tabContainerLabel:u,onFocus:h})))}},t.onReduceData=function(e){if(0!==e.taskPanes.length)return Object(p.__assign)(Object(p.__assign)({},e),{overflowTabCount:e.overflowTabCount+1})},t.onGrowData=function(e){if(0!==e.overflowTabCount)return Object(p.__assign)(Object(p.__assign)({},e),{overflowTabCount:e.overflowTabCount-1})},t.splitTabsIntoOverflow=function(e){var n=e.taskPanes,o=e.overflowTabCount,i=Object(Ka.c)(n.length,(function(e){return-1})),r=Object(Ka.e)(n,(function(e){return e.id===t.props.selectedPaneId})),a=n.length-1;r>=0&&(i[r]=a,a-=1);for(var s=0;s<i.length;s+=1)-1===i[s]&&(i[s]=a,a-=1);return{items:n.filter((function(e,t){return i[t]>=o})),overflowItems:n.filter((function(e,t){return i[t]<o}))}},t.getVisiblePanes=function(){return t.props.taskPanes.filter((function(e){return!e.hidden}))},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props.selectedPaneId,n=this.getVisiblePanes(),o={taskPanes:n,overflowTabCount:0};return d.createElement(Ys.a.Consumer,null,(function(i){return d.createElement(lo.a,null,(function(r){var a=is(ns(r,n.length,t,Object(ua.isReducedAnimations)(),Object(Js.a)(i,Js.c.taskPaneBackgroundRefreshIsEnabled)));return d.createElement("div",{ref:function(t){return e.tabStripContainer=t}},d.createElement(al.a,{className:a.resizeGroupRoot,data:o,onReduceData:e.onReduceData,onGrowData:e.onGrowData,direction:sl.a.vertical,onRenderData:e.renderResizedTabStrip(a)}),d.createElement("div",{ref:e.indicatorContainer}))}))}))},t.prototype.focus=function(){this.innerTabStrip&&this.innerTabStrip.focus()},t.prototype.componentDidUpdate=function(){this.getVisiblePanes().length<2&&this.indicatorContainer.current&&h.render(d.createElement("div",null),this.indicatorContainer.current)},t}(d.PureComponent),ul=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabStripButtonId="tabStripButton",t.focusZoneId="tabStripFocusZone",t.pivotRef=d.createRef(),t.selectedPane="",t.indicatorState={position:0,offset:0,length:0,thickness:0},t.convertItemsToPivotHeaders=Object(In.c)((function(e,n,o){return n.map((function(n){return{id:t.tabStripButtonId+n.id,title:n.title,styles:as(e,Object(Js.a)(o,Js.c.taskPaneBackgroundRefreshIsEnabled)),icon:n.icon,hideLabel:!0,ariaControls:Ya(n.id),tooltipDirection:A.DirectionalHint.leftCenter,getMenuItemClassNames:rs(),ariaLabel:n.title}}))})),t.containsElement=function(e){var n=document.getElementById(t.focusZoneId);return Object(z.a)(n,e)},t.panesNotEqual=function(e,t){var n=e.map((function(e){return e.id})),o=t.map((function(e){return e.id}));return!Object(Ka.b)(n,o)},t.selectedPaneWasInOverflow=function(e,t){return!!t&&e.map((function(e){return e.id})).indexOf(t)>=0},t.getTransitionProperties=function(e){var t="all";return e||(t="width"),t},t.renderPivotIndicator=function(e,n,o,i){void 0===i&&(i=!1),t.selectedPane=o,i||(t.indicatorState=t.getPivotIndicatorState(o)),h.render(d.createElement(nl.a,{direction:ol.a.Vertical,showAnimation:n,position:t.indicatorState.position,length:t.indicatorState.length,thickness:t.indicatorState.thickness,styles:ls(e,t.props.indicatorStyles)}),t.props.indicatorContainer.current)},t.onFocusCapture=function(e){var n=document.getElementById(t.focusZoneId),o=document.activeElement,i=o&&Object(z.a)(n,document.activeElement,!1),r=e&&e.relatedTarget,a=r&&!Object(z.a)(n,e.relatedTarget,!1),s=t.props.onFocus;s&&i&&a&&s();var l=o&&n===document.activeElement,c=o&&i&&o.id!==t.tabStripButtonId+t.props.selectedPaneId;(o||r)&&(l||c)&&a&&(e.preventDefault(),t.focus())},t.getFocusZoneProps=Object(In.c)((function(){return Object(p.__assign)(Object(p.__assign)({direction:Ln.a.vertical,isCircularNavigation:!0,onFocusCapture:t.onFocusCapture,tabIndex:0},{"data-is-focusable":!0}),{id:t.focusZoneId})})),t.getPivotIndicatorState=function(e){if(e){var n=document.getElementById(t.tabStripButtonId+e);if(n&&t.props.tabStripContainer)return{position:n.getBoundingClientRect().top-t.props.tabStripContainer.getBoundingClientRect().top,offset:3,length:40,thickness:3}}return{position:t.indicatorState&&t.indicatorState.position||0,offset:t.indicatorState&&t.indicatorState.offset||0,length:t.indicatorState&&t.indicatorState.length||0,thickness:0}},t.onTabButtonExecute=function(){return function(e,n){var o=e.slice(t.tabStripButtonId.length);t.renderPivotIndicator(t.getTransitionProperties(t.selectedPane),!0,o),t.props.onTabButtonExecute&&t.props.onTabButtonExecute(o,n&&n.inputMethod||ll.a.Unknown)}},t.getMenuProps=Object(In.c)((function(){return{directionalHint:A.DirectionalHint.leftBottomEdge,onMenuOpened:t.onMenuOpened,onMenuDismissed:t.onMenuDismiss}})),t.onMenuDismiss=function(e){var n=t.props.onOverflowMenuClose;n&&n()},t.onMenuOpened=function(e){var n=t.props.onOverflowMenuOpen;n&&n()},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.items,o=t.overflowItems,i=t.overflowMenuLabel,r=t.overflowMenuIcon,a=t.selectedPaneId,s=t.tabContainerLabel;return d.createElement(d.Fragment,null,d.createElement(Ys.a.Consumer,null,(function(t){return d.createElement(lo.a,null,(function(l){return d.createElement(il.a,{ref:e.pivotRef,label:s,topLevelItems:e.convertItemsToPivotHeaders(l,n,t),overflowItems:e.convertItemsToPivotHeaders(l,o,t),selectedPivotId:a?e.tabStripButtonId+a:void 0,overflowMenuLauncherLabel:i,onPivotHeaderExecute:e.onTabButtonExecute(),direction:rl.a.Vertical,menuProps:e.getMenuProps(),menuIconProps:Object(vn.a)(r),styles:ss(l,Object(Js.a)(t,Js.c.taskPaneBackgroundRefreshIsEnabled)),focusZoneProps:e.getFocusZoneProps(),tooltipDirection:A.DirectionalHint.leftCenter})}))})))},t.prototype.focus=function(){this.pivotRef.current&&this.pivotRef.current.focus()},t.prototype.componentDidMount=function(){this.props.indicatorContainer.current&&this.renderPivotIndicator("all",!0,this.props.selectedPaneId)},t.prototype.componentDidUpdate=function(e){var t=this.selectedPaneWasInOverflow(e.overflowItems,this.props.selectedPaneId);(this.selectedPane!==this.props.selectedPaneId||this.panesNotEqual(e.items,this.props.items)||this.panesNotEqual(e.overflowItems,this.props.overflowItems)||t)&&this.renderPivotIndicator(this.getTransitionProperties(e.selectedPaneId),e.selectedPaneId!==this.props.selectedPaneId,this.props.selectedPaneId,t)},t}(d.PureComponent),pl=(Xs=function(e,t){return(Xs=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}Xs(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),dl=function(){return(dl=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},hl={top:{width:"100%",height:"10px",top:"-5px",left:"0px",cursor:"row-resize"},right:{width:"10px",height:"100%",top:"0px",right:"-5px",cursor:"col-resize"},bottom:{width:"100%",height:"10px",bottom:"-5px",left:"0px",cursor:"row-resize"},left:{width:"10px",height:"100%",top:"0px",left:"-5px",cursor:"col-resize"},topRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",top:"-10px",cursor:"ne-resize"},bottomRight:{width:"20px",height:"20px",position:"absolute",right:"-10px",bottom:"-10px",cursor:"se-resize"},bottomLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",bottom:"-10px",cursor:"sw-resize"},topLeft:{width:"20px",height:"20px",position:"absolute",left:"-10px",top:"-10px",cursor:"nw-resize"}},gl=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onMouseDown=function(e){t.props.onResizeStart(e,t.props.direction)},t.onTouchStart=function(e){t.props.onResizeStart(e,t.props.direction)},t}return pl(t,e),t.prototype.render=function(){return d.createElement("div",{className:this.props.className||"",style:dl(dl({position:"absolute",userSelect:"none"},hl[this.props.direction]),this.props.replaceStyles||{}),onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart},this.props.children)},t}(d.PureComponent),ml=n(1895),bl=n.n(ml),fl=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),yl=function(){return(yl=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},vl={width:"auto",height:"auto"},Cl=bl()((function(e,t,n){return Math.max(Math.min(e,n),t)})),xl=bl()((function(e,t){return Math.round(e/t)*t})),Sl=bl()((function(e,t){return new RegExp(e,"i").test(t)})),El=function(e){return Boolean(e.touches&&e.touches.length)},wl=bl()((function(e,t,n){void 0===n&&(n=0);var o=t.reduce((function(n,o,i){return Math.abs(o-e)<Math.abs(t[n]-e)?i:n}),0),i=Math.abs(t[o]-e);return 0===n||i<n?t[o]:e})),kl=bl()((function(e,t){return e.substr(e.length-t.length,t.length)===t})),Tl=bl()((function(e){return"auto"===(e=e.toString())||kl(e,"px")||kl(e,"%")||kl(e,"vh")||kl(e,"vw")||kl(e,"vmax")||kl(e,"vmin")?e:e+"px"})),Il=function(e,t,n,o){if(e&&"string"==typeof e){if(kl(e,"%"))return t*(Number(e.replace("%",""))/100);if(kl(e,"vw"))return n*(Number(e.replace("vw",""))/100);if(kl(e,"vh"))return o*(Number(e.replace("vh",""))/100)}return e},Rl=bl()((function(e,t,n,o,i,r,a){return o=Il(o,e.width,t,n),i=Il(i,e.height,t,n),r=Il(r,e.width,t,n),a=Il(a,e.height,t,n),{maxWidth:void 0===o?void 0:Number(o),maxHeight:void 0===i?void 0:Number(i),minWidth:void 0===r?void 0:Number(r),minHeight:void 0===a?void 0:Number(a)}})),Ol=["as","style","className","grid","snap","bounds","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],Pl=function(e){function t(t){var n=e.call(this,t)||this;return n.ratio=1,n.resizable=null,n.parentLeft=0,n.parentTop=0,n.resizableLeft=0,n.resizableTop=0,n.targetLeft=0,n.targetTop=0,n.ref=function(e){e&&(n.resizable=e)},n.state={isResizing:!1,width:void 0===(n.propsSize&&n.propsSize.width)?"auto":n.propsSize&&n.propsSize.width,height:void 0===(n.propsSize&&n.propsSize.height)?"auto":n.propsSize&&n.propsSize.height,direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},n.onResizeStart=n.onResizeStart.bind(n),n.onMouseMove=n.onMouseMove.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n}return fl(t,e),Object.defineProperty(t.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"window",{get:function(){return this.resizable&&this.resizable.ownerDocument?this.resizable.ownerDocument.defaultView:null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||vl},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"base",{get:function(){var e=this.parentNode;if(e)for(var t=0,n=[].slice.call(e.children);t<n.length;t++){var o=n[t];if(o.classList.contains("__resizable_base__"))return o}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var e=0,t=0;if(this.resizable&&this.window){var n=this.resizable.offsetWidth,o=this.resizable.offsetHeight,i=this.resizable.style.position;"relative"!==i&&(this.resizable.style.position="relative"),e="auto"!==this.resizable.style.width?this.resizable.offsetWidth:n,t="auto"!==this.resizable.style.height?this.resizable.offsetHeight:o,this.resizable.style.position=i}return{width:e,height:t}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sizeStyle",{get:function(){var e=this,t=this.props.size,n=function(t){if(void 0===e.state[t]||"auto"===e.state[t])return"auto";if(e.propsSize&&e.propsSize[t]&&kl(e.propsSize[t].toString(),"%")){if(kl(e.state[t].toString(),"%"))return e.state[t].toString();var n=e.getParentSize();return Number(e.state[t].toString().replace("px",""))/n[t]*100+"%"}return Tl(e.state[t])};return{width:t&&void 0!==t.width&&!this.state.isResizing?Tl(t.width):n("width"),height:t&&void 0!==t.height&&!this.state.isResizing?Tl(t.height):n("height")}},enumerable:!1,configurable:!0}),t.prototype.getParentSize=function(){if(!this.base||!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var e=!1,t=this.parentNode.style.flexWrap,n=this.base.style.minWidth;"wrap"!==t&&(e=!0,this.parentNode.style.flexWrap="wrap"),this.base.style.position="relative",this.base.style.minWidth="100%";var o={width:this.base.offsetWidth,height:this.base.offsetHeight};return this.base.style.position="absolute",e&&(this.parentNode.style.flexWrap=t),this.base.style.minWidth=n,o},t.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},t.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},t.prototype.componentDidMount=function(){if(this.resizable&&this.window){var e=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:"auto"!==e.flexBasis?e.flexBasis:void 0});var t=this.parentNode;if(t&&!this.base){var n=this.window.document.createElement("div");n.style.width="100%",n.style.height="100%",n.style.position="absolute",n.style.transform="scale(0, 0)",n.style.left="0",n.style.flex="0",n.classList?n.classList.add("__resizable_base__"):n.className+="__resizable_base__",t.appendChild(n)}}},t.prototype.componentWillUnmount=function(){if(this.window){this.unbindEvents();var e=this.parentNode;if(!this.base||!e)return;if(!e||!this.base)return;e.removeChild(this.base)}},t.prototype.createSizeForCssProperty=function(e,t){var n=this.propsSize&&this.propsSize[t];return"auto"!==this.state[t]||this.state.original[t]!==e||void 0!==n&&"auto"!==n?e:"auto"},t.prototype.calculateNewMaxFromBoundary=function(e,t){if("parent"===this.props.bounds){var n=this.parentNode;if(n){var o=n.offsetWidth+(this.parentLeft-this.resizableLeft),i=n.offsetHeight+(this.parentTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<i?t:i}}else if("window"===this.props.bounds){if(this.window){o=this.window.innerWidth-this.resizableLeft,i=this.window.innerHeight-this.resizableTop;e=e&&e<o?e:o,t=t&&t<i?t:i}}else if(this.props.bounds){o=this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),i=this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop);e=e&&e<o?e:o,t=t&&t<i?t:i}return{maxWidth:e,maxHeight:t}},t.prototype.calculateNewSizeFromDirection=function(e,t){var n=this.props.scale||1,o=this.props.resizeRatio||1,i=this.state,r=i.direction,a=i.original,s=this.props,l=s.lockAspectRatio,c=s.lockAspectRatioExtraHeight,u=s.lockAspectRatioExtraWidth,p=a.width,d=a.height,h=c||0,g=u||0;return Sl("right",r)&&(p=a.width+(e-a.x)*o/n,l&&(d=(p-g)/this.ratio+h)),Sl("left",r)&&(p=a.width-(e-a.x)*o/n,l&&(d=(p-g)/this.ratio+h)),Sl("bottom",r)&&(d=a.height+(t-a.y)*o/n,l&&(p=(d-h)*this.ratio+g)),Sl("top",r)&&(d=a.height-(t-a.y)*o/n,l&&(p=(d-h)*this.ratio+g)),{newWidth:p,newHeight:d}},t.prototype.calculateNewSizeFromAspectRatio=function(e,t,n,o){var i=this.props,r=i.lockAspectRatio,a=i.lockAspectRatioExtraHeight,s=i.lockAspectRatioExtraWidth,l=void 0===o.width?10:o.width,c=void 0===n.width||n.width<0?e:n.width,u=void 0===o.height?10:o.height,p=void 0===n.height||n.height<0?t:n.height,d=a||0,h=s||0;if(r){var g=(u-d)*this.ratio+h,m=(p-d)*this.ratio+h,b=(l-h)/this.ratio+d,f=(c-h)/this.ratio+d,y=Math.max(l,g),v=Math.min(c,m),C=Math.max(u,b),x=Math.min(p,f);e=Cl(e,y,v),t=Cl(t,C,x)}else e=Cl(e,l,c),t=Cl(t,u,p);return{newWidth:e,newHeight:t}},t.prototype.setBoundingClientRect=function(){if("parent"===this.props.bounds){var e=this.parentNode;if(e){var t=e.getBoundingClientRect();this.parentLeft=t.left,this.parentTop=t.top}}if(this.props.bounds&&"string"!=typeof this.props.bounds){var n=this.props.bounds.getBoundingClientRect();this.targetLeft=n.left,this.targetTop=n.top}if(this.resizable){var o=this.resizable.getBoundingClientRect(),i=o.left,r=o.top;this.resizableLeft=i,this.resizableTop=r}},t.prototype.onResizeStart=function(e,t){if(this.resizable&&this.window){var n,o=0,i=0;if(e.nativeEvent&&function(e){return Boolean((e.clientX||0===e.clientX)&&(e.clientY||0===e.clientY))}(e.nativeEvent)){if(o=e.nativeEvent.clientX,i=e.nativeEvent.clientY,3===e.nativeEvent.which)return}else e.nativeEvent&&El(e.nativeEvent)&&(o=e.nativeEvent.touches[0].clientX,i=e.nativeEvent.touches[0].clientY);if(this.props.onResizeStart)if(this.resizable)if(!1===this.props.onResizeStart(e,t,this.resizable))return;this.props.size&&(void 0!==this.props.size.height&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),void 0!==this.props.size.width&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio="number"==typeof this.props.lockAspectRatio?this.props.lockAspectRatio:this.size.width/this.size.height;var r=this.window.getComputedStyle(this.resizable);if("auto"!==r.flexBasis){var a=this.parentNode;if(a){var s=this.window.getComputedStyle(a).flexDirection;this.flexDir=s.startsWith("row")?"row":"column",n=r.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var l={original:{x:o,y:i,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:yl(yl({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(e.target).cursor||"auto"}),direction:t,flexBasis:n};this.setState(l)}},t.prototype.onMouseMove=function(e){if(this.state.isResizing&&this.resizable&&this.window){if(this.window.TouchEvent&&El(e))try{e.preventDefault(),e.stopPropagation()}catch(e){}var t=this.props,n=t.maxWidth,o=t.maxHeight,i=t.minWidth,r=t.minHeight,a=El(e)?e.touches[0].clientX:e.clientX,s=El(e)?e.touches[0].clientY:e.clientY,l=this.state,c=l.direction,u=l.original,p=l.width,d=l.height,h=this.getParentSize(),g=Rl(h,this.window.innerWidth,this.window.innerHeight,n,o,i,r);n=g.maxWidth,o=g.maxHeight,i=g.minWidth,r=g.minHeight;var m=this.calculateNewSizeFromDirection(a,s),b=m.newHeight,f=m.newWidth,y=this.calculateNewMaxFromBoundary(n,o),v=this.calculateNewSizeFromAspectRatio(f,b,{width:y.maxWidth,height:y.maxHeight},{width:i,height:r});if(f=v.newWidth,b=v.newHeight,this.props.grid){var C=xl(f,this.props.grid[0]),x=xl(b,this.props.grid[1]),S=this.props.snapGap||0;f=0===S||Math.abs(C-f)<=S?C:f,b=0===S||Math.abs(x-b)<=S?x:b}this.props.snap&&this.props.snap.x&&(f=wl(f,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(b=wl(b,this.props.snap.y,this.props.snapGap));var E={width:f-u.width,height:b-u.height};if(p&&"string"==typeof p)if(kl(p,"%"))f=f/h.width*100+"%";else if(kl(p,"vw")){f=f/this.window.innerWidth*100+"vw"}else if(kl(p,"vh")){f=f/this.window.innerHeight*100+"vh"}if(d&&"string"==typeof d)if(kl(d,"%"))b=b/h.height*100+"%";else if(kl(d,"vw")){b=b/this.window.innerWidth*100+"vw"}else if(kl(d,"vh")){b=b/this.window.innerHeight*100+"vh"}var w={width:this.createSizeForCssProperty(f,"width"),height:this.createSizeForCssProperty(b,"height")};"row"===this.flexDir?w.flexBasis=w.width:"column"===this.flexDir&&(w.flexBasis=w.height),this.setState(w),this.props.onResize&&this.props.onResize(e,c,this.resizable,E)}},t.prototype.onMouseUp=function(e){var t=this.state,n=t.isResizing,o=t.direction,i=t.original;if(n&&this.resizable){var r={width:this.size.width-i.width,height:this.size.height-i.height};this.props.onResizeStop&&this.props.onResizeStop(e,o,this.resizable,r),this.props.size&&this.setState(this.props.size),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:yl(yl({},this.state.backgroundStyle),{cursor:"auto"})})}},t.prototype.updateSize=function(e){this.setState({width:e.width,height:e.height})},t.prototype.renderResizer=function(){var e=this,t=this.props,n=t.enable,o=t.handleStyles,i=t.handleClasses,r=t.handleWrapperStyle,a=t.handleWrapperClass,s=t.handleComponent;if(!n)return null;var l=Object.keys(n).map((function(t){return!1!==n[t]?d.createElement(gl,{key:t,direction:t,onResizeStart:e.onResizeStart,replaceStyles:o&&o[t],className:i&&i[t]},s&&s[t]?s[t]:null):null}));return d.createElement("span",{className:a,style:r},l)},t.prototype.render=function(){var e=this,t=Object.keys(this.props).reduce((function(t,n){return-1!==Ol.indexOf(n)||(t[n]=e.props[n]),t}),{}),n=yl(yl(yl({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(n.flexBasis=this.state.flexBasis);var o=this.props.as||"div";return d.createElement(o,yl({ref:this.ref,style:n,className:this.props.className},t),this.state.isResizing&&d.createElement("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer())},t.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},t}(d.PureComponent),Fl=n(169),Dl=function(e){var t=Object(E.a)();return e&&!t||!e&&t},_l=function(e){function t(t){var n=e.call(this,t)||this;return n.async=new Fl.a,n.resizableRef=d.createRef(),n.resizeButtonRef=d.createRef(),n.onResize=function(e,t,o){var i,r;null===(r=(i=n.props).onResize)||void 0===r||r.call(i,o.offsetWidth)},n.onResizeStart=function(){var e,t;null===(t=(e=n.props).onResizeStart)||void 0===t||t.call(e)},n.onResizeStop=function(e,t,o){n.props.onResizeEnd&&n.props.onResizeEnd(o.offsetWidth)},n.onResizeHandleBlur=function(){var e,t,o,i=n.props.resizeStrings;if(null===(e=n.resizableRef)||void 0===e?void 0:e.current){i&&n.setMessage(i.resizeModeOff),n.setState({resizeHandleVisible:!1});var r=n.resizableRef.current.size.width;null===(o=(t=n.props).onResizeEnd)||void 0===o||o.call(t,r)}},n.onResizeHandleFocus=function(){var e=n.props.resizeStrings;n.onResizeStart(),e&&n.setMessage(e.resizeModeOn),n.setState({resizeHandleVisible:!0})},n.onKeyDown=function(e){var t=n.props,o=t.invertResizeKey,i=t.keyboardResizeIncrement,r=i||15,a=Dl(!!o)?-r:r,s=0;e.keyCode===R.a.left?(n.resizableRef&&n.resizableRef.current&&(s=n.getLeftArrowContentWidth(n.resizableRef.current.size.width-a)),n.handleResizeKey(e,s)):e.keyCode===R.a.right&&(n.resizableRef&&n.resizableRef.current&&(s=n.getRightArrowContentWidth(n.resizableRef.current.size.width+a)),n.handleResizeKey(e,s))},n.handleResizeKey=function(e,t){var o,i,r,a;n.resizableRef&&n.resizableRef.current&&(n.resizableRef.current.updateSize({width:t,height:"100%"}),null===(i=(o=n.props).onResize)||void 0===i||i.call(o,t)),null===(a=null===(r=n.resizeButtonRef.current)||void 0===r?void 0:r.removeToolTip)||void 0===a||a.call(r),e.stopPropagation(),e.preventDefault()},n.getLeftArrowContentWidth=function(e){var t=n.props,o=t.invertResizeKey,i=t.maxWidth,r=t.minWidth,a=e,s=Dl(!!o);return s&&i?a=Math.min(e,i):!s&&r&&(a=Math.max(e,r)),n.calculateNewSizeMessage(a),a},n.getRightArrowContentWidth=function(e){var t=n.props,o=t.invertResizeKey,i=t.maxWidth,r=t.minWidth,a=e,s=Dl(!!o);return s&&r?a=Math.max(e,r):!s&&i&&(a=Math.min(e,i)),n.calculateNewSizeMessage(a),a},n.calculateNewSizeMessage=function(e){var t=n.props,o=t.maxWidth,i=t.minWidth,r=t.resizeStrings;if(r){var a="";a=e===o?r.resizeMaxValue:e===i?r.resizeMinValue:r.resizeCurrentValue.replace("{0}",e.toString()),n.setMessage(a)}},n.setMessage=function(e){n.setState({message:e})},n.state={message:"",resizeHandleVisible:!1},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.enable,n=e.defaultSize,o=e.minWidth,i=e.maxWidth,r=e.style,a=e.handleStyles,s=e.resizeHandleIcon,l=e.invertResizeKey,c=e.enableKeyboardResize,u=e.resizeStrings,p=Dl(!!l);return d.createElement(d.Fragment,null,d.createElement(Pl,{ref:this.resizableRef,handleStyles:a,style:r,minWidth:o,maxWidth:i,defaultSize:n,enable:t,onResize:this.async.debounce(this.onResize,5,{leading:!1,maxWait:5}),onResizeStart:this.onResizeStart,onResizeStop:this.onResizeStop},this.props.children,c&&d.createElement(ia.a,{type:"AppButtonProps",label:(null==u?void 0:u.resizeLabel)||"",hideLabel:!0,id:"resizeHandleButton",ref:this.resizeButtonRef,onKeyDown:this.onKeyDown,onFocus:this.onResizeHandleFocus,onBlur:this.onResizeHandleBlur,styles:Ml(p,this.state.resizeHandleVisible,Object(ua.isReducedAnimations)()),icon:s})),d.createElement(Pt.a,{"aria-live":"polite",message:this.state.message}))},t.prototype.focusResizeHandle=function(){var e,t;this.props.enableKeyboardResize&&(null===(t=null===(e=this.resizeButtonRef)||void 0===e?void 0:e.current)||void 0===t||t.focus())},t.prototype.updateSize=function(e){var t,n;null===(n=null===(t=this.resizableRef)||void 0===t?void 0:t.current)||void 0===n||n.updateSize(e)},t}(d.PureComponent),jl=Object(In.c)((function(e,t){return Dl(e)?{left:t}:{right:t}})),Bl=Object(In.c)((function(e){return Dl(e)?{left:{width:15}}:{right:{width:15}}})),Ll=Object(In.c)((function(e,t){var n=Object(vr.y)(t);return e?{}:{transition:"width "+n+"ms ease"}})),Ml=Object(In.c)((function(e,t,n){return{root:[{paddingLeft:0,paddingRight:0,backgroundColor:"transparent",borderColor:"transparent",position:"absolute",top:0,bottom:0,marginTop:"auto",marginBottom:"auto",pointerEvents:"none",transition:"opacity "+Object(vr.y)(n)+"ms ease"},t&&{opacity:1},!t&&{opacity:0},!e&&{right:0,marginRight:-16},e&&{left:0,marginLeft:-16},vr.v],icon:{height:32,width:32}}})),Al=function(e){function t(t){var n=e.call(this,t)||this;return n.animationClassNames=Qs(),n.persistedPanes=[],n.nonPersistedPanes=[],n.taskPaneContainer=d.createRef(),n.tabStrip=d.createRef(),n.resizable=d.createRef(),n.rootId="tabbedTaskPaneContainer",n.lastInputMethod=ll.a.Unknown,n.getResizedPaneWidth=function(e){return!n.isResizeDisabled()&&(null==e?void 0:e.resizeWidth)?null==e?void 0:e.resizeWidth:null==e?void 0:e.width},n.onRootFocus=function(e){var t=document.getElementById("tabbedTaskPaneContainer"),o=document.activeElement,i=e&&e.relatedTarget,r=!o||!(Object(z.a)(t,document.activeElement)&&t!==o),a=!i||!(Object(z.a)(t,e.relatedTarget)&&t!==i);((o||i)&&r&&a||!n.props.selectedPaneId&&n.props.taskPanes.filter((function(e){return!e.hidden})).length>=2&&n.tabStrip.current&&!n.tabStrip.current.containsElement(o))&&n.focus()},n.onRootMouseDown=function(e){var t=e.target,o="#"+n.rootId+' [draggable="true"]',i=t.matches||t.webkitMatchesSelector||t.msMatchesSelector;if(i){var r=i.call(t,"input, input *"),a=i.call(t,"textarea, textarea *"),s=i.call(t,'[role="textbox"], [role="textbox"] *'),l=(t.closest||n.closestPolyfill(t,i)).call(t,o);r||a||s||l||e.preventDefault()}},n.closestPolyfill=function(e,t){return function(n){var o=e;do{if(t.call(o,n))return o;o=o.parentElement||o.parentNode}while(null!==o&&1===o.nodeType);return null}},n.renderPanes=function(e,t,o){var i=n.state,r=i.prevSelectedPaneId,a=i.prevPanes,s=i.isResizing,l=n.props,u=l.location,h=l.taskPanes,g=l.selectedPaneId,m=l.stretchWidthToContainer,b=l.resizeStrings,f=l.resizeHandleIcon,y=l.getSplashPageContent;n.persistedPanes=[],n.nonPersistedPanes=[];var v=!!g&&!Object(Ka.d)(a,(function(e){return e.id===g})),C=h.filter((function(e){return!e.isPersistedTaskPane})),x=function(e){return e.filter((function(e){return!!e.isPersistedTaskPane}))}(h),S=Object(Ka.d)(h,(function(e){return e.id===g})),E=!!S&&!!S.enableResize,w=t&&!n.isResizeDisabled(),k=S?n.getPaneWidth(S,w):0,T=u===c.Right,I=w?{ref:n.resizable,enable:jl(T,t&&E),handleStyles:Bl(T),style:Ll(s,Object(ua.isReducedAnimations)()),defaultSize:{width:k,height:"100%"},minWidth:s&&E?null==S?void 0:S.minResizeWidth:void 0,maxWidth:s&&E?null==S?void 0:S.maxResizeWidth:void 0,onResize:n.onResize,onResizeStart:n.onResizeStart,onResizeEnd:n.onResizeEnd,invertResizeKey:T,resizeStrings:b,resizeHandleIcon:f,enableKeyboardResize:E}:void 0,R=w?_l:d.Fragment,O=void 0;return 0===o&&y&&m&&(O=y()),d.createElement(R,Object(p.__assign)({},I),d.createElement("div",{className:e.taskPaneContainer,ref:n.taskPaneContainer},O,x.map((function(e){var t=d.createRef();n.persistedPanes.push(t);var o=e.id===g,i=w&&e.enableResize;return d.createElement(Zs,Object(p.__assign)({},e,{key:e.id,ref:t,styles:Ks(o,v,s,!!m,r,Object(ua.isReducedAnimations)()),"data-is-visible":o,role:"tabpanel",width:n.getPaneWidth(e,!!i)}))})),d.createElement(el,{component:null},C.map((function(e){var t=d.createRef();n.nonPersistedPanes.push(t);var o=g===e.id,i=w&&e.enableResize;return d.createElement($s,{key:e.id,classNames:n.animationClassNames,timeout:Object(vr.y)(Object(ua.isReducedAnimations)()),onEntering:e.onOpen,onExiting:e.onClose},d.createElement(Zs,Object(p.__assign)({key:e.id,ref:t},e,{styles:Ks(o,v,s,!!m,r,Object(ua.isReducedAnimations)()),"data-is-visible":o,role:"tabpanel",width:n.getPaneWidth(e,!!i)})))})))))},n.onResize=function(e){var t=n.props,o=t.onResize,i=t.selectedPaneId,r=t.location,a=t.taskPanes;if(o&&i){var s=Object(Ka.d)(a,(function(e){return e.id===i}));s&&s.enableResize&&o(e,r)}},n.onResizeStart=function(){var e=n.props,t=e.onResizeStart,o=e.selectedPaneId;n.setState({isResizing:!0}),t&&o&&t()},n.onResizeEnd=function(e){var t=n.props,o=t.onResizeEnd,i=t.selectedPaneId;n.setState({isResizing:!1}),o&&i&&o(i,e)},n.findSelectedPaneRef=function(){var e=Object(Ka.d)(n.nonPersistedPanes,(function(e){return!!e.current&&e.current.props.id===n.props.selectedPaneId}));return e||(e=Object(Ka.d)(n.persistedPanes,(function(e){return!!e.current&&e.current.props.id===n.props.selectedPaneId})))},n.boundingWindowRectsChanged=function(e,t){n.setState({windowMode:t,layoutBreakpoint:Object(ua.getLayoutBreakpoint)()})},n.findPane=function(e,t){return Object(Ka.d)(t,(function(t){return t.id===e}))},n.getOnTabButtonExecute=Object(In.c)((function(e){return function(t,o){n.setLastInputMethod(o),e&&e(t)}})),n.setLastInputMethod=function(e){n.lastInputMethod=e},n.isResizeDisabled=function(){return!!n.props.stretchWidthToContainer},n.getPaneWidth=function(e,t){return e.resizeWidth&&e.enableResize&&t?e.resizeWidth:e.width},n.state={prevSelectedPaneId:void 0,currSelectedPaneId:t.selectedPaneId,prevPanes:[],currPanes:t.taskPanes,windowMode:Object(ua.getWindowMode)(),layoutBreakpoint:Object(ua.getLayoutBreakpoint)(),isResizing:!1,taskPaneOpeningMessage:""},Object(ua.registerBoundingWindowRectsChanged)("reactTabbedTaskPanes",n.boundingWindowRectsChanged),n}return Object(p.__extends)(t,e),t.prototype.componentWillUnmount=function(){Object(ua.unregisterBoundingWindowRectsChanged)("reactTabbedTaskPanes")},t.prototype.componentDidMount=function(){this.props.innerRef&&(this.props.innerRef.current=this)},t.prototype.componentDidUpdate=function(e){var t,n,o;t=this.persistedPanes,n=e.taskPanes,o=this.props.taskPanes,t.forEach((function(e){if(e.current){var t=e.current.props.id,i=Object(Ka.d)(n,(function(e){return e.id===t})),r=Object(Ka.d)(o,(function(e){return e.id===t})),a=e.current.getDOMRef();a&&i&&r&&(!i.hidden&&r.hidden&&r.onClose?r.onClose(a):i.hidden&&!r.hidden&&r.onOpen&&r.onOpen(a))}}));var i=e.selectedPaneId,r=this.props.selectedPaneId,a=r!==i;if(i&&a){var s=this.findPane(i,this.props.taskPanes);s&&s.onHide&&s.onHide(this.lastInputMethod)}if(r){var l=this.findPane(r,this.props.taskPanes);if(a&&l&&l.onShow&&l.onShow(this.lastInputMethod),l&&this.resizable.current){var c=i?this.getResizedPaneWidth(this.findPane(i,e.taskPanes)):void 0,u=this.getResizedPaneWidth(l);u&&(a||c&&u!==c)&&(this.resizable.current.updateSize({width:u,height:"100%"}),this.onResize(u))}}!r&&this.resizable.current&&this.resizable.current.updateSize({width:0,height:"100%"}),this.setLastInputMethod(ll.a.Unknown),e.innerRef!==this.props.innerRef&&(e.innerRef&&(e.innerRef.current=null),this.props.innerRef&&(this.props.innerRef.current=this))},t.getDerivedStateFromProps=function(e,t){var n={prevPanes:t.currPanes,currPanes:e.taskPanes},o=t.currSelectedPaneId,i=e.selectedPaneId,r=e.taskPaneOpeningString,a="";if(r&&void 0!==i&&(o!==i||""!==t.taskPaneOpeningMessage)){var s=Object(Ka.d)(e.taskPanes,(function(e){return e.id===i}));a=s?r.replace("{0}",s.title):""}return void 0!==o&&void 0!==i&&o!==i?Object(p.__assign)(Object(p.__assign)({prevSelectedPaneId:o,currSelectedPaneId:i},n),{windowMode:t.windowMode,layoutBreakpoint:t.layoutBreakpoint,taskPaneOpeningMessage:a}):Object(p.__assign)(Object(p.__assign)({prevSelectedPaneId:t.currSelectedPaneId,currSelectedPaneId:i},n),{windowMode:t.windowMode,layoutBreakpoint:t.layoutBreakpoint,taskPaneOpeningMessage:a})},t.prototype.render=function(){var e=this,t=this.props,n=t.taskPanes,o=t.location,i=t.selectedPaneId,r=t.onTabButtonExecute,a=t.styles,s=t.indicatorStyles,l=t.overflowMenuIcon,u=t.overflowMenuLabel,p=t.onOverflowMenuOpen,h=t.onOverflowMenuClose,g=t.tabContainerLabel,m=t.getGroupAdaptiveLayoutStyles,b=t.stretchWidthToContainer,f=t.onTabStripFocus,y=this.state,v=y.windowMode,C=y.layoutBreakpoint,x=0,S=void 0;if(i){if(!(S=Object(Ka.d)(n,(function(e){return e.id===i}))))throw new Error("Selected pane ID was not found in the TabbedTaskPaneGroup");x=S.width}var E=n.filter((function(e){return!e.hidden})),w=d.createElement(cl,{ref:this.tabStrip,taskPanes:n,selectedPaneId:i,onTabButtonExecute:this.getOnTabButtonExecute(r),indicatorStyles:s,overflowMenuIcon:l,overflowMenuLabel:u,onOverflowMenuOpen:p,onOverflowMenuClose:h,tabContainerLabel:g,onFocus:f});return d.createElement(Ys.a.Consumer,null,(function(t){return d.createElement(lo.a,null,(function(n){var i=!!Object(Js.a)(t,Js.c.taskPaneResizingIsEnabled)&&!e.isResizeDisabled();S&&(x=e.getPaneWidth(S,i));var r=js(_s(n,o,x,i,!!b,a,m&&m(v,C,E.length>0),Object(ua.isReducedAnimations)(),Object(Js.a)(t,Js.c.taskPaneBackgroundRefreshIsEnabled))),s=e.renderPanes(r,i,E.length);return d.createElement(tl.a,{id:e.rootId,isClickableOutsideFocusTrap:!0,forceFocusInsideTrap:!1,disableFirstFocus:!0,ignoreExternalFocusing:!0,className:r.root,tabIndex:0,"data-is-focusable":!0,onFocus:e.onRootFocus,onMouseDown:e.onRootMouseDown},d.createElement(Pt.a,{"aria-live":"polite",message:e.state.taskPaneOpeningMessage,"aria-atomic":!0}),d.createElement(Zi.a,null,o===c.Left?d.createElement(d.Fragment,null,w,s):d.createElement(d.Fragment,null,s,w)))}))}))},t.prototype.focus=function(){if(this.props.taskPanes.filter((function(e){return!e.hidden})).length>1&&this.tabStrip&&this.tabStrip.current)this.tabStrip.current.focus();else{var e=this.findSelectedPaneRef();e&&e.current&&e.current.focus()}},t.prototype.focusResizeHandle=function(){var e,t;null===(t=null===(e=this.resizable)||void 0===e?void 0:e.current)||void 0===t||t.focusResizeHandle()},t}(d.PureComponent),Wl=function(e){return e.taskPaneDataModel.taskPaneModels},zl=function(e,t){return t.location===c.Left?e.taskPaneDataModel.leftTaskPanes:e.taskPaneDataModel.rightTaskPanes},Hl=function(e,t){return t.location},Nl=function(e,t){return t.onOpen},Vl=function(e,t){return t.onClose},Gl=function(e,t){return t.middleContainer},Ul=function(e){return e.taskPaneDataModel.selectedTaskPaneId};var Kl,ql=n(95),Ql=n(905),Jl=n(379),Yl=n(906),Xl=(Object(ql.a)([zl,Wl,Hl,Nl,Vl,Gl],(function(e,t,n,o,i,r){var a=Object(Yl.a)(),s=Object(Tr.a)();return Xl(e,t,{icon:a.closeIcon,label:s.closeLabel},n,o,i,r)})),Object(In.c)((function(e,t,n,o,i,r,a){var s=Zl(e,t);return $l(s,n,o,i,r,a)}))),Zl=Object(In.c)((function(e,t){return e.map((function(e){return t[e]})).reduce((function(e,t){return t&&e.push(t),e}),[])})),$l=Object(In.c)((function(e,t,n,o,i,r){var a=e.map((function(e){return ec(e,t,n,o,i,r)}));return{location:n,taskPanes:a}})),ec=Object(In.c)((function(e,t,n,o,i,r){var a=e.id,s=e.title,l=e.width,c=e.hideHeader,u=e.renderContent,d=e.isPersistedTaskPane,h=e.hidden,g=e.onCloseButtonTabKeyDown,m=e.actionButtonProps;return{id:a,title:s,width:l,hideHeader:c,closeButtonProps:Object(p.__assign)(Object(p.__assign)({},t),{onExecute:tc(n),onTabKeyDown:g}),renderContent:u,onOpen:nc(e.id,n,e.width+1,e.onOpen,o,r),onClose:nc(e.id,n,-1*(e.width+1),e.onClose,i,r),isPersistedTaskPane:d,hidden:h,actionButtonProps:m}})),tc=Object(In.c)((function(e){return function(t){Object(Ql.a)(Rs(t,e))}})),nc=Object(In.c)((function(e,t,n,o,i,r){return function(a){i&&i(e,a),o&&o(a),r&&oc(r,n,t)}})),oc=function(e,t,n){if(!Object(Jl.d)()){var o=Object(E.a)();if(n===c.Left&&!o||n===c.Right&&o){if(null!==e.style.left){var i=parseInt(e.style.left,10)||0;e.style.left=i+t+"px"}}else if(null!==e.style.right){var r=parseInt(e.style.right,10)||0;e.style.right=r+t+"px"}}},ic=n(1779),rc=n(771),ac=Object(ql.a)([zl,Wl,Hl,function(e,t){return t.defaultTabStripIcon},Nl,Vl,Ul,Gl,function(e,t){return t.onShow},function(e,t){return t.onHide},function(e,t){return t.stretchWidthToContainer},function(e,t){return t.addVerticalScrollSpace},function(e,t){return t.globalMaxResizeWidth}],(function(e,t,n,o,i,r,a,s,l,c,u,p,d){return sc(e,t,n,o,i,r,a,s,l,c,u,p,d)})),sc=Object(In.c)((function(e,t,n,o,i,r,a,s,l,c,u,p,d){var h=Zl(e,t);return lc(h,n,o,i,r,a,s,l,c,u,p,d)})),lc=Object(In.c)((function(e,t,n,o,i,r,a,s,l,c,u,p){var d=Object(Yl.a)(),h=Object(Tr.a)(),g=e.map((function(e){return uc(e,d,h,t,n,o,i,a,r,s,l,u,p)}));return{location:t,taskPanes:g,selectedPaneId:r,onTabButtonExecute:pc(!!c,r,a),overflowMenuIcon:d.overflowMenuLauncher,overflowMenuLabel:h.taskPaneOverflowMenuLabel,tabContainerLabel:h.taskPaneTabsContainerLabel,onResize:cc(e,a,r),taskPaneOpeningString:h.taskPaneOpeningString}})),cc=Object(In.c)((function(e,t,n){return function(o,i){if(bc(t)&&t){var r=e.filter((function(e){return!e.hidden})).length>1,a=n?Object(Ka.d)(e,(function(e){return e.id===n})):void 0,s=o+Cs(r,a)+"px",l=Object(E.a)();i===c.Left&&!l||i===c.Right&&l?t.style.left=s:t.style.right=s}}})),uc=Object(In.c)((function(e,t,n,o,i,r,a,s,l,c,u,p,d){void 0===d&&(d=Number.MAX_SAFE_INTEGER);var h=e.id,g=e.title,m=e.width,b=e.hideHeader,f=e.renderContent,y=e.isPersistedTaskPane,v=e.hidden,C=e.onCloseButtonTabKeyDown,x=e.icon,S=e.actionButtonProps,E=e.enableResize,w=e.minResizeWidth,k=e.maxResizeWidth,T=e.resizeWidth,I=e.isModernPane,R=e.disableVerticalScrollSpace,O=e.isNonClosablePane,P=Object(ge.d)("TaskPaneResizingIsEnabled")&&E,F=k&&Math.min(k,d),D=P&&F?Math.min(F,920):m,_=P&&w?Math.max(w,100):m;return{id:h,title:g,width:m,hideHeader:b,closeButtonProps:O?void 0:{icon:t.closeIcon,label:n.closeLabel,onExecute:tc(o),onTabKeyDown:C},renderContent:f,icon:x||i,onOpen:dc(h,e.onOpen,r,s),onClose:hc(h,e.onClose,a,s),isPersistedTaskPane:y,hidden:v,actionButtonProps:S,onShow:gc(h,e.onShow,c),onHide:mc(h,l,e.onHide,u),stretchBodyToContainer:I,enableResize:!!P&&E,minResizeWidth:Math.min(_,D),maxResizeWidth:D,roleDescription:n.taskPaneRoleDescription,resizeWidth:T&&F?Math.min(T,F):T,addVerticalScrollSpace:!R&&p}})),pc=Object(In.c)((function(e,t,n){return function(o){var i=o;if(t&&t===o){if(e)return;i=void 0}n&&bc(n)?Object(Ql.a)([Os(i),Ps(n)]):Object(Ql.a)(Os(i))}})),dc=Object(In.c)((function(e,t,n,o){return function(i){n&&n(e,i),t&&t(i),o&&bc(o)&&Object(Ql.a)(Ps(o,e));var r=e+":PaneOpen:Start",a=e+":PaneOpen:End";Object(ic.a)(a,r),Object(rc.a)()&&(window.performance.clearMarks(r),window.performance.clearMarks(a))}})),hc=Object(In.c)((function(e,t,n,o){return function(i){n&&n(e,i),t&&t(i),o&&bc(o)&&Object(Ql.a)(Ps(o))}})),gc=Object(In.c)((function(e,t,n){return function(o){n&&n(e,o),t&&t(o)}})),mc=Object(In.c)((function(e,t,n,o){return function(i){var r=!t;o&&o(e,i,r),n&&n(i,r)}})),bc=function(e){return!!e&&!Object(Jl.d)()},fc=n(194),yc=Object(In.c)((function(e,t,n){return function(o,i){t&&(Object(Jl.d)()?e(Is(o,i)):e(Object(fc.batchActions)([Is(o,i),Ps(t,o)]))),n&&n()}})),vc=n(1166),Cc=n(308),xc=n(1565),Sc=Object(Ds.b)((function(e,t){Object(Cc.g)("TabbedTaskPaneGroup");var n=Object(p.__assign)(Object(p.__assign)({},ac(e,t)),{innerRef:t.innerRef,styles:t.styles,indicatorStyles:t.indicatorStyles,onOverflowMenuClose:t.onOverflowMenuClose,onOverflowMenuOpen:t.onOverflowMenuOpen,onResizeStart:t.onResizeStart,getGroupAdaptiveLayoutStyles:t.getGroupAdaptiveLayoutStyles,stretchWidthToContainer:t.stretchWidthToContainer,resizeStrings:t.resizeStrings,getSplashPageContent:t.getSplashPageContent,addVerticalScrollSpace:t.addVerticalScrollSpace,resizeHandleIcon:t.resizeHandleIcon,onTabStripFocus:t.onTabStripFocus,id:"TabbedTaskPaneGroupProps"});return Object(Cc.g)("TabbedTaskPaneGroup","NonCached"),n}),(function(e,t){Object(Cc.e)("TabbedTaskPaneGroup");var n=Object(p.__assign)({},function(e,t){return{onResizeEnd:yc(e,t.middleContainer,t.onResizeEnd)}}(e,t));return Object(Cc.e)("TabbedTaskPaneGroup","NonCached"),n}),(function(e,t){Object(Cc.f)("TabbedTaskPaneGroup");var n=Object(p.__assign)(Object(p.__assign)({},e),t);return Object(Cc.f)("TabbedTaskPaneGroup","NonCached"),n}))(Object(xc.a)(Al)),Ec=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.tabbedTaskPaneGroup=d.createRef(),t}return Object(p.__extends)(t,e),t.prototype.focus=function(){var e,t;null===(t=null===(e=this.tabbedTaskPaneGroup)||void 0===e?void 0:e.current)||void 0===t||t.focus()},t.prototype.focusResizeHandle=function(){var e,t;null===(t=null===(e=this.tabbedTaskPaneGroup)||void 0===e?void 0:e.current)||void 0===t||t.focusResizeHandle()},t.prototype.render=function(){return d.createElement(vc.a,null,d.createElement(Sc,Object(p.__assign)({innerRef:this.tabbedTaskPaneGroup},this.props)))},t}(d.PureComponent),wc=n(432),kc=Object(In.c)((function(){return{resizeCurrentValue:OfficeCommonStrings.TaskPaneResizeCurrentValue,resizeLabel:OfficeCommonStrings.TaskPaneResize,resizeMaxValue:OfficeCommonStrings.TaskPaneResizeMaxValue,resizeMinValue:OfficeCommonStrings.TaskPaneResizeMinValue,resizeModeOff:OfficeCommonStrings.TaskPaneResizeModeOff,resizeModeOn:OfficeCommonStrings.TaskPaneResizeModeOn}})),Tc=function(e){function t(t){var n=e.call(this,t)||this;return n.tabbedContainer=d.createRef(),Object(Yl.b)(Co.a),Object(Tr.b)(Object(s.a)()),n}return Object(p.__extends)(t,e),t.prototype.focus=function(){var e,t;null===(t=null===(e=this.tabbedContainer)||void 0===e?void 0:e.current)||void 0===t||t.focus()},t.prototype.focusResizeHandle=function(){var e,t;null===(t=null===(e=this.tabbedContainer)||void 0===e?void 0:e.current)||void 0===t||t.focusResizeHandle()},t.prototype.render=function(){return d.createElement($n.a,{className:Object(P.eb)({fontFamily:ExcelRibbonStrings.UserInterfaceFontName,fontSize:ExcelRibbonStrings.UserInterfaceFontSize})},d.createElement(Ds.a,{store:wc.a},d.createElement(Ec,Object(p.__assign)({ref:this.tabbedContainer},this.props,{resizeStrings:kc(),defaultTabStripIcon:r.a.MissingIcon_20,resizeHandleIcon:r.a.MissingIcon_20,styles:{root:{position:"relative"}},indicatorStyles:{root:{backgroundColor:Object(a.a)().primary}}}))))},t}(d.PureComponent),Ic=function(e){function t(t){var n=e.call(this,t)||this;return n.state={contentProps:t.paneProps},n}return Object(p.__extends)(t,e),t.prototype.update=function(e){var t={contentProps:e.paneProps};this.setState(t)},t.prototype.render=function(){switch(this.state.contentProps.type){case"ConditionalFormattingTaskPaneProps":return d.createElement(Tn,Object(p.__assign)({},this.state.contentProps));case"DataCleansingTaskPaneProps":return d.createElement(Zn,Object(p.__assign)({},this.state.contentProps));case"ExternalLinksTaskPaneProps":return d.createElement(Lo,Object(p.__assign)({},this.state.contentProps));case"FieldListTaskPaneProps":return d.createElement(di,Object(p.__assign)({},this.state.contentProps));case"PivotTableSettingsTaskPaneProps":return d.createElement(Ji,Object(p.__assign)({},this.state.contentProps));case"PowerQueryTaskPaneProps":return d.createElement(Dr,Object(p.__assign)({},this.state.contentProps));case"SlicerSettingsTaskPaneProps":return d.createElement(Wr,Object(p.__assign)({},this.state.contentProps));case"SpellCheckTaskPaneProps":return d.createElement(ja,Object(p.__assign)({},this.state.contentProps));default:return v.a.shipAssertTag(575681805,C.a.msoulscat_ES_EWAJS,!1,"Incorrect pane type received by Excel Legacy Task Pane"),d.createElement(d.Fragment,null)}},t.prototype.componentDidMount=function(){this.props.onExcelLegacyTaskPaneCreated&&this.props.onExcelLegacyTaskPaneCreated(this.props.container)},t}(d.Component),Rc={};function Oc(){return void 0===Kl&&(Kl=!Object(ge.d)("WacTaskPaneInfra")),Kl}var Pc,Fc=[],Dc=d.createRef();var _c=function(e,t){return function(n){var o,i;n(Object(fc.batchActions)([Ts(Bc(e,t)),(o=e,i=t.location,Object(ws.a)(Na.t,{taskPaneIds:ks(o),location:i}))]))}},jc=function(e){return function(t){t(Os(e))}};var Bc=function(e,t){var n=t.title,o=t.width,i=t.onOpen,r=t.onClose,a=t.hideHeader,s=t.onCloseButtonTabKeyDown,l=t.actionButtonProps,c=t.enableResize,u=t.minResizeWidth,p=t.maxResizeWidth,d=t.onShow,h=t.onHide,g=t.isModernPane,m=t.disableVerticalScrollSpace,b=t.isNonClosablePane;return{title:n,width:o,onOpen:i,onClose:r,hideHeader:a,id:e,renderContent:function(){return Aa(e,t.contentProps)},onCloseButtonTabKeyDown:s,icon:Ha(t.contentProps,e),isPersistedTaskPane:Fc.indexOf(e)>=0,actionButtonProps:l,enableResize:c,minResizeWidth:u,maxResizeWidth:p,onShow:d,onHide:h,isModernPane:g,disableVerticalScrollSpace:m,isNonClosablePane:b}};var Lc,Mc={renderTaskPaneGroups:function(e,t,n){Oc()||(Pc=n.middleContainer,Ss(),n.setFocusCallback,h.render(d.createElement(Tc,Object(p.__assign)({ref:Dc,location:c.Right},n)),t))},showTaskPane:function(e,t){if(Oc())return function(e,t){if(void 0===Rc[e]){var n=t.contentProps;n.onExcelLegacyTaskPaneCreated=t.onOpen,h.render(d.createElement(Ic,Object(p.__assign)({ref:function(t){Rc[e]=t||void 0}},n)),n.container)}else v.a.shipAssertTag(575681806,C.a.msoulscat_ES_EWAJS,!1,"ExcelLegacyTaskPaneDeprecated ref for id: "+e+" already exists")}(e,t);Object(Es.a)([_c(e,t),jc(e)])},updateTaskPane:function(e,t){if(Oc())return function(e,t){var n=Rc[e],o=t.contentProps;void 0!==n?n.update(o):v.a.shipAssertTag(575681807,C.a.msoulscat_ES_EWAJS,!1,"UpdateTaskPane failed as ExcelLegacyTaskPane ref for id: "+e+" does not exist")}(e,t);Object(Es.a)(Ts(Bc(e,t)))},hideTaskPane:function(e,t){if(Oc())return function(e,t){var n=Rc[e];void 0!==n?(h.unmountComponentAtNode(n.props.container)||v.a.shipAssertTag(575681808,C.a.msoulscat_ES_EWAJS,!1,"Failed to unmount ExcelLegacyTaskPane for id: "+e+"."),delete Rc[e]):v.a.sendTraceTag(575681809,C.a.msoulscat_ES_EWAJS,$.a.Warning,"HideTaskPane failed as ExcelLegacyTaskPane ref for id: "+e+" does not exist")}(e);Object(Es.a)(Rs(e,t))},doNotUse_InitializePersistedTaskPane:function(e,t){Oc()||(Fc.indexOf(e)<0&&Fc.push(e),Object(Es.a)(_c(e,t)))},focusTabbedTaskPaneArea:function(){var e;Oc()||null===(e=null==Dc?void 0:Dc.current)||void 0===e||e.focus()},setSelectedTaskPane:function(e){Oc()||(Pc&&bc(Pc)?Object(Es.a)([jc(e),Ps(Pc,e)]):Object(Es.a)(jc(e)))},selectors:(Lc=wc.a,{getTabbedTaskPaneCount:function(){return(e=Lc.getState()).taskPaneDataModel.rightTaskPanes.reduce((function(t,n){var o=e.taskPaneDataModel.taskPaneModels[n];return o&&!o.hidden?t+1:t}),0);var e},getSelectedTaskPane:function(){return Ul(Lc.getState())}}),focusResizeHandle:function(){var e;Oc()||null===(e=null==Dc?void 0:Dc.current)||void 0===e||e.focusResizeHandle()}},Ac=n(428),Wc=n(957),zc=n(1048),Hc=n(1130),Nc=n(1131),Vc=n(1132),Gc=n(1119),Uc=n(1122),Kc=n(1051),qc=n(1133),Qc=n(1134),Jc=n(1135),Yc=n(1136),Xc=n(1137);function Zc(e){for(var t in e)"object"==typeof e[t]?Zc(e[t]):e[t]=Da.utils.decodeHtml(e[t]);return e}function $c(e,t){var n=t.dialogIcon?Object(zc.a)(t.dialogIcon):void 0,o=Object(zc.b)(),i=Object(zc.c)();switch(t.type){case"StandardDialogProps":var r=function(e){return Zc(e)}(Object(p.__assign)({},t)),s=Object(p.__assign)(Object(p.__assign)({},r),{icon:n,closeIconProps:o,msLogoProps:zc.f,dragOptions:i,settings:Ac.dialogSettings});return Object(Ac.showStandardDialog)(s,Co.a.checkboxCheckmark);case"CustomDialogProps":n=n||t.icon;var l={},c=(r=function(e){return e.bodyControls=Zc(e.bodyControls),e}(Object(p.__assign)({},t)),Object(p.__assign)(Object(p.__assign)({},r),{icon:n,closeIconProps:o,msLogoProps:zc.f,dragOptions:i,settings:Ac.dialogSettings}));switch(e){case"ChangeLocaleDialog":return Object(Hc.a)(c);case"ChartEditDataDialog":return Object(Nc.a)(c);case"ChartEditTitleDialog":return Object(Vc.a)(c);case"CommercialTrustCenterDialog":l={checkmarkIcon:Co.a.checkboxCheckmark,optionalExperiencesInfoMessageIcon:Object(zc.a)(Ac.DialogIcon.Info)};break;case"CustomSortDialog":return Object(Gc.a)(c);case"KeyboardShortcutsDialog":return Object(Uc.a)(c,Object(a.a)());case"InsertDeleteCellsDialog":return Object(Kc.a)(c,Object(a.a)());case"PasswordProtectedDialog":return Object(qc.b)(c);case"RenameSheetDialog":return Object(Ac.getRenameDialog)(c);case"ResizeHeadersDialog":return Object(Qc.a)(c);case"ResizeTableDialog":return Object(Jc.b)(c,Object(a.a)());case"WorkbookStatisticsDialog":return Object(Yc.b)(c);case"InsertSlicerDialog":return Object(Xc.a)(c)}return Object(Ac.showSharedCustomDialog)(e,Object(p.__assign)(Object(p.__assign)({},c),l),Object(a.a)());default:return Object(Wc.assertNever)(t)}}function eu(e,t){return n=$c(e,t),d.createElement(Pn,null,n);var n}var tu={initialize:function(e){Object(Ac.initialize)(e,eu,Object(zc.d)())},show:Ac.show,hide:Ac.hide,update:Ac.update,dispose:Ac.dispose};function nu(e,t){if(void 0===e&&(e={}),null===e)return{};switch(t.type){case Na.j:var n=Object(p.__assign)({},e);return t.payload.models.forEach((function(e){return n[e.id]=e})),n;default:return e}}function ou(e,t){if(void 0===e&&(e=[]),null==e)return[];switch(t.type){case Na.S:return t.payload.activeGroups;default:return e}}var iu=n(31),ru=n(1160),au=function(e){return e.floatieGroupModels},su=function(e){return e.activeFloatieGroups},lu=function(e){return!!e.contextualUILayoutModel.floatieLayout},cu=Object(ql.a)([su,au],(function(e,t){return e.length<=0?[]:e.map((function(e){var n=t[e];if(void 0!==n)switch(n.type){case"MultiRowFloatieGroupModel":return Object(p.__spreadArrays)(n.topControlsRow,n.bottomControlsRow);case"SingleRowFloatieGroupModel":return n.controls;case"SingleControlFloatieGroupModel":return[n.control]}return[]})).reduce((function(e,t){return e.concat.apply(e,t)}))})),uu=Object(ql.a)([cu,lu],(function(e,t){return e.length<=0||!t?[]:e})),pu=Object(ql.a)([cu,iu.s],(function(e,t){if(e.length<=0)return{};var n={};return e.forEach((function(e){var o=Object(iu.p)(t,e);n[e]=o.modelType})),n}));function du(e,t){if(void 0===e&&(e={}),null===e)return{};switch(t.type){case Na.W:return{flyoutAnchorId:t.payload.flyoutAnchorId};default:return e}}function hu(e,t){if(void 0===e&&(e={}),null===e)return{};switch(t.type){case Na.Y:return Object(p.__assign)({},t.payload.contextualUILayoutModel);case Na.B:return e.floatieLayout?{contextMenuLayout:e.contextMenuLayout}:e;case Na.A:return e.contextMenuLayout?{floatieLayout:e.floatieLayout}:e;case Na.X:return{contextMenusToShadowRender:t.payload.contextMenusToShadowRender};default:return e}}function gu(e,t){Va.b.register("floatieGroupModels",nu),Va.b.register("activeFloatieGroups",ou),Object(ru.c)((function(e){return uu(e)})),Va.b.register("contextMenuModel",du),Va.b.register("contextualUILayoutModel",hu),t(e)}var mu=n(1759),bu=n(293),fu=n(1700),yu=n(145),vu=function(e){return e.contextMenuModel.flyoutAnchorId},Cu=function(e){return!!e.contextualUILayoutModel.contextMenuLayout},xu=Object(ql.a)([vu,iu.N,iu.s,iu.Q],(function(e,t,n,o){var i=e&&Object(iu.t)(t,n,e);if(i&&"FlyoutAnchorModel"===i.type&&i.menuModel)return ku(i.menuModel,t,n,o)})),Su=Object(ql.a)([iu.N,iu.s,iu.Q,iu.ib,iu.C],(function(e,t,n,o,i){if(o&&o.queryText&&""!==o.queryText&&o.menuModel)return Tu(o.menuModel,e,t,n,yu.a.SearchResult);var r=i.ZeroTermContextMenu;return r&&r.menuModel&&!r.disabled?Tu(r.menuModel,e,t,n,yu.a.ZeroTermMenu):void 0})),Eu=Object(ql.a)([iu.N,iu.s,iu.Q,function(e){return e.contextualUILayoutModel.contextMenusToShadowRender}],(function(e,t,n,o){var i=new Map;if(o)return o.forEach((function(o){var r=o&&Object(iu.t)(e,t,o);r&&"FlyoutAnchorModel"===r.type&&r.menuModel?i.set(o,ku(r.menuModel,e,t,n)):i.set(o,void 0)})),i})),wu=Object(ql.a)([iu.C],(function(e){return!!e.ZeroTermContextMenu})),ku=Object(fu.a)((function(e,t,n,o){return Object(bu.a)(e,t,n,o)})),Tu=Object(fu.a)((function(e,t,n,o,i){return Object(p.__assign)(Object(p.__assign)({},Object(bu.a)(e,t,n,o,void 0,void 0,void 0,!0)),{contextualUILocation:i})})),Iu=n(322),Ru=n(478),Ou=n(74),Pu=n(1766),Fu=function(e){return!!e&&!!e.sections&&e.sections.some((function(e){return e.controls&&e.controls.length>0}))},Du=function(e){return Fu(e)&&(null==e?void 0:e.contextualUILocation)||yu.a.StandardContextMenu};function _u(e){if(!e)return[];for(var t=[],n=0,o=e.sections;n<o.length;n++)for(var i=0,r=o[n].controls;i<r.length;i++){var a=r[i];t.push(a.id)}return t}var ju="",Bu="",Lu=function(e,t,n){var o=t||Ou.a.ContextMenu;Object(Ru.b)(o,"FlyoutAnchorModel",e)({id:o,location:yu.b.ContextMenu,isShadowRendering:n})},Mu=Object(Pu.a)("ContextMenuPopulate",(function(e,t,n){Lu(e,t,n)})),Au=Object(Pu.a)("ContextMenuDispatch",(function(e,t){e(Object(mu.g)(t))})),Wu=Object(Pu.a)("ContextualUIDispatch",(function(e,t){e(Object(mu.g)(t))})),zu=Object(Pu.a)("FloatieDispatch",(function(e,t){e(Object(mu.g)(t))}));var Hu=function(e){return!!e&&void 0===!e.x};var Nu=n(68),Vu=n(65),Gu=n(171),Uu={galleryButtonInExpanded:n(1620).b.galleryButtonInExpanded,expandedGallerySectionTitle:{fontSize:12,backgroundColor:G.a.gray20,paddingRight:0,paddingLeft:0},expandedGallerySectionTitleInnerSpan:{height:16,backgroundColor:G.a.gray20,fontSize:12,fontWeight:700,paddingTop:8,paddingBottom:8,paddingRight:4,paddingLeft:4}},Ku=n(1753);function qu(e,t){return{id:e,type:"SingleRowFloatieGroupModel",controls:t}}function Qu(e,t,n){return{id:e,type:"SingleControlFloatieGroupModel",control:t,preventAutoDismiss:n}}var Ju=n(337),Yu=n(2),Xu=n(890),Zu=n(61),$u=n.n(Zu),ep=n(216),tp=Object(Ju.a)(["Edit","Clipboard","Copy","Color","AutoFill","RowOperations","ColumnOperations","ViewModeRowOperations","ViewModeColumnOperations","Hyperlink","OpenHyperlink","ShapeStyle","FloatingObjectClipboard","PivotTableCopyDelete","PivotTableFieldListActions","PivotTableFieldListActionsExpanded","ContextMenu","GridContextMenu","PivotTableContextMenu","FloatingObjectContextMenu","CellFloatie","ShapeFloatie","PasteRecoveryUI"]),np=[tp.Copy,tp.OpenHyperlink,tp.ViewModeRowOperations,tp.ViewModeColumnOperations,tp.Edit,tp.Hyperlink,tp.Color,tp.AutoFill,tp.Clipboard,tp.RowOperations,tp.ColumnOperations,tp.GridContextMenu,tp.PivotTableCopyDelete,tp.PivotTableFieldListActions,tp.PivotTableContextMenu,tp.FloatingObjectClipboard,tp.ShapeStyle,tp.FloatingObjectContextMenu,tp.ContextMenu,tp.CellFloatie,tp.ShapeFloatie];var op=[Yu.b.GridContextMenu,Yu.b.SheetOpsContextMenu,Yu.b.AutoFilterContextMenu];var ip=n(901),rp=n(475),ap=n(140),sp=n(784),lp=n(1593),cp=n(255),up=n(1772),pp=n(1776),dp=n(1777),hp=n(1741),gp=n(1742),mp=n(1740),bp=n(197),fp=n(1584),yp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this;return d.createElement(lo.a,null,(function(t){return d.createElement(fp.a,Object(p.__assign)({},e.props,{dataAutomationType:"ContextMenuCompoundButton",styles:Object(ao.b)(t,{root:{padding:0,minHeight:"initial",minwidth:"initial",height:"50px"},label:{fontWeight:P.k.bold,margin:"0"}}),keytipProps:void 0}))}))},t}(d.PureComponent),vp=n(247),Cp=n(1743),xp=n(248),Sp=n(1006),Ep=n(725),wp=Object(In.c)((function(e){return function(){return d.createElement(I.a,{iconName:e,style:{width:20,height:20}})}})),kp=Object(In.c)((function(e){var t,n=Object(xp.a)(e),o=Object(qa.a)()?n.defaultBackgroundColor:vp.a.defaultBackgroundColor;return{root:{selectors:(t={},t[vr.b]={background:o},t[":active"]={background:o},t),padding:"0px 16px 0px 9px",width:"100%"},label:{paddingLeft:6}}})),Tp=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderIcon=function(){return d.createElement(Ep.a,{coinSize:20,imageInitials:Object(Sp.a)(t.props.personaInfo.displayName,!1),onRenderInitials:""===Object(Sp.a)(t.props.personaInfo.displayName,!1)||t.props.personaInfo.isUnauthenticatedSender?wp(t.props.icon):void 0,initialsColor:t.props.personaInfo.personaCoinColor})},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this;return d.createElement(lo.a,null,(function(t){return d.createElement(Cp.a,Object(p.__assign)({},e.props,{onRenderIcon:e.renderIcon,styles:Object(ao.b)(t,kp(t)),keytipProps:void 0}))}))},t}(d.PureComponent);function Ip(e,t,n,o){var i=isNaN(n)?void 0:n,r=isNaN(o)?void 0:o;switch(e.type){case"AppColorPickerProps":return d.createElement(up.a,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.b)(e,t)));case"AppCompoundButtonProps":return d.createElement(yp,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.b)(e,t),{lang:e.lang,enableFocusOnHover:!0}));case"AppCharacterCodeGalleryProps":return d.createElement(pp.a,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.a)(e,t)));case"AppListGalleryProps":return d.createElement(dp.a,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.a)(e,t)));case"AppIconFullGalleryProps":return d.createElement(hp.a,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.a)(e,t)));case"AppFontStylesFullGalleryProps":return d.createElement(gp.a,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.a)(e,t)));case"AppPersonaButtonProps":return d.createElement(Tp,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.b)(e,t),{lang:e.lang}));case"RibbonChangeColorsFullGalleryProps":return d.createElement(mp.a,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.a)(e,t)));default:throw new Error("The control of type "+e.type+" is not valid in a Floatie menu")}}var Rp=n(154),Op=function(e,t){return d.createElement("span",{key:e.key},Ip(e.data,Object(vo.m)(t),Number(e["aria-posinset"]),Number(e["aria-setsize"])))},Pp=Object(Rp.a)((function(e,t){return{key:e,data:t,onRender:Op,customOnRenderListLength:Object(vo.i)(t)}})),Fp=Object(In.c)((function(e,t){return function(n){var o=n.controlProps,i=n.subComponentStyles,r=n.location,a=n.arePerfImprovementsEnabled,s=n.onMenuItemExecuted,l=n.onSubMenuPositioned,c=n.useStructurealMenuSections;return o.filter((function(e){return Object(vo.i)(e)>0})).map((function(n){var o=Object(p.__assign)(Object(p.__assign)({},Object(vo.a)(n,s)),{keytipProps:void 0,location:r,appStrings:t}),u=o.id;switch(o.type){case"AppButtonProps":return Object(vo.b)(Object(ga.a)(o.id,o.location),o,i);case"AppToggleButtonProps":return Object(vo.l)(o,i);case"AppFlyoutAnchorProps":return(a?vo.g:vo.f)(Object(ga.a)(o.id,o.location),o,Fp(e,t),e,l,i,i,a,s,c);case"AppSplitButtonProps":return(a?vo.k:vo.j)(Object(ga.a)(o.id,o.location),o,Fp(e,t),e,l,i,i,a,s,c);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppFontStylesFullGalleryProps":case"AppCharacterCodeGalleryProps":case"AppCompoundButtonProps":case"RibbonChangeColorsFullGalleryProps":return Pp(u,o);default:throw new Error("The control of type "+o.type+" is not valid in a Floatie menu")}}))}})),Dp=n(1569),_p=n(1178),jp=n(1149),Bp=n(30),Lp=Object(In.c)((function(e){return{width:"260px",display:"flex",flexDirection:e?"column-reverse":"column"}})),Mp=Object(In.c)((function(e,t){var n=Object(Pi.a)(e),o={margin:"1px",selectors:{".ms-Button":Object(p.__assign)(Object(p.__assign)({},vr.i),{borderRadius:"4px",selectors:{":after":{display:"none"},":focus":Object(p.__assign)(Object(p.__assign)({},vr.t),{border:"1px solid "+n.focusedBorderColor}),":hover":Object(p.__assign)({},vr.t)}}),i:{width:"20px",height:"20px",selectors:{svg:Object(p.__assign)({},Object(vr.A)())}}}};return{root:{margin:t?"4px 12px 6px 12px":"6px 12px 4px 12px",height:"30px",borderRadius:"4px",padding:"0px 0px 0px 8px",borderColor:Bp.a.gray50,selectors:{":hover":Object(p.__assign)(Object(p.__assign)({},vr.t),{borderColor:Bp.a.gray50,borderRadius:"4px"}),":after":Object(p.__assign)(Object(p.__assign)({},vr.t),{border:"1px solid "+n.focusedBorderColor,borderRadius:"4px"})}},iconContainer:{display:"none"},clearButton:o}})),Ap=Object(In.c)((function(e,t,n){var o,i=Object(Pi.a)(e),r={selectors:(o={"button span":{textOverflow:"ellipsis",overflow:"hidden"}},o[n?"li:first-child li:first-child":"li:first-child"]=t?{backgroundColor:i.toggledBackgroundColor,outline:"1px solid "+i.inputBorderColor,outlineOffset:"-1px"}:void 0,o['li div[data-automation-type="RibbonComboBox"]']={width:"100%",selectors:{"> div:first-child":{maxWidth:"66%"},i:{flexShrink:0},"i + .textContainer":{overflow:"hidden"},".textContainer":{selectors:{label:{textOverflow:"ellipsis",overflow:"hidden",lineHeight:"normal"}}}}},o)};return Object(P.eb)(r)})),Wp=function(e){function t(t){var n=e.call(this,t)||this;return n.resultsWrapperId="resultsWrapper",n.menuRegion=d.createRef(),n.onSearchChanged=n.onSearchChanged.bind(n),n.onEscape=n.onEscape.bind(n),n.onSearchExecuted=n.onSearchExecuted.bind(n),n.onClick=n.onClick.bind(n),n.onSearchBoxFocus=n.onSearchBoxFocus.bind(n),n.onSearchBoxBlur=n.onSearchBoxBlur.bind(n),n.state={query:""},n.activities={sessionStart:0,sessionId:t.sessionId,menuId:t.menuId},n}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this;return d.createElement(lo.a,null,(function(t){var n,o;return d.createElement("div",{role:"search",style:Lp(e.props.searchBoxOnTheBottom)},e.renderSearchBox(t),d.createElement("div",{ref:e.menuRegion,role:"region",id:e.resultsWrapperId,"aria-label":e.props.appStrings.searchableMenuRegionLabel,className:Ap(t,!!e.state.searchBoxFocused&&e.isSearchResult(),null===(o=(n=e.context).isExperimentalFeatureEnabled)||void 0===o?void 0:o.call(n,Js.c.useStructurealMenuSections))},e.renderSearchResults()))}))},t.prototype.componentDidMount=function(){this.props.hidden||this.onMenuOpen()},t.prototype.componentWillUnmount=function(){this.props.hidden||this.onMenuClosed()},t.prototype.componentDidUpdate=function(e){switch(!this.props.hidden&&e.hidden?this.onMenuOpen():this.props.hidden&&!e.hidden&&this.onMenuClosed(),this.activities.zeroTermMenuEnabled=this.props.zeroTermMenuEnabled,this.props.contextualUILocation){case yu.a.SearchResult:this.activities.searchResultShown=!0;break;case yu.a.ZeroTermMenu:this.activities.zeroTermMenuShown=!0}},t.prototype.renderSearchBox=function(e){return d.createElement(jp.a,{"data-no-horizontal-wrap":"false",type:"text",ariaLabel:this.props.appStrings.searchLabel,"aria-controls":this.resultsWrapperId,"aria-expanded":!0,id:this.props.searchBoxId,clearButtonProps:{ariaLabel:this.props.appStrings.clearSearch,iconProps:{iconName:this.props.appIcons.closeIcon}},iconProps:{iconName:""},styles:Mp(e,this.props.searchBoxOnTheBottom),placeholder:this.props.appStrings.search,onChange:this.onSearchChanged,onSearch:this.onSearchExecuted,onEscape:this.onEscape,autoComplete:"off",value:this.state.query,onClick:this.onClick,onFocus:this.onSearchBoxFocus,onBlur:this.onSearchBoxBlur,onContextMenu:this.onContextMenu})},t.prototype.renderSearchResults=function(){return this.props.defaultRender(this.props.menuListProps)},t.prototype.onSearchBoxFocus=function(e){this.setState({searchBoxFocused:!0})},t.prototype.onSearchBoxBlur=function(e){this.setState({searchBoxFocused:!1})},t.prototype.onClick=function(){this.activities.clicked=!0,this.props.onShowZeroTermMenu&&this.props.zeroTermMenuEnabled&&(this.activities.zeroTermMenuInvoked=!0,this.props.onShowZeroTermMenu())},t.prototype.onSearchExecuted=function(e){if(this.activities.entered=!0,this.isSearchResult()){var t=this.props.menuListProps.items?this.props.menuListProps.items[0]:void 0;!(null==t?void 0:t.onClick)||t.disabled?this.focusFirstMenuItem()||this.props.onSearchExecuted&&this.props.onSearchExecuted(e):t.onClick()}else!this.state.query&&this.props.onShowZeroTermMenu&&this.props.zeroTermMenuEnabled&&(this.activities.zeroTermMenuInvoked=!0,this.props.onShowZeroTermMenu())},t.prototype.isSearchResult=function(){return this.props.contextualUILocation===yu.a.SearchResult||this.props.contextualUILocation===yu.a.ZeroTermMenu},t.prototype.focusFirstMenuItem=function(){var e=this.menuRegion.current;if(!e)return!1;var t=Object(_o.j)(e,e);return!!t&&(t.focus(),!0)},t.prototype.onSearchChanged=function(e,t){var n=t||"",o=n.length>0;o&&(this.activities.typed=!0),this.activities.hasQuery=o,this.props.onSearchStateChanged&&this.props.onSearchStateChanged(o,n),this.setState({query:n})},t.prototype.onEscape=function(e){if(this.activities.escaped=!0,!this.state.query)return this.props.contextualUILocation===yu.a.ZeroTermMenu&&this.props.onHideZeroTermMenu?(this.props.onHideZeroTermMenu(),e.preventDefault(),void e.stopPropagation()):void(this.props.onEscape&&this.props.onEscape(e))},t.prototype.onContextMenu=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.onMenuOpen=function(){var e=this;this.activities={sessionStart:window.performance.now(),sessionId:this.props.sessionId,menuId:this.activities.menuId},(new Fl.a).setImmediate((function(){e.props.onMenuOpened&&e.props.onMenuOpened()}))},t.prototype.onMenuClosed=function(){this.props.onMenuClosed&&(this.activities.sessionDuration=window.performance.now()-this.activities.sessionStart,this.props.onMenuClosed(this.activities,yu.b.ContextMenu))},t.getDerivedStateFromProps=function(e,t){return""!==t.query&&e.hidden?{query:""}:null},t.contextType=Ys.a,t}(d.Component),zp=n(466),Hp=n(217),Np=Object(In.c)((function(){return{label:{maxWidth:320,textOverflow:"ellipsis",overflowX:"hidden"},divider:{margin:"1px 8px"},root:{},linkContent:{},icon:{},checkmarkIcon:{},secondaryText:{paddingLeft:"20px"},subMenuIcon:{},item:{},anchorLink:{},iconColor:{}}})),Vp=function(e){function t(t){var n=e.call(this,t)||this;return n.searchBoxId="contextualSearchBox",n.contextMenuWrapper=d.createRef(),n.getContextualMenuProps=function(){var e,t,o,i,r,a=n.useSearchableMenu(),s=a?Object(zp.a)(null===(e=n.props.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition,n.onItemExecute):n.props.menuDefinition,l=Object(cp.b)({menuDefinition:s,controlInMenuRendererFunction:a?n.controlInMenuTellMeRendererFunction:n.controlInMenuRendererFunction,location:yu.b.ContextMenu,subComponentStyles:Np(),arePerfImprovementsEnabled:null===(o=(t=n.context).isExperimentalFeatureEnabled)||void 0===o?void 0:o.call(t,"ContextualUIPerfImprovementsIsEnabled"),onMenuItemExecuted:n.useSearchableMenu()?void 0:n.onItemExecute,onSubMenuPositioned:n.props.onItemSubmenuOpen?n.onSubmenuPositioned:void 0,useStructurealMenuSections:null===(r=(i=n.context).isExperimentalFeatureEnabled)||void 0===r?void 0:r.call(i,Js.c.useStructurealMenuSections)},!0);return n.getMenuItemToExpand(s,l),l.focusZoneProps=Object(p.__assign)(Object(p.__assign)({},l.focusZoneProps),{shouldInputLoseFocusOnArrowKey:function(e){return n.isContextualSearchEnabled()&&e.id===n.searchBoxId}}),l},n.onContextMenuOpen=function(){var e=n.props,t=e.onMenuOpen,o=e.id;t&&t({id:o,location:yu.b.ContextMenu})},n.onDismiss=function(e,t){var o=n.props.onDismiss;o&&o(e,t)},n.onMouseDown=function(e){n.props.onDismiss&&!n.elementIsWithinContextMenu(e)&&n.onDismiss(e)},n.elementIsWithinContextMenu=function(e){return void 0!==e&&(n.contextMenuWrapper.current===e.target||Object(z.a)(n.contextMenuWrapper.current,e.target))},n.shadowRenderingIsEnabled=function(){var e,t;return null===(t=(e=n.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,"ContextMenuShadowRenderingIsEnabled")},n.maxHeight=function(){return window.innerHeight-2*Hp.a.floatieLargeControlHeight},n.onItemExecute=function(e,t){n.props.onItemExecute&&n.props.onItemExecute(e,n.getContextualUiLocation(),t)},n.onSubmenuPositioned=function(e,t){n.props.onItemSubmenuOpen&&n.props.onItemSubmenuOpen(t,n.getContextualUiLocation())},n.state={isShadowRendering:!1},n.renderSearchableMenuList=n.renderSearchableMenuList.bind(n),n.onSearchStateChanged=n.onSearchStateChanged.bind(n),n.onPositioned=n.onPositioned.bind(n),n.onShowZeroTermMenu=n.onShowZeroTermMenu.bind(n),n.controlInMenuRendererFunction=Fp(n.props.appIcons,n.props.appStrings),n.controlInMenuTellMeRendererFunction=Object(vo.e)(n.props.appIcons,n.props.appStrings),n.hasListeners=!1,n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.isShadowRendering&&!e.hidden?{isShadowRendering:!1}:null},t.prototype.shouldComponentUpdate=function(e,t){return!(this.props.hidden&&e.hidden&&!t.isShadowRendering)&&(!Object(ap.e)(this.props,e)||!Object(ap.e)(this.state,t))},t.prototype.render=function(){var e,t=this.props,n=t.id,o=t.target,i=t.directionalHint,r=t.positionAndHide,a=t.inputMethod,s=t.hidden;return d.createElement(sp.a.Provider,{value:Object(sp.b)(!!this.state.isShadowRendering)},d.createElement("div",{ref:this.contextMenuWrapper},d.createElement(lp.a,Object(p.__assign)({onRenderMenuList:this.isContextualSearchEnabled()?this.renderSearchableMenuList:void 0,onDismiss:this.onDismiss,onMenuOpened:this.onContextMenuOpen},this.getContextualMenuProps(),{directionalHint:i||A.DirectionalHint.bottomLeftEdge,directionalHintFixed:!1,alignTargetEdge:!0,target:o,calloutProps:{id:""+n,onPositioned:this.onPositioned,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,styles:(e=r,{root:{animation:"none"},container:e&&{opacity:0}}),calloutMaxHeight:this.maxHeight()},shouldFocusOnContainer:!this.isContextualSearchEnabled()&&a!==ll.a.Keyboard&&!this.controlIdToExpand,"data-unique-id":"ContextMenu",hidden:s,shouldUpdateWhenHidden:this.state.isShadowRendering}))))},t.prototype.componentDidMount=function(){var e=this;this.props.hidden||this.addListeners(),Object(Dp.a)((function(){e.contextualItemRef&&e.contextualItemRef.current&&e.contextualItemRef.current.openSubMenu()}));var t=this.props,n=t.populateMenuCallback,o=t.id;Object(_p.a)()&&this.shadowRenderingIsEnabled()&&n&&(window.requestIdleCallback((function(){n(ll.a.Mouse,o,!0)}),void 0,"ContextMenu-"+this.props.id+"-ShadowMenuOpen"),window.requestIdleCallback((function(){e.setState({isShadowRendering:!0})}),void 0,"ContextMenu-"+this.props.id+"-StartShadowRendering"))},t.prototype.componentDidUpdate=function(e){var t=this;this.props.hidden?this.removeListeners():this.addListeners(),this.state.isShadowRendering&&void 0!==this.props.menuDefinition&&this.setState({isShadowRendering:!1}),Object(Dp.a)((function(){(e.hidden&&!t.props.hidden||e.menuDefinition!==t.props.menuDefinition)&&t.contextualItemRef&&t.contextualItemRef.current&&t.contextualItemRef.current.openSubMenu()}))},t.prototype.componentWillUnmount=function(){this.removeListeners()},t.prototype.onPositioned=function(e){var t=this.props.onPositioned;t&&t(e),this.targetEdge=(null==e?void 0:e.targetEdge)||Gi.b.bottom},t.prototype.renderSearchableMenuList=function(e,t){var n,o,i,r,a,s=this,l={sessionId:this.props.sessionId,contextualUILocation:this.getContextualUiLocation(),zeroTermMenuEnabled:null===(n=this.props.searchableContextualMenuProps)||void 0===n?void 0:n.zeroTermMenuEnabled,menuId:this.props.id,onEscape:function(e){return s.onDismiss(e,!0)},onSearchStateChanged:this.onSearchStateChanged,appStrings:this.props.appStrings,appIcons:this.props.appIcons,hidden:this.props.hidden,searchBoxOnTheBottom:this.targetEdge===Gi.b.top,menuListProps:e,defaultRender:t,searchBoxId:this.searchBoxId,onShowZeroTermMenu:this.onShowZeroTermMenu,onHideZeroTermMenu:null===(o=this.props.searchableContextualMenuProps)||void 0===o?void 0:o.onHideZeroTermMenu,onSearchExecuted:null===(i=this.props.searchableContextualMenuProps)||void 0===i?void 0:i.openSearchPane,onMenuOpened:null===(r=this.props.searchableContextualMenuProps)||void 0===r?void 0:r.onAfterMenuOpen,onMenuClosed:null===(a=this.props.searchableContextualMenuProps)||void 0===a?void 0:a.onAfterMenuDismiss};return d.createElement(Wp,Object(p.__assign)({},l))},t.prototype.onShowZeroTermMenu=function(){this.props.searchableContextualMenuProps&&(this.props.onFloatieDismiss&&this.props.onFloatieDismiss(),this.props.searchableContextualMenuProps.onShowZeroTermMenu())},t.prototype.onSearchStateChanged=function(e,t){this.props.searchableContextualMenuProps&&(e&&this.props.onFloatieDismiss&&this.props.onFloatieDismiss(),this.props.searchableContextualMenuProps.onSearchStateChanged(e,t))},t.prototype.isContextualSearchEnabled=function(){return!!this.props.searchableContextualMenuProps},t.prototype.useSearchableMenu=function(){var e;return Fu(null===(e=this.props.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition)},t.prototype.getMenuItemToExpand=function(e,t){var n=this;e&&(this.controlIdToExpand=void 0,e.sections.forEach((function(e){e.controls.forEach((function(e){if("AppFlyoutAnchorProps"!==e.type&&"AppSplitButtonProps"!==e.type||!e.menuDefinition||!e.menuDefinition.shouldAutoOpen);else if(n.controlIdToExpand=e.id,n.controlIdToExpand&&t){var o=Object(Ka.d)(t.items,(function(e){return e.key===n.controlIdToExpand}));n.contextualItemRef=o&&o.componentRef}else n.contextualItemRef=void 0}))})))},t.prototype.addListeners=function(){this.hasListeners||(window.document.body.addEventListener("mousedown",this.onMouseDown,!0),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(window.document.body.removeEventListener("mousedown",this.onMouseDown,!0),this.hasListeners=!1)},t.prototype.getContextualUiLocation=function(){var e;return Du(null===(e=this.props.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition)},t.contextType=Ys.a,t}(d.Component);function Gp(e,t){return function(e,t){if(e.left&&e.top&&t.left&&t.top)return Math.round(Math.sqrt(Math.pow(e.left-t.left,2)+Math.pow(e.top-t.top,2)));return 0}(e,function(e,t){var n={left:e.left,top:e.top};null!=t&&n.left&&n.top&&(n.left<t.left&&(n.left=t.left),n.left>t.left+t.width&&(n.left=t.left+t.width),n.top<t.top&&(n.top=t.top),n.top>t.top+t.height&&(n.top=t.top+t.height));return n}(e,t))}var Up=n(1579),Kp={root:{height:Hp.a.floatieRowHeight,padding:"0 3px",fontSize:12}},qp={root:{height:Hp.a.floatieLargeControlHeight,minWidth:Hp.a.minimumFloatieLargeControlWidth,padding:"2px 2px 0px 2px",fontSize:12},flexContainer:{flexDirection:"column"},icon:{width:Hp.a.floatieLargeIconSize,height:Hp.a.floatieLargeIconSize,padding:"2px 12px 2px 12px"},textContainer:{padding:"2px 2px 0px 2px",fontSize:14}},Qp={root:{height:Hp.a.floatieRowHeight,minWidth:Hp.a.floatieRowHeight,padding:"2px 2px 0px 2px",fontSize:12},flexContainer:{flexDirection:"row"},icon:{width:Hp.a.menuButtonWidth,height:Hp.a.menuButtonWidth,padding:"0px 10px 0px 0px"},textContainer:{fontSize:14,fontWeight:400}},Jp={display:"inline-block",lineHeight:"14px",fontSize:"12px"};function Yp(e){if(e){var t=e.split(" ");return t.length>1?function(){return d.createElement("div",{style:Jp},d.createElement("div",null,t[0]),d.createElement("div",null,t.slice(1).join(" ")))}:function(){return d.createElement("span",{style:Jp},e)}}}var Xp=n(1190),Zp=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Xp.a,Object(p.__assign)({},this.props,{hideLabel:!0,styles:Kp,variant:"floatieButton",dataAutomationType:"FloatieButton",keytipProps:void 0}))},t}(d.PureComponent),$p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(Xp.a,Object(p.__assign)({},this.props,{styles:qp,variant:"floatieLargeButton",dataAutomationType:"FloatieLargeButton",onRenderText:Yp(this.props.label),keytipProps:void 0}))},t}(d.PureComponent),ed=n(1183),td=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(ed.a,Object(p.__assign)({},this.props,{hideLabel:!0,styles:Kp,variant:"floatieButton",dataAutomationType:"FloatieToggleButton",keytipProps:void 0}))},t}(d.PureComponent),nd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(ed.a,Object(p.__assign)({},this.props,{styles:qp,variant:"floatieLargeButton",dataAutomationType:"FloatieLargeToggleButton",onRenderText:Yp(this.props.hideLabel?void 0:this.props.label),keytipProps:void 0}))},t}(d.PureComponent),od=n(1174),id=n(922),rd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(od.a,Object(p.__assign)({},this.props,{directionalHintFixed:!1,hideLabel:!0,variant:"floatieMenuButton",styles:Kp,dataAutomationType:"FloatieFlyoutAnchor",keytipProps:void 0}))},t}(d.PureComponent),ad=Object(In.c)((function(e,t,n){var o={root:{height:Hp.a.floatieLargeControlHeight,padding:"2px 2px 0px 2px"},flexContainer:{flexDirection:"column"},label:{margin:0,textAlign:"center"}},i={height:Hp.a.floatieSingleRowFlyoutAnchorDefaultLabelHeight,padding:"2px 2px 0px 2px",whiteSpace:"nowrap"},r={height:Hp.a.floatieSingleRowFlyoutAnchorLabelHeight,padding:"2px 2px 0px 2px"};return o.textContainer=n?i:r,Object(P.H)(e,o,t)})),sd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._onRenderIcon=function(e){return function(){var n,o=t.props,i=o.icon,r=o.iconColor,a=o.styles,s=null!=i?i:{display:"none"},l=null==a?void 0:a.icon,c=null==a?void 0:a.menuIcon,u=null===(n=t.props.hideChevron)||void 0===n||n;return d.createElement("div",{className:Object(P.eb)(ld)},d.createElement(I.a,Object(p.__assign)({},Object(vn.a)(i,r),{className:Object(P.eb)(ud,s,l)})),u&&d.createElement(I.a,Object(p.__assign)({iconName:"ChevronDown"},Object(vn.a)(Object(id.a)(t.props)),{className:Object(P.eb)(cd(e),c)})))}},t}return Object(p.__extends)(t,e),t.prototype.render=function(){var e,t=this,n=null===(e=this.props.hideChevron)||void 0===e||e;return d.createElement(lo.a,null,(function(e){return d.createElement(od.a,Object(p.__assign)({},t.props,{styles:ad(qp,t.props.styles,t.props.isDefaultLabelRendering),dataAutomationType:"FloatieSingleRowFlyoutAnchor",directionalHintFixed:!1,useLegacyButton:!0,onRenderText:t.props.isDefaultLabelRendering?void 0:Yp(t.props.hideLabel?void 0:t.props.label),onRenderIcon:t._onRenderIcon(e),hideChevron:n,keytipProps:void 0}))}))},t}(d.PureComponent),ld={display:"flex",alignItems:"center"},cd=function(e){return{height:12,lineHeight:12,width:12,fill:Object(qa.a)()?Object(Pi.a)(e).textColor:"#444444",padding:"6px 0px"}},ud={width:Hp.a.floatieLargeIconSize,height:Hp.a.floatieLargeIconSize,padding:2,lineHeight:20,margin:0},pd=n(1189),dd=Object(In.c)((function(){var e={root:{padding:"0 2px 0 5px"},splitButtonMenuButton:{height:Hp.a.floatieRowHeight,width:Hp.a.menuButtonWidth,padding:0},splitButtonContainer:{height:Hp.a.floatieRowHeight}};return Object(P.H)(Kp,e)})),hd=Object(In.c)((function(){var e={splitButtonMenuButton:{height:Hp.a.floatieLargeControlHeight,width:Hp.a.menuButtonWidth},splitButtonContainer:{height:Hp.a.floatieLargeControlHeight,padding:"0px 2px 0px 0px"}};return Object(P.H)(qp,e)})),gd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(pd.a,Object(p.__assign)({},this.props,{hideLabel:!0,styles:dd(),directionalHintFixed:!1,dataAutomationType:"FloatieSplitButton",variant:"floatieSplitButton",keytipProps:void 0,shadowRenderMenu:!1}))},t}(d.PureComponent),md=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(pd.a,Object(p.__assign)({},this.props,{styles:hd(),directionalHintFixed:!1,dataAutomationType:"FloatieLargeSplitButton",useLegacyButton:!0,onRenderText:Yp(this.props.label),keytipProps:void 0,shadowRenderMenu:!1}))},t}(d.PureComponent),bd=n(1597),fd=n(309),yd=Object(In.c)((function(e){return{container:[{height:Hp.a.floatieRowHeight,display:"inline-flex"},Object(fd.b)(0,e)],root:{paddingRight:Hp.a.menuButtonWidth,height:28}}})),vd={root:{width:Hp.a.menuButtonWidth,height:28}},Cd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(bd.a,Object(p.__assign)({},this.props,{dataAutomationType:"FloatieComboBox",styles:yd(this.props.pinToPreviousComboBox),caretDownButtonStyles:vd,keytipProps:void 0,shadowRenderMenu:!1,directionalHintDynamic:!0}))},t}(d.PureComponent),xd=n(1587),Sd={root:{marginRight:0,height:28},subComponentStyles:{textFieldStyles:{subComponentStyles:{buttonStyles:{root:{width:Hp.a.menuButtonWidth,height:28}}}},dropDownStyles:{}}},Ed=function(e){return d.createElement(xd.a,Object(p.__assign)({},e,{styles:Sd,keytipProps:void 0}))},wd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this;return d.createElement(lo.a,null,(function(t){return d.createElement(fp.a,Object(p.__assign)({},e.props,{dataAutomationType:"FloatieCompoundButton",styles:Object(ao.b)(t,{label:{fontWeight:P.k.bold,margin:"0"}}),keytipProps:void 0}))}))},t}(d.PureComponent);var kd=Object(In.c)((function(e,t){return function(n){e&&e(!0),t&&t(n)}})),Td=Object(In.c)((function(e,t){return function(n){e&&e(!1),t&&t(n)}})),Id=Object(In.c)((function(e,t){return function(n){e&&e(void 0),t&&t(n)}})),Rd=function(e,t){return d.createElement("span",{key:e.key},function(e,t,n,o){var i=isNaN(n)?void 0:n,r=isNaN(o)?void 0:o;switch(e.type){case"AppCompoundButtonProps":return d.createElement(wd,Object(p.__assign)({positionInSet:i,setSize:r},Object(bp.b)(e,t),{lang:e.lang,enableFocusOnHover:!0}));case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppFontStylesFullGalleryProps":case"AppCharacterCodeGalleryProps":case"RibbonChangeColorsFullGalleryProps":return Ip(e,Object(vo.m)(t),n,o);default:throw new Error("The control of type "+e.type+" is not valid in a Floatie menu")}}(e.data,Object(vo.m)(t),Number(e["aria-posinset"]),Number(e["aria-setsize"])))},Od=Object(Rp.a)((function(e,t){return{key:e,data:t,onRender:Rd,customOnRenderListLength:Object(vo.i)(t)}}));var Pd=Object(In.c)((function(e,t){return function(n){var o=n.controlProps,i=n.subComponentStyles,r=n.location,a=n.arePerfImprovementsEnabled,s=n.onMenuItemExecuted,l=n.onSubMenuPositioned,c=n.useStructurealMenuSections;return o.filter((function(e){return Object(vo.i)(e)>0})).map((function(n){var o=Object(p.__assign)(Object(p.__assign)({},Object(vo.a)(n,s)),{keytipProps:void 0,location:r,appStrings:t});switch(o.type){case"AppButtonProps":return Object(vo.b)(Object(ga.a)(o.id,o.location),o,i);case"AppToggleButtonProps":return Object(vo.l)(o,i);case"AppFlyoutAnchorProps":return(a?vo.g:vo.f)(Object(ga.a)(o.id,o.location),o,Pd(e,t),e,l,i,i,a,s,c);case"AppSplitButtonProps":return(a?vo.k:vo.j)(Object(ga.a)(o.id,o.location),o,Pd(e,t),e,l,i,i,a,s,c);case"AppPersonaButtonProps":case"AppColorPickerProps":case"AppListGalleryProps":case"AppIconFullGalleryProps":case"AppFontStylesFullGalleryProps":case"AppCharacterCodeGalleryProps":case"AppCompoundButtonProps":case"RibbonChangeColorsFullGalleryProps":return Od(o.id,o);default:throw new Error("The control of type "+o.type+" is not valid in a Floatie menu")}}))}}));function Fd(e){var t=e.flyoutAnchorProps;return{type:"AppFlyoutAnchorProps",id:e.id,disabled:e.disabled,icon:t&&t.icon,label:t&&t.label||e.menuLauncherLabel,menuDefinition:e.expandedOptions,onExecute:e.onMenuButtonExecute,onAfterMenuDismiss:e.onAfterMenuDismiss,keytipProps:e.keytipProps}}var Dd={padding:"2px 0",display:"flex"},_d=Object(In.c)((function(e){return Object(P.eb)(Dd,e)})),jd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.controls,n=e.controlRendererFunction;return d.createElement("div",{style:Dd},t.map((function(e){return Ld(e,n)})))},t}(d.PureComponent),Bd=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.controls,n=e.controlRendererFunction;return d.createElement("div",{className:_d(this.props.customStyles)},t.map((function(e){return Ld(e,n)})))},t}(d.PureComponent);function Ld(e,t){return d.createElement("div",{key:e.id},t(Object(p.__assign)(Object(p.__assign)({},e),{location:yu.b.Floatie})))}var Md=n(1124),Ad=n(793),Wd=Object(In.c)((function(e){return{display:e?"none":"flex"}})),zd=Object(In.c)((function(e,t){return Object(P.db)({wrapper:{position:"relative",maxWidth:"490px"},container:Object(P.eb)(Hd,Nd),leftFade:Object(P.eb)(Vd,Gd(e,t)),rightFade:Object(P.eb)(Vd,Ud(e,t))})})),Hd={display:"inline-flex",width:"100%",overflowX:"scroll",whiteSpace:"nowrap",MsOverflowStyle:"none",selectors:{"::-webkit-scrollbar":{display:"none"}}},Nd={"scrollbar-width":"none"},Vd={position:"absolute",top:0,width:"25px",height:"100%",zIndex:1,pointerEvents:"none"},Gd=Object(In.c)((function(e,t){return{left:0,backgroundImage:"linear-gradient(to right, "+Object(Pi.a)(e).menuBackgroundColor+" 20%, transparent)",visibility:t?"visible":"hidden"}})),Ud=Object(In.c)((function(e,t){return{right:0,backgroundImage:"linear-gradient(to left,  "+Object(Pi.a)(e).menuBackgroundColor+" 20%, transparent)",visibility:t?"hidden":"visible"}})),Kd=Object(In.c)((function(e,t,n){var o=Object(Pi.a)(e);return Object(P.db)({root:{animation:"none",border:"none",lineHeight:"14px"},calloutMain:{background:o.menuBackgroundColor,display:"inline-flex",alignItems:"center",padding:"3px 4px"},container:t?{opacity:0}:{opacity:n}})})),qd=Object(In.c)((function(e){return Object(P.db)(Object(Ad.b)(e),{divider:{height:Hp.a.floatieDividerHeight},wrapper:{padding:"0 5px"}})})),Qd=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.getFloatieGroupType=function(){switch(t.props.type){case"MultiRowFloatieGroup":return d.createElement("div",null,d.createElement(jd,{key:t.props.id+"TopRow",controls:t.props.topControlsRow,controlRendererFunction:t.props.controlRendererFunction}),d.createElement(jd,{key:t.props.id+"BottomRow",controls:t.props.bottomControlsRow,controlRendererFunction:t.props.controlRendererFunction}));case"SingleRowFloatieGroup":return d.createElement("div",null,d.createElement(Bd,Object(p.__assign)({},t.props,{controlRendererFunction:t.props.controlRendererFunction,customStyles:t.props.customStyles})));case"SingleControlFloatieGroup":var e=Object(p.__assign)(Object(p.__assign)({},t.props),{controls:[t.props.control]});return d.createElement("div",null,d.createElement(Bd,Object(p.__assign)({},e,{controlRendererFunction:e.controlRendererFunction})))}},t}return Object(p.__extends)(t,e),t.prototype.shouldComponentUpdate=function(e){return this.props.hidden?this.props.hidden!==e.hidden:!Object(ap.e)(this.props,e)},t.prototype.render=function(){return d.createElement("div",{style:Wd(this.props.hidden),id:this.props.id+"Group"},this.props.renderDivider&&d.createElement("div",null,d.createElement(Md.a,{getClassNames:qd})),d.createElement("div",null,this.getFloatieGroupType()))},t}(d.Component),Jd="ReactFloatie",Yd=function(e){function t(t){var n=e.call(this,t)||this;n.floatieWrapper=d.createRef(),n.floatieExtraDistance=0,n.initialMouseDistance=-1,n.floatieBounds=null,n.totalShadowRenderingTime=0,n.renderFloatieGroups=function(){var e,t,o=n.props.groups;return n.isShadowRenderingEnabled()&&(o=n.state.isShadowRendering?null!==(t=null===(e=n.props.floatieGroupsToShadowRender)||void 0===e?void 0:e.slice(0,n.state.itemsToRender))&&void 0!==t?t:[]:n.props.floatieGroupsToShadowRender),n.renderAllFloatieGroups(o,n.props.isSmallScreenFloatie,n.props.scrollStyles)},n.renderAllFloatieGroups=function(e,t,o){if(t&&o){var i=e.find((function(e){return"ContextMenu"===e.id})),r=e.filter((function(e){return"ContextMenu"!==e.id}));return d.createElement(d.Fragment,null,d.createElement("div",{className:o.wrapper},d.createElement("div",{className:o.leftFade}),d.createElement("div",{className:o.container,onScroll:n.onSmallScreenSwipe},r.map((function(e){return n.renderFloatieGroup(e)}))),d.createElement("div",{className:o.rightFade})),i&&n.renderFloatieGroup(i))}return e.map((function(e){return n.renderFloatieGroup(e)}))},n.renderFloatieGroup=function(e){return d.createElement(Qd,Object(p.__assign)({},e,{key:e.id,renderDivider:n.renderFloatieGroupDivider(e.id),hidden:n.isShadowRenderingEnabled()&&!n.floatieGroupShouldBeShown(e.id),controlRendererFunction:n.getFloatieGroupRenderFunction(e)}))},n.renderFloatieGroupDivider=function(e){return n.props.groups[0]&&n.props.groups[0].id!==e},n.onMouseMove=function(e){if(!n.props.hidden&&n.state.fadeOutFloatie&&!n.props.attachedContextMenu){n.initialMouseDistance=Gp(n.props.originalTarget,n.floatieBounds);var t=Gp({left:e&&e.clientX,top:e&&e.clientY},n.floatieBounds);if(0===t)n.floatieExtraDistance=0,n.setState((function(){return{opacity:"1",inRubberbandState:!1}}));else{n.state.inRubberbandState&&((0===n.floatieExtraDistance||t<n.floatieExtraDistance)&&(n.floatieExtraDistance=t),t-=n.floatieExtraDistance);var o=255-4*(t=Math.max(t-n.initialMouseDistance,0));o<=0&&t>=63.75?n.props.onDismiss&&n.props.onDismiss(e):n.setState((function(){return{opacity:Math.max(o/255,0).toFixed(2)}}))}}},n.onSmallScreenSwipe=function(e){var t=e.target;if(t.parentElement&&t.parentElement.children&&!(t.parentElement.children.length<2)){var n=t.parentElement,o=n.firstChild,i=n.lastChild,r=0===t.scrollLeft;o.style.visibility=r?"hidden":"visible";var a=t.scrollWidth-t.scrollLeft-t.clientWidth<1;i.style.visibility=a?"hidden":"visible"}},n.onMenuToggled=function(e){n.setState({fadeOutFloatie:!e,inRubberbandState:!e}),n.floatieExtraDistance=0,n.props.onMenuToggled&&n.props.onMenuToggled(e)},n.updateFloatieBounds=function(e){n.getFloatieBounds(),n.props.onPositioned&&n.props.onPositioned(e)},n.renderMoreItemsInIdleCallback=function(){var e=n.state,t=e.isShadowRendering,o=e.itemsToRender,i=n.props.floatieGroupsToShadowRender;if(t&&void 0!==i)if(o<i.length){n.currentShadowRenderingStart&&(n.totalShadowRenderingTime+=performance.now()-n.currentShadowRenderingStart);var r=Object(Up.a)(n.totalShadowRenderingTime,o);Object(_p.a)()&&window.requestIdleCallback((function(){n.currentShadowRenderingStart=performance.now(),n.setState({itemsToRender:o+r})}),void 0,"Floatie-"+Jd+"-ShadowRenderIncrement")}else n.setState({isShadowRendering:!1})},n.isShadowRenderingEnabled=function(){return!!n.props.floatieGroupsToShadowRender};var o=t.appIcons,i=t.appStrings;return n.controlInMenuRendererFunction=Pd(o,i),n.controlRendererFunction=function(e,t,n){return function(o){switch(o.type){case"AppButtonProps":return d.createElement(Zp,Object(p.__assign)({},o));case"AppToggleButtonProps":return d.createElement(td,Object(p.__assign)({},o));case"AppFlyoutAnchorProps":return d.createElement(rd,Object(p.__assign)({},o,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:kd(n,o.onExecute),onAfterMenuDismiss:Td(n,o.onAfterMenuDismiss)}));case"AppSplitButtonProps":return d.createElement(gd,Object(p.__assign)({},o,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:kd(n,o.onMenuButtonExecute),onAfterMenuDismiss:Td(n,o.onAfterMenuDismiss)}));case"AppComboBoxProps":return d.createElement(Cd,Object(p.__assign)({},o,{onMenuOpen:kd(n,o.onMenuOpen),onAfterMenuDismiss:Td(n,o.onAfterMenuDismiss),downChevronIcon:e.downChevron}));case"AppFontPickerProps":return d.createElement(Ed,Object(p.__assign)({},o,{onMenuOpen:kd(n,o.onMenuOpen),onAfterMenuDismiss:Td(n,o.onAfterMenuDismiss),downChevronIcon:e.downChevron}));default:throw new Error("The control of type "+o.type+" is not a valid Floatie control")}}}(o,n.controlInMenuRendererFunction,n.onMenuToggled),n.singleRowControlRendererFunction=function(e,t,n,o){return function(i){switch(i.type){case"AppButtonProps":return d.createElement($p,Object(p.__assign)({},i,{onExecute:i.dismissHostingSurfaceOnExecute?Id(o,i.onExecute):i.onExecute}));case"AppToggleButtonProps":return d.createElement(nd,Object(p.__assign)({},i,{onExecute:i.dismissHostingSurfaceOnExecute?Id(o,i.onExecute):i.onExecute}));case"AppFlyoutAnchorProps":return d.createElement(sd,Object(p.__assign)({},i,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?kd(n,i.onExecute):i.onExecute,onAfterMenuDismiss:n?Td(n,i.onAfterMenuDismiss):i.onAfterMenuDismiss}));case"AppFontStylesPreviewGalleryProps":case"AppIconPreviewGalleryProps":return d.createElement(sd,Object(p.__assign)({},Fd(i),{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onExecute:n?kd(n,i.onMenuButtonExecute):i.onMenuButtonExecute,onAfterMenuDismiss:n?Td(n,i.onAfterMenuDismiss):i.onAfterMenuDismiss}));case"AppSplitButtonProps":return d.createElement(md,Object(p.__assign)({},i,{controlInMenuRendererFunction:t,downChevronIcon:e.downChevron,onMenuButtonExecute:kd(n,i.onMenuButtonExecute),onAfterMenuDismiss:n?Td(n,i.onAfterMenuDismiss):i.onAfterMenuDismiss}));default:throw new Error("The control of type "+i.type+" is not a valid Floatie large control")}}}(o,n.controlInMenuRendererFunction,n.onMenuToggled,n.props.onDismiss),n.singleControlRendererFunction=function(e,t,n,o){return function(i){switch(i.type){case"AppFlyoutAnchorProps":return d.createElement(sd,Object(p.__assign)({},i,{controlInMenuRendererFunction:t,styles:o,downChevronIcon:e.downChevron,onExecute:n?kd(n,i.onExecute):i.onExecute,onAfterMenuDismiss:n?Td(n,i.onAfterMenuDismiss):i.onAfterMenuDismiss,isDefaultLabelRendering:!0}));default:throw new Error("The control of type "+i.type+" is not a valid Floatie single control")}}}(o,n.controlInMenuRendererFunction,n.onMenuToggled,Qp),n.hasListeners=!1,n.state={opacity:"1",fadeOutFloatie:!0,itemsToRender:0},n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){return t.isShadowRendering&&e.floatieGroupsToShadowRender&&!e.hidden?{isShadowRendering:!1,itemsToRender:e.floatieGroupsToShadowRender.length}:null},t.prototype.componentWillUnmount=function(){this.removeListeners()},t.prototype.addListeners=function(){this.props.hidden||this.props.attachedContextMenu||this.props.preventAutoDismiss||this.props.preventLightDismiss||!this.state.fadeOutFloatie||(window.document.body.addEventListener("mousemove",this.onMouseMove,!0),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(window.document.body.removeEventListener("mousemove",this.onMouseMove,!0),this.hasListeners=!1)},t.prototype.shouldComponentUpdate=function(e,t){return!(this.props.hidden&&e.hidden&&!t.isShadowRendering)&&(!Object(ap.e)(this.props,e)||!Object(ap.e)(this.state,t))},t.prototype.render=function(){var e=this,t=this.props,n=t.gapSpace,o=void 0===n?this.props.attachedContextMenu?12:22:n,i=t.target,r=t.hidden,a=t.directionalHint,s=void 0===a?A.DirectionalHint.topLeftEdge:a,l=t.positionAndHide;return d.createElement(lo.a,null,(function(t){return d.createElement("div",{ref:e.floatieWrapper},d.createElement(Yt.a,{id:Jd,hidden:r,doNotLayer:!0,gapSpace:o,directionalHint:s,directionalHintForRTL:s,directionalHintFixed:e.props.attachedContextMenu&&e.props.positionFloatieInSingleFrame,alignTargetEdge:!(e.props.attachedContextMenu&&e.props.positionFloatieInSingleFrame),target:i,isBeakVisible:!1,styles:Kd(t,l,e.state.opacity),onPositioned:e.updateFloatieBounds,preventDismissOnScroll:!0,preventDismissOnLostFocus:!0,"data-unique-id":"Floatie",bounds:ua.getBoundingWindowWithPaddingFabric,shouldUpdateWhenHidden:e.state.isShadowRendering},e.renderFloatieGroups()))}))},t.prototype.componentDidMount=function(){var e=this;this.props.hidden||this.addListeners(),Object(_p.a)()&&this.props.hidden&&this.isShadowRenderingEnabled()&&window.requestIdleCallback((function(){e.setState({isShadowRendering:!0})}),void 0,"Floatie-"+Jd+"-StartShadowRendering")},t.prototype.componentDidUpdate=function(e){this.state.isShadowRendering?this.renderMoreItemsInIdleCallback():this.props.hidden?(this.removeListeners(),this.initialMouseDistance=-1,this.setState((function(){return{opacity:"1",inRubberbandState:!1}}))):(this.hasListeners||this.addListeners(),(e.hidden||e.target!==this.props.target)&&this.getFloatieBounds())},t.prototype.floatieGroupShouldBeShown=function(e){return this.props.groups.some((function(t){return t.id===e}))},t.prototype.getFloatieGroupRenderFunction=function(e){switch(e.type){case"MultiRowFloatieGroup":return this.controlRendererFunction;case"SingleControlFloatieGroup":return this.singleControlRendererFunction;case"SingleRowFloatieGroup":default:return this.singleRowControlRendererFunction}},t.prototype.getFloatieBounds=function(){var e=this;requestAnimationFrame((function(){var t=document.getElementById(Jd);e.floatieBounds=t&&t.getBoundingClientRect()}))},t}(d.Component),Xd=n(276),Zd=n(948);function $d(e,t){var n=Object(Xd.c)(e);return n===Gi.b.top&&t===Gi.b.left||n===Gi.b.left&&t===Gi.b.top?A.DirectionalHint.topLeftEdge:n===Gi.b.bottom&&t===Gi.b.left||n===Gi.b.left&&t===Gi.b.bottom?A.DirectionalHint.bottomLeftEdge:n===Gi.b.bottom&&t===Gi.b.right||n===Gi.b.right&&t===Gi.b.bottom?A.DirectionalHint.bottomRightEdge:n===Gi.b.top&&t===Gi.b.right||n===Gi.b.right&&t===Gi.b.top?A.DirectionalHint.topRightEdge:A.DirectionalHint.topLeftEdge}var eh=n(943),th=function(e){function t(t){var n=e.call(this,t)||this;return n.contextualUIWrapper=d.createRef(),n.contextMenuIds=[],n.fullyPositioned=function(){var e=!(n.shouldRenderFloatie()&&!n.state.floatiePositioned),t=!(n.shouldRenderContextMenu()&&!n.state.contextMenuPositioned);return n.props.positionInOneFrameIsEnabled?n.state.fullyPositioned:t&&e},n.onPointerDown=function(e){n.elementIsWithinContextualUI(e)||n.dismissContextualUI(e)},n.onFocus=function(e){n.shouldDismissContextualUIOnFocusLost()&&!n.elementIsWithinContextualUI(e)&&n.dismissContextualUI(e)},n.onMouseWheel=function(e){n.shouldDismissContextualUIOnScroll()&&!n.elementIsWithinContextualUI(e)&&n.dismissContextualUI(e)},n.onPointerMove=function(e){!n.shouldDismissFloatieOnPointerMove()||n.elementIsWithinFloatie(e)||n.state.floatieMenuOpened||"touch"!==(null==e?void 0:e.pointerType)||n.dismissContextualUI(e)},n.onKeyDown=function(e){e&&e.keyCode===R.a.escape&&n.props.contextMenuProps.hidden&&!n.props.floatieProps.hidden&&!n.state.floatieMenuOpened&&n.dismissContextualUI(e)},n.onBoundingWindowRectChanged=function(){n.dismissContextualUI()},n.onContextMenuDismiss=function(e,t){n.props.onContextMenuDismiss(e,t,n.props.contextMenuProps.id)},n.onContextualItemExecute=function(e,t,o){n.props.onItemExecute&&n.props.onItemExecute(e,t,o),n.usageData&&n.usageData.executedCommands.push({commandId:e,location:t,parentId:o})},n.onSubMenuPositioned=function(e,t){n.usageData&&(n.usageData.openedSubMenu={commandId:e,location:t})},n.onContextMenuPositioned=function(e){if(n.props.contextMenuProps.attachedFloatie&&!n.state.contextMenuPositioned){var t=e.targetEdge,o=e.alignmentEdge;n.setState({floatieLayoutFromState:{directionalHint:$d(t,o),target:n.getContextMenuSelector(),gapSpace:12},contextMenuPositioned:!0})}else n.state.contextMenuPositioned||n.setState({contextMenuPositioned:!0})},n.onFloatiePositioned=function(e){if(n.props.floatieProps.attachedContextMenu&&!n.state.floatiePositioned){var t=e.targetEdge,o=e.alignmentEdge,i=function(e,t,n){var o=e.getBoundingClientRect(),i=o.left,r=o.right,a=o.top,s=o.bottom;return t===Gi.b.top&&n===Gi.b.left||t===Gi.b.right&&n===Gi.b.bottom?{directionalHint:A.DirectionalHint.topLeftEdge,target:{left:i,top:s}}:t===Gi.b.bottom&&n===Gi.b.right||t===Gi.b.left&&n===Gi.b.top?{directionalHint:A.DirectionalHint.bottomRightEdge,target:{left:r,top:a}}:t===Gi.b.bottom&&n===Gi.b.left||t===Gi.b.right&&n===Gi.b.top?{directionalHint:A.DirectionalHint.bottomLeftEdge,target:{left:i,top:a}}:t===Gi.b.top&&n===Gi.b.right||t===Gi.b.left&&n===Gi.b.bottom?{directionalHint:A.DirectionalHint.topRightEdge,target:{left:r,top:s}}:{directionalHint:A.DirectionalHint.topLeftEdge,target:{left:i,top:s}}}(document.getElementById(Jd),t,o),r=i.target,a=i.directionalHint;n.setState({floatieLayoutFromState:{directionalHint:a,target:r,gapSpace:0},floatiePositioned:!0})}else n.state.floatiePositioned||n.setState({floatiePositioned:!0})},n.onFloatieMenuToggled=function(e){n.setState({floatieMenuOpened:e})},n.state={contextMenuPositioned:!1,floatiePositioned:!1,floatieMenuOpened:!1,fullyPositioned:!1},n.hasListeners=!1,n.sessionId=0,n}return Object(p.__extends)(t,e),t.getDerivedStateFromProps=function(e,t){var n=e.contextMenuProps.target,o=e.floatieProps.target;return e.contextMenuProps.hidden||e.floatieProps.hidden||t.lastPropsContextMenuTarget===n||t.lastPropsFloatieTarget===o?{lastPropsContextMenuTarget:n,lastPropsFloatieTarget:o}:{contextMenuPositioned:!1,floatiePositioned:!1,floatieLayoutFromState:void 0,floatieMenuOpened:!1,fullyPositioned:!1,lastPropsContextMenuTarget:n,lastPropsFloatieTarget:o}},t.prototype.componentDidUpdate=function(e){if(this.props.positionInOneFrameIsEnabled&&!this.state.fullyPositioned)if(this.props.floatieProps.attachedContextMenu){var t=function(e,t,n,o){var i,r,a,s,l=A.DirectionalHint.topLeftEdge,c={top:0,left:0};if(null===e||null==t||void 0===n)return{directionalHint:l,target:c};var u=e.getBoundingClientRect(),p=t.getBoundingClientRect(),d=window.innerWidth,h=window.innerHeight,g=p.width,m=p.height,b=Object(Zd.e)(t),f=null!==(i=null==b?void 0:b.top)&&void 0!==i?i:0,y=h-(null!==(r=null==b?void 0:b.bottom)&&void 0!==r?r:0),v=null!==(a=n.left)&&void 0!==a?a:0,C=null!==(s=n.top)&&void 0!==s?s:0,x=C+m<=h-y,S=v+g<=d,E=x||C-m-f>0,w=u.width,k=u.height,T=x?C:E?C-m:f,I=x?C+m:E?C:m,R=S?v:v-g,O=S?v+g:v,P=x?T-(o+k)>0:I+o+k<h,F=!x&&I+y+o+k>h,D=F?O+w<d:R+w<d;return F?D?(l=A.DirectionalHint.rightTopEdge,c={top:T,left:O}):(l=A.DirectionalHint.leftTopEdge,c={top:T,left:R}):x&&P&&D||!x&&!P&&D?(l=A.DirectionalHint.topLeftEdge,c={top:T,left:R}):x&&P&&!D||!x&&!P&&!D?(l=A.DirectionalHint.topRightEdge,c={top:T,left:O}):x&&!P&&D||!x&&P&&D?(l=A.DirectionalHint.bottomLeftEdge,c={top:I,left:R}):(l=A.DirectionalHint.bottomRightEdge,c={top:I,left:O}),{directionalHint:l,target:c}}(document.getElementById(Jd),document.querySelector(this.getContextMenuSelector()),this.props.contextMenuProps.target,12);this.setState({floatieLayoutFromState:Object(p.__assign)(Object(p.__assign)({},t),{gapSpace:12}),fullyPositioned:!0},this.addListeners)}else this.setState({fullyPositioned:!0},this.addListeners);else this.isContextualUIVisible()?this.addListeners():this.removeListeners();var n=this.isContextualUIVisible(),o=this.isContextualUIVisibleFromProps(e);n&&!o?this.onShow():!n&&o&&this.onHide()},t.prototype.componentDidMount=function(){this.isContextualUIVisible()&&this.addListeners()},t.prototype.componentWillUnmount=function(){this.removeListeners()},t.prototype.render=function(){return d.createElement(ip.a,{hostId:this.props.containerId},d.createElement("div",{ref:this.contextualUIWrapper},this.renderContextMenu(),this.renderFloatie()))},t.prototype.menuIdHasBeenRenderedBefore=function(e){return Object(Ka.e)(this.contextMenuIds,(function(t){return t===e}))>-1},t.prototype.renderContextMenu=function(){var e,t,n=this,o=Object(rp.e)(),i=this.props,r=i.contextMenuProps,a=i.contextMenusToShadowRender,s=i.populateMenuCallback,l=i.onFloatieDismiss,c=i.positionInOneFrameIsEnabled,u=[];return(null===(t=(e=this.context).isExperimentalFeatureEnabled)||void 0===t?void 0:t.call(e,"IDBasedContextMenusIsEnabled"))?(a&&a.forEach((function(e,t){n.menuIdHasBeenRenderedBefore(t)||n.contextMenuIds.push(t)})),this.menuIdHasBeenRenderedBefore(r.id)||this.contextMenuIds.push(r.id),u=this.contextMenuIds.map((function(e){return d.createElement(Vp,Object(p.__assign)({},r,{menuDefinition:a&&a.has(e)?a.get(e):r.menuDefinition,sessionId:n.sessionId,key:e,id:e,onPositioned:c?void 0:n.onContextMenuPositioned,onDismiss:n.onContextMenuDismiss,onFloatieDismiss:l,positionAndHide:n.shouldPositionContextMenuHidden(),hidden:!n.shouldRenderContextMenu(e),populateMenuCallback:s,onItemExecute:n.onContextualItemExecute,onItemSubmenuOpen:n.onSubMenuPositioned}))}))):u.push(d.createElement(Vp,Object(p.__assign)({},r,{sessionId:this.sessionId,key:r.id,id:r.id,onPositioned:c?void 0:this.onContextMenuPositioned,onDismiss:this.onContextMenuDismiss,onFloatieDismiss:l,positionAndHide:this.shouldPositionContextMenuHidden(),hidden:!this.shouldRenderContextMenu(),onItemExecute:this.onContextualItemExecute,onItemSubmenuOpen:this.onSubMenuPositioned}))),o?u:d.createElement(Zi.a,null,u)},t.prototype.renderFloatie=function(){var e=this,t=Object(rp.e)(),n=this.props,o=n.floatieProps,i=n.onFloatieDismiss,r=n.useSmallScreenLayout,a=n.floatieGroupsToShadowRender,s=n.positionInOneFrameIsEnabled,l=this.state.floatieLayoutFromState,c=d.createElement(lo.a,null,(function(t){return d.createElement(Yd,Object(p.__assign)({},o,o.attachedContextMenu&&l,{originalTarget:o.target,onPositioned:s?void 0:e.onFloatiePositioned,onDismiss:i,onMenuToggled:e.onFloatieMenuToggled,positionAndHide:e.shouldPositionFloatieHidden(),hidden:s?!e.shouldRenderFloatieV2():!e.shouldRenderFloatie(),isSmallScreenFloatie:r,scrollStyles:zd(t,Object(E.a)()),floatieGroupsToShadowRender:a,positionFloatieInSingleFrame:s,onItemExecute:e.onContextualItemExecute,onItemSubmenuOpen:e.onSubMenuPositioned}))}));return t?c:d.createElement(Zi.a,{appColors:this.props.floatieProps.appColors},c)},t.prototype.addListeners=function(){!this.hasListeners&&this.fullyPositioned()&&(this.props.floatieProps.preventAutoDismiss||(window.document.body.addEventListener("pointerdown",this.onPointerDown,!0),window.document.body.addEventListener("wheel",this.onMouseWheel,!0),window.document.body.addEventListener("focus",this.onFocus,!0),window.document.body.addEventListener("pointermove",this.onPointerMove,!0),window.document.body.addEventListener("keydown",this.onKeyDown,!0),Object(eh.t)("ContextualUI",this.onBoundingWindowRectChanged)),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(window.document.body.removeEventListener("pointerdown",this.onPointerDown,!0),window.document.body.removeEventListener("wheel",this.onMouseWheel,!0),window.document.body.removeEventListener("focus",this.onFocus,!0),window.document.body.removeEventListener("pointermove",this.onPointerMove,!0),window.document.body.removeEventListener("keydown",this.onKeyDown,!0),Object(eh.w)("ContextualUI"),this.hasListeners=!1)},t.prototype.dismissContextualUI=function(e){!this.props.floatieProps.hidden&&this.props.onFloatieDismiss(e),!this.props.contextMenuProps.hidden&&this.onContextMenuDismiss(e)},t.prototype.startSessionLog=function(){var e,t,n;this.usageData={sessionId:this.sessionId,menuId:this.props.contextMenuProps.id,menuVisualization:(t=this.props,n=[],t.floatieProps.hidden||n.push(yu.a.Floatie),t.contextMenuProps.hidden||n.push(yu.a.StandardContextMenu),n),sessionStart:window.performance.now(),sessionDuration:0,executedCommands:[],offeredCommands:[],menuTargetType:(null===(e=this.props.contextMenuProps.menuDefinition)||void 0===e?void 0:e.menuTargetType)||"Unknown",visualizationAtClose:yu.a.StandardContextMenu,invocationMethod:this.props.contextMenuProps.inputMethod}},t.prototype.completeSessionLog=function(){var e,t;this.props.onInteractionCompleted&&this.usageData&&(this.usageData.sessionDuration=window.performance.now()-this.usageData.sessionStart,this.usageData.offeredCommands=function(e){var t,n=void 0;return(null===(t=e.searchableContextualMenuProps)||void 0===t?void 0:t.menuDefinition)?n=e.searchableContextualMenuProps.menuDefinition:e.menuDefinition&&(n=e.menuDefinition),_u(n)}(this.props.contextMenuProps),this.usageData.visualizationAtClose=Du(null===(e=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===e?void 0:e.menuDefinition),this.usageData.zeroTermMenuEnabled=null===(t=this.props.contextMenuProps.searchableContextualMenuProps)||void 0===t?void 0:t.zeroTermMenuEnabled,this.props.onInteractionCompleted(this.usageData)),this.sessionId=this.sessionId+1,this.usageData=void 0},t.prototype.elementIsWithinContextualUI=function(e){return void 0!==e&&(this.contextualUIWrapper.current===e.target||Object(z.a)(this.contextualUIWrapper.current,e.target))},t.prototype.elementIsWithinFloatie=function(e){var t=document.getElementById(Jd);return void 0!==e&&(this.contextualUIWrapper.current===e.target||Object(z.a)(this.contextualUIWrapper.current,e.target))||this.pointIsWithinFloatie(t,e)},t.prototype.pointIsWithinFloatie=function(e,t){if(!e||!t)return!1;var n=e.getBoundingClientRect();return t.clientX>n.x&&t.clientX<n.x+n.width&&t.clientY>n.y&&t.clientY<n.y+n.height},t.prototype.shouldRenderContextMenu=function(e){var t,n;return e&&(null===(n=(t=this.context).isExperimentalFeatureEnabled)||void 0===n?void 0:n.call(t,"IDBasedContextMenusIsEnabled"))?!this.props.contextMenuProps.hidden&&e===this.props.contextMenuProps.id:!this.props.contextMenuProps.hidden},t.prototype.shouldRenderFloatie=function(){return!this.props.floatieProps.hidden&&(this.props.contextMenuProps.hidden||this.state.contextMenuPositioned)},t.prototype.shouldPositionContextMenuHidden=function(){return this.props.positionInOneFrameIsEnabled?!(!this.props.contextMenuProps.attachedFloatie||this.state.fullyPositioned):!this.props.floatieProps.hidden&&!this.state.floatiePositioned},t.prototype.shouldPositionFloatieHidden=function(){return this.props.positionInOneFrameIsEnabled?!(!this.props.floatieProps.attachedContextMenu||this.state.fullyPositioned):!this.props.contextMenuProps.hidden&&!this.state.floatiePositioned},t.prototype.shouldDismissContextualUIOnFocusLost=function(){return!this.props.contextMenuProps.hidden},t.prototype.shouldDismissContextualUIOnScroll=function(){return!this.props.floatieProps.hidden&&this.props.contextMenuProps.hidden},t.prototype.shouldDismissFloatieOnPointerMove=function(){return!this.props.floatieProps.hidden&&this.props.contextMenuProps.hidden},t.prototype.isContextualUIVisible=function(){return this.isContextualUIVisibleFromProps(this.props)},t.prototype.isContextualUIVisibleFromProps=function(e){return!(e.contextMenuProps.hidden&&e.floatieProps.hidden)},t.prototype.getContextMenuSelector=function(){return"div#"+this.props.contextMenuProps.id},t.prototype.shouldRenderFloatieV2=function(){return!this.props.floatieProps.hidden},t.prototype.onShow=function(){this.startSessionLog()},t.prototype.onHide=function(){this.completeSessionLog()},t.contextType=Ys.a,t}(d.PureComponent),nh=n(404),oh=Object(Rp.a)((function(e,t,n,o,i){return{type:"MultiRowFloatieGroup",id:e,topControlsRow:t.topControlsRow.map((function(e){return Object(nh.b)(n,o,e,i,void 0,void 0,yu.b.Floatie)})),bottomControlsRow:t.bottomControlsRow.map((function(e){return Object(nh.b)(n,o,e,i,void 0,void 0,yu.b.Floatie)}))}})),ih=Object(Rp.a)((function(e,t,n,o,i){return{type:"SingleRowFloatieGroup",id:e,controls:t.controls.map((function(e){var t=Object(nh.b)(n,o,e,i,void 0,void 0,yu.b.Floatie),r=Object(iu.t)(n,o,e);switch(r.type){case"ButtonModel":case"ToggleButtonModel":case"FlyoutAnchorModel":case"SplitButtonModel":case"StatefulSplitButtonModel":return Object(p.__assign)(Object(p.__assign)({},t),{icon:r.iconSet&&r.iconSet.icon24||r.iconSet&&r.iconSet.default});case"PreviewGalleryModel":return Object(p.__assign)(Object(p.__assign)({},t),{flyoutAnchorProps:{icon:r.flyoutAnchorIconSet&&r.flyoutAnchorIconSet.icon24||r.flyoutAnchorIconSet&&r.flyoutAnchorIconSet.default,label:r.flyoutAnchorLabel}})}return t}))}})),rh=Object(Rp.a)((function(e,t,n,o,i){return{type:"SingleControlFloatieGroup",id:e,control:ah(n,o,t.control,i),preventAutoDismiss:t.preventAutoDismiss}})),ah=function(e,t,n,o){var i=Object(nh.b)(e,t,n,o,void 0,void 0,yu.b.Floatie),r=Object(iu.t)(e,t,n);switch(r.type){case"FlyoutAnchorModel":return Object(p.__assign)(Object(p.__assign)({},i),{icon:r.iconSet&&r.iconSet.icon16||r.iconSet&&r.iconSet.default})}return i},sh=function(e){return Object(ql.a)([su,au,iu.N,iu.s,iu.Q],(function(t,n,o,i,r){var a=[];return(null!=e?e:t).map((function(e){var t=n[e];if(void 0!==t)switch(t.type){case"MultiRowFloatieGroupModel":a.push(oh(e,t,o,i,r));break;case"SingleRowFloatieGroupModel":a.push(ih(e,t,o,i,r));break;case"SingleControlFloatieGroupModel":a.push(rh(e,t,o,i,r));break;default:throw new Error("The floatie group type can't be placed in the floatie")}})),a}))},lh=n(1168),ch=n(1750),uh=n(567),ph=n(94),dh=n(1561),hh=function(e,t){if(Object(O.c)("ContextMenuSearchIsEnabled")&&gh(t))return{menuDefinition:Su(e),zeroTermMenuEnabled:wu(e),onSearchStateChanged:function(e,t){Object(uh.n)()(t,yu.b.ContextMenu)},onShowZeroTermMenu:function(){Object(Ql.a)(Object(lh.a)("ZeroTermContextMenu",!1))},onHideZeroTermMenu:function(){Object(Ql.a)(Object(lh.a)("ZeroTermContextMenu",!0))},onAfterMenuDismiss:function(e,t){mh(e)},onAfterMenuOpen:Object(uh.g)(yu.b.ContextMenu,"TellMe",yu.b.ContextMenu),openSearchPane:Object(uh.i)(yu.b.ContextMenu)}},gh=function(e){switch(e){case"ContextMenu":case"GridContextMenu":return!0}return!1},mh=function(e){var t=[{name:"MenuId",string:e.menuId},{name:"SessionId",int64:e.sessionId},{name:"Clicked",bool:e.clicked},{name:"Escaped",bool:e.escaped},{name:"Entered",bool:e.entered},{name:"Typed",bool:e.typed},{name:"HasQuery",bool:e.hasQuery},{name:"ZeroTermMenuInvoked",bool:e.zeroTermMenuInvoked},{name:"ZeroTermMenuShown",bool:e.zeroTermMenuShown},{name:"SearchResultShown",bool:e.searchResultShown},{name:"TellMeCorrelationId",string:Object(dh.a)()},{name:"ZeroTermMenuEnabled",bool:e.zeroTermMenuEnabled}];Object(ph.logActivity)("ContextualMenuSearchSessionCompleted",!0,e.sessionDuration,t)},bh=function(e){return e===ll.a.Touch||e===ll.a.Pen},fh=function(e,t){return!(!e||e.attachedContextMenu||0===t.length)&&t.some((function(e){return"SingleControlFloatieGroup"===e.type&&e.preventAutoDismiss}))},yh=function(e){var t,n;Object(ph.logActivity)("ContextualUIUsageData",!0,e.sessionDuration,function(e){return[{name:"MenuId",string:e.menuId},{name:"MenuVisualization",string:JSON.stringify(e.menuVisualization)},{name:"OpenedSubMenu",string:JSON.stringify(e.openedSubMenu)},{name:"OfferedCommands",string:JSON.stringify(e.offeredCommands)},{name:"ExecutedCommands",string:JSON.stringify(e.executedCommands)},{name:"SessionDuration",double:e.sessionDuration},{name:"SessionId",int64:e.sessionId},{name:"MenuTargetType",string:e.menuTargetType},{name:"VisualizationAtClose",string:e.visualizationAtClose},{name:"InvocationMethod",string:ll.a[e.invocationMethod||ll.a.Unknown]},{name:"TellMeCorrelationId",string:Object(dh.a)()},{name:"ZeroTermMenuEnabled",bool:e.zeroTermMenuEnabled}]}(e)),t=e.zeroTermMenuEnabled,n=t?[Object(lh.a)("ZeroTermContextMenu",!0),Object(ch.a)("ZeroTermContextMenu",[])]:[],Object(dh.a)()?Object(uh.f)(yu.b.ContextMenu,"TellMe")(n,yu.b.ContextMenu):t&&Object(Ql.a)(n)},vh=function(e,t){var n=document.getElementById(e),o=t;return void 0!==o&&"Escape"===o.key&&(n===o.target||Object(z.a)(n,o.target))},Ch=function(e,t,n){t===yu.a.SearchResult&&Object(uh.m)(e,n,yu.b.ContextMenu)},xh={areStatePropsEqual:function(e,t){var n=e.floatieProps.hidden!==t.floatieProps.hidden||!e.floatieProps.hidden,o=e.contextMenuProps.hidden!==t.contextMenuProps.hidden||!e.contextMenuProps.hidden,i=e.contextMenusToShadowRender,r=t.contextMenusToShadowRender;return!n&&!o&&!function(e,t){var n=0,o=0;return t&&t.forEach((function(e){void 0===e&&(o+=1)})),e&&e.forEach((function(e){void 0===e&&(n+=1)})),o!==n}(i,r)},areStatesEqual:function(e,t){return!(Cu(e)||Cu(t)||lu(e)||lu(t))}},Sh=Object(Ds.b)((function(e,t){var n=function(e){return e.contextualUILayoutModel.floatieLayout}(e),o=function(e){return e.contextualUILayoutModel.contextMenuLayout}(e),i=vu(e),r=function(e){return e.contextualUILayoutModel.inputMethod}(e),a=sh()(e),s=fh(n,a);return{floatieProps:Object(p.__assign)(Object(p.__assign)({},n),{hidden:!lu(e),groups:a,appIcons:t.appIcons,appStrings:t.appStrings,appColors:t.appColors,preventLightDismiss:s||bh(r),preventAutoDismiss:s}),contextMenuProps:Object(p.__assign)(Object(p.__assign)({},o),{hidden:!Cu(e),id:Object(O.c)("IDBasedContextMenusIsEnabled")?null!=i?i:Ou.a.ContextMenu:t.contextMenuId,menuDefinition:xu(e),appIcons:t.appIcons,appStrings:t.appStrings,inputMethod:r,searchableContextualMenuProps:hh(e,i)}),contextMenusToShadowRender:Eu(e),floatieGroupsToShadowRender:Object(O.c)("FloatieShadowRenderingIsEnabled")?sh(t.floatieGroupsToShadowRender)(e):void 0}}),(function(e,t){return{onFloatieDismiss:function(){e(Object(mu.c)())},onContextMenuDismiss:function(n,o,i){(o||vh(t.containerId,n))&&e(Object(mu.c)()),e(Object(mu.b)()),Object(Ru.a)(null!=i?i:t.contextMenuId,"FlyoutAnchorModel")()}}}),(function(e,t,n){var o=Object(p.__assign)(Object(p.__assign)({},n),{onInteractionCompleted:yh,onItemExecute:e.contextMenuProps.searchableContextualMenuProps?Ch:void 0});return Object(p.__assign)(Object(p.__assign)(Object(p.__assign)({},o),e),t)}),xh)(th),Eh=function(e){return d.createElement(vc.a,null,d.createElement(Sh,Object(p.__assign)({},e)))},wh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement($n.a,null,d.createElement(Ds.a,{store:wc.a},d.createElement(Eh,{appStrings:Object(s.a)(),appIcons:Co.a,appColors:Object(a.a)(),contextMenuId:"ContextMenuContainer",contextMenuCommandId:Ou.a.ContextMenu,containerId:this.props.containerId,positionInOneFrameIsEnabled:Object(ep.c)("positionInOneFrameIsEnabled"),useSmallScreenLayout:Object(ep.c)("SmallScreenContextualUIIsEnabled")&&Object(rp.f)(),populateMenuCallback:Lu,floatieGroupsToShadowRender:Object(ep.c)("FloatieShadowRenderingIsEnabled")?np:void 0})))},t}(d.PureComponent),kh=function(e){return{getFloatieOnlyControlsMap:function(){return pu(e.getState())}}}(wc.a),Th=n(927);var Ih={initializeContextualUI:function(e){var t,n,o,i,r,a=[Object(Th.a)((i=Object(ep.c)("WebExternalLinksPasteLink"),r=[Yu.b.PasteRecoveryUIPaste,Yu.b.PasteRecoveryUIPasteValues,Yu.b.PasteRecoveryUIPasteFormulas,Yu.b.PasteRecoveryUIPasteTranspose,Yu.b.PasteRecoveryUIPasteFormatting],i&&r.push(Yu.b.PasteRecoveryUIPasteLink),[Object(Nu.a)(Ou.a.ContextMenu,""),Object(Nu.a)(Yu.b.AutoFilterContextMenu,""),Object(Nu.a)(Yu.b.AutoFilterFieldListContextMenu,""),Object(Nu.a)(Yu.b.ChartContextMenu,""),Object(Nu.a)(Yu.b.FieldListContextMenu,""),Object(Nu.a)(Yu.b.FieldListPivotContextMenu,""),Object(Nu.a)(Yu.b.FieldWellContextMenu,""),Object(Nu.a)(Yu.b.FloatingObjectContextMenu,""),Object(Nu.a)(Yu.b.GridContextMenu,""),Object(Nu.a)(Yu.b.PivotFilterContextMenu,""),Object(Nu.a)(Yu.b.PivotTableContextMenu,""),Object(Nu.a)(Yu.b.PulloutFieldListContextMenu,""),Object(Nu.a)(Yu.b.SheetOpsContextMenu,""),Object(Nu.a)(Yu.b.SlicerContextMenu,""),Object(Nu.a)(Yu.b.TimeSlicerLevelMenu,""),Object(Nu.a)(Yu.b.ContextCoauthors,"",{iconSet:{default:$u.a.BrowseGroups_20}}),Object(Nu.a)(Yu.b.AllSheetsMenu,""),Object(Nu.a)(Yu.b.ShapeStylesFloatie,ExcelRibbonStrings.ApplyShapeStylesShort,{iconSet:{default:T.a.UxGalThemeStyles_20},menuModel:Object(Vu.a)([Object(Vu.b)([])]),keytip:ExcelRibbonStrings.ApplyShapeStylesKeyTip}),Object(Nu.a)(Yu.b.PasteRecoveryUI,ExcelRibbonStrings.PasteRecoveryUIExpansionKey,{iconSet:{default:T.a.Paste_16},hideChevron:!1,customTooltip:ExcelRibbonStrings.PasteRecoveryUIToolTip,menuModel:Object(ep.c)("PasteTextToColumnsRecoveryUI")?Object(Vu.a)([Object(Vu.b)([Yu.b.PasteRecoveryUIGallery]),Object(Vu.b)([Yu.b.TextToColumns])]):Object(Vu.a)([Object(Vu.b)([Yu.b.PasteRecoveryUIGallery])])}),Object(Gu.a)(Yu.b.PasteRecoveryUIGallery,{columns:4,styles:Uu,galleryType:"IconGallery",sections:[Object(Gu.b)(r,Xu.a.PasteRecoveryUIGallery,ExcelRibbonStrings.Paste)]}),Object(Ku.c)(Yu.b.PasteRecoveryUIPaste,T.a.Paste_24,ExcelRibbonStrings.Paste),Object(Ku.c)(Yu.b.PasteRecoveryUIPasteValues,T.a.PasteValues_24,ExcelRibbonStrings.PasteValues),Object(Ku.c)(Yu.b.PasteRecoveryUIPasteFormulas,T.a.PasteFormulas_24,ExcelRibbonStrings.PasteFormulas),Object(Ku.c)(Yu.b.PasteRecoveryUIPasteTranspose,T.a.PasteTranspose_24,ExcelRibbonStrings.PasteTranspose),Object(Ku.c)(Yu.b.PasteRecoveryUIPasteFormatting,T.a.PasteFormatting_24,ExcelRibbonStrings.PasteFormatting),Object(Ku.c)(Yu.b.PasteRecoveryUIPasteLink,T.a.PasteLink_24,ExcelRibbonStrings.PasteLink)])),Object(mu.a)([qu(tp.Edit,[Yu.b.Edit]),qu(tp.Clipboard,[Yu.b.Paste,Yu.b.Cut,Yu.b.Copy,Yu.b.Clear]),qu(tp.Color,[Yu.b.FillColor,Yu.b.FontColor]),qu(tp.AutoFill,[Yu.b.AutoFill]),qu(tp.RowOperations,[Yu.b.InsertRowsSheetFloatie,Yu.b.DeleteRowsSheetFloatie,Yu.b.HideRowsFloatie,Yu.b.UnhideRowsFloatie]),qu(tp.ColumnOperations,[Yu.b.InsertColumnsSheetFloatie,Yu.b.DeleteColumnsSheetFloatie,Yu.b.HideColumnsFloatie,Yu.b.UnhideColumnsFloatie]),qu(tp.ViewModeRowOperations,[Yu.b.HideRowsFloatie,Yu.b.UnhideRowsFloatie]),qu(tp.ViewModeColumnOperations,[Yu.b.HideColumnsFloatie,Yu.b.UnhideColumnsFloatie]),qu(tp.Hyperlink,[Yu.b.EditLink,Yu.b.OpenLink,Yu.b.RemoveLink]),qu(tp.ShapeStyle,[Yu.b.ShapeStylesFill,Yu.b.ShapeStylesOutline]),qu(tp.FloatingObjectClipboard,[Yu.b.Paste,Yu.b.Cut,Yu.b.Copy,Yu.b.DeleteFloatingObject]),qu(tp.PivotTableCopyDelete,[Yu.b.Copy,Yu.b.DeletePivotTable]),qu(tp.PivotTableFieldListActions,[Yu.b.RefreshFieldList]),qu(tp.PivotTableFieldListActionsExpanded,[Yu.b.RefreshFieldList,Yu.b.HideFiedList]),qu(tp.Copy,[Yu.b.Copy]),qu(tp.OpenHyperlink,[Yu.b.OpenLink]),qu(tp.ContextMenu,[Ou.a.ContextMenu]),qu(tp.PivotTableContextMenu,[Yu.b.PivotTableContextMenu]),qu(tp.FloatingObjectContextMenu,[Yu.b.FloatingObjectContextMenu]),qu(tp.GridContextMenu,[Yu.b.GridContextMenu]),(t=tp.CellFloatie,n=[Yu.b.FontName_New,Yu.b.FontSize,Yu.b.GrowFontSize,Yu.b.ShrinkFontSize,Yu.b.NumberFormatAccountingNew,Yu.a.NumberFormatPercentage_MLR,Yu.a.NumberFormatComma_MLR,Yu.b.MergeAndCenter],o=[Yu.b.Bold,Yu.b.Italic,Yu.b.BordersSplitButtonCompactMenu,Yu.b.FillColor,Yu.b.FontColor,Yu.a.AlignCenter_MLR,Yu.b.Wrap,Yu.b.IncreaseDecimal,Yu.b.DecreaseDecimal,Yu.b.FormatPainter],{id:t,type:"MultiRowFloatieGroupModel",topControlsRow:n,bottomControlsRow:o}),qu(tp.ShapeFloatie,[Yu.b.ShapeStylesFloatie,Yu.b.ShapeStylesFill,Yu.b.ShapeStylesOutline]),Qu(tp.PasteRecoveryUI,Yu.b.PasteRecoveryUI,!0)]),Object(mu.e)(Ou.a.ContextMenu)];Object(ep.c)("ContextMenuShadowRenderingIsEnabled")&&(a=a.concat([Object(mu.f)(op)])),gu(a,Es.a),h.render(d.createElement(wh,{containerId:e.id}),e)},showContextMenu:function(e,t,n,o){return function(i,r){if(!Cu(r())){n&&i(Object(mu.e)(n));var a=Hu(e.target)?{left:e.target.x,top:e.target.y}:e.target;Object(Iu.b)("ShowReactContextMenu",(function(){var e=_u(xu(r())).toString(),t=e===ju;return ju=e,t}),null!=n?n:vu(r())),Mu(t,n),Au(i,{contextMenuLayout:Object(p.__assign)(Object(p.__assign)({},e),{target:a}),inputMethod:t,useSmallScreenlayout:o})}}},showContextualUI:function(e,t,n,o,i){return function(r,a){if(!lu(a())||!Cu(a())){i&&r(Object(mu.e)(i)),Object(Iu.b)("ShowReactContextualUI",(function(){var e=su(a()).toString(),t=e===Bu;Bu=e;var n=_u(xu(a())).toString(),o=n===ju;return ju=n,t&&o}),null!=i?i:vu(a())),Mu(n,i);var s=Hu(e.target)?{left:e.target.x,top:e.target.y}:e.target,l=Hu(t.target)?{left:t.target.x,top:t.target.y}:t.target;Wu(r,{floatieLayout:Object(p.__assign)(Object(p.__assign)({},e),{target:s,attachedContextMenu:!0}),contextMenuLayout:Object(p.__assign)(Object(p.__assign)({},t),{target:l,attachedFloatie:!0}),inputMethod:n,useSmallScreenlayout:o})}}},showFloatie:function(e,t,n){return function(o,i){if(!lu(i())){var r=Hu(e.target)?{left:e.target.x,top:e.target.y}:e.target;Object(Iu.b)("ShowReactFloatie",(function(){var e=su(i()).toString(),t=e===Bu;return Bu=e,t})),zu(o,{floatieLayout:Object(p.__assign)(Object(p.__assign)({},e),{target:r}),inputMethod:t,useSmallScreenlayout:n})}}},hideContextMenu:function(){return function(e){e(Object(mu.b)())}},hideContextualUI:function(){return function(e){e(Object(fc.batchActions)([Object(mu.c)(),Object(mu.b)()]))}},hideFloatie:function(){return function(e){e(Object(mu.c)())}},selectors:kh},Rh=n(1770),Oh={},Ph=function(e){return e.messageBar||Oh},Fh=Object(ql.a)([Ph],(function(e){return e.dismissIconProps})),Dh=Object(ql.a)([Ph],(function(e){return e.typeIconsProps})),_h=Object(Ds.b)((function(e,t){Object(Cc.g)("AppMessageBar");var n=void 0,o=Dh(e);o&&(n=o[t.messageBarType||Ea.a.info]);var i={dismissIconProps:t.closeable?Fh(e):void 0,messageBarIconProps:n,id:"AppMessageBar"};return Object(Cc.g)("AppMessageBar","NonCached"),i}))(Object(xc.a)(Rh.a)),jh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement($n.a,null,d.createElement(Ds.a,{store:wc.a},d.createElement(_h,Object(p.__assign)({},this.props))))},t}(d.Component);function Bh(e,t){if(void 0===e&&(e=Oh),null===e)return Oh;switch(t.type){case Na.nb:var n=t.payload.typeIconsProps;return n?Object(p.__assign)(Object(p.__assign)({},e),{typeIconsProps:n}):e;case Na.mb:var o=t.payload.dismissIconProps;return o?Object(p.__assign)(Object(p.__assign)({},e),{dismissIconProps:o}):e;default:return e}}var Lh=!1;var Mh={initializeMessageBarInStore:function(){var e,t,n;Lh||(Va.b.register("messageBar",Bh),Object(Es.a)([(n={iconName:r.a.CancelGlyph_16},Object(ws.a)(Na.mb,{dismissIconProps:n})),(e={},e[Ea.a.info]={iconName:$u.a.AlertInfoLight_16},e[Ea.a.success]={iconName:$u.a.AlertSuccess_16},e[Ea.a.warning]={iconName:$u.a.AlertInfoLight_16},e[Ea.a.severeWarning]={iconName:$u.a.AlertSevereWarning_16},e[Ea.a.error]={iconName:$u.a.AlertError_16},e[Ea.a.blocked]={iconName:$u.a.DrmStatus_16},t=e,Object(ws.a)(Na.nb,{typeIconsProps:t}))]),v.a.sendTraceTag(587321818,C.a.msoulscat_ES_EWAJS,$.a.Info,"MessageBar store is initialized."),Lh=!0)},createNewMessageBar:function(e,t){h.render(d.createElement(jh,Object(p.__assign)({},t)),e)}},Ah={root:{backgroundColor:"#ffffff"},list:{fontSize:"12px"}},Wh=function(e){return{root:{backgroundColor:e?vp.a.selectedBackgroundColor:"#ffffff",selectors:{":focus":{background:vp.a.hoverBackgroundColor+"!important"}}}}},zh=n(393),Hh=[],Nh=function(e){function t(t){var n=e.call(this,t)||this;n.tableTotalRowOptionSelected=function(e,t){return!!t&&(e&&v.a.sendTraceTag(595636250,C.a.msoulscat_ES_EWAJS,$.a.Verbose,"TableTotalRowOptions.tableTotalRowOptionSelected - Event : "+e.type),n.props.tableTotalRowOptionSelected(t.key))};var o=Object.keys(n.props.totalRowOptions);Hh.splice(0,Hh.length);for(var i=0,r=o;i<r.length;i++){var a=r[i],s=n.props.totalRowOptions[a],l={key:a,ariaLabel:s,text:s,itemProps:{styles:Wh(!1)}};Hh.push(l)}return n.state={previouslySelectedItem:"None",currentMenuItems:Hh,currentButtonSize:17},n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement(M.a,{content:ExcelRibbonStrings.TableTotalRowOptionsKeyTip,id:"TotalRowDropDownId",tooltipProps:{style:{overflowY:"auto",display:"block"},calloutProps:{isBeakVisible:!0,beakWidth:10},directionalHint:A.DirectionalHint.topCenter,delay:zh.a.long}},d.createElement(xn.a,{"data-is-focusable":!0,id:"TableTotalRowDropDownIconButtonId",allowDisabledFocus:!1,ariaLabel:ExcelRibbonStrings.TableTotalRowOptionsLabel,ariaDescription:ExcelRibbonStrings.TableTotalRowOptionsAriaDescription,tabIndex:0,styles:(e=this.state.currentButtonSize,{root:{position:"absolute",top:"0px",left:"0px",padding:"unset",height:e,width:e},flexContainer:{position:"absolute",top:"0px",left:"0px",height:e,width:e},icon:{display:"flex",position:"absolute",top:"0px",left:"0px",margin:"unset",height:e,width:e}}),iconProps:{iconName:T.a.DropdownArrowHover_16},menuTriggerKeyCode:R.a.alt&R.a.down,persistMenu:!0,primary:!0,menuProps:{gapSpace:0,focusZoneProps:{allowFocusRoot:!1,isCircularNavigation:!0,doNotAllowFocusEventToPropagate:!1,tabIndex:0,allowTabKey:!0},shouldFocusOnContainer:!1,shouldFocusOnMount:!0,styles:Ah,onItemClick:this.tableTotalRowOptionSelected,items:this.state.currentMenuItems}}));var e},t.getDerivedStateFromProps=function(e,t){var n,o=[];return n=e.buttonSize!==t.currentButtonSize?e.buttonSize:t.currentButtonSize,e.selectedItem!==t.previouslySelectedItem?(Hh.forEach((function(t){var n=t;n.text===e.selectedItem?n.itemProps={styles:Wh(!0)}:n.itemProps={styles:Wh(!1)},o.push(n)})),{currentMenuItems:o,currentButtonSize:n,previouslySelectedItem:e.selectedItem}):{currentMenuItems:Hh,currentButtonSize:n}},t}(d.Component);function Vh(e,t,n,o,i){h.render(d.createElement(Nh,{totalRowOptions:t,selectedItem:n,buttonSize:o,tableTotalRowOptionSelected:i}),e)}var Gh=function(e){var t=e.target,n=e.menuItems,o=e.toggleStateId,i=e.onShow,r=e.onHide,a=e.onRenderComplete,s=d.useState(!1),l=s[0],c=s[1],u=d.useState(0),p=u[0],h=u[1];d.useLayoutEffect((function(){o===p&&l&&null!=a&&Object(Dp.a)(a)}));var g=function(){c(!0),i()},m=function(){c(!1),r()};o!==p&&(l?m():g(),h(o));var b=Object(Ru.a)(Yu.b.AllSheetsMenu,"FlyoutAnchorModel");return d.createElement("div",null,d.createElement(lp.a,{items:n,hidden:!l,target:t,onDismiss:m,onMenuOpened:function(){return Object(Ru.b)(Yu.b.AllSheetsMenu,"FlyoutAnchorModel")({id:Yu.b.AllSheetsMenu})},onMenuDismissed:b,isBeakVisible:!1,shouldFocusOnMount:!0,calloutProps:{calloutMaxHeight:400,styles:{root:{animation:"none"}}}}))};function Uh(e,t,n,o,i,r,a){h.render(d.createElement(Gh,{menuItems:n,target:t,toggleStateId:o,onShow:i,onHide:r,onRenderComplete:a}),e)}var Kh='"Segoe UI", "Segoe UI Web", Arial, Verdana, sans-serif',qh={root:[{position:"relative",height:"22px",width:"69px",marginTop:"4px"}],fieldGroup:[{border:"1px solid #C8C6C4",height:"26px",width:"110px"}],wrapper:[{fontFamily:Kh,color:"#484644",lineHeight:"20px"}]},Qh={root:[{position:"relative",margin:"4px 8px 4px 0px",border:"1px solid rgba(0,0,0,0)",padding:"0px",height:"26px",background:"#107C41",alignSelf:"flex-start",selectors:{":active":{backgroundColor:"#0F703B"},":hover":{backgroundColor:"#0F703B"},":focus":{border:"1px solid black"}}}],textContainer:[{fontWeight:"normal",color:"#FFFFFF"}]},Jh={root:[{position:"relative",margin:"4px 8px 4px 0px",border:"1px solid rgba(0,0,0,0)",padding:"0px",height:"26px",background:"#F3F2F1",alignSelf:"flex-start",selectors:{":active":{backgroundColor:"#EDEBE9"},":hover":{backgroundColor:"#EDEBE9"},":focus":{border:"1px solid black"}}}],textContainer:[{fontWeight:"normal",color:"#323130"}]},Yh={root:[{paddingLeft:"0px",marginLeft:"0px",fontSize:"13px"}]},Xh={root:[{boxShadow:"0px 3.2px 7.2px rgba(0, 0, 0, 0.13), 0px 0.6px 1.8px rgba(0, 0, 0, 0.1)",backgroundColor:"#FFFFFF"}]},Zh={root:[{paddingLeft:"0px",marginLeft:"0px",marginBottom:"11px"}]},$h={root:[{position:"relative",minWidth:"110px",height:"32px",float:"right",top:"0px",bottom:"0px",border:"0px",boxSizing:"border-box",marginTop:"4px",padding:"6px 36px",background:"#107C41",alignSelf:"center",cursor:"pointer",selectors:{":active":{backgroundColor:"#0F703B"},":hover":{backgroundColor:"#0F703B"}}}],textContainer:[{color:"#FFFFFF",fontFamily:Kh,textAlign:"center"}],labelDisabled:[{color:"#EDEBE9"}],labelChecked:[{color:"#0C5F32"}]},eg=function(){return Object(P.eb)([{marginLeft:"12px",marginTop:"8px",position:"relative",display:"flex",right:"86px",left:"0px",fontFamily:Kh,fontSize:"15px",lineHeight:"16px",color:"#22221E",order:0,fontWeight:P.k.semibold}])},tg=function(e){return Object(P.eb)([{direction:e?"rtl":"ltr",backgroundColor:"#F3F2F1",position:"relative",maxWidth:"312px",width:"312px",maxHeight:"132px",height:"132px",minHeight:"132px",overflow:"auto",border:"1px solid #BEBBB8",boxSizing:"border-box",margin:"6px 0px"}])},ng=function(e){return Object(P.eb)([{borderRight:e?"solid 1px /* @noflip */":"solid 0px /* @noflip */",borderLeft:e?"solid 0px /* @noflip */":"solid 1px /* @noflip */",borderColor:"#D2D0CE",minWidth:"60px",fontFamily:Kh,fontStyle:"normal",fontWeight:"normal",padding:"3px",fontSize:"12px",color:"#252423",flex:"display"}])},og=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(p.__extends)(t,e),t.prototype.render=function(){var e=this.props.previewTableText,t=this.props.rowNumbers,n=this.props.isGridRtl;return d.createElement("pre",{className:tg(n),"aria-hidden":"true"},d.createElement("table",{className:Object(P.eb)([{borderCollapse:"separate",borderSpacing:"0px",height:"12px"}])},d.createElement("tbody",null,e.map((function(e,o){return d.createElement("tr",{className:Object(P.eb)([{border:"none",height:"12px"}]),key:o},d.createElement("td",{className:Object(P.eb)([{borderBottom:"solid 1px",borderColor:"#D2D0CE",minWidth:"12px",fontFamily:Kh,fontStyle:"normal",fontWeight:"normal",padding:"3px",fontSize:"12px",color:"#252423",flex:"display"}])},t[o]),e.map((function(e,t){return d.createElement("td",{className:ng(n),key:t},e)})))})))))},t}(d.Component),ig=function(e){function t(t){var n=e.call(this,t)||this;return n.focusTrapZone=d.createRef(),n.focusZoneRef=d.createRef(),n.delimiters="delimiters",n.textToColumnsHeading=ExcelRibbonStrings.TextToColumns,n.applyButtonText=ExcelRibbonStrings.TextToColumnsApply,n.previewText=ExcelRibbonStrings.TextToColumnsPreview,n.chooseDelimiters=ExcelRibbonStrings.TextToColumnsSelectDelimiters,n.partialDataText=ExcelRibbonStrings.TextToColumnsPartialDataText,n.customDelimiterPlaceHolder=ExcelRibbonStrings.TextToColumnsCustomDelimiterPlaceHolder,n.textToColumnsDelimiterCustom=ExcelRibbonStrings.TextToColumnsDelimiterCustom,n.selectedAriaLabel=ExcelRibbonStrings.TextToColumnsDelimitersSelectedAriaLabel,n.unSelectedAriaLabel=ExcelRibbonStrings.TextToColumnsDelimitersUnSelectedAriaLabel,n.calloutGap=2,n.splitTextKey="splitText",n.partialDataKey="isPartial",n.rowNumbersKey="rowNumbers",n.previewTableKey="previewTableKey",n.delimitersArr=[ExcelRibbonStrings.TextToColumnsDelimiterTab,ExcelRibbonStrings.TextToColumnsDelimiterSemicolon,ExcelRibbonStrings.TextToColumnsDelimiterComma,ExcelRibbonStrings.TextToColumnsDelimiterSpace,n.textToColumnsDelimiterCustom],n.delimitersArrKey=["Tab","Semicolon","Comma","Space","Custom"],n.hasListeners=!1,n.preview={splitText:[[""]],isPartial:!1,rowNumbers:[0]},n.focus=function(){var e=document.querySelector("button#"+n.delimitersArrKey[0]);n.focusZoneRef.current&&n.focusZoneRef.current.focusElement(e)},n.setInitialFocus=function(e){n.async.requestAnimationFrame((function(){return n.focus()}))},n.calloutDismissed=function(){n.setState({isVisible:!1}),n.removeListeners(),n.props.OnCalloutDismissHandler()},n.customDelimiterChanged=function(e,t){if(n.setState({customDelimiter:t}),null!=(null==t?void 0:t.length)){var o=(null==t?void 0:t.length)>0;n.setState((function(e){var t;return{delimiterButtons:Object(p.__assign)(Object(p.__assign)({},e.delimiterButtons),(t={},t[n.textToColumnsDelimiterCustom]=o,t))}}))}},n.onApplyClicked=function(){var e;n.setState({isVisible:!1}),n.removeListeners(),n.props.OnCalloutDismissHandler(),n.props.OnApplyTextToColumns(n.state.delimiterButtons,null!==(e=n.state.customDelimiter)&&void 0!==e?e:"")},n.onDelimiterButtonChange=function(e){n.setState((function(t){var n;return{delimiterButtons:Object(p.__assign)(Object(p.__assign)({},t.delimiterButtons),(n={},n[e.id]=!t.delimiterButtons[e.id],n))}}))},n.onMouseWheel=function(e){void 0!==e&&n.calloutWrapperElement.current&&!Object(z.a)(n.calloutWrapperElement.current,e.target)&&e.preventDefault()},n.getDelimiterAriaLabel=function(e){var t="";return"0"===e&&(t=n.textToColumnsHeading+" "+n.chooseDelimiters+" "),t+=n.delimitersArr[e]+" ",t+=n.state.delimiterButtons[n.delimitersArrKey[e]]?n.selectedAriaLabel:n.unSelectedAriaLabel},n.async=new Fl.a(n),n.calloutWrapperElement=d.createRef(),n.state={isVisible:!0,customDelimiter:"",delimiterButtons:n.delimitersArrKey.reduce((function(e,t){var o;return Object(p.__assign)(Object(p.__assign)({},e),((o={})[t]=n.selectAutomaticDelimiter(t),o))}),{})},n.onDelimiterButtonChange=n.onDelimiterButtonChange.bind(n),n.getDelimiterAriaLabel=n.getDelimiterAriaLabel.bind(n),n}return Object(p.__extends)(t,e),t.prototype.render=function(){return d.createElement("div",{ref:this.calloutWrapperElement},d.createElement(Yt.a,{role:"alertdialog",className:Object(P.eb)([{display:"flex",flexDirection:"column",position:"absolute",padding:"12px 12px 12px 12px",alignItems:"center"}]),styles:Xh,target:this.props.anchorElement,isBeakVisible:!1,hidden:!this.state.isVisible,onDismiss:this.calloutDismissed,setInitialFocus:!0,gapSpace:this.calloutGap,directionalHint:A.DirectionalHint.rightTopEdge},d.createElement(tl.a,{componentRef:this.focusTrapZone,id:"TextToColumnsContextualCalloutFocus",forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!1},d.createElement(Bn.a,{componentRef:this.focusZoneRef,direction:Ln.a.bidirectional,isCircularNavigation:!0,allowTabKey:!0},d.createElement(Cn.a,{className:eg(),styles:Zh},this.textToColumnsHeading),d.createElement(Zi.a,null,d.createElement(xn.a,{type:"AppIconButtonProps",iconProps:Object(vn.a)(r.a.CancelGlyph_16),className:Object(P.eb)([{cursor:"pointer",position:"fixed",top:"0px",right:"0px",height:"32px",maxWidth:"32px",border:"none",color:"black",overflow:"hidden",selectors:{":hover":{backgroundColor:"#F3F2F1"}}}]),onClick:this.calloutDismissed,ariaLabel:ExcelRibbonStrings.Close,customTooltip:ExcelRibbonStrings.Close,id:"Close"})),d.createElement(Cn.a,{className:eg(),styles:Yh},this.chooseDelimiters),this.renderTextToColumnsDelimitersItems(),this.renderPreview(),this.renderPartialDataIndicator(),d.createElement(ia.a,{type:"AppButtonProps",styles:$h,onExecute:this.onApplyClicked,id:this.applyButtonText,label:this.applyButtonText,key:this.applyButtonText})))))},t.prototype.renderTextToColumnsDelimitersItems=function(){var e,t=[];for(e in this.delimitersArrKey)t.push(d.createElement(ia.a,{id:this.delimitersArrKey[e],fullDescriptionLabel:this.getDelimiterAriaLabel(e),type:"AppButtonProps",styles:this.state.delimiterButtons[this.delimitersArrKey[e]]?Qh:Jh,label:this.delimitersArr[e],key:this.delimitersArrKey[e],onExecute:this.onDelimiterButtonChange}));return t.push(this.renderCustomDelimiterTextBox()),d.createElement("div",{id:this.delimiters,className:Object(P.eb)([{display:"flex",flexDirection:"row",flexWrap:"wrap",position:"static",alignSelf:"flex-start",marginTop:"4px",maxWidth:"312px"}])},t)},t.prototype.renderCustomDelimiterTextBox=function(){return d.createElement("div",{className:Object(P.eb)([{boxSizing:"border-box",position:"relative",background:"#FFFFFF",fontSize:"4px",bottom:"0px",borderRadius:"2px",flex:"none",alignSelf:"flex-start",marginBottom:"4px"}])},d.createElement(y.a,{className:Object(P.eb)([{position:"absolute",bottom:0,fontSize:"2px",display:"flex"}]),styles:qh,value:this.state.customDelimiter,maxLength:1,onChange:this.customDelimiterChanged,placeholder:this.customDelimiterPlaceHolder,ariaLabel:this.customDelimiterPlaceHolder}))},t.prototype.renderPreview=function(){var e;return this.preview=this.props.GenerateTextToColumnsPreview(this.state.delimiterButtons,null!==(e=this.state.customDelimiter)&&void 0!==e?e:""),[d.createElement(Cn.a,{className:eg(),key:this.previewText,styles:Yh},this.previewText),d.createElement(og,{previewTableText:this.preview[this.splitTextKey],rowNumbers:this.preview[this.rowNumbersKey],key:this.previewTableKey,isGridRtl:this.props.isGridRtl})]},t.prototype.renderPartialDataIndicator=function(){return this.preview[this.partialDataKey]?[d.createElement("div",{className:Object(P.eb)([{height:"16px",left:"25.18px",fontFamily:Kh,fontSize:"12px",lineHeight:"14px",color:"#545454",flex:"display",alignSelf:"center",marginTop:"6px",marginLeft:"0px"}]),style:{display:"flex"},key:this.partialDataKey},d.createElement(I.a,{iconName:T.a.Info_20,className:Object(P.eb)([{position:"relative",height:"16px",marginRight:"2px",maxWidth:"20px",color:"#545454",flex:"none",marginLeft:"0px",filter:"grayscale(100%)"}]),style:{color:"black"}}),this.partialDataText)]:[]},t.prototype.componentWillReceiveProps=function(e){e.isVisible!==this.state.isVisible&&(this.setState({isVisible:!0}),this.addListeners(),this.focus())},t.prototype.componentDidMount=function(){this.addListeners(),this.setInitialFocus()},t.prototype.addListeners=function(){this.hasListeners||(window.document.body.addEventListener("wheel",this.onMouseWheel,{passive:!1}),this.hasListeners=!0)},t.prototype.removeListeners=function(){this.hasListeners&&(window.document.body.removeEventListener("wheel",this.onMouseWheel),this.hasListeners=!1)},t.prototype.selectAutomaticDelimiter=function(e){var t=!1;return this.props.automaticDelimiter.forEach((function(n){e===n&&(t=!0)})),t},t}(d.Component);function rg(e,t,n,o,i,r){h.render(d.createElement(ig,{anchorElement:e,isVisible:!0,OnApplyTextToColumns:t,GenerateTextToColumnsPreview:n,OnCalloutDismissHandler:o,isGridRtl:i,automaticDelimiter:r}),e)}n.d(t,"notifications",(function(){return u})),n.d(t,"taskPane",(function(){return Mc})),n.d(t,"contextualUI",(function(){return Ih})),n.d(t,"dialog",(function(){return tu})),n.d(t,"messageBar",(function(){return Mh})),n.d(t,"renderTableTotalRowOptions",(function(){return Vh})),n.d(t,"renderSheetDropdownMenu",(function(){return Uh})),n.d(t,"renderTextToColumnsContextualUI",(function(){return rg}))}}]);
//# sourceMappingURL=uiSlice20.min.js.map