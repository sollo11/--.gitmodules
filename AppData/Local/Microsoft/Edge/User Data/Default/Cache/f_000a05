(window.odspNextWebpackJsonp=window.odspNextWebpackJsonp||[]).push([["237"],{"561":function(e,t,n){"use strict";n.r(t);var r=n(273),i=(n(271),n(274),n(1)),s=n(0),o=n(195),u=n(213),a=n(11);Object(a.n)([{rawString:".od-AllPhotosHeader{width:100%;height:100%}.md .od-AllPhotosHeader,.sm .od-AllPhotosHeader{height:40px;line-height:40px}.od-AllPhotosHeader:hover .od-AllPhotosHeader-check{opacity:1}.lg .od-AllPhotosHeader::before,.xlg .od-AllPhotosHeader::before,.xxlg .od-AllPhotosHeader::before,.xxxlg .od-AllPhotosHeader::before,.xxxxlg .od-AllPhotosHeader::before{content:'';position:absolute;top:0;right:0;bottom:0;left:0;border:1px solid rgba(0,0,0,.06)}.md .od-AllPhotosHeader-eventName,.sm .od-AllPhotosHeader-eventName{display:inline-block}[dir=ltr] .md .od-AllPhotosHeader-eventName,[dir=ltr] .sm .od-AllPhotosHeader-eventName{padding-left:10px}[dir=rtl] .md .od-AllPhotosHeader-eventName,[dir=rtl] .sm .od-AllPhotosHeader-eventName{padding-right:10px}.lg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-eventName{position:absolute;left:16px;right:16px;top:120px}html[dir=ltr] .lg .od-AllPhotosHeader-eventName,html[dir=ltr] .xlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxlg .od-AllPhotosHeader-eventName,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-eventName{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-eventName,html[dir=rtl] .xlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxlg .od-AllPhotosHeader-eventName,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-eventName{text-align:left}.od-AllPhotosHeader-month{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.md .od-AllPhotosHeader-month,.sm .od-AllPhotosHeader-month{font-size:17px;font-weight:300}.lg .od-AllPhotosHeader-month,.xlg .od-AllPhotosHeader-month,.xxlg .od-AllPhotosHeader-month,.xxxlg .od-AllPhotosHeader-month,.xxxxlg .od-AllPhotosHeader-month{font-size:15px;font-weight:400;font-weight:100}.lg .od-AllPhotosHeader-month::after,.xlg .od-AllPhotosHeader-month::after,.xxlg .od-AllPhotosHeader-month::after,.xxxlg .od-AllPhotosHeader-month::after,.xxxxlg .od-AllPhotosHeader-month::after{content:'\\A';white-space:pre}.lg .od-AllPhotosHeader-eventName,.lg .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader-eventName,.xlg .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader-eventName,.xxlg .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader-eventName,.xxxlg .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader-eventName,.xxxxlg .od-AllPhotosHeader-share{font-size:14px;font-weight:400}.md .od-AllPhotosHeader-check,.sm .od-AllPhotosHeader-check{top:10px;position:absolute}[dir=ltr] .md .od-AllPhotosHeader-check,[dir=ltr] .sm .od-AllPhotosHeader-check{right:0}[dir=rtl] .md .od-AllPhotosHeader-check,[dir=rtl] .sm .od-AllPhotosHeader-check{left:0}.md .od-AllPhotosHeader-check .ItemCheck,.sm .od-AllPhotosHeader-check .ItemCheck{display:inline-block}.lg .od-AllPhotosHeader-check,.xlg .od-AllPhotosHeader-check,.xxlg .od-AllPhotosHeader-check,.xxxlg .od-AllPhotosHeader-check,.xxxxlg .od-AllPhotosHeader-check{top:8px;position:absolute;opacity:0}[dir=ltr] .lg .od-AllPhotosHeader-check,[dir=ltr] .xlg .od-AllPhotosHeader-check,[dir=ltr] .xxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxlg .od-AllPhotosHeader-check,[dir=ltr] .xxxxlg .od-AllPhotosHeader-check{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-check,[dir=rtl] .xlg .od-AllPhotosHeader-check,[dir=rtl] .xxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxlg .od-AllPhotosHeader-check,[dir=rtl] .xxxxlg .od-AllPhotosHeader-check{left:16px}.od-AllPhotosHeader-check.is-selected{opacity:1}.od-AllPhotosHeader .od-AllPhotosHeader-share{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.md .od-AllPhotosHeader .od-AllPhotosHeader-share,.sm .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;top:0}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-right:15px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{margin-left:15px}[dir=ltr] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{right:18px}[dir=rtl] .md .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .sm .od-AllPhotosHeader .od-AllPhotosHeader-share{left:18px}.lg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,.xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{position:absolute;bottom:16px}[dir=ltr] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=ltr] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{right:16px}[dir=rtl] .lg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share,[dir=rtl] .xxxxlg .od-AllPhotosHeader .od-AllPhotosHeader-share{left:16px}.od-AllPhotosHeader .od-AllPhotosHeader-share:focus,.od-AllPhotosHeader .od-AllPhotosHeader-share:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}.od-AllPhotosHeader .od-AllPhotosHeader-share:active{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.md .od-AllPhotosHeader-date,.sm .od-AllPhotosHeader-date{display:inline-block}.lg .od-AllPhotosHeader-date,.xlg .od-AllPhotosHeader-date,.xxlg .od-AllPhotosHeader-date,.xxxlg .od-AllPhotosHeader-date,.xxxxlg .od-AllPhotosHeader-date{position:absolute;top:40px}[dir=ltr] .lg .od-AllPhotosHeader-date,[dir=ltr] .xlg .od-AllPhotosHeader-date,[dir=ltr] .xxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxlg .od-AllPhotosHeader-date,[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{right:16px}[dir=rtl] .lg .od-AllPhotosHeader-date,[dir=rtl] .xlg .od-AllPhotosHeader-date,[dir=rtl] .xxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxlg .od-AllPhotosHeader-date,[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{left:16px}html[dir=ltr] .lg .od-AllPhotosHeader-date,html[dir=ltr] .xlg .od-AllPhotosHeader-date,html[dir=ltr] .xxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxlg .od-AllPhotosHeader-date,html[dir=ltr] .xxxxlg .od-AllPhotosHeader-date{text-align:right}html[dir=rtl] .lg .od-AllPhotosHeader-date,html[dir=rtl] .xlg .od-AllPhotosHeader-date,html[dir=rtl] .xxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxlg .od-AllPhotosHeader-date,html[dir=rtl] .xxxxlg .od-AllPhotosHeader-date{text-align:left}[dir=ltr] .md .od-AllPhotosHeader-day,[dir=ltr] .sm .od-AllPhotosHeader-day{margin-left:5px}[dir=rtl] .md .od-AllPhotosHeader-day,[dir=rtl] .sm .od-AllPhotosHeader-day{margin-right:5px}.lg .od-AllPhotosHeader-day,.xlg .od-AllPhotosHeader-day,.xxlg .od-AllPhotosHeader-day,.xxxlg .od-AllPhotosHeader-day,.xxxxlg .od-AllPhotosHeader-day{font-size:42px}"}]);var f=n(16),l=n(9),c=n(6),h=n(8),p=n(353),d=n(720),v=n(1012),m=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.mode,i=void 0===r?0:r;n.itemCheckTagName=p.e.tagName;n._itemSetSelectionModel=n.resources.consume(c.C);n._itemCommandHelper=new(n.managed(d.e));n._startIndex=t.startIndex;n._mode=i;n.displayMonth=0===n._mode?t.group.latestPhotoTime.monthName:"";n.displayDay=0===n._mode?t.group.latestPhotoTime.day:"";n.displayDate=0===n._mode?t.group.latestPhotoTime.longDate:"";n.displayYear=1===n._mode?t.group.latestPhotoTime.year:"";n.group=t.group;n.eventName=n.group&&n.group.location||"";n.shareText=h.e.Share;n._range=n.createPureComputed(n._computeRange,{deferEvaluation:!0});n._selectedCount=n.createPureComputed(n._computeSelectedCount,{deferEvaluation:!0});n.areAllPhotosSelected=n.createPureComputed(n._computeAreAllPhotosSelected,{deferEvaluation:!0});n.isSelectAllAvailable=n.createPureComputed(n._computeIsSelectAllAvailable,{deferEvaluation:!0});n.isCheckVisible=n.createPureComputed(n._computeIsCheckVisible,{deferEvaluation:!0});n._isShareSupported=n.createPureComputed(n._computeIsShareSupported,{deferEvaluation:!0});n.isShareAvailable=n.createPureComputed(n._computeIsShareAvailable,{deferEvaluation:!0});var s=n.resources.consume(c.e);n._shareAction=new(n.managed(s.ShareByLinkAction));return n}t.prototype.onClickSelectAll=function(e,t){for(var n=this.areAllPhotosSelected.peek(),r=this._range.peek(),i=r.start;i<r.end;i++)this._itemSetSelectionModel.setIndexSelected(i,!n);t.stopPropagation();t.preventDefault();return!1};t.prototype.onClickShare=function(e,t){this._itemSetSelectionModel.clear();for(var n=this._range.peek(),r=n.start;r<n.end;r++)this._itemSetSelectionModel.setIndexSelected(r,!0);this._shareAction.isAvailable.peek()&&this._shareAction.execute(t);t.stopPropagation();t.preventDefault();return!1};t.prototype.onClickDate=function(e,t){return!1};t.prototype._computeRange=function(){var e,t,n=this._itemSetSelectionModel.itemSet.peek().content.peek().groupings||[],r=0===this._mode?0:2;if(n&&n.length)for(var i=0,s=n;i<s.length;i++){var o=s[i];if(o.groupType===r){t=o.groups;break}}if(t)for(var u=0,a=t;u<a.length;u++){var f=a[u];if(f.startIndex===this._startIndex){e=f;break}}return e&&e.keys?{start:e.startIndex,end:e.keys.length+e.startIndex}:{start:-1,end:0}};t.prototype._computeSelectedCount=function(){this._itemSetSelectionModel.selection();for(var e=this._range.peek(),t=0,n=e.start;n<e.end;n++)this._itemSetSelectionModel.isIndexSelected(n)&&t++;return t};t.prototype._computeAreAllPhotosSelected=function(){var e=this._selectedCount(),t=this._range.peek();return 0===this._itemSetSelectionModel.mode?e===t.end-t.start:e>0};t.prototype._computeIsShareAvailable=function(){var e=this._range.peek();return this._isShareSupported()&&(0===this._itemSetSelectionModel.mode||e.end-e.start==1)};t.prototype._computeIsCheckVisible=function(){return 0===this._itemSetSelectionModel.mode||this._selectedCount()>0};t.prototype._computeIsSelectAllAvailable=function(){return 0===this._itemSetSelectionModel.mode||this._selectedCount()>0};t.prototype._computeIsShareSupported=function(){var e=this._itemSetSelectionModel.itemSet().content().items,t=this._range.peek(),n=this.unwrapObservable(e[t.start]);return this._itemCommandHelper.isCommandSupported(n,v.a)};return t})(l.t),g=f.e({tagName:"od-all-photos-header",template:'<div class="od-AllPhotosHeader" tabindex="0"><div class="od-AllPhotosHeader-date"><span class="od-AllPhotosHeader-month" data-bind="text:displayMonth,click:onClickDate"></span>\x3c!--ko if:displayDay--\x3e<span class="od-AllPhotosHeader-day ms-font-xxl" data-bind="text:displayDay,click:onClickDate"></span>\x3c!--/ko--\x3e\x3c!--ko if:displayYear--\x3e<span class="od-AllPhotosHeader-year ms-font-xxl" data-bind="text:displayYear"></span>\x3c!--/ko--\x3e</div>\x3c!--ko if:eventName--\x3e<div class="od-AllPhotosHeader-eventName ms-font-l ms-fontColor-neutralPrimary" data-bind="text:eventName"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShareAvailable--\x3e<a href="#" class="od-AllPhotosHeader-share od-Link ms-font-l" data-bind="text:shareText,click:onClickShare"></a>\x3c!--/ko--\x3e\x3c!--ko if:isCheckVisible--\x3e<span class="od-AllPhotosHeader-check" data-bind="click:onClickSelectAll,css:{\'is-selected\':areAllPhotosSelected,\'can-select\':isSelectAllAvailable},component:{name:itemCheckTagName}"></span>\x3c!--/ko--\x3e</div>',viewModel:m,synchronous:!0}),y=n(1713),b=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.mode,i=void 0===r?0:r;n._mode=n.wrapObservable(i);return n}t.prototype.getInnerMargin=function(){return 2};t.prototype.getMinRowHeight=function(){switch(this.responsiveHelper.formFactorSize.peek()){case"Small":case"Medium":return 120;default:return 220}};t.prototype.getGroup=function(e){var t=this._itemSet.peek().content.peek(),n=t.groupings||[],r=t.items,i=0===this._mode.peek()?0:2;if(n&&n.length){for(var s=void 0,o=void 0,u=r[e].peek(),a=0,f=n;a<f.length;a++){var l=f[a];if(l.groupType===i){o=(s=l).groups;break}}if(!s||!o.length)return;return s.groupMap[s.itemToGroupMap[u.key]]}};t.prototype.getHeader=function(e,t,n){var r=null;if(t&&t.peek&&t.peek()){var i=this.getGroup(n);if(i&&this.currentGroup!==i){if((!this.currentGroup||this.currentGroup.latestPhotoTime.monthName!==i.latestPhotoTime.monthName||this.currentGroup.latestPhotoTime.year!==i.latestPhotoTime.year)&&1!==this._mode.peek()){var s=new Date(i.latestPhotoTime.isoDate).getFullYear(),o=y.e.tagName,u={resources:this.resources,headerText:i.latestPhotoTime.monthName+" "+s},a=this._shouldInlineHeadersLineBreak()?64:80;r={key:n+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:a,viewType:o,viewData:u,shouldLineBreak:!0,isHeader:!0};this.addToCurrentRow(r,!0)}var f,l,c,h=void 0;this.currentGroup=i;l=g.tagName;c={group:i,resources:this.resources,startIndex:n,mode:this._mode.peek()};f=this._shouldInlineHeadersLineBreak();h=40;0!==n||l||(h=0);r={key:n+"_header",cellIndex:this.cells.length,left:0,top:0,width:f?0:124,height:h,viewType:l,viewData:c,shouldLineBreak:f,aspectRatio:f?void 0:.55,isHeader:!0,shouldNotBeLastInRow:!0,isFixedWidth:!f};this.nextGroup=i}}return r};t.prototype.getVisibleItemRange=function(e){void 0===e&&(e=this.viewport);for(var t=this.getRowRangeForViewport(e),n=t.start,r=t.end,i=0,s=0,o=0;o<r;o++){var u=this.rows[o],a=u.cells.length-u.itemCellCount;o<=n&&(i+=a);o<r&&(s+=a)}if(this._shouldInlineHeadersLineBreak()){i=0;s=0}var f=this.rows[n],l=this.rows[r-1];return{start:n>=0?f.cells[0].cellIndex-i:-1,end:r>=0?l.cells[l.cells.length-1].cellIndex-s:-1}};t.prototype._shouldInlineHeadersLineBreak=function(){var e=this.responsiveHelper;return e.compareSize(e.formFactorSize.peek(),"Medium")<=0};return t})(u.t),w=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(b))(t));return r}return t})(o.e),E={tagName:"ms-all-photos-list",template:r.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(w))(e,t)}},synchronous:!0};i.components.isRegistered(E.tagName)||i.components.register(E.tagName,E);t.default=E},"562":function(e,t,n){"use strict";n.r(t);var r=n(273),i=(n(271),n(355),n(520),n(1)),s=n(0),o=n(195),u=n(289),a=n(6),f=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getSettings=function(){return{headerHeight:0,rowHeight:54,outerPadding:0,innerPadding:24}};t.prototype.isCheckSupported=function(){return!1};t.prototype.getHeaderCell=function(){return null};t.prototype.onRowInvoke=function(e){var t=this.resources.consume(a.C);t.clear(!0);t.setItemSelected(i.dataFor(e.target).item,!0);e.stopPropagation();e.preventDefault();return!1};return t})(u.e),l=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this,i=new(r.managed(f))(t);r.initialize(i);return r}return t})(o.e),c={tagName:n(43).p,template:r.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(l))(e,t)}},synchronous:!0};i.components.isRegistered(c.tagName)||i.components.register(c.tagName,c);t.default=c},"564":function(e,t,n){"use strict";n.r(t);var r=n(273),i=(n(271),n(274),n(1)),s=n(0),o=n(195),u=n(410),a=n(11);Object(a.n)([{rawString:".od-autoAlbumHeader-textWrapper{position:absolute;cursor:pointer}.xlg .od-autoAlbumHeader-textWrapper,.xxlg .od-autoAlbumHeader-textWrapper,.xxxlg .od-autoAlbumHeader-textWrapper,.xxxxlg .od-autoAlbumHeader-textWrapper{top:38px;font-size:14px;font-weight:400}.lg .od-autoAlbumHeader-textWrapper,.md .od-autoAlbumHeader-textWrapper,.sm .od-autoAlbumHeader-textWrapper{top:18px;font-size:14px;font-weight:400}.sm .od-autoAlbumHeader-textWrapper{top:20px;font-size:12px;font-weight:400}.od-autoAlbumHeader-text{display:inline-block}.xlg .od-autoAlbumHeader,.xxlg .od-autoAlbumHeader,.xxxlg .od-autoAlbumHeader,.xxxxlg .od-autoAlbumHeader{height:74px}.lg .od-autoAlbumHeader,.md .od-autoAlbumHeader,.sm .od-autoAlbumHeader{height:49px}.sm .od-autoAlbumHeader{height:46px}.od-autoAlbumHeader .ms-Icon{padding-bottom:2px;vertical-align:middle}"}]);var f=n(16),l=n(2395),c=n(9),h=n(547),p=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.group=t.group;n._onToggle=t.onToggle;n.text=n.createPureComputed(n._computeText);n.chevronClass=n.createPureComputed(n._computeChevron);return n}t.prototype.onClickHeader=function(e,t){var n=this.group.state.peek().isCollapsed;this.group.state({isCollapsed:!n});this._onToggle();return!1};t.prototype._computeText=function(){return this.group.state().isCollapsed?l.e.ShowMoreAlbums:l.e.ShowLessAlbums};t.prototype._computeChevron=function(){return Object(h.C)(this.group.state().isCollapsed?"ChevronDown":"ChevronUp")};return t})(c.t),d=f.e({tagName:"od-auto-album-header",template:'<div class="od-autoAlbumHeader"><div class="od-autoAlbumHeader-textWrapper" data-bind="click:onClickHeader"><div class="od-autoAlbumHeader-text ms-fontColor-neutralSecondary" data-bind="text:text"></div><div class="ms-Icon" data-bind="class:chevronClass"></div></div></div>',viewModel:p,synchronous:!0}),v=n(1713),m=n(4),g=(function(e){Object(s.__extends)(t,e);function t(t){t.isGrouped=!0;return e.call(this,t)||this}t.prototype.getMinRowHeight=function(){return Object(m.isFeatureEnabled)(m.EnableEvokeAlignments)?240:e.prototype.getMinRowHeight.call(this)};t.prototype.getItemAspectRatio=function(t){return Object(m.isFeatureEnabled)(m.EnableEvokeAlignments)?4/3:e.prototype.getItemAspectRatio.call(this,t)};t.prototype.getInnerMargin=function(){return 4};t.prototype.getGroup=function(e,t){if(!Object(m.isFeatureEnabled)(m.EnableEvokeAlignments)){var n=this._itemSet().content.peek().groupings||[];if(n&&n.length&&n[1]&&n[1].itemGroups)for(var r=0,i=n[1].itemGroups;r<i.length;r++){var s=i[r];if(s){var o=s.startIndex+s.count-1;if(s.startIndex<=e&&o>=e)return s}}}};t.prototype.getHeader=function(t,n,r){if(!Object(m.isFeatureEnabled)(m.EnableEvokeAlignments))return e.prototype.getHeader.call(this,t,n,r);var i=t&&t.peek&&t.peek(),s=n&&n.peek&&n.peek();if(i&&i.dateCreatedTime&&s&&s.dateCreatedTime&&i.dateCreatedTime.getFullYear()!==s.dateCreatedTime.getFullYear()){var o=s.dateCreatedTime.getFullYear(),u=v.e.tagName,a={resources:this.resources,headerText:""+o},f=this.isSmallWidthLayout?64:80;return{key:r+"_monthHeader",cellIndex:this.cells.length,left:0,top:0,width:0,height:f,viewType:u,viewData:a,shouldLineBreak:!0,isHeader:!0}}};t.prototype.finalizeRow=function(t,n){var r=this._itemSet().content.peek().groupings;if(!Object(m.isFeatureEnabled)(m.EnableEvokeAlignments)&&r&&r.length){var i=this.currentRow,s=!1;if(i&&this.currentGroup&&this.currentGroup.state){var o=this.currentGroup.state.peek();o&&(s=o.isCollapsed&&!i.isHeader)}s?this.currentRow=null:e.prototype.finalizeRow.call(this,t,n)}else e.prototype.finalizeRow.call(this,t,n)};t.prototype.getHeaderDetails=function(e,t){var n=this,r="",i={group:null,cellsInGroup:null},s=20,o=this.responsiveHelper,u=o.formFactorSize.peek();if(e){r=d.tagName;i={startIndex:t,group:e,cellsInGroup:0,resources:this.resources,onToggle:function(){n.evaluateLayout(!0)}};s=o.compareSize(u,"XLarge")>=0?74:o.compareSize(u,"Small")>0?49:46}return{viewType:r,viewData:i,headerHeight:s}};return t})(u.e),y=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(g))(t));return r}return t})(o.e),b={tagName:n(43).e,template:r.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(y))(e,t)}},synchronous:!0};i.components.isRegistered(b.tagName)||i.components.register(b.tagName,b);t.default=b},"565":function(e,t,n){"use strict";n.r(t);var r=n(273),i=(n(271),n(274),n(1)),s=n(0),o=n(195),u=n(410),a=n(11);Object(a.n)([{rawString:".AllTagsHeader{position:relative;font-weight:100;white-space:nowrap;text-overflow:ellipsis}.xxlg .AllTagsHeader,.xxxlg .AllTagsHeader,.xxxxlg .AllTagsHeader{padding-top:22px;padding-bottom:12px;height:37px}.lg .AllTagsHeader,.md .AllTagsHeader,.sm .AllTagsHeader,.xlg .AllTagsHeader{padding-top:14px;height:28px}.AllTagsHeader-title,a.AllTagsHeader-regionLink{font-weight:100;color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}html[dir=ltr] .AllTagsHeader-title,html[dir=ltr] a.AllTagsHeader-regionLink{float:left}html[dir=rtl] .AllTagsHeader-title,html[dir=rtl] a.AllTagsHeader-regionLink{float:right}[dir=ltr] .AllTagsHeader-title,[dir=ltr] a.AllTagsHeader-regionLink{margin-right:8px}[dir=rtl] .AllTagsHeader-title,[dir=rtl] a.AllTagsHeader-regionLink{margin-left:8px}.xxlg .AllTagsHeader-title,.xxlg a.AllTagsHeader-regionLink,.xxxlg .AllTagsHeader-title,.xxxlg a.AllTagsHeader-regionLink,.xxxxlg .AllTagsHeader-title,.xxxxlg a.AllTagsHeader-regionLink{font-size:28px;font-weight:100}.lg .AllTagsHeader-title,.lg a.AllTagsHeader-regionLink,.md .AllTagsHeader-title,.md a.AllTagsHeader-regionLink,.sm .AllTagsHeader-title,.sm a.AllTagsHeader-regionLink,.xlg .AllTagsHeader-title,.xlg a.AllTagsHeader-regionLink{font-size:21px;font-weight:100}.AllTagsHeader-subText{position:absolute;display:inline;font-size:12px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.xxlg .AllTagsHeader-subText,.xxxlg .AllTagsHeader-subText,.xxxxlg .AllTagsHeader-subText{bottom:16px}.lg .AllTagsHeader-subText,.md .AllTagsHeader-subText,.sm .AllTagsHeader-subText,.xlg .AllTagsHeader-subText{bottom:2px}"}]);var f=n(16),l=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.header=t.group.tagHeader.title;n.subtext=t.group.tagHeader.countSubtitle;n.regionUrl=t.group.tagHeader.regionUrl;return n}return t})(n(9).t),c=f.e({tagName:"ms-allTags-header",template:'<div class="AllTagsHeader"><div class="AllTagsHeader-title">\x3c!--ko if:regionUrl--\x3e<a class="AllTagsHeader-regionLink" data-bind="text:header,attr:{href:regionUrl}"></a>\x3c!--/ko--\x3e\x3c!--ko ifnot:regionUrl--\x3e<span data-bind="text:header"></span>\x3c!--/ko--\x3e</div><div class="AllTagsHeader-subText" data-bind="text:subtext"></div></div>',viewModel:l,synchronous:!0}),h=(function(e){Object(s.__extends)(t,e);function t(){return null!==e&&e.apply(this,arguments)||this}t.prototype.getHeaderDetails=function(e){var t="",n={},r=20;if(e){var i=this.responsiveHelper,s=i.compareSize(i.formFactorSize.peek(),"XXLarge")>=0,o=s?37:28,u=s?22:14,a=s?12:0;t=c.tagName;n={group:e,cellsInGroup:0,resources:this.resources};r=o+u+a}return{viewType:t,viewData:n,headerHeight:r}};return t})(u.e),p=(function(e){Object(s.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.initialize(new(r.managed(h))(t));return r}return t})(o.e),d={tagName:n(43).h,template:r.e,viewModel:{createViewModel:function(e,t){return new(e.resources.injected(p))(e,t)}},synchronous:!0};i.components.isRegistered(d.tagName)||i.components.register(d.tagName,d);t.default=d},"581":function(e,t,n){"use strict";n.r(t);var r=n(11);Object(r.n)([{rawString:".od-BasePage:not(.od-BasePage--hasSmartBanner) .od-photos-smartBanner{display:none}.od-photos-smartBanner .SmartBannerV2{position:absolute}.od-photos-promoted{position:relative}.md .od-photos-promoted,.sm .od-photos-promoted{margin-left:16px;margin-right:16px}.lg .od-photos-promoted,.xlg .od-photos-promoted,.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:32px;margin-right:32px}.xxlg .od-photos-promoted,.xxxlg .od-photos-promoted,.xxxxlg .od-photos-promoted{margin-left:48px;margin-right:48px}.od-photos-promoted .od-PromotedPhotos-title{margin-top:23px}.od-photos-promotedWrapper.od-photos-promotedWrapper--loaded{transition:height 467ms cubic-bezier(.1,.25,.75,.9);height:385px}.od-photos-promotedWrapper{overflow:hidden;height:0}"}]);var i=n(450),s=(n(561),n(564),n(425),n(562),n(565),n(0)),o=n(25),u=n(34),a=n(1),f=n(14),l=n(39),c=n(36),h=n(483),p=n(281),d=n(160),v=n(4),m=n(6),g=n(31),y=n(256),b=n(207),w=n(107),E=n(17),S=n(8),x=n(400),T=n(346),N=n(414),C=n(2396),k=n(446),L=n(539),A=n(379),O=n(219),M=n(43),_=n(121),D=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=n.resources;n._viewParams=r.consume(m.H);n._urlDataSource=r.consume(y.n);n._currentView=t.currentView;n._photoType=t.photoType;n._isOneUp=t.isOneUp;n._photoProvider=r.consume(g.d);n._arePivotsHidden=n.createComputed(n._computeArePivotsHidden);n._hasSamsungSpecialFolder=n.observables.create(void 0);n.hideNewShareCommands=n.createPureComputed(n._computeHideNewShareCommands);n.hideOldShareCommand=n.createPureComputed(n._computeHideOldShareCommand);n._requestor=r.consume(A.e);n._isOneDriveXboxApp=Object(_.t)();n.filesCommandSetHelper=new(n.managed(O.e))({showLabels:n.responsiveUI.showLabels});n._buildCommands();Object(v.isFeatureEnabled)(v.SamsungGalleryFilter)&&n._checkSamsungFolderExists();return n}t.prototype._checkSamsungFolderExists=function(){var e=this;this.observables.backgroundCompute(function(){var t=e._viewParams(),n=e._urlDataSource.getPhotoType(t),r=e._hasSamsungSpecialFolder.peek();0===n&&void 0===r&&e._requestor.send({apiName:"Special",path:"/drive/special/samsungGallery",requestType:"HEAD",useAuthorizationHeaders:!0}).then(function(){e._hasSamsungSpecialFolder(!0)}).catch(function(t){e._hasSamsungSpecialFolder(!1)})})};t.prototype._buildCommands=function(){var e=this,t=new(this.managed(this.actionMap.SaveAutoAlbumAction))({isHidden:!0}),n=[new(this.managed(f.e))({text:S.e.addToSharedList,renderLabel:2,icon:new E.e("Add"),action:new(this.managed(this.actionMap.AddToSharedListAction))})],r=[new(this.managed(k.e))({renderLabel:2,mode:L.e.share,itemsKey:b.n,text:S.e.Share,tooltip:S.e.ShareCommandTooltipV3,icon:new E.e("Share"),keys:["S"],engagementName:"newShareCommand",isHidden:this.hideNewShareCommands}).command,new(this.managed(f.e))({text:S.e.Share,isHidden:this.hideOldShareCommand,tooltip:S.e.ShareCommandTooltipV3,renderLabel:2,icon:new E.e("Share"),keys:["S"],action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.ShareByLinkAction)),saveAutoAlbumAction:t})})];n=n.concat(r);var i=[new(this.managed(f.e))({text:S.e.selectItems,renderLabel:2,icon:new E.e("CheckboxComposite"),action:new(this.managed(this.actionMap.ToggleSelectionModeAction)),isHidden:this.createPureComputed(function(){if(!e._isOneDriveXboxApp)return!1;var t=e._viewParams();return Object(l.l)(t)||Object(l.f)(t)})}),new(this.managed(f.e))({text:C.e.newAlbumPlaceholder,renderLabel:2,icon:new E.e("Add"),action:new(this.managed(this.actionMap.CreateAlbumAction)),isHidden:this.createObservable(Object(v.isFeatureEnabled)(v.EnableEvokeAlignments))}),new(this.managed(f.e))({text:S.e.AddToAlbum,renderLabel:2,icon:new E.e("Photo2Add"),action:new(this.managed(this.actionMap.AddToAlbumAction))}),new(this.managed(f.e))({text:S.e.addToBundle,icon:new E.e("Add"),renderLabel:2,action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.AddPhotosToAlbumAction)),saveAutoAlbumAction:t})}),new(this.managed(f.e))({text:S.e.editTags,renderLabel:2,icon:new E.e("Tag"),keys:["T"],action:Object(v.isFeatureEnabled)(v.EnableNewDetailsPane)?new(this.managed(this.actionMap.ShowTagsEditorAction)):new(this.managed(this.actionMap.EditTagsAction))}),new(this.managed(f.e))({text:S.e.Download,renderLabel:2,icon:new E.e("Download"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.DownloadAction)),saveAutoAlbumAction:t})}),new(this.managed(f.e))({text:S.e.setCoverPhotoTitle,renderLabel:2,icon:new E.e("Picture"),action:new(this.managed(this.actionMap.SetAlbumCoverPhotoAction))}),new(this.managed(f.e))({text:S.e.rotate,renderLabel:2,icon:new E.e("rotate"),action:new(this.managed(this.actionMap.RotateAction))({})}),new(this.managed(f.e))({text:S.e.DeleteItem,renderLabel:2,icon:new E.e("Delete"),action:new(this.managed(this.actionMap.DeleteAction)),keys:["MetaBackspace","Delete"],automationId:"delete"}),new(this.managed(f.e))({text:S.e.Remove,renderLabel:2,icon:new E.e("Cancel"),action:new(this.managed(this.actionMap.RemoveFromAlbumAction))}),new(this.managed(f.e))({text:S.e.Remove,renderLabel:2,icon:new E.e("Cancel"),action:new(this.managed(this.actionMap.RemoveTagFromItemAction))}),new(this.managed(f.e))({text:S.e.OrderPrints,icon:new E.e("Print"),renderLabel:2,action:new(this.managed(this.actionMap.OrderPrintsAction))}),new(this.managed(f.e))({text:S.e.viewInFolder,icon:new E.e("Folder"),action:new(this.managed(this.actionMap.ViewInFolderAction)),renderLabel:2,automationId:"viewInFolder"}),new(this.managed(f.e))({text:S.e.Rename,renderLabel:2,icon:new E.e("Edit"),action:new(this.managed(this.actionMap.ImplicitSaveAutoAlbumAction))({action:new(this.managed(this.actionMap.RenameAction)),saveAutoAlbumAction:t}),keys:["F2"],automationId:"rename"}),new(this.managed(f.e))({text:S.e.Embed,icon:new E.e("Embed"),renderLabel:2,hasLineBreakAfter:!0,automationId:"embed",action:new(this.managed(this.actionMap.EmbedAction))}),new(this.managed(f.e))({text:S.e.saveAutoAlbum,icon:new E.e("Add"),renderLabel:2,action:new(this.managed(this.actionMap.SaveAutoAlbumAction))}),new(this.managed(f.e))({text:S.e.discardAutoAlbum,icon:new E.e("Delete"),renderLabel:2,action:new(this.managed(this.actionMap.DiscardAutoAlbumAction))}),this.overflowHostCommand,new(this.managed(N.e))({renderLabel:2,suppressNotifications:this._isOneUp()}).command],s=this.createPureComputed(function(){var t=e.selection&&e.selection.selection().length||0;return e.responsiveUI.showLabels()?c.format(S.e.NumberSelected,t):t.toString()}),o=new(this.managed(f.e))({text:s,tooltip:S.e.showSelection,isHidden:this.selectionModeOff,icon:new E.e("Cancel"),location:4,positionIconRight:!0,action:new(this.managed(this.actionMap.ShowSelectionAction)),keys:["CtrlD","MetaD"]}),u=this.createPureComputed(function(){var t=e._photoType(),n=e.selectionModeOn();return 5!==t||n}),h=new(this.managed(f.e))({icon:new E.e("Cancel"),hasIconOnly:!0,isHidden:u,isDisabled:u,action:new(this.managed(this.actionMap.NavigationAction))({ignoreHistory:!1,url:this._urlDataSource.getAlbumsQueryUrl()}),keys:["AltUp"],location:4,text:S.e.Close,renderLabel:0}),m=new(this.managed(f.e))({text:S.e.setRootPhotosIdTitle,icon:new E.e("Settings"),renderLabel:2,requiredChildren:2,location:4,isHidden:this.createPureComputed(function(){var t=e.selectionModeOn();return Object(w.e)(e._urlDataSource.getQueryType(e._viewParams()))||t}),children:a.observableArray([new(this.managed(f.e))({text:S.e.setRootPhotosValueAll,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"ROOT"}),isToggleable:!0}),new(this.managed(f.e))({text:S.e.setRootPhotosValuePhotos,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"ALLPHOTOSFOLDER"}),isToggleable:!0}),new(this.managed(f.e))({text:S.e.setRootPhotosValueSamsungGallery,action:new(this.managed(this.actionMap.SetPhotosRootAction))({rootId:"SAMSUNGFOLDER"}),isToggleable:!0,isHidden:this.observables.pureCompute(function(){return!e._hasSamsungSpecialFolder()})})])}),g=new(this.managed(f.e))({text:S.e.ViewGrid,tooltip:S.e.ViewGridCommandTooltip,icon:new E.e(O.e.gridIcon),isToggleable:!0,isHidden:this.createComputed(function(){return e.selectionModeOn()||!Object(v.isFeatureEnabled)(v.UseItemsScopeInAllPhotosEnableGrid)}),action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:M.u}),automationId:"switchLayout",location:4,engagementName:"ViewGrid"}),y=new(this.managed(f.e))({text:S.e.ViewPhoto,tooltip:S.e.ViewPhotoCommandTooltip,icon:new E.e(O.e.singleAlbumIcon),isToggleable:!0,isHidden:this.selectionModeOn,action:new(this.managed(this.actionMap.ToggleListLayoutAction))({layoutType:M.t}),automationId:"switchLayout",location:4}),T=new(this.managed(f.e))({renderLabel:0,icon:this.createComputed(function(){return e.filesCommandSetHelper.computeViewSelectorIcon()}),isHidden:this.selectionModeOn,hasIconOnly:!0,location:4,requiredChildren:2,children:a.observableArray([g,y]),automationId:"switchLayoutSwitcher",text:S.e.Views,tooltip:S.e.ViewsCommandTooltip}),A=this.resources,_=A.consume(p.e),D=A.consume(d.e),P=[o,m,T,h,new(this.managed(f.e))({text:S.e.Details,tooltip:x.e.DetailsPane,icon:new E.e("Info"),location:12,hasIconOnly:!0,action:new(this.managed(this.actionMap.ShowPropertiesAction))({useToggleBehavior:!0}),ariaControls:_,ariaExpanded:D,renderLabel:0,keys:["I"],automationId:"showProperties"})],H=[n=this._makePivots(1).concat(n),i,P].map(function(t){return e.createObservable(t)});this.commandSets(H)};t.prototype._computeArePivotsHidden=function(){var e=this._photoType(),t=this.selectionModeOn();return 5===e||t};t.prototype._makePivots=function(e){var t=this._photoProvider.getAllPhotosSettings()(),n=[];n.push(new(this.managed(f.e))({text:T.e.allPhotosNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(0),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAllMyPhotosQueryUrl(t.rootId)}),location:3}));n.push(new(this.managed(f.e))({text:T.e.albumsNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(1),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getAlbumsQueryUrl()}),location:3}));Object(v.isFeatureEnabled)(v.EnableTagsInODC)&&n.push(new(this.managed(f.e))({text:T.e.tagsNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(2),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getTagsQueryUrl()}),automationId:"showTags",location:3}));n.push(new(this.managed(f.e))({text:T.e.placesNavLink,renderLabel:e,isCurrentView:this._createComputedIsCurrentViewAndNotSearch(3),isHidden:this._arePivotsHidden,isPermanent:!0,action:new(this.managed(this.actionMap.NavigationAction))({url:this._urlDataSource.getPlacesQueryUrl()}),location:3}));n[n.length-1].isLastPivot=!0;return n};t.prototype._createComputedIsCurrentViewAndNotSearch=function(e){var t=this;return this.createPureComputed(function(){return t._isCurrentViewAndNotSearch(e)})};t.prototype._isCurrentViewAndNotSearch=function(e){var t=Object(w.e)(this._urlDataSource.getQueryType(this._viewParams()));return this._currentView()===e&&!t};t.prototype._computeHideNewShareCommands=function(){return!Object(v.isFeatureEnabled)(v.UseNewShareDialog)||Object(_.e)()&&!Object(v.isFeatureEnabled)(v.UseNewShareDialogForWinApp)};t.prototype._computeHideOldShareCommand=function(){return Object(v.isFeatureEnabled)(v.UseNewShareDialog)&&(!Object(_.e)()||Object(v.isFeatureEnabled)(v.UseNewShareDialogForWinApp))};return t})(h.e),P=n(449),H=n(268),B=n(24),j=n(237),F=n(66),I=n(76),q=n(3),R=n(5),U=new q.t({name:"AlbumItemContent.key",loader:new R.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("125")]).then(n.bind(null,3152)).then(function(e){return e.resourceKey.local})})}),z=new q.t({name:"AlbumsContent.key",loader:new R.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("127")]).then(n.bind(null,3155)).then(function(e){return e.resourceKey.local})})}),W=new q.t({name:"AlbumsRootItemContent.key",loader:new R.t(function(){return n.e("126").then(n.bind(null,2589)).then(function(e){return e.resourceKey.local})})}),X=n(2148),V=new q.t({name:"OnThisDayItemContent.key",loader:new R.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("130")]).then(n.bind(null,3161)).then(function(e){return e.resourceKey.local})})}),$=n(2572),J=new q.t({name:"TagsRootItemContent.key",loader:new R.t(function(){return n.e("132").then(n.bind(null,3191)).then(function(e){return e.resourceKey.local})})}),K=n(515),Q=new q.t({name:"ItemsScopePlaces.key",loader:new R.t(function(){return Object(K.t)({path:"./ItemsScopePlaces",getModule:function(){return o.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("156")]).then(n.bind(null,3017)))},getExport:function(e){return e.knockoutResourceKey.local}})})}),G=new q.t({name:"ItemsScopeAlbums.key",loader:new R.t(function(){return Object(K.t)({path:"./ItemsScopeAlbums",getModule:function(){return o.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("155")]).then(n.bind(null,3142)))},getExport:function(e){return e.knockoutResourceKey.local}})})}),Y=n(1539),Z=n(2193),ee=new q.t({name:"ItemsScopeTagsGallery.key",loader:new R.t(function(){return Object(K.t)({path:"./ItemsScopeTagsGallery",getModule:function(){return o.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("157")]).then(n.bind(null,3236)))},getExport:function(e){return e.knockoutResourceKey.local}})})}),te=n(462),ne=n(2149),re=n(238),ie=n(278),se=n(60),oe=n(1181),ue=n(2196),ae=n(13),fe=n(10),le=n(941),ce=n(466),he=n(7),pe=n(46),de=n(286),ve=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.itemSet=t.itemSet;n._requiredRange=t.requiredRange;n.mappedRequiredRange=n.createObservable({start:0,end:0});n.mappedItemSet=n.createPureComputed(n._computeMappedItemSet,{deferEvaluation:!0});n.mappedItemSet.equalityComparer=pe.t;n.createBackgroundComputed(n._computeRequiredRange);n.createBackgroundComputed(n._computeMappedItemSetContent);return n}t.prototype.getOriginalItemIndexByMappedIndex=function(e){return this._indexMap?this._indexMap[e]:e};t.prototype.getNewMappedIndexByOldIndex=function(e){throw"Not implemented"};t.prototype._computeMappedItemSet=function(){var e=this.itemSet(),t=new de.e(e.key,e.context);t.item=e.item;t.content.peek().groupings=e.content.peek().groupings;t.schema=e.schema;t.isPlaceholder=e.isPlaceholder;t.content.peek().items=[];return t};t.prototype._computeRequiredRange=function(){var e=this.mappedRequiredRange(),t=0,n=0;if(this._indexMap){t=this._indexMap[e.start];n=this._indexMap[e.end]}var r={start:t,end:n};this._requiredRange(r)};t.prototype._computeMappedItemSetContent=function(){for(var e=this.itemSet(),t=e.content(),n=[],r=[],i=0;i<t.items.length;i++)if(t.items[i]){var s=t.items[i],o=s.peek();if(!le.s(o)){n.push(s);r.push(i)}}else{n.push(void 0);r.push(i)}this._indexMap=r;this.mappedItemSet.peek().isPlaceholder=e.isPlaceholder;this.mappedItemSet.peek().content({items:n,groupings:t.groupings})};return t})(he.n),me=n(2192),ge=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.lastItem=a.observable(null);n._itemKeyToHistoryItem={};n._currentItemSet=n.resources.consume(m.o);n.currentItem=n.createComputed(function(){var e=n._currentItemSet();return n.lastItem.peek()&&e.key===n.currentItem.peek().item.key?n.currentItem.peek():n._pushCurrentItemSet()},{deferEvaluation:!0});return n}t.prototype.getHistoryItemByKey=function(e){return this._itemKeyToHistoryItem[e]};t.prototype._pushCurrentItemSet=function(){var e=this._currentItemSet.peek();if(e){var t=this._itemKeyToHistoryItem[e.key],n={item:e,anchorItem:t&&t.anchorItem||a.observable(null)};this.lastItem(this.currentItem.peek());this._itemKeyToHistoryItem[e.key]=n;return this._itemKeyToHistoryItem[e.key]}};return t})(he.n),ye=n(2197),be=n(15),we=n(23),Ee=n(80),Se=n(56),xe=new q.t({name:"ItemsScopePhotoPage.key",loader:new R.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("210")]).then(n.bind(null,3018)).then(function(e){return e.resourceKey})})}),Te=n(164),Ne=n(2397),Ce=n(41),ke=n(401),Le=(function(e){Object(s.__extends)(t,e);function t(t){var r=e.call(this,t)||this;r._navigation=r.resources.consume(Ce.e);r._urlDataSource=r.resources.consume(y.n);r._engagement=r.resources.consume(se.e);r._shouldRedirectForOnThisDay();r.oneUpOverlayTagName=i.e.tagName;r.transclusionContentTagName=re.e.tagName;r.smartBannerTagName=ne.default.tagName;r._isOneDriveWinApp=Object(_.e)();r._commandSet=t.commandSet;r.addBindingHandlers({clientRect:H.e,element:F.e,scrollContainer:I.e,control:B.t});r._canMarqueeSelect=r.resources.consume(m.r);var s=r.resources.consume(g.e);r.haveDeferredControlsLoaded=s.getBundleInfo(1).isLoaded;s.queueBundle(1,function(){return o.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("176")]).then(n.bind(null,2155)))});r.resources.expose(be.K,new(r.managed(ue.e)));r.resources.expose(g.g,new(r.managed(ye.e)));r.platform=r.resources.consume(u.e);r.resources.expose(g.f,new(r.managed(ge)));r.detailsPaneSpecification=Object(B.n)(Y.resourceKey,{});r.photoType=r.createPureComputed(r._computePhotoType,{deferEvaluation:!0});r._activePivot=r.createPureComputed(r._computeActivePivot,{deferEvaluation:!0});r.createComputed(function(){var e=r.layoutType();r.isSuiteNavHamburgerVisible();var t=r.responsiveUI;r.isTopBarHamburgerVisible((!r._isOneDriveWinApp||Object(v.isWinAppVersionCompatible)())&&e!==M.l&&t.compareSize(t.formFactorSize(),"Large")>0)});Object(v.isWinAppVersionCompatible)()||r.hideLeftNav(!0);r.createBackgroundComputed(r._computeUpdateCanMarqueeSelect).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}});r._photoPage=r.observables.pureCompute(r._computePhotoPage);r.shouldShowPromotedPhotos=r.createPureComputed(r._computeShouldShowPromotedPhotos);var a=r._setupCommandSet();r._commandSet&&r._commandSet(a);r.commandBarSpecification=r.createPureComputed(function(){return r._computeCommandBarSpecification(a)});r.promotedPhotosParams={};r.createComputed(r._computeIsSuiteNavHidden);r.createComputed(r._computeIsSearchHidden);r._photosItemsScopeItemProps=r.createPureComputed(r._computePhotosItemsScopeProps);r._placesItemsScopeItemProps=r.createPureComputed(function(){return{props:{}}});r._albumsItemsScopeItemProps=r.createPureComputed(function(){return{props:{child:function(e){return r.child(e)}}}});r._isItemsScopeInAllPhotosEnabled=r.resources.consume(Ee.n);r._isItemsScopeInAllTagsEnabled=r.resources.consume(Ee.i);r._isItemsScopeInAllPlacesEnabled=r.resources.consume(Ee.r);r._isItemsScopeInAllAlbumsEnabled=r.resources.consume(Ee.e);r._isItemsScopeInSingleAlbumEnabled=r.resources.consume(Ee.a);r._isItemsScopeInSingleTagEnabled=r.resources.consume(Ee.l);r._isItemsScopeInSinglePlaceEnabled=r.resources.consume(Ee.f);r._isItemsScopeOnThisDayEnabled=r._isItemsScopeInAllPhotosEnabled&&Object(v.isFeatureEnabled)(v.UseItemsScopeInOnThisDay);Object(v.isFeatureEnabled)(v.UseItemsScopeInAllPhotosEnableGrid)||r.observables.backgroundCompute(function(){r.layoutType()===M.u&&r.layoutType(M.t)});r._itemsScopePhotoPageReady=r.createObservable(!1);r.createBackgroundComputed(function(){r.resources.consumeAsync(xe).then(function(e){r._itemsScopePhotoPage=e.photoPage;r._itemsScopePhotoPageReady(!0)})});r.isOneUpForPhotosOnly(!0);return r}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.isTopBarHamburgerVisible(!1);this.hideLeftNav(!1);this.isSearchHidden(!1);this.isSuiteNavHidden(!1);this.isCommandBarDarkTheme(!1);this.isOneUpForPhotosOnly(!1)};t.prototype.computeCurrentPageName=function(){var e=this._photoPage&&this._photoPage(),t=Ne.e[e||Ne.e.none];return"Photos-"+(""+t.substring(0,1).toUpperCase()+t.substring(1))};t.prototype.computeContentControl=function(){var t=e.prototype.computeContentControl.call(this);if(t)return t;var n=this.getContentControlParams();switch(this._photoPage()){case Ne.e.allPhotos:return this._isItemsScopeInAllPhotosEnabled?Object(B.n)(Z.e,this._photosItemsScopeItemProps()):Object(B.n)($.resourceKey,n);case Ne.e.singleTag:return this._isItemsScopeInSingleTagEnabled?Object(B.n)(Z.e,this._photosItemsScopeItemProps()):Object(B.n)($.resourceKey,n);case Ne.e.singlePlace:return this._isItemsScopeInSinglePlaceEnabled?Object(B.n)(Z.e,this._photosItemsScopeItemProps()):Object(B.n)($.resourceKey,n);case Ne.e.search:return Object(B.n)(X.resourceKey,n);case Ne.e.tags:return this._isItemsScopeInAllTagsEnabled?Object(B.n)(ee,{props:{}}):Object(B.n)(J,n);case Ne.e.places:return this._isItemsScopeInAllPlacesEnabled?Object(B.n)(Q,this._placesItemsScopeItemProps()):Object(B.n)(J,n);case Ne.e.albums:return this._isItemsScopeInAllAlbumsEnabled?Object(B.n)(G,this._albumsItemsScopeItemProps()):Object(v.isFeatureEnabled)(v.EnableEvokeAlignments)?Object(B.n)(z,n):Object(B.n)(W,n);case Ne.e.singleAlbum:return this._isItemsScopeInSingleAlbumEnabled?Object(B.n)(Z.e,this._photosItemsScopeItemProps()):Object(B.n)(U,n);case Ne.e.onThisDay:return this._isItemsScopeOnThisDayEnabled?Object(B.n)(Z.e,this._photosItemsScopeItemProps()):Object(B.n)(V,n)}};t.prototype.computeCreateDataManager=function(){var e,t=this.viewParams(),n=this.urlDataSource.getQueryType(t);if("photos"!==t.v)return null;switch(n){case fe.e.Search:e=this._createFilesDataManager;break;default:e=this._createPhotosDataManager}return e};t.prototype.computeDataManagerMapper=function(){var t=this._photoPage(),n=this.viewParams(),r=this.dataManager();return Object(v.isFeatureEnabled)(v.EnableEvokeAlignments)&&t===Ne.e.albums&&n.tagFilter!==oe.n?new(this.managed(ve))({itemSet:this.unmappedItemSet,requiredRange:r.requiredRange}):e.prototype.computeDataManagerMapper.call(this)};t.prototype._shouldRedirectForOnThisDay=function(){var e=this.identityDataSource.getIdentity().type,t=this.viewParams.peek();if(e===Te.e.anonymous&&Object(ke.t)(t)){this._logTelemetry("AllPhotos.OnThisDayRedirect",{otdEntryPoint:t.sc});var n=this._urlDataSource.getOnThisDayQueryUrl();this._navigation.navigateTo(n)}};t.prototype._computeIsSuiteNavHidden=function(){var e=this._photoPage();this.isSuiteNavHidden(e===Ne.e.singleAlbum&&!Object(v.isFeatureEnabled)(v.UseItemsScopeInSingleAlbum)||this._isOneDriveWinApp)};t.prototype._computeIsSearchHidden=function(){var e=this._photoPage();this.isSearchHidden(e===Ne.e.singleAlbum||this._isOneDriveWinApp)};t.prototype._createPhotosDataManager=function(){return new(this.managed(me.e))({requiredPageType:ae.e.Photos})};t.prototype._createFilesDataManager=function(){return new(this.managed(ce.e))({requiredPageType:ae.e.Photos})};t.prototype._computePhotoType=function(){var e=this.viewParams();return this.urlDataSource.getPhotoType(e)};t.prototype._computeUpdateCanMarqueeSelect=function(){var e;switch(this.photoType()){case 2:case 3:e=!1;break;default:e=!0}this._canMarqueeSelect(e)};t.prototype._computeActivePivot=function(){var e=this.photoType();return 1===e||5===e?1:2===e||6===e?2:3===e||7===e?3:0===e?0:null};t.prototype._computeShouldShowPromotedPhotos=function(){return!this._isItemsScopeInAllPhotosEnabled&&Object(v.isFeatureEnabled)(v.PromotedPhotosContentEnabled)&&this._photoPage()===Ne.e.allPhotos};t.prototype._computePhotoPage=function(){var e=this.item(),t=this.viewParams(),n=this._itemsScopePhotoPageReady&&this._itemsScopePhotoPageReady()?this._itemsScopePhotoPage():Ne.e.none,r=this.urlDataSource.getKeyParams(e.key);return"search"===r.qt?Ne.e.search:"allmyphotos"===r.qt?r.tagFilter?this._isItemsScopeInSingleTagEnabled?n:Ne.e.singleTag:r.locationFilter?this._isItemsScopeInSinglePlaceEnabled?n:Ne.e.singlePlace:r.onThisDay?Object(v.isFeatureEnabled)(v.UseItemsScopeInOnThisDay)?n:Ne.e.onThisDay:this._isItemsScopeInAllPhotosEnabled?n:Ne.e.allPhotos:"tags"===r.id?this._isItemsScopeInAllTagsEnabled?n:Ne.e.tags:"places"===r.id?this._isItemsScopeInAllPlacesEnabled?n:Ne.e.places:Object(l.u)(t)?this._isItemsScopeInAllAlbumsEnabled?n:Ne.e.albums:Object(l.p)(t)?this._isItemsScopeInSingleAlbumEnabled?n:Ne.e.singleAlbum:Ne.e.none};t.prototype._computePhotosItemsScopeProps=function(){var e=this;this.layoutType();var t=this.viewParams(),n=this.urlDataSource.getLayoutContentType(t),r=this.dataManager.peek().getContextualQueryType(fe.e.AllMyPhotos),i=(n||r)===Se.n?M.u:M.t,s=this.urlDataSource.getPhotoType(t);Object(l.a)(t)||i!==M.u||(i=M.t);var o,u={layoutType:i,isMobile:this.platform.isMobile,child:function(t){return e.child(t)},photoType:s,isInFilePicker:!1};if(le.s(this.item())){o={saveAutoAlbumAction:new(this.managed(this.actionMap.SaveAutoAlbumAction))({item:this.item}),discardAutoAlbumAction:new(this.managed(this.actionMap.DiscardAutoAlbumAction))({item:this.item})};u.footerProps=o}var a=this._photosItemsScopeItemProps.peek();return a&&a.props.layoutType===u.layoutType&&a.props.isMobile===u.isMobile&&a.props.photoType===u.photoType&&a.props.footerProps===o?a:{props:u}};t.prototype._setupCommandSet=function(){var e={currentView:this._activePivot,photoType:this.photoType,isOneUp:this.isOneUp},t=new(this.managed(D))(e);this.resources.expose(we.u,new(this.managed(j.e))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"List",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));this.contextMenuHelper(new(this.managed(j.e))({items:this.platform.isMobile?[]:t.commands.peek(),rootElementClass:"od-Photos",boundingElementClass:"od-BasePage-content",shouldHideIcons:!0}));return t};t.prototype._computeCommandBarSpecification=function(e){if(this._isItemsScopeInAllAlbumsEnabled&&this._photoPage()===Ne.e.albums){this.contextMenuHelper(null);return Object(B.n)(te.e,{props:{handleRenderComplete:function(e,t){t.unblockItemPageRender()}}})}return Object(B.n)(ie.e,{commandSet:e})};t.prototype._logTelemetry=function(e,t){if(this._engagement){var n={name:"AllPhotos."+e,extraData:t};this._engagement.logData(n)}};return t})(P.e),Ae=n(16).e({tagName:"od-photos",template:'\x3c!--ko if:shouldShowPromotedPhotos--\x3e<div class="od-photos-promotedWrapper" data-bind="css:{\'od-photos-promotedWrapper--loaded\':haveDeferredControlsLoaded}">\x3c!--ko if:haveDeferredControlsLoaded--\x3e<div class="od-photos-promoted" data-bind="component:{name:\'od-promoted-photos\',params:promotedPhotosParams}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isBannerApplicable--\x3e<div class="od-photos-smartBanner" data-bind="component:{name:smartBannerTagName,params:{isVisible:isSmartBannerVisible}}"></div>\x3c!--/ko--\x3e\x3c!--ko control:contentControl--\x3e\x3c!--/ko--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:commandBarTransclusionContentParams}--\x3e<div data-bind="control:commandBarSpecification"></div>\x3c!--/ko--\x3e\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e\x3c!--ko if:isOneUp--\x3e\x3c!--ko component:{name:oneUpOverlayTagName,params:{}}--\x3e\x3c!--ko control:oneUpSpecification--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:Le,synchronous:!0});t.default=Ae},"701":function(e,t,n){"use strict";n.d(t,"e",function(){return o});n.d(t,"n",function(){return u});n.d(t,"t",function(){return f});n.d(t,"r",function(){return l});var r=n(0),i=n(150),s=n(336),o=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={message:"Canceled"});var n=e.call(this,Object(r.__assign)({code:"Canceled",isExpected:!0},t))||this;n.name="Canceled";return n}return t})(i.e);function u(e){return e instanceof o}var a=function(e){var t,n=e.catch(function(e){t=e;return Promise.reject(e)});this.subscribe=function(e){var t=e;n.then(function(){t=void 0},function(e){if(t){var n=t;t=void 0;n(e)}});return function(){t=void 0}};this.isCanceled=function(){return!!t};this.throwIfCanceled=function(){if(t)throw new o(t)}},f=function(){var e=new s.e,t=e.reject,n=e.resolve,r=e.promise;this.cancel=function(e){return t(e||new o)};this.dispose=function(){return n()};this.token=new a(r)};function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,o=this;return Object(r.__generator)(this,function(u){switch(u.label){case 0:return t?[3,2]:[4,e];case 1:return[2,u.sent()];case 2:n=new s.e;i=t.subscribe(function(e){n.reject(e)});Object(r.__awaiter)(o,void 0,void 0,function(){var t,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,2,3,4]);s=(t=n).resolve;return[4,e];case 1:s.apply(t,[r.sent()]);return[3,4];case 2:o=r.sent();n.reject(o);return[3,4];case 3:i();return[7];case 4:return[2]}})});return[4,n.promise];case 3:return[2,u.sent()]}})})}},"720":function(e,t,n){"use strict";n.d(t,"t",function(){return a});var r=n(0),i=n(7),s=n(1146),o=n(5),u=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});void 0===n&&(n={});var r=e.call(this,t,n)||this,i=n.itemCommandProvider,o=void 0===i?r.resources.consume(s.e):i;r._itemCommandProvider=o;return r}t.prototype.isCommandSupported=function(e,t){var n=this._itemCommandProvider;return!n||!!n.getCommand(e,t)};t.prototype.getCommandBehavior=function(e,t){var n=this._itemCommandProvider,r=n&&n.getCommand(e,t);return r&&r.behavior};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandProvider:s.e});return t})(i.n);t.e=u;var a=Object(o.s)("ItemCommandHelper",u)},"762":function(e,t,n){"use strict";n.d(t,"t",function(){return u});n.d(t,"e",function(){return a});var r=n(0),i=n(336),s=n(701),o=n(888);function u(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o,u,a,f,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=new i.e,o=n.resolve,u=n.reject,a=n.promise;t&&t.throwIfCanceled();f=e!==1/0?window.setTimeout(function(){return o()},e):void 0;l=t&&t.subscribe(function(){f&&window.clearTimeout(f);u(new s.e)});r.label=1;case 1:r.trys.push([1,,3,4]);return[4,a];case 2:r.sent();return[3,4];case 3:l&&l();return[7];case 4:return[2]}})})}function a(e,t){var n="number"==typeof e?{timeout:e}:e,i=n.timeout,u=n.errorProps,a=void 0===u?{}:u,f=new s.t,l=t&&t.subscribe(f.cancel),c=i!==1/0?window.setTimeout(function(){f.cancel(new o.e(Object(r.__assign)({timeout:i},a)))},i):void 0;c&&f.token.subscribe(function(){window.clearTimeout(c)});return Object(r.__assign)(Object(r.__assign)({},f),{dispose:function(){c&&clearTimeout(c);l&&l();f.dispose()}})}},"888":function(e,t,n){"use strict";n.d(t,"e",function(){return i});var r=n(0),i=(function(e){Object(r.__extends)(t,e);function t(t){var n=t.timeout,i=Object(r.__rest)(t,["timeout"]),s=e.call(this,Object(r.__assign)(Object(r.__assign)({message:"Timeout"},i),{extraData:{timeout:n}}))||this;s.timeout=n;s.name="TimeoutError";return s}return t})(n(150).e)},"941":function(e,t,n){"use strict";n.d(t,"t",function(){return d});n.d(t,"n",function(){return v});n.d(t,"r",function(){return m});n.d(t,"o",function(){return y});n.d(t,"s",function(){return b});n.d(t,"i",function(){return w});n.d(t,"e",function(){return E});var r=n(47),i=n(61),s=n(36),o=n(175),u=["docx","doc","docm","dotm","dotx","xlsx","xlsb","xls","xlsm","pptx","ppsx","ppt","pps","pptm","potm","ppam","potx","ppsm","pdf"],a="Doc",f="Ppt",l="Xls",c="Vsd",h="Lib",p={WinDocuments:h,WinLibrary:h,WinMusic:h,WinPictures:h,WinPodcastLibrary:h,WinVideos:h,WinDrive:"Drive",CDDrive:"CDDrive",GenericDrive:"Drive",UsbDrive:"USBDrive",ExternalDrive:"ExtDrive",NetworkStorage:"NetDrive",Accdb:"Mdb",Doc:a,Docm:a,Docx:a,Dot:a,Dotm:a,Dotx:a,Exe:"Exe",Html:"Html",Mdb:"Mdb",Mpp:"Mpp",Mpt:"Mpp",Odp:f,Ods:l,Odt:a,One:"One",Onepkg:"One",Onetoc2:"One",Notebook:"OneNotebook",Pot:f,Potm:f,Potx:f,Ppa:f,Ppam:f,Pps:f,Ppsm:f,Ppsx:f,Ppt:f,Pptm:f,Pptx:f,Pub:"Pub",Rtf:"Rtf",Txt:"Txt",Vdw:c,Vsd:c,Vsdm:c,Vsdx:c,Vsl:c,Vss:c,Vssm:c,Vssx:c,Vst:c,Vstm:c,Vstx:c,Xaml:"Xaml",Xla:l,Xlam:l,Xll:l,Xls:l,Xlsb:l,Xlsm:l,Xlsx:l,Xlt:l,Xltm:l,Xltx:l,Xml:"Xml",Xps:"Xps",Xsn:"Xsn",Zip:"Zip"};function d(e,t,n){var o=e.extension,u=o&&o.slice("."===o[0]?1:0),a=u&&u.toUpperCase(),f=g(e.itemFromServer&&e.itemFromServer.iconType||u);return e.isDocSet?i.e.fileTypeDocSet:f||e.type!==r.e.Folder?n||(e.panorama?i.e.fileTypePanorama:e.photo&&!e.video?s.format(i.e.fileTypeImage,a||"").trim():f?i.e["fileType"+f]:a?s.format(i.e.fileTypeUnknown,a):t?i.e.listItemType:i.e.fileTypeNoExtension):i.e.fileTypeFolder}function v(e){var t=e.slice(e.lastIndexOf(".")+1);return s.format(i.e.shortcutFileTypeFormat,t.length!==e.length?this.getShortcutFileTypeFromExtension(t):i.e.fileTypeNoExtension)}function m(e){var t=i.e.fileTypeNoExtension;if(!e)return t;var n=g(s.capitalize(e));if(n)return i.e["fileType"+n];var r=e.toUpperCase();return r?s.format(i.e.fileTypeUnknown,r):t}function g(e){return p[e]}function y(e){return e&&-1!==u.indexOf(e)}function b(e){return w(e)&&!!e.properties.newTag}function w(e){return!!e.properties&&!!e.properties.autoAlbumTag}function E(e){if(!e)return o.e.Word;var t=g(s.capitalize(e.split(".").pop()));return"One"===t?o.e.OneNote:t===f?o.e.PowerPoint:t===l?o.e.Excel:t===c?o.e.Visio:o.e.Word}},"957":function(e,t,n){"use strict";var r=(function(){function e(t){this.id=""+ ++e._lastId;this.name=t}e.prototype.matches=function(e){return e===this};e._lastId=0;return e})();t.e=r},"1012":function(e,t,n){"use strict";n.d(t,"a",function(){return i});n.d(t,"t",function(){return s});n.d(t,"r",function(){return o});n.d(t,"n",function(){return u});n.d(t,"s",function(){return a});n.d(t,"e",function(){return f});n.d(t,"i",function(){return l});n.d(t,"o",function(){return c});n.d(t,"u",function(){return h});var r=n(957),i=new r.e("share"),s=new r.e("addToShared"),o=new r.e("embed"),u=new r.e("comment"),a=new r.e("removeFromShared"),f=new r.e("addAsMountPoint"),l=new r.e("removeAsMountPoint"),c=new r.e("reportAbuse"),h=new r.e("requestReview");new r.e("alertItem"),new r.e("alertItem")},"1024":function(e,t,n){"use strict";var r=n(0),i=n(190),s=n(25),o=n(26),u=n(41),a=n(6),f=n(22),l=n(187),c=n(3),h=n(5),p=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===n&&(n={});var r=e.call(this,t,n)||this;r.name="Navigation";var i=t.url,s=t.viewParams,o=t.target,f=void 0===o?"_top":o,l=t.forceNavigation,c=void 0!==l&&l,h=t.ignoreHistory,p=t.beforeNavigation,d=t.afterNavigation,v=t.postProcessUrl,m=n.navigation,g=void 0===m?r.resources.consume(u.e):m,y=n.viewParamsObservable,b=void 0===y?r.resources.consume(a.H):y;r._navigation=g;r._viewParams=b;r._url=r.wrapObservable(i);r._inputViewParams=r.wrapObservable(s);r._target=r.wrapObservable(f);r._forceNavigation=c;r._ignoreHistory=h;r._beforeNavigation=p;r._afterNavigation=d;r._postProcessUrl=v;return r}t.prototype.onExecute=function(e,t){var n=this._url.peek(),r=this._inputViewParams.peek(),i=this._beforeNavigation;i&&i(this._navigation);var u=this._postProcessUrl?this._postProcessUrl(n):n;(this._forceNavigation||n)&&this._navigation.navigateTo({url:u,viewParams:r,frameId:this._target.peek(),ignoreHistory:this._ignoreHistory});this._afterNavigation&&this._afterNavigation(this._navigation);return s.n.wrap({resultType:o.e.Success})};t.prototype.onIsAvailable=function(){var e=this._url();if(!e)return!1;if(this._forceNavigation)return!0;var t=this._inputViewParams(),n=this._viewParams(),r="#"+f.n(n),i=t&&0===t.indexOf("#")?t.substring(1):"",s=i+(i?"&":"")+(0===e.indexOf("#")?e.substring(1):"");if(s){var o=f.e(s);return!l.e(n,o)}return e!==r};t.dependencies={resources:c.o,navigation:u.e,viewParamsObservable:a.H};return t})(i.e);t.e=p;Object(h.o)("NavigationAction",p)},"1038":function(e,t,n){"use strict";var r=n(0),i=n(27);var s=n(380),o=n(762);n.d(t,"e",function(){return l});var u=new WeakMap,a=new Map,f=new WeakMap;function l(e,t){void 0===t&&(t={});var n=t.useChildrenAsPlaceholder,l=void 0!==n&&n,c=function(){return(function(e){var t=f.get(e);t||f.set(e,t=e().then(function(t){var n,r=(n=t).default||n;u.set(e,r);return r}).catch(function(t){f.delete(e);return Promise.reject(t)}));return t})(e)},h=function(){if(u.has(e))return u.get(e)};function p(e){var t=this,n=i.useState(function(){return{}}),u=e.placeholder,f=e.children,p=e.barrier,d=Object(r.__rest)(e,["placeholder","children","barrier"]),v=Object(s.e)(function(){return d},d),m=i.useState(function(){return h()}),g=m[0],y=m[1],b=i.useRef(y),w=i.useState(),E=w[0],S=w[1],x=i.useRef(S);i.useLayoutEffect(function(){return function(){b.current=void 0;x.current=void 0;a.delete(n)}},[]);i.useLayoutEffect(function(){if(a.size>0){var e=[];a.forEach(function(t){e.push(t)});a.clear();for(var t=0,n=e;t<n.length;t++){(0,n[t])()}}});i.useLayoutEffect(function(){g||E||Object(r.__awaiter)(t,void 0,void 0,function(){var e,t,i,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:r.trys.push([0,4,,5]);return p?[4,p]:[3,2];case 1:r.sent();r.label=2;case 2:return[4,c()];case 3:e=r.sent();return[3,5];case 4:i=r.sent();t=i;return[3,5];case 5:a.set(n,function(){e?b.current&&b.current(function(){return e}):t&&x.current&&x.current(t)});return[4,Object(o.t)(0)];case 6:r.sent();if(s=a.get(n)){a.delete(n);s()}return[2]}})})},[]);return i.useMemo(function(){if(E)throw E;return g?i.createElement(g,Object(r.__assign)({},v,{children:f})):l?i.createElement(i.Fragment,null,f):u?i.createElement(i.Fragment,null,u):null},[v,u,f,g,E])}p.asAsync={load:c,getComponent:h,options:t};return p}},"1146":function(e,t,n){"use strict";n.d(t,"e",function(){return a});var r=n(0),i=n(7),s=n(15),o=n(5),u=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t)||this;r._commandDataSource=n.itemCommandDataSource;return r}t.prototype.getCommand=function(e,t){return this._commandDataSource.getCommand(e,t)};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{itemCommandDataSource:s.M});return t})(i.n),a=Object(o.s)("ItemCommandProvider",u)},"1181":function(e,t,n){"use strict";var r=n(0),i=n(7),s=n(25),o=n(256),u=n(264),a=n(155),f=n(1344),l=n(22),c=n(384),h=1e3,p=n(404);n.d(t,"n",function(){return d});n.d(t,"e",function(){return v});n.d(t,"r",function(){return m});n.d(t,"t",function(){return g});var d="__New",v="__Auto",m="__WeekendRecap",g="__EventRecap",y=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._urlDataSource=n.resources.consume(o.n);return n}t.prototype.addToAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.ADD_TO_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.removeFromAlbum=function(e,n){var r={id:e.id,name:null,items:this._getIdsFromKeyArray(n),action:t.REMOVE_FROM_ALBUM_ACTION};return this._handleRequest(n,r)};t.prototype.createAlbum=function(e,n){var r=this,i=this._getIdsFromKeyArray(n),o=i.slice(0,20),a={id:null,name:e,items:o,action:t.CREATE_ALBUM_ACTION};return(new u.e).send({requestType:"POST",postData:JSON.stringify(a),apiName:t.MODIFY_ALBUM_API_NAME+"."+a.action,url:this._getModifyAlbumUrl(),isErrorExpectedCallback:p.e}).then(function(e){if(!n||n&&n.length<20)return e;o=i.slice(20);var u={id:e.id,items:o,action:t.ADD_TO_ALBUM_ACTION,name:null};return r._handleRequest(o,u).then(function(t){return e},function(e){var t={errorType:c.e.other,error:new Error(e.data.message)};return s.n.wrapError(t)})},function(e){var t=c.e.other;e.data.code===h&&(t=c.e.conflict);var n={errorType:t,error:new Error(e.data.message)};return s.n.wrapError(n)})};t.prototype.getWalgreensLandingPageUrl=function(e){var t=this._urlDataSource.getPublishToWalgreensUrl();return(new u.e).sendPostUrlEncoded("PublishToWalgreens",t,JSON.stringify({ids:e}))};t.prototype.createAlbumFromFolder=function(e){var n=this._getModifyAlbumUrl(),r=new u.e,i={id:null,name:e.folder.name,items:[e.folder.id],action:t.CREATE_ALBUM_WITH_RENAME_ACTION};return r.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+i.action,url:n,requestType:"POST",postData:JSON.stringify(i),isErrorExpectedCallback:p.e})};t.prototype.getAlbumsParentKey=function(e){var n;void 0===e&&(e={});var r=((n={}).id=t.ALBUMS_ID,n.cid=this._urlDataSource.getOwnerId(),n.tagFilter=e.tagFilter,n);return l.n(r,void 0,!0)};t.prototype.setCoverPhoto=function(e,n){var r=this._getModifyAlbumUrl(),i=new u.e,o={id:e.id,items:[n.id],action:t.SET_COVER_PHOTO_ACTION,name:null};return i.send({apiName:t.MODIFY_ALBUM_API_NAME+"."+o.action,url:r,requestType:"POST",postData:JSON.stringify(o),isErrorExpectedCallback:p.e}).then(null,function(e){var t=e&&e.data&&e.data.message||"";return s.n.wrapError(t)})};t.prototype._handleRequest=function(e,n){var r=this._getModifyAlbumUrl();return f.e.start({apiName:t.MODIFY_ALBUM_API_NAME+"."+n.action,url:r,batchSize:20,items:e,isErrorExpectedCallback:p.e,getPostData:function(e){return{id:n.id,name:n.name,items:e,action:n.action}}})};t.prototype._getModifyAlbumUrl=function(){return a.t.skyApiBaseUrl+t.MODIFY_ALBUM_API_NAME};t.prototype._getIdsFromKeyArray=function(e){return e.map(function(e){return l.e(e).id})};t.ADD_TO_ALBUM_ACTION="Add";t.CREATE_ALBUM_ACTION="Create";t.CREATE_ALBUM_WITH_RENAME_ACTION="CreateWithRename";t.REMOVE_FROM_ALBUM_ACTION="Remove";t.SET_COVER_PHOTO_ACTION="SetCoverPhoto";t.MODIFY_ALBUM_API_NAME="ModifyAlbum";t.ALBUMS_ID="albums";return t})(i.n);t.i=y},"1223":function(e,t,n){"use strict";var r;(function(e){e[e.allTags=0]="allTags";e[e.allPlaces=1]="allPlaces";e[e.singleTag=2]="singleTag";e[e.singlePlace=3]="singlePlace"})(r||(r={}));t.e=r},"1228":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".od-ItemContent-header{box-sizing:border-box;display:flex;flex-flow:row wrap;align-items:flex-end;padding-top:10px;padding-bottom:10px}.xlg .od-ItemContent-header,.xxlg .od-ItemContent-header,.xxxlg .od-ItemContent-header,.xxxxlg .od-ItemContent-header{padding-top:32px;padding-bottom:0}.od-FolderItemContent .StorageInfo-sectionHeading{margin:44px 32px 20px;max-width:800px;font-size:18px;font-weight:600;margin-bottom:20px;padding-bottom:20px;border-bottom:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:"}.sm .od-FolderItemContent .StorageInfo-sectionHeading{margin:44px 16px 20px}.xxlg .od-FolderItemContent .StorageInfo-sectionHeading,.xxxlg .od-FolderItemContent .StorageInfo-sectionHeading,.xxxxlg .od-FolderItemContent .StorageInfo-sectionHeading{max-width:1080px}.isFluent.sm .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.isFluent.md .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.isFluent.lg .od-FolderItemContent .od-ItemContent-progress-container{margin:0 32px 40px}.isFluent.sm .od-FolderItemContent .od-ItemContent-progress-container{margin:0 16px 40px}.isFluent.xxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.isFluent.xxxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.isFluent.xxxxlg .od-FolderItemContent .od-ItemContent-progress-container{max-width:1080px}.isFluent .od-FolderItemContent .od-ItemContent-progress-container{max-width:800px;box-shadow:0 1.6px 3.6px 0 rgba(0,0,0,.132),0 .3px .9px 0 rgba(0,0,0,.108);border-radius:2px;margin:0 32px 20px;padding:24px 0}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .od-quota-progress-bar-main{display:flex;flex-direction:column}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .od-quota-progress-bar-main .od-quota-progress-bar-top{order:1;margin-top:12px}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .StorageInfo-totalUsed{font-weight:600}.isFluent .od-FolderItemContent .od-ItemContent-progress-container .od-ItemContent-progress{padding:0 24px;margin-top:12px;height:46px}.od-FolderItemContent .StorageInfo-totalUsed{margin:0 24px}.od-ItemContent-progress{height:31px;padding:10px 32px}.md .od-ItemContent-progress,.sm .od-ItemContent-progress{padding-left:16px;padding-right:16px}.od-ItemContent-title{margin:0;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;font-size:21px;font-weight:100}.isFluent .od-ItemContent-title{font-size:20px;font-weight:600}.lg .od-ItemContent-title,.md .od-ItemContent-title,.sm .od-ItemContent-title{font-weight:300}.isFluent.sm .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:10px;margin-bottom:10px}.isFluent.md .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:10px;margin-bottom:10px}.isFluent.lg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:10px;margin-bottom:10px}.xlg .od-ItemContent-title,.xxlg .od-ItemContent-title,.xxxlg .od-ItemContent-title,.xxxxlg .od-ItemContent-title{font-size:28px;font-weight:100}.isFluent.xlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:20px;margin-bottom:4px;line-height:36px}.isFluent.xxlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:20px;margin-bottom:4px;line-height:36px}.isFluent.xxxlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:20px;margin-bottom:4px;line-height:36px}.isFluent.xxxxlg .od-ItemContent-title{font-size:20px;font-weight:600;margin-top:20px;margin-bottom:4px;line-height:36px}.od-ItemContent-breadcrumb{font-size:17px;font-weight:300}.md .od-ItemContent-breadcrumb,.sm .od-ItemContent-breadcrumb{font-size:14px;font-weight:400}.xlg .od-ItemContent-breadcrumb,.xxlg .od-ItemContent-breadcrumb,.xxxlg .od-ItemContent-breadcrumb,.xxxxlg .od-ItemContent-breadcrumb{font-size:21px;font-weight:100;margin-bottom:1px}.isFluent.xlg .od-ItemContent-breadcrumb{margin-top:14px}.isFluent.xxlg .od-ItemContent-breadcrumb{margin-top:14px}.isFluent.xxxlg .od-ItemContent-breadcrumb{margin-top:14px}.isFluent.xxxxlg .od-ItemContent-breadcrumb{margin-top:14px}.xlg .od-ItemContent-list,.xxlg .od-ItemContent-list,.xxxlg .od-ItemContent-list,.xxxxlg .od-ItemContent-list{padding-top:20px}.od-ItemContent-footer{margin:0}[dir=ltr] .od-ItemContent-footer,[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-left:32px}[dir=rtl] .od-ItemContent-footer,[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-right:32px}[dir=ltr] .od-ItemContent-footer,[dir=ltr] .od-ItemContent-header,[dir=ltr] .od-ItemContent-list{padding-right:32px}[dir=rtl] .od-ItemContent-footer,[dir=rtl] .od-ItemContent-header,[dir=rtl] .od-ItemContent-list{padding-left:32px}[dir=ltr] .xlg .od-ItemContent-footer,[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-footer,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-footer,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-footer,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=rtl] .xlg .od-ItemContent-footer,[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-footer,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-footer,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-footer,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=ltr] .xlg .od-ItemContent-footer,[dir=ltr] .xlg .od-ItemContent-header,[dir=ltr] .xlg .od-ItemContent-list,[dir=ltr] .xxlg .od-ItemContent-footer,[dir=ltr] .xxlg .od-ItemContent-header,[dir=ltr] .xxlg .od-ItemContent-list,[dir=ltr] .xxxlg .od-ItemContent-footer,[dir=ltr] .xxxlg .od-ItemContent-header,[dir=ltr] .xxxlg .od-ItemContent-list,[dir=ltr] .xxxxlg .od-ItemContent-footer,[dir=ltr] .xxxxlg .od-ItemContent-header,[dir=ltr] .xxxxlg .od-ItemContent-list{padding-right:32px}[dir=rtl] .xlg .od-ItemContent-footer,[dir=rtl] .xlg .od-ItemContent-header,[dir=rtl] .xlg .od-ItemContent-list,[dir=rtl] .xxlg .od-ItemContent-footer,[dir=rtl] .xxlg .od-ItemContent-header,[dir=rtl] .xxlg .od-ItemContent-list,[dir=rtl] .xxxlg .od-ItemContent-footer,[dir=rtl] .xxxlg .od-ItemContent-header,[dir=rtl] .xxxlg .od-ItemContent-list,[dir=rtl] .xxxxlg .od-ItemContent-footer,[dir=rtl] .xxxxlg .od-ItemContent-header,[dir=rtl] .xxxxlg .od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-ItemContent-footer,[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-footer,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-left:16px}[dir=rtl] .md .od-ItemContent-footer,[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-footer,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-right:16px}[dir=ltr] .md .od-ItemContent-footer,[dir=ltr] .md .od-ItemContent-header,[dir=ltr] .md .od-ItemContent-list,[dir=ltr] .sm .od-ItemContent-footer,[dir=ltr] .sm .od-ItemContent-header,[dir=ltr] .sm .od-ItemContent-list{padding-right:16px}[dir=rtl] .md .od-ItemContent-footer,[dir=rtl] .md .od-ItemContent-header,[dir=rtl] .md .od-ItemContent-list,[dir=rtl] .sm .od-ItemContent-footer,[dir=rtl] .sm .od-ItemContent-header,[dir=rtl] .sm .od-ItemContent-list{padding-left:16px}.od-ItemContent-header-sharedIndicator{display:inline-block;position:relative;padding:0}.od-ItemContent-header-sharedIndicator .od-ItemContent-metadata{padding-bottom:3px;margin:0}"}])},"1321":function(e,t,n){"use strict";var r=n(1),i=(function(){function e(){}e.update=function(e,t){var n=r.unwrap(t());e.style.visibility=n?"inherit":"hidden"};return e})();t.e=i},"1336":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".EmptyFolder{text-align:center}.EmptyFolder.EmptyFolder-content-vault{padding-top:95px}.EmptyFolder-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.EmptyFolder-image .EmptyFolder-imageTag{height:208px;width:auto}.md .EmptyFolder-image,.sm .EmptyFolder-image{padding-top:20px;height:168px;width:168px}.EmptyFolder-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .EmptyFolder-title{padding:16px 16px 0 16px}.isFluent .EmptyFolder-title{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";font-size:18px;font-weight:600}.md .EmptyFolder-title,.sm .EmptyFolder-title{font-size:17px;font-weight:300;padding-top:64px}.EmptyFolder-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .EmptyFolder-subText{padding:6px 16px 0 16px}.isFluent .EmptyFolder-subText{padding:8px 16px 0}.EmptyFolder-icon{display:inline;font-size:13px;padding-left:2px;padding-right:1px}.EmptyFolder-mobile{display:none}.od--isMobile .EmptyFolder-mobile{display:block}.od--isMobile .EmptyFolder-pc{display:none}.EmptyFolder-subTextPart2Link{cursor:pointer}"}]);var i=n(0),s=n(547),o=n(36),u=n(9),a=n(377),f=n(6),l=n(15),c=n(31),h=n(378),p=n(1839),d=n(13),v=n(10),m=n(1557),g=n(121),y=n(4),b=n(18),w='<i class="EmptyFolder-icon '+Object(s.C)("Add")+'" ></i>',E=b.e.isActivated("5E34EBC4-606B-498C-8C53-40910E216F64","5/28/2020","Lazy-initialize OneDrive root items"),S=(function(e){Object(i.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.addBindingHandlers({bindableHtml:h.e});var i=r.observables,s=r.resources;r.isDocLib=!0;r._rootItems=i.create();r._urlDataSource=n.urlDataSource;r._content=i.pureCompute(r._computeContent);r._currentPage=r._urlDataSource.getPageType();r._isViewOnly=t.isViewOnly;r._item=n.item;r._itemParentHelper=n.itemParentHelper;E&&s.consumeAsync(m.e.optional).then(function(e){r._rootItems(e)});r._storageOptionsProvider=n.storageOptionsProvider;r._userInfoProvider=n.userInfoProvider;r._viewParams=n.viewParams;r._isOneDriveXboxApp=Object(g.t)();r._useFluentIllustrations=Object(y.isFeatureEnabled)(y.EmptyStateIllustrationsRefresh);r._fluentV2String=r._useFluentIllustrations?"_v2":"";r._recentDocsNavigationAction=new(r.managed(n.actionMap.NavigationAction))({target:"blank",url:i.pureCompute(function(){if(!E)return r._urlDataSource.getRecentQueryUrl();var e=i.unwrap(i.unwrap(r._rootItems)),t=i.unwrap(e&&e.recent);return t&&r._urlDataSource.getDefaultClickUrl(t)||""})});r.altText=i.pureCompute(function(){return r._content().altText||""});r.subText=i.pureCompute(function(){return r._content().subText});r.subTextMobile=i.pureCompute(function(){return r._content().subTextMobile||r._content().subText});r.subTextPostIcon=i.pureCompute(function(){return r._content().subTextPostIcon});r.title=i.pureCompute(function(){return r._content().title});r.url=i.pureCompute(function(){return r._content().url});r.additionalContentCss=i.pureCompute(function(){return r._computeContentCss()});return r}t.prototype.navigateToRecentDocs=function(){this._recentDocsNavigationAction.execute(null);return!1};t.prototype.hasInsertPermission=function(){return!this.observables.unwrap(this._isViewOnly)};t.prototype.emptyFolderSubText=function(){return this._isOneDriveXboxApp?"":p.e.emptyFolderSubText};t.prototype.hasSmartFiltersApplied=function(){return!1};t.prototype.onComputeContent=function(){var e,t=this._item(),n=t.queryType,r=this.hasInsertPermission();switch(n){case v.e.Recent:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recent"+this._fluentV2String+".svg"),title:p.e.emptyRecentTitle,subText:p.e.emptyRecentSubText};break;case v.e.RecycleBin:case v.e.SecondStageRecycleBin:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_recyclebin"+this._fluentV2String+".svg"),title:p.e.emptyRecycleBinTitle,subText:p.e.emptyRecycleBinSubText};break;case v.e.Search:case v.e.SearchOdbScope:var s=void 0;s=this._currentPage===d.e.Photos?p.e.emptyPhotosSearchSubText:this.isDocLib?o.format(p.e.emptySearchSubText,'<a class="EmptyFolder-subTextPart2 EmptyFolder-subTextPart2Link" href="#" data-bind="click: navigateToRecentDocs">',"</a>"):p.e.emptyListSearchSubText;e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search"+this._fluentV2String+".svg"),title:p.e.emptySearchTitle,subText:s};break;case v.e.SharedWithMe:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared"+this._fluentV2String+".svg"),title:p.e.emptySharedTitle,subText:p.e.emptySharedSubText};break;case v.e.DocsInCommon:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_shared"+this._fluentV2String+".svg"),title:p.e.emptyDocsInCommonTitle,subText:p.e.emptyDocsInCommonSubText};break;case v.e.Subsites:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_sites.svg"),title:p.e.emptySubsitesTitle,subText:""};break;case v.e.Apps:e=this._getSearchContentOrDefault(p.e.emptyAppsTitle);break;case v.e.Popular:e=this._getSearchContentOrDefault(p.e.emptyPopularTitle);break;case v.e.ExternallyShared:e=this._getSearchContentOrDefault(p.e.emptyExternallySharedTitle);break;case v.e.AllMyPhotos:e=this._getEmptyPhotoFolderContent();break;default:var u=!1;this._itemParentHelper.getAncestorOrSelf(t,function(e){return"Music"===e.specialFolderCanonicalName})&&(u=!0);if(u){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_"+(this._useFluentIllustrations?"folder_v2":"music")+".svg"),title:p.e.emptyMusicFolderTitle,subText:r&&p.e.emptyMusicFolderSubText||"",subTextMobile:r&&o.format(p.e.emptyMusicFolderMobileSubText,w)||""};if(this._userInfoProvider){var a=this._userInfoProvider.getMarket();a=a&&a.toLowerCase()}break}if(this.hasSmartFiltersApplied()){e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_filter.svg"),title:p.e.emptyFilterResultTitle,subText:p.e.emptyFilterResultSubText,altText:p.e.emptyFilterResultAltText};break}if(t.vault&&t.vault.root){var f=this._computeIsPremium()?p.e.vaultEmptyFolderPremiumSubtext:p.e.M365VaultEmptyFolderNonPremiumSubtext;e={title:p.e.vaultEmptyFolderTitle,subText:f,url:""};break}if(this._item().isRootFolder&&!this.isDocLib)e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_list.svg"),title:p.e.emptyListTitle,subText:p.e.emptyListSubText,altText:p.e.emptyListDefaultAltText};else{var l=window.require.toUrl("odsp-media/images/emptyfolder/empty_"+(this._useFluentIllustrations?"documents":"folder")+".svg"),c=window.require.toUrl("odsp-media/images/emptyfolder/empty_folder"+this._fluentV2String+".svg");e={url:this._item().isRootFolder?l:c,title:this._item().isRootFolder?p.e.emptyLibraryTitle:p.e.emptyFolderTitle,subText:r&&this.emptyFolderSubText()||"",subTextMobile:r?o.format(p.e.emptyFolderMobileSubText,w):void 0}}}return Object(i.__assign)({altText:p.e.emptyFolderDefaultAltText},e)};t.prototype._computeContent=function(){return this.onComputeContent()};t.prototype._getSearchContentOrDefault=function(e){return this._viewParams().q?{url:window.require.toUrl("odsp-media/images/emptyfolder/empty_search"+this._fluentV2String+".svg"),title:p.e.emptySearchTitle,subText:""}:{title:e,url:"",subText:""}};t.prototype._getEmptyPhotoFolderContent=function(){var e,t=this._viewParams();switch(this._urlDataSource.getPhotoType(t)){case 5:case 1:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_album_albumsview.svg"),title:p.e.emptyAlbumsListTitle,subText:p.e.emptyAlbumsListSubText};break;case 2:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_tags.svg"),title:p.e.emptyPhotosTagsTitle,subText:o.format(p.e.emptyPhotosTagsSubTextFormat,'<a href="'+this._urlDataSource.getTaggingOptionsUrl()+'">',"</a>")};break;case 3:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_places.svg"),title:p.e.emptyAllPhotosTitle,subText:""};break;case 9:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_onthisday.svg"),title:p.e.emptyOnThisDayTitle,subText:""};break;default:e={url:window.require.toUrl("odsp-media/images/emptyfolder/empty_allphotosview.svg"),title:p.e.emptyAllPhotosTitle,subText:""}}return e};t.prototype._computeIsPremium=function(){return!(!this._storageOptionsProvider||!this._storageOptionsProvider.isReady())&&this._storageOptionsProvider.hasOffice.peek()};t.prototype._computeContentCss=function(){var e=this._item();return e.vault&&e.vault.root?"EmptyFolder-content-vault":""};t.dependencies=Object(i.__assign)(Object(i.__assign)({},u.t.dependencies),{actionMap:f.e,item:f.s,itemParentHelper:a.e,urlDataSource:l.we,userInfoProvider:c.L.optional,viewParams:f.H,storageOptionsProvider:c.S.optional});return t})(u.t),x=n(24);n.d(t,"e",function(){return T});var T=Object(x.e)({automationName:"ms-empty-folder",name:"EmptyFolder",template:'<div class="EmptyFolder" data-bind="class:additionalContentCss">\x3c!--ko if:url--\x3e<div class="EmptyFolder-image"><img id="emptyFolderImg" class="EmptyFolder-imageTag" data-bind="attr:{src:url,alt:altText}"></div>\x3c!--/ko--\x3e<div role="alert"><div class="EmptyFolder-title" data-bind="text:title"></div>\x3c!--ko if:subText||subTextMobile--\x3e<div class="EmptyFolder-subText"><span class="EmptyFolder-pc" data-bind="bindableHtml:subText"></span><span class="EmptyFolder-mobile" data-bind="bindableHtml:subTextMobile"></span></div>\x3c!--/ko--\x3e</div></div>',viewModelType:S})},"1344":function(e,t,n){"use strict";var r=n(147),i=n(264),s=(function(){function e(){}e.start=function(e){var t=new r.e(function(){for(var e=0,t=o;e<t.length;e++){t[e].cancel()}}),n=e.items.slice(),s=e.parallelRequests||1,o=[];function u(e){var t=o.indexOf(e);t>=0&&o.splice(1,t)}function a(){var r=new i.e,s=n.splice(0,e.batchSize),f=JSON.stringify(e.getPostData(s)),l=r.send({apiName:e.apiName,url:e.url,requestType:"POST",postData:f,isErrorExpectedCallback:e.isErrorExpectedCallback}).then(function(){u(l);e.onBatchComplete&&e.onBatchComplete(s);n.length?a():t.complete()},function(e){u(l);(function(e){t.error(e)})(e)});o.push(l)}for(var f=0;n.length>0&&f<s;f++)a();return t.getPromise()};return e})();t.e=s},"1366":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".xlg .BreadcrumbBar,.xxlg .BreadcrumbBar,.xxxlg .BreadcrumbBar,.xxxxlg .BreadcrumbBar{margin-top:7px}.isFluent.xlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.isFluent.xxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.isFluent.xxxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.isFluent.xxxxlg .BreadcrumbBar{margin-top:1px;position:relative;top:2px}.BreadcrumbBar-list{display:block;margin:0;padding:0;display:block;white-space:nowrap;overflow:hidden;font-size:0}[dir=ltr] .BreadcrumbBar-list{margin-left:-8px}[dir=rtl] .BreadcrumbBar-list{margin-right:-8px}.BreadcrumbBar-list li{list-style-type:none;vertical-align:top;margin:0;padding:0;display:inline-block}.isFluent .BreadcrumbBar-list li:last-child .BreadcrumbBar-item{font-weight:600}.lg .BreadcrumbBar-list,.md .BreadcrumbBar-list,.sm .BreadcrumbBar-list{margin-top:0}.BreadcrumbBar-overflow{font-size:16px;display:inline-block;color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";padding:8px 4px;cursor:pointer}.isFluent .BreadcrumbBar-overflow{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.lg .BreadcrumbBar-overflow{padding:9px 4px}.xlg .BreadcrumbBar-overflow,.xxlg .BreadcrumbBar-overflow,.xxxlg .BreadcrumbBar-overflow,.xxxxlg .BreadcrumbBar-overflow{font-size:18px;padding:8px 8px}.isFluent.xlg .BreadcrumbBar-overflow{padding:5px 8px}.isFluent.xxlg .BreadcrumbBar-overflow{padding:5px 8px}.isFluent.xxxlg .BreadcrumbBar-overflow{padding:5px 8px}.isFluent.xxxxlg .BreadcrumbBar-overflow{padding:5px 8px}.BreadcrumbBar-overflow:hover{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.BreadcrumbBar-navItem:hover,.BreadcrumbBar-overflow:hover{background:"},{theme:"neutralLighter",defaultValue:"#f3f2f1"},{rawString:"}.od-focus--enabled .BreadcrumbBar-navItem:focus,.od-focus--enabled .BreadcrumbBar-overflow:focus{box-shadow:0 0 0 2px "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:" inset}.BreadcrumbBar-navItem:active{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}a.BreadcrumbBar-item{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}.isFluent a.BreadcrumbBar-item{color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:"}.BreadcrumbBar-navItem{max-width:160px}.md .BreadcrumbBar-navItem,.sm .BreadcrumbBar-navItem{max-width:116px}.BreadcrumbBar-item{font-size:14px;font-weight:400;display:inline-block;text-decoration:none;padding:0 8px;height:28px;line-height:32px;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.lg .BreadcrumbBar-item{font-size:17px;font-weight:300}.xlg .BreadcrumbBar-item,.xxlg .BreadcrumbBar-item,.xxxlg .BreadcrumbBar-item,.xxxxlg .BreadcrumbBar-item{font-size:21px;font-weight:100;padding-bottom:1px;line-height:28px}.isFluent.sm .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.md .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.lg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xxxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.isFluent.xxxxlg .BreadcrumbBar-item{font-size:18px;font-weight:400;line-height:24px;height:24px}.sm .BreadcrumbBar-item{max-width:100px}.BreadcrumbBar-item.dropping{background:"},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:"}.BreadcrumbBar-item-chevron{font-size:10px;display:inline-block;font-family:FabricMDL2Icons;font-style:normal;font-weight:400;speak:none;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";vertical-align:top;padding:0 2px;margin-top:11px}.lg .BreadcrumbBar-item-chevron{margin-top:13px}.isFluent.lg .BreadcrumbBar-item-chevron{margin-top:10px}.xlg .BreadcrumbBar-item-chevron,.xxlg .BreadcrumbBar-item-chevron,.xxxlg .BreadcrumbBar-item-chevron,.xxxxlg .BreadcrumbBar-item-chevron{font-size:12px;margin-top:11px;padding:0 4px}.isFluent.xlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.isFluent.xxxxlg .BreadcrumbBar-item-chevron{margin-top:7px;font-size:12px}.BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76c'}html[dir=rtl] .BreadcrumbBar-item-chevron:after{font-family:FabricMDL2Icons;content:'\\e76b'}.od-ListItemFormRoot .BreadcrumbBar{margin-bottom:12px}.xlg .od-ListItemFormRoot .BreadcrumbBar,.xxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxlg .od-ListItemFormRoot .BreadcrumbBar,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar{margin-top:0}.od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.isFluent .od-ListItemFormRoot .BreadcrumbBar-item{height:32px}.lg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:21px;font-weight:100}.xlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxlg .od-ListItemFormRoot .BreadcrumbBar-item,.xxxxlg .od-ListItemFormRoot .BreadcrumbBar-item{font-size:28px;font-weight:100;line-height:1}"}]);var i=n(0),s=n(1),o=n(139),u=n(124),a=n(206),f=n(199),l=n(35),c=n(49),h=n(9),p=n(1024),d=n(41),v=n(17),m=n(75),g=n(6),y=n(1278),b=n(1837),w=n(36),E=(function(e){Object(i.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._currentDroppingCrumb=null;n.addBindingHandlers({dismiss:u.e,dragAndDrop:a.e,keyboard:m.e});var r=t.iconClass,i=void 0===r?new v.e("More").getClass():r,o=t.canShowTooltipOverflow,h=void 0!==o&&o;n._responsiveUI=n.resources.consume(c.n);n._navigation=n.resources.consume(d.e);n.overflowMenuAriaLabel=b.e.overflowAriaLabel;n.iconClass=i;n._item=t.item;n._maxFoldersVisibleLgUp=t.maxFoldersVisibleLgUp;n._maxFoldersVisibleMdDown=t.maxFoldersVisibleMdDown;n.isDroppable=s.observable(!0);n.isDroppingTarget=s.observable(!1);n.isOverflowOpen=s.observable(!1);n.overflowMenuOffset=s.observable(new l.e(-24,24));n.ariaLabelForBreadCrumbBar=s.observable("");n._openActionItem=s.observable(null);n.overflowCrumbs=s.observableArray();n.mouseOverTrigger=n.createObservable(!1);n._canShowTooltipOverflow=h;n._crumbs=t.crumbs;n._actionMap=n.resources.consume(g.e);n._openAction=new(n.managed(n._actionMap.OpenAction))({item:n._openActionItem,openRelation:2});n.overflowDismissParams={isOpen:n.isOverflowOpen,isAutomatic:n._canShowTooltipOverflow,timeout:100};n._dropHelper=n.resources.consume(f.e);n.crumbs=n.createComputed(function(){return n._computeCrumbs(t.getCrumbs)});return n}t.prototype.dispose=function(){e.prototype.dispose.call(this);this.crumbs.dispose()};t.prototype.onOverflowMouseover=function(e,t){this._canShowTooltipOverflow&&this.isOverflowOpen(!0)};t.prototype.onMayReceiveDrop=function(e,t){var n=t?s.dataFor(t):null;if(n&&n.item&&n.showNextChevron){this.onRemoveDropLocation();this._currentDroppingCrumb=n;this._currentDroppingCrumb.isDroppingTarget(!0);return{targetName:n.item.name}}this.onRemoveDropLocation();return null};t.prototype.onReceiveDrop=function(e,t){var n=t?s.dataFor(t):null,r=this._dropHelper.processDrop(e,n.item);r&&this.onRemoveDropLocation();return r};t.prototype.onRemoveDropLocation=function(){this._currentDroppingCrumb&&this._currentDroppingCrumb.isDroppingTarget(!1)};t.prototype.onEnter=function(e,t){t.stopPropagation()};t.prototype.onClick=function(e,t){if(e.onClick)e.onClick(e,t);else if(e.isOverflow)this._canShowTooltipOverflow?this.isOverflowOpen.peek()||this.isOverflowOpen(!0):this.isOverflowOpen(!this.isOverflowOpen());else if(e.item&&!e.isFiltered){this._openActionItem(e.item);this._openAction.execute(t)}else{this._navigation.navigateTo(e.url)}e&&this.ariaLabelForBreadCrumbBar(w.format(b.e.breadCrumbNavigation,e.ariaLabel?e.ariaLabel:e.name))};t.prototype._computeCrumbs=function(e){this.isOverflowOpen(!1);var t,n=[],r=[],i=this._responsiveUI;t=i.compareSize(i.formFactorSize(),"Medium")<=0?void 0===this._maxFoldersVisibleMdDown?2:this._maxFoldersVisibleMdDown:void 0===this._maxFoldersVisibleLgUp?4:this._maxFoldersVisibleLgUp;var s=this._item(),o=[];this._crumbs?o=this._crumbs():s&&s.key&&(e?o=e(s):s.parent&&(o=this._getCrumbsForNonRoots(s)));for(var u=0;u<o.length;u++)n.length<t?n.unshift(o[u]):r.unshift(this._commandForCrumb(o[u]));r.length&&n.unshift({key:"overflow",url:null,name:"",showNextChevron:!1,isDroppingTarget:null,item:null,isOverflow:!0,isNavItem:!1,isStaticItem:!1,ariaLabel:""});this.overflowCrumbs().forEach(function(e){e.dispose()});this.overflowCrumbs(r);n&&n.length>0?n[n.length-1].ariaLabel?this.ariaLabelForBreadCrumbBar(w.format(b.e.breadCrumbNavigation,n[n.length-1].ariaLabel)):this.ariaLabelForBreadCrumbBar(w.format(b.e.breadCrumbNavigation,s&&s.key?s.name:n[n.length-1].name)):s&&s.key&&this.ariaLabelForBreadCrumbBar(w.format(b.e.breadCrumbNavigation,s.name));return n};t.prototype._getCrumbsForNonRoots=function(e){for(var t=[],n=!1,r=this._getAriaLabelsForBreadCrumbs(e);e;){var i=new(this.resources.injected(this._actionMap.OpenAction))({item:this.createObservable(e),openRelation:2}),o=i.isAvailable.peek();i.dispose();var u=n,a=!n;if(!o){u=!1;a=!0}if(e.isStub){u=!1;a=!0}var f={key:e.key,url:"#"+e.key,name:e.name||y.e.Files,showNextChevron:n,isDroppingTarget:s.observable(!1),item:e,isOverflow:!1,isNavItem:u,isStaticItem:a,ariaLabel:r.pop()};t.push(f);n=!0;e=e.parent}return t};t.prototype._getAriaLabelsForBreadCrumbs=function(e){for(var t=[],n=void 0;e;){if(n){n=w.format(b.e.breadCrumbItem,n,e.name||y.e.Files);t.push(n)}else{n=e.name||y.e.Files;e.parent&&t.push(e.parent.name)}e=e.parent}return t};t.prototype._commandForCrumb=function(e){var t=this;return new(this.managed(o.e))({text:e.name,action:new(this.managed(p.e))({url:e.url}),callback:function(){e.isNavItem&&t.onClick(e,null)}})};return t})(h.t),S=n(16).e({tagName:"ms-breadcrumb-bar",template:'<nav class="BreadcrumbBar" data-bind="attr:{\'aria-label\':ariaLabelForBreadCrumbBar}"><ul class="BreadcrumbBar-list" data-bind="foreach:crumbs,dragAndDrop:{mayReceiveDrop:onMayReceiveDrop,isDragging:isDroppingTarget,receiveDrop:onReceiveDrop}"><li>\x3c!--ko if:isOverflow--\x3e<a class="BreadcrumbBar-overflow noContextMenu beak-anchor ms-Icon" href="javascript:;" aria-haspopup="true" data-bind="click:$component.onClick.bind($component),dismiss:$component.overflowDismissParams,attr:{\'aria-expanded\':$component.isOverflowOpen(),\'aria-label\':$component.overflowMenuAriaLabel},keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},class:$component.iconClass,event:{mouseover:$component.onOverflowMouseover.bind($parent)}">\x3c!--ko if:$parent.isOverflowOpen()--\x3e<ms-contextual-menu params="items: $component.overflowCrumbs, isOpen: $component.isOverflowOpen, offset: $component.overflowMenuOffset, mouseOverTrigger: $component.mouseOverTrigger, target: $element.parentElement"></ms-contextual-menu>\x3c!--/ko--\x3e</a>\x3c!--/ko--\x3e\x3c!--ko if:isNavItem--\x3e<a class="BreadcrumbBar-item BreadcrumbBar-navItem noContextMenu" data-bind="text:name,click:$component.onClick.bind($component),keyboard:{mappings:{Enter:$component.onEnter.bind($component)}},attr:{href:url,title:name},css:{dropping:isDroppingTarget}"></a>\x3c!--/ko--\x3e\x3c!--ko if:isStaticItem--\x3e<span class="BreadcrumbBar-item" data-bind="text:name,attr:{title:name}"></span>\x3c!--/ko--\x3e\x3c!--ko if:showNextChevron--\x3e<i class="BreadcrumbBar-item-chevron" role="presentation"></i>\x3c!--/ko--\x3e</li></ul></nav>',viewModel:E,synchronous:!0});t.e=S},"1380":function(e,t,n){"use strict";n.r(t);n.d(t,"resourceKey",function(){return S});var r=n(0),i=n(7),s=n(15),o=n(25),u=n(138),a=n(83),f=n(31),l=n(30),c=n(129),h=n(85),p=n(338),d=n(405),v=n(240),m=n(114),g=n(5),y=n(1181),b=n(941),w=n(80),E=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r._albumDataSource=n.albumDataSource;r._operationProvider=n.operationProvider;r._itemProvider=n.itemProvider;r._urlDataSource=n.urlDataSource;r._tagProvider=n.tagProvider;r._isSingleAlbumItemsScopeEnabled=r.resources.consume(w.a);return r}t.prototype.addToAlbum=function(e){for(var t=this,n=new c.e,r=this.observables.createArray(e.items).map(function(r){var i=t._operationProvider.register({name:r.name,type:h.e.addItemsToAlbum,payloads:{addItemsToAlbum:{item:r,album:e.album}},iconName:r.iconName,batch:n});i.progress.maximum(1);i.progress.current(0);return i}),i=0,s=r();i<s.length;i++){s[i].state(l.e.started)}return this._albumDataSource.addToAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){if(!t._isSingleAlbumItemsScopeEnabled){t._itemProvider.invalidateItem(e.album.key);t._itemProvider.invalidateItem(t.getAlbumsParentKey())}for(var i=0,s=r();i<s.length;i++){var o=s[i];o.progress.current(1);o.state(l.e.completed)}return n},function(e){for(var t=0,n=r();t<n.length;t++){n[t].state(l.e.failed)}return o.n.wrapError(e)})};t.prototype.createAlbum=function(e,t){var n=this,r=[new p.e("createAlbum="+e.name,e.name)],i=e.keys;return this._albumDataSource.createAlbum(e.name,i).then(function(e){return n._getNewlyCreatedAlbum(e.id)}).then(function(e){r=e?r.map(function(t){return t.succeed(e)}):r.map(function(e){return e.fail(m.e.DefaultTitle)});t.update(r)},function(e){r=r.map(function(t){return t.fail(e.error)});t.update(r);return o.n.wrapError(e)})};t.prototype.getWalgreensLandingPageUrl=function(e){for(var t=[],n=0;n<e.length;n++)e[n].photo&&!e[n].video&&t.push(e[n].id);return this._albumDataSource.getWalgreensLandingPageUrl(t)};t.prototype.removeFromAlbum=function(e){var t=this;return this._albumDataSource.removeFromAlbum(e.album,e.items.map(function(e){return e.id})).then(function(n){t._itemProvider.invalidateItem(t.getAlbumsParentKey());t._itemProvider.invalidateItem(e.album.key);return n},function(e){return o.n.wrapError(e)})};t.prototype.createAlbumFromFolder=function(e,n){for(var r=this,i=[new p.e("createAlbumFromFolder="+e.folder.id,e.folder.name)],s=0,u=i;s<u.length;s++){u[s].status=0}n.update(i);return this._albumDataSource.createAlbumFromFolder(e).then(function(e){return r._getNewlyCreatedAlbum(e.id)}).then(function(e){if(!e){var s=m.e.DefaultTitle;i=i.map(function(e){return e.fail(s)});n.update(i);return o.n.wrapError(s)}var u=null,a=function(){var s={type:d.e.albumFolderExtraction};u&&(s.workItemIds=u);r._itemProvider.getWorkProgress(s).done(function(s){var o;s.progress&&s.progress.length&&(o=s.progress[0]);if(o&&o.status!==v.e[v.e.Completed]){u||(u=[o.id]);r.async.setTimeout(a,t.ASYNC_DELAY)}else{i=i.map(function(t){return t.succeed(e)});n.update(i)}},function(e){i=i.map(function(e){return e.fail(m.e.DefaultTitle)});n.update(i)})};r.async.setTimeout(a,t.ASYNC_DELAY)},function(e){var t=m.e.DefaultTitle,r=new Error(t);i=i.map(function(e){return e.fail(r)});n.update(i);return o.n.wrapError(r)})};t.prototype.getAlbumsParentKey=function(e){void 0===e&&(e={});return this._albumDataSource.getAlbumsParentKey(e)};t.prototype.setCoverPhoto=function(e,t){var n=this,r=this.getAlbumsParentKey(),i=[new p.e(r+"&scp="+e.album.name,e.album.name)];return this._albumDataSource.setCoverPhoto(e.album,e.items[0]).then(function(s){n._itemProvider.invalidateItem(r);n._itemProvider.invalidateItem(e.album.key);i=i.map(function(e){return e.succeed(s.id)});t.update(i)},function(e){var n=new Error(e);i=i.map(function(e){return e.fail(n)});t.update(i);return o.n.wrapError(n)})};t.prototype.saveAutoAlbum=function(e,t,n){var r=this,i=e.album,s=i.properties.newTag,u=new p.e(i.key,i);if(!b.s(i)){u=u.fail();n.update([u]);return o.n.wrap(void 0)}n.update([u]);return this._tagProvider.updateTags({items:[i],tagsToDelete:[s],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){u=u.succeed();n.update([u]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:y.n}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(i.key)},function(e){var t=new Error(e);u=u.fail();n.update([u]);return o.n.wrapError(t)})};t.prototype.markAutoAlbumAsSeen=function(e,t){var n=e.properties.newTag,r=e.properties.autoAlbumTag;return n&&r?this._tagProvider.updateTags({items:[e],tagsToDelete:[n],tagsToAdd:null,rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(e){return e&&!e.error},function(e){return!1}):o.n.wrap(!1)};t.prototype.convertToAutoAlbum=function(e,t,n){var r=this,i=e.properties.newTag,s=e.properties.autoAlbumTag,u=new p.e(e.key,e);if(i){u=u.fail();n.update([u]);return o.n.wrap(void 0)}i={localizedTag:"__New",source:"SystemDefined",tag:"__New",type:"Keyword"};s||(s={localizedTag:"__Auto",source:"SystemDefined",tag:"__Auto",type:"Keyword"});return this._tagProvider.updateTags({items:[e],tagsToDelete:null,tagsToAdd:[s,i],rootItemId:this.getAlbumsParentKey(),skipInvalidate:t}).then(function(t){u=u.succeed();n.update([u]);r._itemProvider.invalidateItem(r.getAlbumsParentKey({tagFilter:y.n}));r._itemProvider.invalidateItem(r.getAlbumsParentKey());r._itemProvider.invalidateItem(e.key)},function(e){var t=new Error(e);u=u.fail();n.update([u]);return o.n.wrapError(t)})};t.prototype._getNewlyCreatedAlbum=function(e){var t=this.getAlbumsParentKey();this._itemProvider.invalidateItem(t);var n={parentKey:t,ownerId:this._urlDataSource.getOwnerId(t),pageSize:10,startIndex:0,isAscending:!1,skipCache:!0};return this._itemProvider.getItem(n).then(function(t){for(var n=t.content.peek().items,r=n.length,i=0;i<r;i++){var s=n[i].peek();if(s.id===e)return s}})};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{operationProvider:u.e,itemProvider:a.resourceKey,albumDataSource:s.e,urlDataSource:s.we,tagProvider:f.T});t.ASYNC_DELAY=5e3;t.ASYNC_RETRY_LIMIT=5;t.ASYNC_RETRY_DELAY=15e3;return t})(i.n);t.default=E;var S=Object(g.s)("AlbumProvider",E)},"1421":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(5),s=new r.t({name:"InfoPane.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("123")]).then(n.bind(null,1799)).then(function(e){return e.resourceKey.local})})})},"1470":function(e,t,n){"use strict";n.d(t,"t",function(){return d});var r=n(0),i=n(7),s=n(26),o=n(43),u=n(23),a=n(25),f=n(159),l=n(3),c=n(5),h=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r._pageLayoutType=n.pageLayoutType;r.layoutType=r._getLayoutType();r._debouncer=r.scope.attach(new f.e);return r}t.prototype._getLayoutType=function(){var e=this,t=this.observables,n=t.create("");t.backgroundCompute(function(){var t=e._pageLayoutType(),r=o.a[t];e._debouncer.debounce(r?r().then(function(e){return e.tagName}):a.n.wrap("")).then(function(e){n(e)})});return n};t.dependencies=Object(r.__assign)(Object(r.__assign)({},i.n.dependencies),{pageLayoutType:u.o.layoutType});return t})(i.n),p=new l.t({name:"ToggleListLayoutHelper.layoutTypeResolver",factory:new c.n(h)}),d=new l.t({name:"ToggleListLayoutHelper.resolvedLayoutType",factory:{dependencies:{layoutTypeResolver:p},create:function(e){return{instance:e.layoutTypeResolver.layoutType}}}}),v=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.pageLayoutType=n.resources.consume(u.o.layoutType);return n}t.prototype.changeLayout=function(e){var t=this;return(0,o.a[e])().then(function(n){t.pageLayoutType(n.tagName);return a.n.resolve({resultType:s.e.Success,extraData:{layout:e}})})};return t})(i.n);t.e=v},"1508":function(e,t,n){"use strict";n.d(t,"e",function(){return s});var r=n(3),i=n(5),s=new r.t({name:"LegacyDetailsPaneHost.key",loader:new i.t(function(){return Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("112")]).then(n.bind(null,1883)).then(function(e){return e.resourceKey.local})})})},"1509":function(e,t,n){"use strict";n.d(t,"e",function(){return m});n.d(t,"t",function(){return g});n.d(t,"s",function(){return b});n.d(t,"i",function(){return w});n.d(t,"n",function(){return E});n.d(t,"r",function(){return S});var r=n(1),i=n(22),s=n(36),o=n(192),u=n(155),a=n(47),f=n(1223),l=n(10),c=n(1181),h=n(2040),p={"pokmon":!0},d={animal:!0,building:!0,dog:!0,drink:!0,fire:!0,fireworks:!0,food:!0,outdoor:!0,people:!0,pizza:!0,screenshot:!0,selfie:!0,sky:!0,text:!0,whiteboard:!0},v=[c.n,c.e,c.r,c.t],m=String.fromCharCode(9),g="%09",y=0;function b(e,t,n,i,o){var u=e.length,a=0,l=[];if(1!==t){for(var c=0,m=e;c<m.length;c++){C=m[c];if(p[C.tag.toLowerCase()]||a<11&&d[C.tag.toLowerCase()]&&-1===v.indexOf(C.tag)){n.push(r.observable(E(f.e.allTags,C,null,o)));a++}}if(a>0){var g={groupingId:"tagHeader",startIndex:0,count:a,tagHeader:{title:h.e.topTagsTitleText,countSubtitle:""}};l.push(g)}e.sort(function(e,t){var n=e.localizedTag||e.tag,r=t.localizedTag||t.tag;return n.localeCompare(r)});for(var y=0,b=e;y<b.length;y++){C=b[y];-1===v.indexOf(C.tag)?n.push(r.observable(E(f.e.allTags,C,null,o))):u--}if(u>0){var w=s.pluralSelect(u,h.e.numberTagsSingularSubtitleText,s.format(h.e.numberTagsPluralSubtitleText,u)),S={groupingId:"tagHeader",startIndex:a,count:u,tagHeader:{title:h.e.allTagsTitleText,countSubtitle:w}};l.push(S)}var x={name:"tagGrouping",itemGroups:l};i.push(x)}else for(var T=0,N=e;T<N.length;T++){var C=N[T];-1===v.indexOf(C.tag)&&n.push(r.observable(E(f.e.allTags,C,null,o)))}}function w(e,t,n,i,s,o){for(var u={},a=0,l=t;a<l.length;a++){var c=l[a];u[c.hierarchyIndex]=!0}e=e.filter(function(e){return u[e]});for(var p=[],d=[],v={name:h.e.otherRegionsTitleText,places:[],totalPlaces:0},m=0,g=t;m<g.length;m++){var y=g[m],b=y.country;if(""===b){v.places.push(y);v.totalPlaces++}else if(d.indexOf(b)<0){p.push(x(b,y));d.push(b)}else T(b,y,p)}p.sort(function(e,t){return t.totalPlaces-e.totalPlaces});v.totalPlaces>0&&p.push(v);for(var w={},S=e.length,L=[],A=S,O=0,M=p;O<M.length;O++){var _=M[O],D=_.places;N(D);D.sort(function(e,t){return e.displayString.localeCompare(t.displayString)});for(var P=D.length,H=void 0,B=0,j=D;B<j.length;B++){var F=j[B];H=E(f.e.allPlaces,null,F,s);n.push(r.observable(H));e.indexOf(F.hierarchyIndex)>-1&&(w[F.hierarchyIndex]=k(H))}L.push(C(A,P,_.name,o(_.name)));A+=P}var I=t.length;if(S>0&&I>=S){for(var q=S-1;q>-1;q--)n.unshift(r.observable(w[e[q]]));var R={groupingId:"tagHeader",startIndex:0,count:S,tagHeader:{title:h.e.recentPlacesTitleText,countSubtitle:""}};L.unshift(R)}var U={name:"tagGrouping",itemGroups:L};i.push(U)}function E(e,t,n,r){var i,s=((i={}).qt="allmyphotos",i.v="photos",i.id=r.rootItemId,i);switch(e){case f.e.allTags:var c=void 0;c=t.localizedTag&&t.localizedTag!==t.tag?t.localizedTag+";"+t.tag:t.tag;s.tagFilter=c;break;case f.e.allPlaces:s.locationFilter=n.hierarchyIndex}s.u=""+y++;var h=u.t.getKey(s),p=new o.e(h);p.type=a.e.Folder;p.queryType=l.e.AllMyPhotos;var d={tagType:e};p.tagInfo=d;p.folder={photoCount:0,covers:[]};switch(e){case f.e.allTags:p.name="#"+(t.localizedTag||t.tag);p.id=t.tag;p.folder.childCount=t.count;p.childCount=t.count;break;case f.e.allPlaces:p.name=n.displayString;p.id=n.hierarchyIndex;p.folder.childCount=n.count;p.childCount=n.count;break;default:return null}p.properties.commandsSupported={defc:"1"};p.isDraggable=!1;return p}function S(e){var t="";e.city&&(t+=e.city+", ");e.state&&(t+=e.state+", ");return 0===t.length?e.country||"":t.slice(0,-2)}function x(e,t){var n=[];n.push(t);return{name:e,places:n,totalPlaces:1}}function T(e,t,n){for(var r,i=n.length,s=0;s<i;s++)if(e===(r=n[s]).name){r.places.push(t);r.totalPlaces++;break}}function N(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];r.displayString=S(r)}}function C(e,t,n,r){return{groupingId:"tagHeader",startIndex:e,count:t,tagHeader:{title:n,countSubtitle:s.pluralSelect(t,h.e.numberPlacesSingularSubtitleText,s.format(h.e.numberPlacesPluralSubtitleText,t)),regionUrl:r}}}function k(e){var t=i.e(e.key);t.u=y++;var n=u.t.getKey(t),r=new o.e(n);r.type=e.type;r.queryType=e.queryType;var s={tagType:e.tagInfo.tagType};r.tagInfo=s;r.name=e.name;r.id=e.id;var a={photoCount:0,childCount:e.folder.childCount,covers:e.folder.covers.slice()};r.folder=a;r.properties.commandsSupported={defc:"1"};r.isDraggable=!1;return r}},"1539":function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(9),s=n(24),o=n(4),u=n(160),a=n(1508),f=n(1421),l=n(266),c=n(7),h=n(423),p=n(238),d=n(1916),v=(function(e){Object(r.__extends)(t,e);function t(t,n){void 0===t&&(t={});var r=e.call(this,t,n)||this;r.infoPaneRegionLabel="";r.transclusionContentTagName=p.e.tagName;r.addBindingHandlers({control:s.t});r.isInfoPaneExpanded=n.isInfoPaneExpanded;r.infoPaneTransclusionContentParams={provider:n.infoPaneTransclusionProvider};r.infoPaneRegionLabel=d.e.infoPaneRegionLabel;r.infoPaneRole=r.observables.create("complementary");r.infoPaneControlParams={specification:Object(s.n)(Object(o.isFeatureEnabled)(o.EnableNewDetailsPane)?a.e:f.e,{}),placeholder:Object(s.n)(l.t,{})};return r}t.dependencies=Object(r.__assign)(Object(r.__assign)({},c.n.dependencies),{infoPaneTransclusionProvider:h.e,isInfoPaneExpanded:u.e});return t})(i.t);n.d(t,"resourceKey",function(){return m});var m=Object(s.e)({name:"DetailsPaneTransclusionContent",template:"\x3c!--ko if:isInfoPaneExpanded()--\x3e\x3c!--ko component:{name:transclusionContentTagName,params:infoPaneTransclusionContentParams}--\x3e<div data-bind=\"control:infoPaneControlParams,attr:{'aria-label':infoPaneRegionLabel,role:infoPaneRole}\"></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e",automationName:"ms-details-pane-transclusion-component",viewModelType:v});t.default=m},"1557":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r=new(n(3).t)("rootItems")},"1713":function(e,t,n){"use strict";var r=n(11);Object(r.n)([{rawString:".md .od-allPhotosMonthHeader,.sm .od-allPhotosMonthHeader{height:64px;line-height:64px}.lg .od-allPhotosMonthHeader,.xlg .od-allPhotosMonthHeader,.xxlg .od-allPhotosMonthHeader,.xxxlg .od-allPhotosMonthHeader,.xxxxlg .od-allPhotosMonthHeader{height:80px;line-height:80px}.od-allPhotosMonthHeader-text{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;display:inline-block;font-size:21px;font-weight:100}[dir=ltr] .od-allPhotosMonthHeader-text{margin-right:15px}[dir=rtl] .od-allPhotosMonthHeader-text{margin-left:15px}.xlg .od-allPhotosMonthHeader-text,.xxlg .od-allPhotosMonthHeader-text,.xxxlg .od-allPhotosMonthHeader-text,.xxxxlg .od-allPhotosMonthHeader-text{font-size:28px;font-weight:100}"}]);var i=n(16),s=n(0),o=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.headerText=t.headerText;return n}return t})(n(9).t),u=i.e({tagName:"od-all-photos-month-header",template:'<div class="od-allPhotosMonthHeader"><div class="od-allPhotosMonthHeader-text" role="heading" aria-level="2" data-bind="text:headerText"></div></div>',viewModel:o,synchronous:!0});t.e=u},"2148":function(e,t,n){"use strict";n.r(t);n(1228),n(429),n(430),n(438);var r=n(0),i=n(9),s=n(6),o=n(23),u=n(1336),a=n(24),f=n(1366),l=n(11);Object(l.n)([{rawString:".lg .od-ItemContent-metadata,.md .od-ItemContent-metadata,.sm .od-ItemContent-metadata{font-size:14px}.xlg .od-ItemContent-metadata,.xxlg .od-ItemContent-metadata,.xxxlg .od-ItemContent-metadata,.xxxxlg .od-ItemContent-metadata{font-size:16px}.od-ItemContent-metadata-button{cursor:pointer;border-width:0;background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";padding-left:0;padding-right:0}.od-ItemContent-metadata-button i{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:"}"}]);var c=n(258),h=n(2194),p=n(36),d=n(382),v=n(75),m=(function(e){Object(r.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({tooltip:d.e,keyboard:v.e});n.item=t.item;n._actionMap=n.resources.consume(s.e);n._showPermissionsAction=new(n.managed(n._actionMap.ShowPermissionsAction))({item:n.item,engagementSource:"GlyphClick"});n.sharedTooltip=h.e.folderIsShared;n.sharedWithSomeIcon=h.e.sharedWithSomeIcon;n.sharedAriaLabel=n._getSharedGlyphAriaLabel();return n}t.prototype.onSharedIconClick=function(e,t){c.e.logData({name:"folderSharedIndicatorClicked"});this._showPermissionsAction.execute(t).done()};t.prototype._getSharedGlyphAriaLabel=function(){return p.format(h.e.ariabelForSharedGlyph,this.item().name)};return t})(i.t),g=n(16).e({tagName:"folder-shared-indicator",template:'<button class="od-ItemContent-metadata od-ItemContent-metadata-button" data-bind="attr:{\'aria-label\':sharedAriaLabel},tooltip:{content:sharedTooltip},click:onSharedIconClick"><i class="ms-Icon ms-Icon--People" data-bind="icon:true,attr:{alt:sharedWithSomeIcon}"></i></button>',viewModel:m,synchronous:!0}),y=n(395),b=n(127),w=n(15),E=n(31),S=n(347),x=n(1470),T=n(4),N=n(1539),C=n(171),k=n(2195),L=n(10),A=n(191),O=n(1038),M=Object(O.e)(function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("190")]).then(n.bind(null,3192))];case 1:return[2,e.sent().default]}})})}),_=(function(e){Object(r.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:a.t,react:A.t});r._urlDataSource=r.resources.consume(w.we);r.breadcrumbBarTagName=f.e.tagName;r.emptyFolderControl=Object(a.n)(u.e,{isViewOnly:r.createPureComputed(r._computeIsViewOnly,{deferEvaluation:!0})});r.isQuotaBarVisible=r.createObservable(!1);var i=r.resources.consume(s.e);r._uploadAction=new(r.managed(i.UploadAction))({uploadProcessorType:b.e.Html5file});r.sharedIndicatorTagName=g.tagName;r.isShowSharedIndicator=r.createPureComputed(r._computeIsShowSharedIndicator);r.isSendTagsFeedbackVisible=r.createPureComputed(r._computeSendTagsFeedback);r._itemSetMonitor=r.resources.consume(y.e);r.footerItem=t.footerItem;r.itemSet=r._itemSetMonitor.itemSet;r.itemSetSelectionModel=r.resources.consume(s.C);r.contentRange=r.resources.consume(o.t);r.layoutType=r.resources.consume(x.t);r.isFluentEnabled=r.resources.consume(C.e);r.listViewContextMenuHelper=r.resources.isExposed(o.u)?r.resources.consume(o.u):void 0;r.title=r._itemSetMonitor.name;r.showBreadcrumb=r._itemSetMonitor.hasParent;r.showEmpty=r._itemSetMonitor.isEmpty;r.showList=r.observables.pureCompute(r._computeShowList);r.item=r._itemSetMonitor.item;r.storageSummaryString=k.e.storageSummaryString;r.totalUsedString=k.e.totalUsedString;r.showTitle=r.createPureComputed(r._computeShowTitle,{deferEvaluation:!0});var l=r.resources.consume(E.e);r.createComputed(function(){var e=l&&l.getBundleInfo(2);e&&e.isLoaded()&&(r.itemSet()&&r._urlDataSource.isSearchPassThrough()?r.isQuotaBarVisible(!0):r.isQuotaBarVisible(!1))});r.detailsPaneSpecification=Object(a.n)(N.resourceKey,{});r.imageTagFeedbackControlParams={componentType:M,props:{isResultsOptions:!0,isTagsPivot:!1,isDetailsPane:!1}};return r}t.prototype._computeShowList=function(){return!!this.layoutType()&&this._itemSetMonitor.hasItems()};t.prototype._computeShowTitle=function(){return this._itemSetMonitor.hasName()&&!this._itemSetMonitor.hasParent()};t.prototype._computeIsViewOnly=function(){return!this._uploadAction.isAvailable()};t.prototype._computeSendTagsFeedback=function(){return Object(T.isFeatureEnabled)(T.EnableTagsInODC)&&this.item().queryType===L.e.Search};t.prototype._computeIsShowSharedIndicator=function(){if(Object(T.isFeatureEnabled)(T.EnableFolderShareAccessHint)){var e=this.item().sharingType;return e===S.e.Shared||e===S.e.Public||e===S.e.PublicUnlisted}return!1};return t})(i.t);n.d(t,"resourceKey",function(){return D});var D=Object(a.e)({name:"FolderItemContent",automationName:"od-folder-item-content",template:'<div class="od-FolderItemContent od-ItemContent">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-FolderItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<h1 class="od-FolderItemContent-title od-ItemContent-title" data-bind="text:title"></h1>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-FolderItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:isShowSharedIndicator--\x3e<div class="od-ItemContent-header-sharedIndicator" data-bind="component:{name:sharedIndicatorTagName,params:{item:item}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:isSendTagsFeedbackVisible--\x3e<div class="od-FolderItemContent-tagsFeedback od-ItemContent-tagsFeedback" data-bind="react:imageTagFeedbackControlParams"></div>\x3c!--/ko--\x3e\x3c!--ko if:isQuotaBarVisible--\x3e\x3c!--ko if:isFluentEnabled--\x3e<div class="StorageInfo-sectionHeading" data-bind="text:storageSummaryString"></div>\x3c!--/ko--\x3e<div class="od-ItemContent-progress-container"><div class="StorageInfo-totalUsed" data-bind="text:totalUsedString,style:{display:isFluentEnabled?\'block\':\'none\'}"></div><div class="od-ItemContent-progress" data-bind="component:{name:\'od-quota-progress-bar\'}"></div></div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-FolderItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:{itemSet:itemSet,selectionModel:itemSetSelectionModel,requiredRange:contentRange,enableMarqueeSelection:true,contextMenuHelper:listViewContextMenuHelper,footerItem:footerItem}}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-FolderItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e</div>\x3c!--ko control:detailsPaneSpecification--\x3e\x3c!--/ko--\x3e',viewModelType:_})},"2149":function(e,t,n){"use strict";n.r(t);var r=n(11);Object(r.n)([{rawString:".SmartBannerV2{background-color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";min-height:80px;overflow:hidden;cursor:pointer;border-bottom:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";position:fixed;z-index:298;bottom:0;left:0;right:0;padding:10px;box-shadow:-7px 0 10px rgba(0,0,0,.22)}.SmartBannerV2 .SmartBanner-close{position:absolute;top:0;width:40px;text-align:center;line-height:40px;cursor:pointer;border:none;background-color:transparent;font-size:20px}[dir=ltr] .SmartBannerV2 .SmartBanner-close{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-close{left:0}.lg .SmartBannerV2 .SmartBanner-close,.xlg .SmartBannerV2 .SmartBanner-close,.xxlg .SmartBannerV2 .SmartBanner-close,.xxxlg .SmartBannerV2 .SmartBanner-close,.xxxxlg .SmartBannerV2 .SmartBanner-close{top:-5px;font-size:16px}[dir=ltr] .SmartBannerV2 .SmartBanner-content{right:0}[dir=rtl] .SmartBannerV2 .SmartBanner-content{left:0}.lg .SmartBannerV2 .SmartBanner-content,.xlg .SmartBannerV2 .SmartBanner-content,.xxlg .SmartBannerV2 .SmartBanner-content,.xxxlg .SmartBannerV2 .SmartBanner-content,.xxxxlg .SmartBannerV2 .SmartBanner-content{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button{padding-top:17px}.md .SmartBannerV2 .SmartBanner-content .SmartBanner-button,.sm .SmartBannerV2 .SmartBanner-content .SmartBanner-button{clear:both;padding-top:12px}.SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:right}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-button .od-Button{float:left}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon{background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";border-radius:5px;height:40px;width:40px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{float:right}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon.SmartBanner-useSquareIcon{border-radius:0}.SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:28px;color:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";margin:6px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon .ms-Icon{font-size:42px;margin:10px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-icon{height:64px;width:64px}[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-left:10px}[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-right:10px}html[dir=ltr] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:left}html[dir=rtl] .SmartBannerV2 .SmartBanner-content .SmartBanner-text{float:right}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text{margin-top:10px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:14px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-lead{font-size:17px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text.SmartBanner-noTagline .SmartBanner-lead{margin-top:7px}.SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:12px;height:15px}.lg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline,.xxxxlg .SmartBannerV2 .SmartBanner-content .SmartBanner-text .SmartBanner-tagline{font-size:14px}"}]);var i,s=n(0),o=n(1),u=n(258),a=n(124),f=n(9),l=n(105),c=n(42),h=n(15),p=n(2185),d=n(36);(function(e){e[e.SmartBannerV2_Close=0]="SmartBannerV2_Close";e[e.SmartBannerV2_Click=1]="SmartBannerV2_Click"})(i||(i={}));var v=i,m=n(13),g=n(10),y=(function(){function e(){}e.init=function(t,n,r,i,s){var a,f,l=o.utils.unwrapObservable(n());if(l){a=l.logClickContext.contextKey;v[a]&&o.utils.registerEventHandler(t,e.BINDING_ACTION,function(){f=d.format(e.ENGAGEMENT_NAME_FORMAT,m.e[l.logClickContext.pageType],g.e[l.logClickContext.queryType],v[a]);u.e.logData({name:f.toLowerCase(),extraData:{action:e.BINDING_ACTION}})});if(l.click){return o.bindingHandlers.click.init(t,function(){return l.click},r,i,s)}}};e.ENGAGEMENT_NAME_FORMAT="{0}_{1}_{2}";e.BINDING_ACTION="click";return e})(),b=n(41),w=n(34),E=(function(e){Object(s.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n.addBindingHandlers({dismiss:a.e});n._platformDetection=n.resources.consume(w.e);n._navigation=n.resources.consume(b.e);var r=n._navigation.viewParams;n._isTestHookEnabled=!!r.mobileupsell;n.buttonText=p.e.SmartBannerV2ButtonUseText;n.taglineText=p.e.SmartBannerV2TaglineText;n.leadText=p.e.SmartBannerV2LeadText;n.useSquareIcon=!1;if(n._platformDetection.isWinPhone){n.hideTagline=!0;n.taglineText="";n.leadText=p.e.SmartBannerV2LeadTextWP;n.useSquareIcon=!0}else if(n._platformDetection.isAndroid)n.hideTagline=!1;else{n.buttonText=p.e.SmartBannerV2ButtonText;n.hideTagline=!1}n._urlDataSource=n.resources.consume(h.we);n._dataStore=n.resources.consume(l.e);n._iosMobilePathDataSource=n.resources.isExposed(h.C)?n.resources.consume(h.C):null;n._isVisible=t.isVisible;n._updateIsVisibleBinding();n.isCloseVisible=o.observable(!0);n._storePath=t.useODCAdjustLink?"https://app.adjust.com/k8x1qd_mpo9r5":"https://app.adjust.com/xxf6jd_wkry4s_qxfx79";return n}t.prototype.onCloseButtonClick=function(){this._dismiss()};t.prototype.onCloseClick=function(){this.isCloseVisible.peek()||this._dismiss()};t.prototype.onContentClick=function(){var e=this,t=Date.now(),n=d.format(y.ENGAGEMENT_NAME_FORMAT,m.e[this._urlDataSource.getPageType()],g.e[this._urlDataSource.getQueryType()],v[v.SmartBannerV2_Click]);u.e.logData({name:n.toLowerCase()});if(this._platformDetection.isIOS)this._navigation.navigateTo(this._storePath);else{this.async.setTimeout(function(){Date.now()-t<750&&e._navigation.navigateTo(e._storePath)},250);this._navigation.navigateTo(this._iosMobilePathDataSource.getPath())}};t.prototype._dismiss=function(){this._isVisible(!1);this._dataStore.setValue(t.STORAGE_KEY,Date.now(),c.e.local);var e=d.format(y.ENGAGEMENT_NAME_FORMAT,m.e[this._urlDataSource.getPageType()],g.e[this._urlDataSource.getQueryType()],v[v.SmartBannerV2_Close]);u.e.logData({name:e.toLowerCase(),extraData:{action:y.BINDING_ACTION}})};t.prototype._updateIsVisibleBinding=function(){var e=!1;if(this._iosMobilePathDataSource){e=!0;if(!this._isTestHookEnabled){var n=this._dataStore.getValue(t.STORAGE_KEY,c.e.local);if(n){n>this._getPromptWaitTimeMilli()&&(e=!1)}}}e&&u.e.logData({name:"SmartBannerV2_View",currentPage:m.e[this._urlDataSource.getPageType()],extraData:{queryType:g.e[this._urlDataSource.getQueryType()]}});this._isVisible(e)};t.prototype._getPromptWaitTimeMilli=function(){return Date.now()-864e5};t.STORAGE_KEY="oneDriveSmartBannerVisible";return t})(f.t),S=n(16).e({tagName:"ms-smart-bannerv2",template:'<div class="SmartBannerV2" data-bind="dismiss:onCloseClick">\x3c!--ko if:isCloseVisible--\x3e<button class="SmartBanner-close" data-bind="click:onCloseButtonClick"><i class="ms-Icon ms-Icon--Cancel" data-bind="icon:true"></i></button>\x3c!--/ko--\x3e<div class="SmartBanner-content"><div class="SmartBanner-icon" data-bind="css:{\'SmartBanner-useSquareIcon\':useSquareIcon}"><span class="ms-Icon ms-Icon--OneDrive" role="img" data-bind="icon:true"></span></div><div class="SmartBanner-text" data-bind="css:{\'SmartBanner-noTagline\':hideTagline}"><div class="SmartBanner-lead" data-bind="text:leadText"></div><div class="SmartBanner-tagline" data-bind="text:taglineText,visible:!hideTagline"></div></div><div class="SmartBanner-button"><button class="od-Button od-Button--primary" data-bind="click:onContentClick"><span class="od-Button-label" data-bind="text:buttonText"></span></button></div><div class="ms-clearfix"></div></div></div>',viewModel:E});t.default=S},"2192":function(e,t,n){"use strict";var r=n(0),i=n(444),s=n(1380),o=n(31),u=n(25),a=n(196),f=n(43),l=n(1223),c=n(10),h=n(141),p=n(4),d=n(80),v=n(346),m=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._photoProvider=n.resources.consume(o.d);n._albumProvider=n.resources.consume(s.resourceKey);n._tagProvider=n.resources.consume(o.T);var r=n.viewParams.peek();if(r&&r.noRootId)n._allPhotosUserSettings=n.createObservable({rootId:"",isAscending:!1});else{n._allPhotosUserSettings=n._photoProvider.getAllPhotosSettings();n.createBackgroundComputed(n._computeAllPhotosSettings).extend({rateLimit:{timeout:0,method:"notifyWhenChangesStop"}})}n.createBackgroundComputed(n._markNewAutoAlbumAsSeen);n.createBackgroundComputed(n._computeRequestFocusItem).extend({rateLimit:{timeout:100,method:"notifyWhenChangesStop"}});return n}t.prototype.getDefaultLayoutForView=function(){var t=this.referenceItemSet(),n=this.layoutType.peek()||f.u;if(!t)return n;var r=t.context,i=t.item(),s=this.urlDataSource.getKeyParams(i.key);if(this._isGetItemRequest(r))if(i.isPlaceholder)switch(s.id){case"albums":n=f.e}else switch(i.virtualItemType){case h.e.Album:n=f.l;break;case h.e.AlbumRoot:n=f.e}else{switch(s.qt){case"allmyphotos":n=e.prototype.getDefaultLayoutForView.call(this)}switch(s.id){case"tags":case"places":n=f.h}}return n};t.prototype.isItemResolved=function(t){return e.prototype.isItemResolved.call(this,t)&&!!t.peek().itemFromServer};t.prototype.resolveIndices=function(e){for(var t=this,n=new a.e(6),r=this.itemSet.peek().content.peek().items,i=[],s=function(e){return function(){return t.itemProvider.getItem(e)}},o=0,f=e;o<f.length;o++){var l=r[f[o]];if(l&&l.peek()&&l.peek().key){var c={parentKey:l.peek().key,resultSetOptions:this.itemResultSetOptions};i.push(n.enqueue(s(c)))}}return u.n.all(i).then(function(){})};t.prototype.getOnThisDayContext=function(){var e=this.requiredRange.peek(),n=this._allPhotosUserSettings.peek().rootId,r=this.referenceRevision.peek(),i=this.currentItemKey.peek(),s=this.urlDataSource.getKeyParams(i),o=this.viewParams.peek(),u={parentKey:void 0,photoType:9,startIndex:e.start,endIndex:e.end,rootItemId:n,revision:r,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:s.locationFilter,tagFilter:s.tagFilter},a=new Date;a.setHours(0);a.setMinutes(0);a.setSeconds(0);a.setMilliseconds(0);var f=a.toISOString(),l=!0,c=!1;try{l=f=new Date(Date.parse(o.onThisDay)).toISOString();c=!!o.highlights&&!!o.highlights}catch(e){}u.startDate=f;u.onThisDay=l;u.highlights=c;return u};t.prototype.getCurrentItemSetSync=function(e){var t;if(this._isGetItemRequest(e)){t=this.itemProvider.getItemSync(e);"albums"===this.urlDataSource.getKeyParams(e.parentKey).id&&(t.item().displayName=v.e.albumsNavLink)}else{switch(e.photoType){case 0:case 6:case 7:case 8:case 9:t=this._photoProvider.getAllPhotosSync(e);break;case 2:t=this._tagProvider.getAllTagsSync(e,l.e.allTags);break;case 3:t=this._tagProvider.getAllTagsSync(e,l.e.allPlaces);break;default:t=this.itemSet.peek()}}return t};t.prototype.getCurrentItemSet=function(e){var t;if(this._isGetItemRequest(e)){switch(this.urlDataSource.getKeyParams(e.parentKey).id){case"albums":default:t=this.itemProvider.getItem(e)}}else switch(e.photoType){case 0:case 6:case 7:case 8:t=this._photoProvider.getAllPhotosForPage(e);break;case 9:t=this._photoProvider.getOnThisDayPhotos(e);break;case 2:t=this._tagProvider.getAllTags(e);break;case 3:t=this._tagProvider.getAllPlaces(e);break;default:t=null}return t};t.prototype.computeCurrentContext=function(){var e,n=this.requiredRange(),r=this.viewParams(),i=this.referenceRevision(),s=this.urlDataSource.getPhotoType(r),o=this.currentItemKey();if(1===s){e={parentKey:o,queryType:c.e.AllMyPhotos,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,r)}}else if(5===s){var u=this.urlDataSource.getFocusItemKey(),a=null;u&&this.focusItemIndexInItemSet()<0&&(a=u);e={parentKey:o,queryType:c.e.AllMyPhotos,startKey:a,startIndex:n.start,endIndex:n.end,revision:i,ownerId:this.urlDataSource.getOwnerId(o,r),resultSetOptions:this.itemResultSetOptions}}else if(4===s)e=this._determineFaceContext();else{var f=this.urlDataSource.getKeyParams(o),l=void 0;"allmyphotos"!==f.qt||f.tagFilter||f.locationFilter||(l=this._allPhotosUserSettings().rootId);e=9===s?this.getOnThisDayContext():{parentKey:null,photoType:s,startIndex:n.start,endIndex:n.end,rootItemId:l,revision:i,ascending:!1,pageSize:t.REQUEST_PAGE_SIZE,locationFilter:f.locationFilter,tagFilter:f.tagFilter}}return e};t.prototype._markNewAutoAlbumAsSeen=function(){var e=this.item();if(!Object(p.isFeatureEnabled)(p.EnableEvokeAlignments)&&e.properties.newTag&&e.properties.autoAlbumTag){var t=!1,n=this.viewParams();this.resources.consume(d.n)&&void 0===n.tagFilter&&(t=!0);this._albumProvider.markAutoAlbumAsSeen(e,t)}};t.prototype._determineFaceContext=function(){var e=this.requiredRange();return{startIndex:e.start,endIndex:e.end,parentKey:this.currentItemKey(),queryType:c.e.AllMyPhotos,sortField:"size",isAscending:!1,revision:this.referenceRevision()}};t.prototype._computeAllPhotosSettings=function(){var e=this._allPhotosUserSettings(),t=this.currentItemKey(),n=this.urlDataSource.getKeyParams(t),r=n.id,i=this.urlDataSource.getQueryType(n),s=!n.locationFilter&&!n.tagFilter&&!n.onThisDay;if(e&&r!==e.rootId&&i===c.e.AllMyPhotos&&s){n.id=e.rootId;this.navigation.navigateTo({url:this.urlDataSource.getItemUrl(this.urlDataSource.getKey(n),{viewParams:this.viewParams.peek()}),ignoreHistory:!0})}};t.prototype._computeRequestFocusItem=function(){var e,t=this.itemCacheToKOStoreDataSource();if(t)e=t.focusedKOItem();else{var n=this.focusItem();if(!n)return;e=n()}if(e&&!e.parentKey&&!e.isPlaceholder){var r=this.focusItemContext();this.trackPromise(this.itemProvider.getItem(r))}};t.prototype._isGetItemRequest=function(e){return!!e.parentKey&&!this.useItemCacheData()};t.REQUEST_PAGE_SIZE=100;return t})(i.e);t.e=m},"2193":function(e,t,n){"use strict";n.d(t,"e",function(){return u});var r=n(25),i=n(515),s=n(3),o=n(5),u=new s.t({name:"PhotosItemsScopeItemContent.key",loader:new o.t(function(){return Object(i.t)({path:"./PhotosItemsScopeItemContent",getModule:function(){return r.n.resolve(Promise.all([n.e("ondemand.resx-ondemand"),n.e("deferred.resx-deferred"),n.e("154")]).then(n.bind(null,2566)))},getExport:function(e){return e.knockoutResourceKey.local}})})})},"2196":function(e,t,n){"use strict";var r=n(0),i=n(1),s=n(7),o=n(1223),u=n(1509),a=n(155),f=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});return e.call(this,t)||this}t.prototype.extractSharedAlbumsFromItemSet=function(e){for(var t=this,n=[],r=0,i=e.content.peek().items;r<i.length;r++){var s=i[r],o=this.peekUnwrapObservable(s);o.isAlbum&&o.ownerId!==a.t.viewerId&&n.push(s)}return n.sort(function(e,n){return t.peekUnwrapObservable(n).dateSharedTime.getTime()-t.peekUnwrapObservable(e).dateSharedTime.getTime()})};t.prototype.getTagsAndPlaces=function(e,t){for(var n=[],r={},i=[],s={},o=0;o<100;o++){var u=e[o];if(!u)break;var a=u.peek(),f=a.tags&&a.tags.length>0,l=a.geoLocation&&a.geoLocation.hierarchyIndex;if(f&&l){Math.random()<.5?this._makeTagEntry(a,r,n,t):this._makePlaceEntry(a,s,i,t)}else f?this._makeTagEntry(a,r,n,t):l&&this._makePlaceEntry(a,s,i,t)}return{tags:n,places:i}};t.prototype._makePlaceEntry=function(e,t,n,r){var i=e.geoLocation,s=i&&i.hierarchyIndex;if(s&&e.thumbnail){var o=t[s];if(!o){var u=this._makePlace(i,r);o=t[s]=u;n.push(u)}var a=o.peek();a.folder.covers?a.folder.covers.push(e.thumbnail):a.folder.covers=[e.thumbnail];o(a)}};t.prototype._makeTagEntry=function(e,t,n,r){var i=e.tags[Math.floor(Math.random()*e.tags.length)],s=t[i.tag];if(!s){var o=this._makeTag(i,r);s=t[i.tag]=o;n.push(o)}var u=s.peek();u.folder.covers?u.folder.covers.push(e.thumbnail):u.folder.covers=[e.thumbnail];s(u)};t.prototype._makeTag=function(e,t){var n={count:0,localizedTag:e.localizedTag,tag:e.tag};return i.observable(u.n(o.e.allTags,n,null,t))};t.prototype._makePlace=function(e,t){return i.observable(u.n(o.e.allPlaces,null,e,t))};return t})(s.n);t.e=f},"2197":function(e,t,n){"use strict";var r=n(0),i=n(25),s=n(7),o=n(15),u=n(31),a=n(1380),f=n(83),l=n(10),c=n(4),h=n(941),p=(function(e){Object(r.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n._promotedPhotosDataSource=n.resources.consume(o.K);n._albumProvider=n.resources.consume(a.resourceKey);n._photoProvider=n.resources.consume(u.d);n._itemProvider=n.resources.consume(f.resourceKey);n._urlDataSource=n.resources.consume(o.we);return n}t.prototype.getNewAutoAlbums=function(){var e={parentKey:this._albumProvider.getAlbumsParentKey({})};return this._itemProvider.getItem(e).then(function(e){return e.content.peek().items.filter(function(e){var t=e.peek();return Object(c.isFeatureEnabled)(c.EnableEvokeAlignments)&&h.s(t)||!Object(c.isFeatureEnabled)(c.EnableEvokeAlignments)&&!!t.properties&&!!t.properties.autoAlbumTag})})};t.prototype.getTagsAndPlaces=function(e){var t=this,n=this._photoProvider.getAllPhotosSync(e);return this._photoProvider.getAllPhotosForPage(e).then(function(){var r=n.content().items;return t._promotedPhotosDataSource.getTagsAndPlaces(r,e)})};t.prototype.getOnThisDay=function(e){var t=new Date;t.setHours(0);t.setMinutes(0);t.setSeconds(0);t.setMilliseconds(0);var n={parentKey:e.parentKey,startDate:t.toISOString(),onThisDay:!0,highlights:!1,pageSize:e.pageSize,ascending:e.ascending,rootItemId:e.rootItemId,startIndex:e.startIndex},r=this._photoProvider.getAllPhotosSync(n),s=r.item,o=s.peek();return r.isPlaceholder||r.isExpired||o.isPlaceholder?this._photoProvider.getOnThisDayPhotos(n).then(function(e){var t=e&&e.content.peek();return t&&t.items.length?[e.item]:[]}):o.folder.covers.length?i.n.wrap([s]):i.n.wrap([])};t.prototype.getSharedAlbums=function(){var e=this;return this._itemProvider.getItem({parentKey:this._urlDataSource.getRootItemKey(l.e.SharedWithMe)}).then(function(t){return e._promotedPhotosDataSource.extractSharedAlbumsFromItemSet(t)})};return t})(s.n);t.e=p},"2397":function(e,t,n){"use strict";n.d(t,"e",function(){return r});var r;(function(e){e[e.none=0]="none";e[e.allPhotos=1]="allPhotos";e[e.albums=2]="albums";e[e.autoAlbums=3]="autoAlbums";e[e.tags=4]="tags";e[e.places=5]="places";e[e.singleAlbum=6]="singleAlbum";e[e.singleTag=7]="singleTag";e[e.singlePlace=8]="singlePlace";e[e.search=9]="search";e[e.onThisDay=10]="onThisDay"})(r||(r={}))},"2572":function(e,t,n){"use strict";n.r(t);n(1228);var r=n(11);Object(r.n)([{rawString:"[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:48px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:48px}[dir=ltr] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:54px}[dir=rtl] .xxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxlg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xxxxlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:54px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=ltr] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:32px}[dir=rtl] .lg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .lg .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .xlg .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .xlg .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:32px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=ltr] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=ltr] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=ltr] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-right:4px}[dir=rtl] .md .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .md .od-PhotosRootItemContent-list.od-ItemContent-list,[dir=rtl] .sm .od-PhotosRootItemContent-header.od-ItemContent-header,[dir=rtl] .sm .od-PhotosRootItemContent-list.od-ItemContent-list{padding-left:4px}.od-PhotosRootItemContent-tagsFeedback{padding-left:48px}.xlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list,.xxxxlg .od-PhotosRootItemContent--hasGroupings .od-PhotosRootItemContent-list.od-ItemContent-list{padding-top:0}"}]);n(561);var i=n(1336),s=n(1366);Object(r.n)([{rawString:".od-ScrollBarTooltip{height:40px;background:"},{theme:"white",defaultValue:"#ffffff"},{rawString:";position:absolute;padding:4px 10px;cursor:default;box-shadow:0 0 5px 0 "},{theme:"blackTranslucent40",defaultValue:"rgba(0,0,0,.4)"},{rawString:";border:1px solid "},{theme:"neutralTertiaryAlt",defaultValue:"#c8c6c4"},{rawString:";box-sizing:border-box}.od-ScrollBarTooltip-displayText{color:"},{theme:"neutralPrimary",defaultValue:"#323130"},{rawString:";line-height:30px}.od-OverlayHost-overlay .od-ScrollBarTooltip{transition:opacity 267ms linear,visibility 0s linear 267ms;opacity:0;visibility:hidden}.od-OverlayHost-overlay.od-OverlayHost-overlay--opened .od-ScrollBarTooltip{transition-delay:0s,0s;opacity:1;visibility:inherit}"}]);var o=n(0),u=n(1),a=n(9),f=n(1321),l=n(21),c=n(76),h=n(35),p=n(268),d=n(187),v=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this;n._container=Object(c.t)(n.element);var r=n.valueAccessor();n._position=u.observable();n._isUpdatingScrollPosition=!1;n.events.on(n._container,"scroll",n._updateScrollPosition);n.events.on(window,"resize",n._updateScrollPosition);n._updateScrollPosition();n._containerClientRect=u.observable();n._containerClientRect.equalityComparer=d.e;new(n.managed(p.e))({element:n._container,bindingContext:n.bindingContext,allBindingsAccessor:n.allBindingsAccessor,valueAccessor:function(){return{size:n._containerClientRect,includePosition:!0}}});if(r.position){n.createComputed(function(){return r.position(n._position())});n.subscribe(r.position,n._position)}r.containerClientRect&&n.createComputed(function(){return r.containerClientRect(n._containerClientRect())});r.container&&r.container(n._container);n.subscribe(n._position,n._onScrollPositionChanged);return n}t.prototype._updateScrollPosition=function(){var e=new h.e(this._container.scrollLeft/this._container.scrollWidth,this._container.scrollTop/this._container.scrollHeight);this._isUpdatingScrollPosition=!0;try{this._position(e)}finally{this._isUpdatingScrollPosition=!1}};t.prototype._onScrollPositionChanged=function(e){if(!this._isUpdatingScrollPosition){var t=this._container.scrollWidth,n=this._container.scrollHeight;this._container.scrollLeft=Math.max(0,Math.min(t,e.x*t));this._container.scrollTop=Math.max(0,Math.min(n,e.y*n))}};t.supportsVirtualElements=!0;return t})(l.t),m=n(86),g=n(51),y=n(49),b=(function(e){Object(o.__extends)(t,e);function t(t){var n=e.call(this,t)||this,r=t.valueAccessor();n._isDragging=r.isDragging;n._mousePoint=r.mousePoint;n._initEvents();return n}t.prototype._onMouseDown=function(e){this._isDragging(!0)};t.prototype._onMouseUp=function(e){this._isDragging(!1);this._mousePoint(new h.e(e.clientX,e.clientY))};t.prototype._onMouseMove=function(e){this._isDragging.peek()&&this._mousePoint(new h.e(e.clientX,e.clientY))};t.prototype._onTouchStart=function(e){this._isDragging(!0)};t.prototype._onTouchEnd=function(e){this._isDragging(!1);this._mousePoint(new h.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY))};t.prototype._onTouchMove=function(e){if(this._isDragging.peek()){e.preventDefault();this._mousePoint(new h.e(e.changedTouches[0].clientX,e.changedTouches[0].clientY))}};t.prototype._initEvents=function(){var e=document.body,t=this.element;this.events.on(t,"touchstart",this._onTouchStart,!0);this.events.on(t,"touchend",this._onTouchEnd,!0);this.events.on(document,"touchmove",this._onTouchMove,!0);this.events.on(t,"mousedown",this._onMouseDown);this.events.on(t,"mouseup",this._onMouseUp);this.events.on(e,"dragend",this._onMouseUp);this.events.on(e,"mousemove",this._onMouseMove);this.events.on(document,"mouseup",this._onMouseUp)};return t})(l.t),w=n(34),E=(function(e){Object(o.__extends)(t,e);function t(t){void 0===t&&(t={});var n=e.call(this,t)||this;n.addBindingHandlers({scrollBarPosition:v,visibility:f.e,drag:b});n._platformDetection=n.resources.consume(w.e);n._scrollBarWidth=y.t.getScrollbarWidth();n.overlayTagName=m.e.tagName;n.scrollContainerClientRect=u.observable();n.scrollContainerClientRect.equalityComparer=d.e;n.scrollPosition=u.observable();n.scrollPosition.equalityComparer=d.e;n.scrollContainer=u.observable();var r=t.label,i=void 0===r?u.observable(""):r,s=t.isDragging,o=void 0===s?u.observable(!1):s;n._label=i;n.isDragging=o;n.mousePoint=u.observable(new h.e(0,0));n.isIdle=u.observable(!0);n.left=n.createComputed(n._computeLeft);n.right=n.createComputed(n._computeRight);n.top=n.createComputed(n._computeTop);n.displayText=n.createComputed(n._computeDisplayText);n.isVisible=n.createPureComputed(n._computeIsVisible);n.createComputed(n._computeUpdateScrollPositionOnDrag);n.createComputed(n._computeSuspendIdleOnScrollPosition);n.createComputed(n._computeGoIdle).extend({rateLimit:{timeout:1200,method:"notifyWhenChangesStop"}});return n}t.prototype._computeLeft=function(){return g.e.isRightToLeft?this._computeMarginOffset():null};t.prototype._computeRight=function(){return g.e.isRightToLeft?null:this._computeMarginOffset()};t.prototype._computeMarginOffset=function(){var e=0;this._platformDetection.isMac&&(e=y.t.MAC_SCROLL_BAR_WIDTH);return this._scrollBarWidth+4+e+"px"};t.prototype._computeDisplayText=function(){var e=this._label();return e||""};t.prototype._computeTop=function(){var e=this.scrollPosition(),t=this.scrollContainerClientRect();if(!e||!t)return"0";var n=t.height-40;return e.y*n+"px"};t.prototype._computeUpdateScrollPositionOnDrag=function(){if(this.isDragging()){var e=this.mousePoint(),t=this.scrollContainerClientRect(),n=e.y-t.top,r=t.height-40,i=new h.e(0,Math.max(0,Math.min(1,n/r)));this.scrollPosition(i)}};t.prototype._computeIsVisible=function(){return!!this._label()&&(!this.isIdle()||this.isDragging())};t.prototype._computeSuspendIdleOnScrollPosition=function(){this.scrollPosition();this.isIdle(!1)};t.prototype._computeGoIdle=function(){this.scrollPosition();this.isIdle()||this.isDragging()||this.isIdle(!0)};return t})(a.t),S=n(16).e({tagName:"od-scroll-bar-tooltip",template:'\x3c!--ko scrollBarPosition:{containerClientRect:scrollContainerClientRect,position:scrollPosition,container:scrollContainer}--\x3e\x3c!--/ko--\x3e\x3c!--ko if:!!scrollContainerClientRect()&&!!scrollContainer()&&isVisible()--\x3e\x3c!--ko component:{name:overlayTagName,params:{alignToParent:true,parentElement:scrollContainer(),animation:{afterAdd:1,beforeRemove:267}}}--\x3e<div class="od-ScrollBarTooltip" data-bind="style:{top:top,left:left,right:right},drag:{isDragging:isDragging,mousePoint:mousePoint}"><span class="od-ScrollBarTooltip-displayText ms-font-m" data-bind="text:displayText"></span></div>\x3c!--/ko--\x3e\x3c!--/ko--\x3e',viewModel:E,synchronous:!0}),x=n(191),T=n(6),N=n(23),C=n(31),k=n(24),L=n(395),A=n(192),O=n(47),M=n(22),_=n(1223),D=n(1509),P=n(43),H=n(1470),B=n(1038),j=Object(B.e)(function(){return Object(o.__awaiter)(void 0,void 0,void 0,function(){return Object(o.__generator)(this,function(e){switch(e.label){case 0:return[4,Promise.all([n.e("ondemand.resx-ondemand"),n.e("190")]).then(n.bind(null,3192))];case 1:return[2,e.sent().default]}})})}),F=(function(e){Object(o.__extends)(t,e);function t(t,n){var r=e.call(this,t,n)||this;r.addBindingHandlers({control:k.t,react:x.t});r.breadcrumbBarTagName=s.e.tagName;r.emptyFolderControl=Object(k.n)(i.e,{});r.scrollBarTooltipTagName=S.tagName;r._itemSetMonitor=r.resources.consume(L.e);r.itemSet=r._itemSetMonitor.itemSet;r.itemSetSelectionModel=r.resources.consume(T.C);r.contentRange=r.resources.consume(N.t);r._photoProvider=r.resources.consume(C.d);r.resources.expose(N.o.layoutType,r.createObservable(P.t));r.layoutType=r.resources.consume(H.t);r._dataManagerMapper=r.resources.consume(T.i);r.listViewContextMenuHelper=r.resources.consume(N.u.optional);r.visibleItemRange=r.createObservable();r.visibleItemRange.equalityComparer=d.e;r._crumbs=r.createPureComputed(r._computeCrumbs);r.title=r.createPureComputed(function(){return r._getTagFilterString(r._itemSetMonitor.itemSet(),r._itemSetMonitor.name())});r.item=r._itemSetMonitor.item;r.showList=r.createPureComputed(function(){return!!r.layoutType()&&r._itemSetMonitor.hasItems()});r.showEmpty=r._itemSetMonitor.isEmpty;r.showBreadcrumb=r.createPureComputed(r._computeShowBreadcrumb);r.showTitle=r.createPureComputed(r._computeShowTitle);r.hasGroupings=r.createPureComputed(r._computeHasGroupings);r.imageTagFeedbackControlParams={componentType:j,props:{isResultsOptions:!0,isTagsPivot:!1,isDetailsPane:!1}};r.createBackgroundComputed(r._computeSetDocumentTitle);r.scrollBarTooltipParams={listRange:r.contentRange,label:r.createPureComputed(r._computeScrollBarTooltipLabel)};r.layoutParams={itemSet:r.itemSet,selectionModel:r.itemSetSelectionModel,requiredRange:r.contentRange,visibleItemRange:r.visibleItemRange,enableMarqueeSelection:!0,contextMenuHelper:r.listViewContextMenuHelper,mode:0};return r}t.prototype.getCrumbs=function(e){function t(e,t){var n=new A.e(t);n.id=e;n.isDropEnabled=!1;n.isPlaceholder=!0;n.properties={};n.type=O.e.Folder;n.tagInfo={tagType:_.e.allPlaces};return n}var n=M.e(e.key);if(!n.locationFilter)return[];var r=n.locationFilter.split(D.e);delete n.locationFilter;for(var i=M.n(n),s=!1,o=[];r.length>0;){var u=s,a=!s,f=r.join(D.e),l=i+"&locationFilter="+r.join(D.t),c=r.pop();if(0!==c.length){var h=t(f,l);o.push({key:h.key,url:"#"+h.key,name:c,showNextChevron:s,isDroppingTarget:this.createObservable(!1),item:h,isOverflow:!1,isNavItem:u,isStaticItem:a});s=!0}}return o};t.prototype._computeScrollBarTooltipLabel=function(){var e=this.visibleItemRange();if(e){var t=this._itemSetMonitor.itemSet(),n=Math.floor((e.end-e.start)/2)+e.start,r=this._dataManagerMapper().getOriginalItemIndexByMappedIndex(n),i=this._photoProvider.findMonthGroupingByIndex(t.key,r);return i&&i.name||""}return""};t.prototype._computeShowTitle=function(){var e=this._itemSetMonitor.item();return this._itemSetMonitor.hasName()&&!e.isRootFolder&&!this._crumbs().length};t.prototype._computeShowBreadcrumb=function(){return!!this._crumbs().length};t.prototype._computeCrumbs=function(){return this.getCrumbs(this._itemSetMonitor.item())};t.prototype._computeHasGroupings=function(){return!!(this._itemSetMonitor.itemSet().content().groupings||[]).length};t.prototype._getTagFilterString=function(e,t){var n=e.context;return n&&n.tagFilter?"#"+n.tagFilter:t};t.prototype._computeSetDocumentTitle=function(){var e=this._itemSetMonitor.itemSet(),t=M.e(e.item().key);if(t.locationFilter){var n=t.locationFilter.split(D.e).pop();n&&(document.title=n)}};return t})(a.t);n.d(t,"resourceKey",function(){return I});var I=Object(k.e)({name:"PhotosRootItemContent",automationName:"od-photos-root-item-content",template:'<div class="od-PhotosRootItemContent od-ItemContent" data-bind="css:{\'od-PhotosRootItemContent--hasGroupings\':hasGroupings}">\x3c!--ko if:showTitle()||showBreadcrumb()--\x3e<div class="od-PhotosRootItemContent-header od-ItemContent-header">\x3c!--ko if:showTitle--\x3e<div class="od-PhotosRootItemContent-title od-ItemContent-title" data-bind="text:title"></div>\x3c!--/ko--\x3e\x3c!--ko if:showBreadcrumb--\x3e<div class="od-PhotosRootItemContent-breadcrumb od-ItemContent-breadcrumb" data-bind="component:{name:breadcrumbBarTagName,params:{item:item,getCrumbs:$component.getCrumbs.bind($component)}}"></div>\x3c!--/ko--\x3e</div>\x3c!--/ko--\x3e\x3c!--ko if:showTitle--\x3e<div class="od-PhotosRootItemContent-tagsFeedback od-ItemContent-tagsFeedback" data-bind="react:imageTagFeedbackControlParams"></div>\x3c!--/ko--\x3e\x3c!--ko if:showList--\x3e<div class="od-PhotosRootItemContent-list od-ItemContent-list" data-bind="component:{name:layoutType,params:layoutParams}"></div>\x3c!--/ko--\x3e\x3c!--ko if:showEmpty--\x3e<div class="od-PhotosRootItemContent-empty od-ItemContent-empty" data-bind="control:emptyFolderControl"></div>\x3c!--/ko--\x3e\x3c!--ko component:{name:scrollBarTooltipTagName,params:scrollBarTooltipParams}--\x3e\x3c!--/ko--\x3e</div>',viewModelType:F})}}]);