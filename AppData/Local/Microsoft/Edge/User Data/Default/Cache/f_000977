Type.registerNamespace("Common.App.AppsForOfficeCommon");Common.App.AppsForOfficeCommon.B=function(){};Common.App.AppsForOfficeCommon.o=function(){this.Ver=1};Common.App.AppsForOfficeCommon.i=function(n){this.b=n};Common.App.AppsForOfficeCommon.i.prototype={b:null,a:function(n,t,i){var r=new Common.App.AppsForOfficeCommon.o;r.Data=t;r.data=t;r.RR=i;r.CreatedOn=(new Date).getTime();this.b.a(n,Sys.Serialization.JavaScriptSerializer.serialize(r))}};Common.App.AppsForOfficeCommon.o.registerClass("Common.App.AppsForOfficeCommon.o");Type.registerNamespace("Common.App.OAuth");Common.App.OAuth.c=function(){};Common.App.OAuth.c.registerInterface("Common.App.OAuth.c");Common.App.OAuth.f=function(){};Common.App.OAuth.f.prototype={supported:0,userUnsupported:1,browserUnsupported:2,hostUnsupported:3};Common.App.OAuth.f.registerEnum("Common.App.OAuth.f",!1);Common.App.OAuth.n=function(){};Common.App.OAuth.n.registerInterface("Common.App.OAuth.n");Common.App.OAuth.e=function(){};Common.App.OAuth.e.prototype={external:0,msa:1,aad:2};Common.App.OAuth.e.registerEnum("Common.App.OAuth.e",!0);Common.App.OAuth.g=function(){};Common.App.OAuth.h=function(n){this.e=n};Common.App.OAuth.h.prototype={e:null,b:function(){return Promise.resolve(!0)},c:function(){return Promise.resolve(!0)},d:function(){Diag.a.a(574239257,3e3,50,"Automation flag set.  Returning Mock Token.");var n;return Promise.resolve((n=new Common.ch,n.IsSuccess=!0,n.Token=this.e,n.ErrorCode="",n.ErrorMessage="",n))},a:function(){return"MockAuthTokenStrategy"}};Common.App.OAuth.b=function(){};Common.App.OAuth.b.b=function(){var n;return n=new Common.App.OAuth.g,n.upn=Common.a.a.b("UserPrincipalName")||"",n.authority=Common.App.OAuth.a.m(),n.authorityType=Common.App.OAuth.b.a(),n.tenantId=Common.a.a.b("TenantId")||"",n};Common.App.OAuth.b.a=function(){var n=0,t=Common.App.OAuth.b.c();return t.toLowerCase()==="aad"?n=2:t.toLowerCase()==="msa"&&(n=1),n};Common.App.OAuth.b.c=function(){return Common.a.a.b("HostAuthType")||""};Common.App.OAuth.d=function(n){var t,i,r,u;this.k=Common.a.a.a("IsO365ConsumerHost")||Common.a.a.a("IsO365CommercialHost");this.j=!1;this.f=this.t();this.e=n?n:this.s();this.d=this.e?this.e.a():"None";this.m=0;Diag.a.a(42084323,3e3,50,"OAuthManager created with clientVer={0}, appVer={1}, docVer={2}, strategy={3}",5,Common.App.OAuth.a.j(),Common.App.OAuth.a.e(),this.d);Common.App.OAuth.a.e()<1&&(t=Common.a.a.b("UserPrincipalName"),i=Common.a.a.b("OAuthManagerDocumentSettings"),Diag.a.a(570775236,3e3,15,"docVer={0}, IsFullAppSettingsReady={1}, userPrincipalNameLength={2}, documentSettingsLength={3}",Common.App.OAuth.a.e(),Common.a.a.m===1,isNullOrUndefined(t)?-1:t.length,isNullOrUndefined(i)?-1:i.length),r=this,u=this,Common.a.a.K().then(function(){return Diag.a.a(562312641,3e3,15,"docVer={0}, IsFullAppSettingsReady={1}, userPrincipalNameLength={2}, documentSettingsLength={3}",Common.App.OAuth.a.e(),Common.a.a.m===1,isNullOrUndefined(t)?-1:t.length,isNullOrUndefined(i)?-1:i.length),!0},function(){return Diag.a.a(562312642,3e3,15,"docVer={0}, IsFullAppSettingsReady={1}, userPrincipalNameLength={2}, documentSettingsLength={3}",Common.App.OAuth.a.e(),Common.a.a.m===1,isNullOrUndefined(t)?-1:t.length,isNullOrUndefined(i)?-1:i.length),!1}))};Common.App.OAuth.d.b=function(){return Common.App.OAuth.a.n()};Common.App.OAuth.d.c=function(n){var i=Common.App.OAuth.b.a(),t=null;return i===2?t=Common.App.OAuth.a.i()[n]:i===1&&(t=Common.App.OAuth.a.k()[n]),t};Common.App.OAuth.d.d=function(){var n=Common.App.OAuth.a.q();return n&&(Common.c.p()&&Array.contains(n,"Electron")||Common.c.X()&&Array.contains(n,"Safari"))?!1:!0};Common.App.OAuth.d.prototype={k:!1,f:0,j:!1,e:null,d:"None",m:0,g:null,h:0,i:null,l:0,t:function(){if(this.x()||this.j)return 0;var n=Common.App.OAuth.b.b().upn,t=!!n&&n.length>0&&!Common.a.a.a("IsAnonymousUser"),i=this.k,r=Common.App.OAuth.d.b()||Common.App.OAuth.d.d();return i?t?r?0:2:1:3},s:function(){var n=Common.App.OAuth.a.u();return n&&n.length>0?(this.j=!0,new Common.App.OAuth.h(n)):!this.f?Common.App.OAuth.d.b()?new Common.App.OAuth.j:new Common.App.OAuth.l:new Common.App.OAuth.m(this.f)},v:function(n){this.p(n)},p:function(n){var i,t,r;return this.g||(Diag.a.a(573390991,3e3,50,"Initializing {0}",this.d),this.h=Common.g.a(),this.g=Common.App.OAuth.d.a.a(this.e.b(),!1,Common.App.OAuth.a.l())),this.i||(this.l=Common.g.a(),t=this,r=this,this.i=this.g.then(function(r){return i=Common.g.a()-t.h,r?(t.d=t.e.a(),Diag.a.a(42084353,3e3,50,"{0} initialized in {1} ms",t.d,i),Common.App.OAuth.d.a.a(t.e.c(Common.App.OAuth.b.b()),!1,Common.App.OAuth.a.l())):(Diag.a.a(42267908,3e3,10,"{0} failed to initialized for app [{1}] after {2} ms, all future TryGetToken requests will fail.",t.d,n,i),Promise.resolve(!1))}).catch(function(){return i=Common.g.a()-r.h,Diag.a.a(574239256,3e3,10,"{0} failed to initialized for app [{1}] after {2} ms, all future TryGetToken requests will fail.",r.d,n,i),Promise.resolve(!1)})),this.i},x:function(){return!1},a:function(n,t,i){return this.o(n,t,!1,null,"",i,0)},c:function(n,t,i,r,u){return this.o(n,t,!0,i,r,u,0)},o:function(n,t,i,r,u,f,e){var o,s,h;if(e+=1,Diag.a.a(42084352,3e3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called.  Using strategy {2} - attempt {3}",n,t,this.d,e),!Common.App.OAuth.a.t())return this.n((o=new Common.ch,o.IsSuccess=!1,o.Token=null,o.ErrorCode="NotEnabled",o.ErrorMessage="OAuthManager is disabled.",o),n);if(s=Common.App.OAuth.d.c(n),isNullOrUndefined(s))return Diag.a.a(41961345,3e3,15,"Auth context not found. Ensure that your app [{0}] is listed in WacFrameImplicitAuthAADApplications or WacFrameImplicitAuthMSAV2Applications.",n),this.n((h=new Common.ch,h.IsSuccess=!1,h.Token=null,h.ErrorCode="DisallowedApp",h.ErrorMessage="Disallowed appName: "+n,h),n);var l=Common.g.a(),y=this,p=this.p(s).then(function(e){return y.w(n,s,t,i,r,u,f,e)}),a=i?0:Common.App.OAuth.a.l(),c,w=(c=new Common.ch,c.IsSuccess=!1,c.Token=null,c.ErrorCode="authTokenStrategy_timeout",c.ErrorMessage="Auth Strategy timed out after ["+a+"] ms when fetching token",c),b=Common.App.OAuth.d.a.a(p,w,a),v=this,k=this;return b.then(function(o){return e<=2&&(o.ErrorCode==="Timeout"||o.ErrorCode==="authTokenStrategy_timeout")?(Diag.a.a(573175516,3e3,50,"TryGetToken attempt {0} timed out after {1} ms - retrying",e,Common.g.a()-l),v.o(n,t,i,r,u,f,e)):Promise.resolve(v.q(o,n,t,s,l))}).catch(function(){var i,r=(i=new Common.ch,i.IsSuccess=!1,i.Token=null,i.ErrorCode="authTokenStrategy_failure",i.ErrorMessage="Auth Strategy failed with an unknown error",i);return Promise.resolve(k.q(r,n,t,s,l))})},w:function(n,t,i,r,u,f,e,o){var l=Common.g.a()-this.l,s,h,c;return Diag.a.a(573390992,3e3,50,"Load {0} status: [{1}] after {2} ms",this.d,o?"succeeded":"failed",l),o?(h=this,c=this,this.e.d(n,t,i,r,u,f,e).then(function(n){return Promise.resolve(h.r(n,!0))}).catch(function(n){return Promise.resolve(c.r(n,!1))})):this.n((s=new Common.ch,s.IsSuccess=!1,s.Token=null,s.ErrorCode="InitFailed",s.ErrorMessage="Auth Strategy Failed to Init or Load",s),n)},q:function(n,t,i,r,u){var f={};return f.IsSuccess=n.IsSuccess,f.ErrorCode=n.IsSuccess?"Success":n.ErrorCode,t==="AddinShared"?(f.ErrorMessage=n.IsSuccess?"Success":"REDACTED",f.Target="REDACTED"):(f.ErrorMessage=n.IsSuccess?"Success":n.ErrorMessage,f.Target=i),f.TimeInMS=Common.g.a()-u,f.AuthLibrary=this.d,f.AppName=t,f.AuthorityType=Common.App.OAuth.e.toString(Common.App.OAuth.b.a()),f.UserType=this.u(Common.App.OAuth.b.b()),f.IsAuthSupportedInSession=Common.App.OAuth.f.toString(this.f),f.RequestCount=++this.m,f.AppId=r,Diag.a.a(593863640,3e3,50,JSON.stringify(f)),n},n:function(n,t){return Diag.a.a(578435090,3e3,15,"OAuthManager failed without invoking GetToken. AppName: '{0}', Reason: '{1}'",t,n.ErrorMessage),Promise.resolve(n)},u:function(n){return Common.a.a.a("IsAnonymousUser")?"anonymous":!n.upn||n.upn.length<1?"empty":n.upn.indexOf("guest#")>-1?"guest":n.upn.indexOf("ext#")>-1?"external":"supported"},b:function(){return!this.f},r:function(n,t){var i=n,e=null,r=null,u=null,o=null,f;return i?i.ErrorCode||i.ErrorMessage?(r=i.ErrorCode?i.ErrorCode:"Exception",u=i.ErrorMessage?i.ErrorMessage:"No message"):i.Token?t?e=i.Token:(r="RejectToken",u="A rejected promise returned a token."):(r="Exception",u=JSON.stringify(i)):(r="NoResult",u="No result came from Auth Token Strategy"),i&&i.Telemetry&&(o=i.Telemetry,Diag.a.a(579166408,3e3,50,JSON.stringify(o))),(r==="monitor_window_timeout"||r==="token_renewal_error")&&(r="Timeout",u="Auth Library Timed Out"),r==="login_required"&&u.indexOf("AADSTS50058")>-1&&(r="Cookies Disabled"),(r||u)&&(e=null),f=new Common.ch,f.IsSuccess=!!e,f.Token=e,f.ErrorCode=r,f.ErrorMessage=u,f.Telemetry=o,f}};Common.App.OAuth.d.a=function(){};Common.App.OAuth.d.a.a=function(n,t,i){if(!i)return n;var r=0;return Promise.race([n,new Promise(function(n){r=window.setTimeout(function(){n(t)},i)})]).then(function(n){return window.clearTimeout(r),Promise.resolve(n)}).catch(function(){return window.clearTimeout(r),Promise.resolve(t)})};Common.App.OAuth.i=function(){};Common.App.OAuth.i.a=function(){Common.App.a.a().a(new Common.App.OAuth.i,0,!1)};Common.App.OAuth.i.prototype={a:function(){return"Common.App.OAuth.OAuthPackage"},c:function(n){var t=this;n.b(Common.App.OAuth.c,null).a().b(function(){return new Common.App.OAuth.d(null)})},b:function(){var i=Common.Utils.a.a().a(Common.App.OAuth.c,null),n,t,r,u;i.v(null);n=Common.App.OAuth.a.s();t=Common.App.OAuth.a.m();!isNullOrUndefined(n)&&n.length>0&&!isNullOrUndefined(t)&&t.length>0&&(t!=="https://login.microsoftonline.com/"||Common.a.a.d("Microsoft.Office.SharedOnline.CorePFTEnabled",!1))&&(r=Common.g.a(),u=this,i.a("Core",n,null).then(function(n){Diag.a.a(562943369,3e3,50,'OAuthManager attempted to get a Core token to the WAC FrontEnd API in {3} ms. Success={0}, ErrorCode="{1}", ErrorMessage="{2}"',n.IsSuccess,n.ErrorCode,n.ErrorMessage,Math.floor(Common.g.a()-r))}))}};Common.App.OAuth.j=function(){};Common.App.OAuth.j.prototype={e:null,b:function(){var n=this;return new Promise(function(t){Common.Utils.a.a().c(Common.App.WopiIdentity.d,null).a(function(i){n.e=i;t(!0)})})},f:function(n){for(var u,i=!1,f=n.toLocaleUpperCase(),r=["HTTPS:","API:"],e=r.length,t=0;t<e;++t)if(u=r[t],f.startsWith(u)){i=!0;break}return i||this.g(n)?n+"/.default":n},g:function(n){var t=new RegExp("/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i");return t.test(n)},c:function(){return Promise.resolve(!0)},d:function(n,t,i,r,u,f,e){var s,c,h,o,l;if(Common.c.F()&&(s=!1,c=Common.a.a.d("Microsoft.Office.SharedOnline.HostSupportsTeamsElectronSSO",!1),c&&(h=Common.App.OAuth.a.x(),h&&(s=Array.contains(h,n))),!s))return l=(o=new Common.ch,o.IsSuccess=!1,o.ErrorCode="TeamsDisallowedApp",o.ErrorMessage="Disallowed appName: "+n,o),Promise.resolve(l);var a=this.f(i),v=new Common.App.WopiIdentity.g(i,a,!r,null,Common.a.k),y=this,p=this;return this.e.getAccessToken(v,t,e).then(function(n){var t;return t=new Common.ch,t.IsSuccess=!0,t.Token=n.get_accessToken(),t},function(n){var t;return t=new Common.ch,t.IsSuccess=!1,t.ErrorCode=n,t})},a:function(){var n=Common.a.a.b("UiHost"),t=Common.a.a.b("UiHostIntegrationType");return n=n&&n!==""?n:"Unspecified",t=t&&t!==""?t:"Unspecified",String.format("ParentFrameTokenStrategy uiHost={0} uiHostIntegrationType={1}",n,t)}};Common.App.OAuth.k=function(){};Common.App.OAuth.k.prototype={a:null,d:null,b:0,c:null};Common.App.OAuth.l=function(){this.p=Function.createDelegate(this,this.y);this.s=Function.createDelegate(this,this.B);this.t=Function.createDelegate(this,this.C);this.q=Function.createDelegate(this,this.z);this.r=Function.createDelegate(this,this.A);this.e=new Common.dc(null,null,null);this.l=Common.a.a.d("Microsoft.Office.SharedOnline.SharedAuthVNext",!1);this.k="SharedAuthTokenStrategy "+(this.l?"BrowserAuth 1.20210225.2/MSAL 2.11.0":"BrowserAuth 1.20210112.6/MSAL 2.11.0");this.g=Common.App.OAuth.a.w();this.n=Common.App.OAuth.a.v();this.i=Common.App.OAuth.a.r();this.m=Common.a.a.d("Microsoft.Office.SharedOnline.OAuthPopupFlashEnabled",!1);this.f={}};Common.App.OAuth.l.prototype={j:null,g:null,n:null,k:null,i:!1,m:!1,h:0,e:null,l:!1,f:null,a:function(){return this.k},b:function(){var i,t,n,r;return"loadFrame"in this.f?this.f.loadFrame.c:this.g?(i=this.o("loadFrame"),this.h=Common.g.a(),t=this.g+this.n+"?replyUrl="+window.location.protocol+"//"+window.location.host+"&usid="+Common.a.k,this.l&&(t=t+"&vnext=1"),n=document.createElement("iframe"),this.x(n),n.style.cssText="height:0;width:0;display:none;",n.id="SharedAuthFrame",n.setAttribute("name","SharedAuthFrame"),n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms allow-popups"),n.src=t,this.j=n,document.body.appendChild(n),r=Common.g.a()-this.h,Diag.a.a(573112899,3e3,50,"SharedAuthTokenStrategy Create: Frame Appended to Document. E/T:[{0}]. sharedAuthFrame.Src={1}",r,n.src),i):(Diag.a.a(562381581,3e3,10,"SharedAuthTokenStrategy Init failed: No Shared Frame Origin Path"),Promise.reject(!1))},c:function(n){var t=new Common.cB("SharedAuth_Init"),i;return t.Values=this.u(n),i=this.o("initFrame"),this.e.h(t,this.j.contentWindow,this.g),Diag.a.a(573112900,3e3,50,"SharedAuthTokenStrategy Init: Called package initialize."),i},d:function(n,t,i,r,u,f){var e=new Common.cB("SharedAuth_TryGetToken"),o=this.w(),s;return e.Values=this.D(n,t,i,r,u,f,o),s=this.o(o),this.e.h(e,this.j.contentWindow,this.g),Diag.a.a(573112901,3e3,50,"SharedAuthTokenStrategy TryGetToken: Called TryGetToken for app {0}",t),s},w:function(){return Common.w.a().a},D:function(n,t,i,r,u,f,e){var o={};return o.appName=n,o.appId=t,o.target=i,o.withPopup=r,o.claims=u,o.promptMessage=f,o.messageCorrelationId=e,o},x:function(n){$addHandler(n,"load",this.r);$addHandler(n,"error",this.q);this.e.f(this.g);this.e.c("SharedAuth_ScriptLoaded");this.e.b("SharedAuth_ScriptLoaded",this.t);this.e.c("SharedAuth_ScriptInitialized");this.e.b("SharedAuth_ScriptInitialized",this.s);this.e.c("SharedAuth_GetTokenResponse");this.e.b("SharedAuth_GetTokenResponse",this.p)},o:function(n){var t=new Common.App.OAuth.k,r,i;return t.b=Common.g.a(),r=this,i=new Promise(function(n,i){t.a=n;t.d=i}),t.c=i,this.f[n]=t,i},A:function(){var n=Common.g.a()-this.h;Diag.a.a(572346566,3e3,50,"WACOAuth.aspx iFrame loaded successfully. E/T:[{0}]",n)},z:function(n){var t=Common.g.a()-this.h;Diag.a.a(572346567,3e3,10,"WACOAuth.aspx iFrame failed to load after {0} ms: {1}",t,this.i?JSON.stringify(n):"")},C:function(n){var i=this.f.loadFrame,u=Common.g.a()-i.b,t=n.Values.AuthLibrary.toString(),r=n.Values.Success.toString();Diag.a.a(573112902,3e3,50,"SharedAuthTokenStrategy OnScriptLoaded. Success={0} AuthLibrary={1} E/T: [{2}]",r,t,u);t&&(this.k="SharedAuthTokenStrategy "+t);i.a(Boolean.parse(r))},B:function(){var n=this.f.initFrame,t=Common.g.a()-n.b;Diag.a.a(573112903,3e3,50,"SharedAuthTokenStrategy OnScriptInitialized. E/T: [{0}]",t);n.a(!0)},y:function(n){var t,i,r;if(!n.Values.messageCorrelationId||!n.Values.messageCorrelationId.toString()){Diag.a.a(573112904,3e3,10,"SharedAuthTokenStrategy OnGetTokenResponse called without valid messageCorrelationId");return}if(t=this.f[n.Values.messageCorrelationId.toString()],!t){Diag.a.a(573112905,3e3,10,"SharedAuthTokenStrategy OnGetTokenResponse called with an unregistered messageCorrelationId");return}i=Common.g.a()-t.b;Diag.a.a(573112906,3e3,50,"SharedAuthTokenStrategy OnGetTokenResponse. E/T: [{0}]",i);r=!!n.Values.isSuccess&&Boolean.parse(n.Values.isSuccess.toString());r?t.a(n.Values.response):t.d(n.Values.response)},u:function(n){var t={};return t.appIds=this.v(n.authorityType),t.upn=n.upn,t.authority=n.authority,t.authorityType=Common.App.OAuth.e.toString(n.authorityType),t.tenantId=n.tenantId,t.correlationId=Common.a.k,t.enableConsoleLogging=this.i,t.enablePopupFlash=this.m,t},v:function(n){var u=[],t={},i,r,f;n===2?t=Common.App.OAuth.a.i():n===1&&(t=Common.App.OAuth.a.k());i=t;for(r in i)f={key:r,value:i[r]},Array.add(u,f.value);return u}};Common.App.OAuth.m=function(n){this.e=n};Common.App.OAuth.m.prototype={e:0,b:function(){return Promise.resolve(!0)},c:function(){return Promise.resolve(!0)},d:function(){var n;return Promise.resolve((n=new Common.ch,n.IsSuccess=!1,n.Token=null,n.ErrorCode="Unsupported",n.ErrorMessage="Unable to get a token. Reason: ["+Common.App.OAuth.f.toString(this.e)+"]",n))},a:function(){return"UnsupportedAuthTokenStrategy"}};Common.App.OAuth.d.registerClass("Common.App.OAuth.d",null,Common.App.OAuth.c);Common.App.OAuth.d.a.registerClass("Common.App.OAuth.d.a");Common.App.OAuth.k.registerClass("Common.App.OAuth.k");Common.App.OAuth.i.a();Type.registerNamespace("Common.App.LivePersonaUtils");Common.App.LivePersonaUtils.b=function(){};Common.App.LivePersonaUtils.b.a=function(){Common.App.a.a().a(new Common.App.LivePersonaUtils.b,0,!1)};Common.App.LivePersonaUtils.b.prototype={a:function(){return"Common.App.LivePersonaUtils"},b:function(){Common.Utils.a.a().a(Common.dZ,null)},c:function(n){var t=this;n.b(Common.App.LivePersonaUtils.a,null).c(Common.dZ,null).a().b(function(){return new Common.App.LivePersonaUtils.a(Common.Utils.b.a(Common.App.OAuth.c,n.c(Common.App.OAuth.c,null)))})}};Common.App.LivePersonaUtils.a=function(n){this.b=n};Common.App.LivePersonaUtils.a.a=function(){return Common.a.a.a("IsO365CommercialHost")||Common.a.a.a("IsO365ConsumerHost")};Common.App.LivePersonaUtils.a.prototype={b:null,a:function(){var r=this.d(),t,i,n;return r?Common.App.LivePersonaUtils.a.a()?(n=this,new Promise(function(t,i){n.b.CW(function(){if(n.b.b===4||n.b.b===5){i(Error.create("Error downloading auth library"));return}n.b.a().a("Loki",r,null).then(function(i){var f,r,u;return f=Common.a.a.a("ForceLokiFallbackToACLPTokenIsEnabled")?n.c():i.IsSuccess&&i.Token?(r=new Common.dD,r.isSuccess=!0,r.token=i.Token,r.errorMessage=null,r):Common.a.a.d("Microsoft.Office.SharedOnline.LokiUserDataSignatureTokenIsEnabled",!1)||Common.a.a.a("LokiUserDataSignatureTokenIsEnabled")?n.c():(u=new Common.dD,u.isSuccess=!1,u.token=null,u.errorMessage=JSON.stringify(i),u),t(f),f})})})):Promise.resolve((i=new Common.dD,i.isSuccess=!1,i.token=null,i.errorMessage="Not attempting to fetch token because host is not an O365 host.",i)):Promise.resolve((t=new Common.dD,t.isSuccess=!1,t.token=null,t.errorMessage=String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",Common.App.OAuth.b.c()),t))},c:function(){var t=Common.a.a.b("LokiUserDataSignature")||"",n;return n=new Common.dD,n.isSuccess=!0,n.token=t,n.errorMessage=null,n},d:function(){var n=null,t=Common.App.OAuth.b.a();return t===2?n=Common.a.a.b("LokiAADAppId"):t===1&&(n=Common.a.a.b("LokiMSAAppId")),n}};Common.App.LivePersonaUtils.a.registerClass("Common.App.LivePersonaUtils.a",null,Common.dZ);Common.App.LivePersonaUtils.b.a();Type.registerNamespace("_Ewa");_Ewa.yR=function(n){_Ewa.yR.initializeBase(this);this.i=n;this.l()};_Ewa.yR.a=function(n){n.a().b(_Ewa.bic.$$(_Ewa.iz),350,new _Ewa.yR(n))};_Ewa.yR.prototype={i:null,b:function(){this.k(this.i.a().a(_Ewa.iz,349,!1,null)||new _Ewa.OAuthManagerWrapper(Common.Utils.a.a().a(Common.App.OAuth.c,null)))}};_Ewa.OAuthManagerWrapper=function(n){this.c=n};_Ewa.OAuthManagerWrapper.prototype={c:null,b:function(n,t){var i,r;return this.c?(r=this,this.c.a(n,t,null).then(function(t){t.IsSuccess||Diag.a.a(51401292,0,15,"Error retrieving auth token. Message: "+t.ErrorMessage+" Error code: "+t.ErrorCode+" App name: "+n);var i;return i=new _Ewa.iA,i.IsSuccess=t.IsSuccess,i.Token=t.Token,i.ErrorCode=t.ErrorCode,i.ErrorMessage=t.ErrorMessage,i})):(Diag.a.a(51401291,0,10,"Oauth manager is null"),Promise.resolve((i=new _Ewa.iA,i.IsSuccess=!1,i.Token=null,i.ErrorCode="FailedToResolve",i.ErrorMessage="Failed to resolve IOAuthManager from the container.",i)))},a:function(){return this.c?this.c.b():null}};_Ewa.yR.registerClass("_Ewa.yR",_Ewa.rY.$$(_Ewa.iz));_Ewa.OAuthManagerWrapper.registerClass("_Ewa.OAuthManagerWrapper",null,_Ewa.iz);Type.registerNamespace("_Ewa");_Ewa.bjw=function(){};_Ewa.bjw.a=function(){_Ewa.m.a(function(n){_Ewa.yR.a(n)})};_Ewa.bjw.a();